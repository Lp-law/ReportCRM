(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const i of l)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(l){const i={};return l.integrity&&(i.integrity=l.integrity),l.referrerPolicy&&(i.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?i.credentials="include":l.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(l){if(l.ep)return;l.ep=!0;const i=n(l);fetch(l.href,i)}})();function Qp(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Bu={exports:{}},Ui={},$u={exports:{}},xe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vl=Symbol.for("react.element"),Xp=Symbol.for("react.portal"),qp=Symbol.for("react.fragment"),Jp=Symbol.for("react.strict_mode"),Zp=Symbol.for("react.profiler"),eh=Symbol.for("react.provider"),th=Symbol.for("react.context"),nh=Symbol.for("react.forward_ref"),rh=Symbol.for("react.suspense"),sh=Symbol.for("react.memo"),lh=Symbol.for("react.lazy"),id=Symbol.iterator;function ih(e){return e===null||typeof e!="object"?null:(e=id&&e[id]||e["@@iterator"],typeof e=="function"?e:null)}var Uu={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Hu=Object.assign,Wu={};function Ns(e,t,n){this.props=e,this.context=t,this.refs=Wu,this.updater=n||Uu}Ns.prototype.isReactComponent={};Ns.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ns.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function zu(){}zu.prototype=Ns.prototype;function Uo(e,t,n){this.props=e,this.context=t,this.refs=Wu,this.updater=n||Uu}var Ho=Uo.prototype=new zu;Ho.constructor=Uo;Hu(Ho,Ns.prototype);Ho.isPureReactComponent=!0;var ad=Array.isArray,Vu=Object.prototype.hasOwnProperty,Wo={current:null},Gu={key:!0,ref:!0,__self:!0,__source:!0};function Ku(e,t,n){var r,l={},i=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(i=""+t.key),t)Vu.call(t,r)&&!Gu.hasOwnProperty(r)&&(l[r]=t[r]);var o=arguments.length-2;if(o===1)l.children=n;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];l.children=c}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)l[r]===void 0&&(l[r]=o[r]);return{$$typeof:vl,type:e,key:i,ref:a,props:l,_owner:Wo.current}}function ah(e,t){return{$$typeof:vl,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function zo(e){return typeof e=="object"&&e!==null&&e.$$typeof===vl}function oh(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var od=/\/+/g;function ia(e,t){return typeof e=="object"&&e!==null&&e.key!=null?oh(""+e.key):t.toString(36)}function Xl(e,t,n,r,l){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case vl:case Xp:a=!0}}if(a)return a=e,l=l(a),e=r===""?"."+ia(a,0):r,ad(l)?(n="",e!=null&&(n=e.replace(od,"$&/")+"/"),Xl(l,t,n,"",function(d){return d})):l!=null&&(zo(l)&&(l=ah(l,n+(!l.key||a&&a.key===l.key?"":(""+l.key).replace(od,"$&/")+"/")+e)),t.push(l)),1;if(a=0,r=r===""?".":r+":",ad(e))for(var o=0;o<e.length;o++){i=e[o];var c=r+ia(i,o);a+=Xl(i,t,n,c,l)}else if(c=ih(e),typeof c=="function")for(e=c.call(e),o=0;!(i=e.next()).done;)i=i.value,c=r+ia(i,o++),a+=Xl(i,t,n,c,l);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function Rl(e,t,n){if(e==null)return e;var r=[],l=0;return Xl(e,r,"","",function(i){return t.call(n,i,l++)}),r}function ch(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var kt={current:null},ql={transition:null},dh={ReactCurrentDispatcher:kt,ReactCurrentBatchConfig:ql,ReactCurrentOwner:Wo};function Yu(){throw Error("act(...) is not supported in production builds of React.")}xe.Children={map:Rl,forEach:function(e,t,n){Rl(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Rl(e,function(){t++}),t},toArray:function(e){return Rl(e,function(t){return t})||[]},only:function(e){if(!zo(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};xe.Component=Ns;xe.Fragment=qp;xe.Profiler=Zp;xe.PureComponent=Uo;xe.StrictMode=Jp;xe.Suspense=rh;xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dh;xe.act=Yu;xe.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Hu({},e.props),l=e.key,i=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,a=Wo.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Vu.call(t,c)&&!Gu.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];r.children=o}return{$$typeof:vl,type:e.type,key:l,ref:i,props:r,_owner:a}};xe.createContext=function(e){return e={$$typeof:th,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:eh,_context:e},e.Consumer=e};xe.createElement=Ku;xe.createFactory=function(e){var t=Ku.bind(null,e);return t.type=e,t};xe.createRef=function(){return{current:null}};xe.forwardRef=function(e){return{$$typeof:nh,render:e}};xe.isValidElement=zo;xe.lazy=function(e){return{$$typeof:lh,_payload:{_status:-1,_result:e},_init:ch}};xe.memo=function(e,t){return{$$typeof:sh,type:e,compare:t===void 0?null:t}};xe.startTransition=function(e){var t=ql.transition;ql.transition={};try{e()}finally{ql.transition=t}};xe.unstable_act=Yu;xe.useCallback=function(e,t){return kt.current.useCallback(e,t)};xe.useContext=function(e){return kt.current.useContext(e)};xe.useDebugValue=function(){};xe.useDeferredValue=function(e){return kt.current.useDeferredValue(e)};xe.useEffect=function(e,t){return kt.current.useEffect(e,t)};xe.useId=function(){return kt.current.useId()};xe.useImperativeHandle=function(e,t,n){return kt.current.useImperativeHandle(e,t,n)};xe.useInsertionEffect=function(e,t){return kt.current.useInsertionEffect(e,t)};xe.useLayoutEffect=function(e,t){return kt.current.useLayoutEffect(e,t)};xe.useMemo=function(e,t){return kt.current.useMemo(e,t)};xe.useReducer=function(e,t,n){return kt.current.useReducer(e,t,n)};xe.useRef=function(e){return kt.current.useRef(e)};xe.useState=function(e){return kt.current.useState(e)};xe.useSyncExternalStore=function(e,t,n){return kt.current.useSyncExternalStore(e,t,n)};xe.useTransition=function(){return kt.current.useTransition()};xe.version="18.3.1";$u.exports=xe;var w=$u.exports;const Vo=Qp(w);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uh=w,fh=Symbol.for("react.element"),mh=Symbol.for("react.fragment"),ph=Object.prototype.hasOwnProperty,hh=uh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xh={key:!0,ref:!0,__self:!0,__source:!0};function Qu(e,t,n){var r,l={},i=null,a=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)ph.call(t,r)&&!xh.hasOwnProperty(r)&&(l[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)l[r]===void 0&&(l[r]=t[r]);return{$$typeof:fh,type:e,key:i,ref:a,props:l,_owner:hh.current}}Ui.Fragment=mh;Ui.jsx=Qu;Ui.jsxs=Qu;Bu.exports=Ui;var s=Bu.exports,Ba={},Xu={exports:{}},Vt={},qu={exports:{}},Ju={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(I,K){var q=I.length;I.push(K);e:for(;0<q;){var F=q-1>>>1,Z=I[F];if(0<l(Z,K))I[F]=K,I[q]=Z,q=F;else break e}}function n(I){return I.length===0?null:I[0]}function r(I){if(I.length===0)return null;var K=I[0],q=I.pop();if(q!==K){I[0]=q;e:for(var F=0,Z=I.length,Ie=Z>>>1;F<Ie;){var be=2*(F+1)-1,Me=I[be],Se=be+1,St=I[Se];if(0>l(Me,q))Se<Z&&0>l(St,Me)?(I[F]=St,I[Se]=q,F=Se):(I[F]=Me,I[be]=q,F=be);else if(Se<Z&&0>l(St,q))I[F]=St,I[Se]=q,F=Se;else break e}}return K}function l(I,K){var q=I.sortIndex-K.sortIndex;return q!==0?q:I.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var c=[],d=[],f=1,m=null,x=3,b=!1,j=!1,S=!1,O=typeof setTimeout=="function"?setTimeout:null,h=typeof clearTimeout=="function"?clearTimeout:null,p=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(I){for(var K=n(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=I)r(d),K.sortIndex=K.expirationTime,t(c,K);else break;K=n(d)}}function E(I){if(S=!1,v(I),!j)if(n(c)!==null)j=!0,U(D);else{var K=n(d);K!==null&&te(E,K.startTime-I)}}function D(I,K){j=!1,S&&(S=!1,h(H),H=-1),b=!0;var q=x;try{for(v(K),m=n(c);m!==null&&(!(m.expirationTime>K)||I&&!y());){var F=m.callback;if(typeof F=="function"){m.callback=null,x=m.priorityLevel;var Z=F(m.expirationTime<=K);K=e.unstable_now(),typeof Z=="function"?m.callback=Z:m===n(c)&&r(c),v(K)}else r(c);m=n(c)}if(m!==null)var Ie=!0;else{var be=n(d);be!==null&&te(E,be.startTime-K),Ie=!1}return Ie}finally{m=null,x=q,b=!1}}var M=!1,P=null,H=-1,ne=5,A=-1;function y(){return!(e.unstable_now()-A<ne)}function $(){if(P!==null){var I=e.unstable_now();A=I;var K=!0;try{K=P(!0,I)}finally{K?_():(M=!1,P=null)}}else M=!1}var _;if(typeof p=="function")_=function(){p($)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,z=R.port2;R.port1.onmessage=$,_=function(){z.postMessage(null)}}else _=function(){O($,0)};function U(I){P=I,M||(M=!0,_())}function te(I,K){H=O(function(){I(e.unstable_now())},K)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(I){I.callback=null},e.unstable_continueExecution=function(){j||b||(j=!0,U(D))},e.unstable_forceFrameRate=function(I){0>I||125<I?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ne=0<I?Math.floor(1e3/I):5},e.unstable_getCurrentPriorityLevel=function(){return x},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(I){switch(x){case 1:case 2:case 3:var K=3;break;default:K=x}var q=x;x=K;try{return I()}finally{x=q}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(I,K){switch(I){case 1:case 2:case 3:case 4:case 5:break;default:I=3}var q=x;x=I;try{return K()}finally{x=q}},e.unstable_scheduleCallback=function(I,K,q){var F=e.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?F+q:F):q=F,I){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=q+Z,I={id:f++,callback:K,priorityLevel:I,startTime:q,expirationTime:Z,sortIndex:-1},q>F?(I.sortIndex=q,t(d,I),n(c)===null&&I===n(d)&&(S?(h(H),H=-1):S=!0,te(E,q-F))):(I.sortIndex=Z,t(c,I),j||b||(j=!0,U(D))),I},e.unstable_shouldYield=y,e.unstable_wrapCallback=function(I){var K=x;return function(){var q=x;x=K;try{return I.apply(this,arguments)}finally{x=q}}}})(Ju);qu.exports=Ju;var gh=qu.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yh=w,zt=gh;function V(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Zu=new Set,Zs={};function Ur(e,t){fs(e,t),fs(e+"Capture",t)}function fs(e,t){for(Zs[e]=t,e=0;e<t.length;e++)Zu.add(t[e])}var Un=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$a=Object.prototype.hasOwnProperty,Nh=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,cd={},dd={};function vh(e){return $a.call(dd,e)?!0:$a.call(cd,e)?!1:Nh.test(e)?dd[e]=!0:(cd[e]=!0,!1)}function bh(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function wh(e,t,n,r){if(t===null||typeof t>"u"||bh(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function It(e,t,n,r,l,i,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=a}var mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){mt[e]=new It(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];mt[t]=new It(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){mt[e]=new It(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){mt[e]=new It(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){mt[e]=new It(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){mt[e]=new It(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){mt[e]=new It(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){mt[e]=new It(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){mt[e]=new It(e,5,!1,e.toLowerCase(),null,!1,!1)});var Go=/[\-:]([a-z])/g;function Ko(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Go,Ko);mt[t]=new It(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Go,Ko);mt[t]=new It(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Go,Ko);mt[t]=new It(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){mt[e]=new It(e,1,!1,e.toLowerCase(),null,!1,!1)});mt.xlinkHref=new It("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){mt[e]=new It(e,1,!1,e.toLowerCase(),null,!0,!0)});function Yo(e,t,n,r){var l=mt.hasOwnProperty(t)?mt[t]:null;(l!==null?l.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(wh(t,n,l,r)&&(n=null),r||l===null?vh(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,r=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Vn=yh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Tl=Symbol.for("react.element"),Kr=Symbol.for("react.portal"),Yr=Symbol.for("react.fragment"),Qo=Symbol.for("react.strict_mode"),Ua=Symbol.for("react.profiler"),ef=Symbol.for("react.provider"),tf=Symbol.for("react.context"),Xo=Symbol.for("react.forward_ref"),Ha=Symbol.for("react.suspense"),Wa=Symbol.for("react.suspense_list"),qo=Symbol.for("react.memo"),Zn=Symbol.for("react.lazy"),nf=Symbol.for("react.offscreen"),ud=Symbol.iterator;function Is(e){return e===null||typeof e!="object"?null:(e=ud&&e[ud]||e["@@iterator"],typeof e=="function"?e:null)}var Ve=Object.assign,aa;function Fs(e){if(aa===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);aa=t&&t[1]||""}return`
`+aa+e}var oa=!1;function ca(e,t){if(!e||oa)return"";oa=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(d){var r=d}Reflect.construct(e,[],t)}else{try{t.call()}catch(d){r=d}e.call(t.prototype)}else{try{throw Error()}catch(d){r=d}e()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var l=d.stack.split(`
`),i=r.stack.split(`
`),a=l.length-1,o=i.length-1;1<=a&&0<=o&&l[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(l[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||l[a]!==i[o]){var c=`
`+l[a].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=a&&0<=o);break}}}finally{oa=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Fs(e):""}function Sh(e){switch(e.tag){case 5:return Fs(e.type);case 16:return Fs("Lazy");case 13:return Fs("Suspense");case 19:return Fs("SuspenseList");case 0:case 2:case 15:return e=ca(e.type,!1),e;case 11:return e=ca(e.type.render,!1),e;case 1:return e=ca(e.type,!0),e;default:return""}}function za(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Yr:return"Fragment";case Kr:return"Portal";case Ua:return"Profiler";case Qo:return"StrictMode";case Ha:return"Suspense";case Wa:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case tf:return(e.displayName||"Context")+".Consumer";case ef:return(e._context.displayName||"Context")+".Provider";case Xo:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case qo:return t=e.displayName||null,t!==null?t:za(e.type)||"Memo";case Zn:t=e._payload,e=e._init;try{return za(e(t))}catch{}}return null}function jh(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return za(t);case 8:return t===Qo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function xr(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function rf(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Eh(e){var t=rf(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Al(e){e._valueTracker||(e._valueTracker=Eh(e))}function sf(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=rf(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function ci(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Va(e,t){var n=t.checked;return Ve({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function fd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=xr(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function lf(e,t){t=t.checked,t!=null&&Yo(e,"checked",t,!1)}function Ga(e,t){lf(e,t);var n=xr(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ka(e,t.type,n):t.hasOwnProperty("defaultValue")&&Ka(e,t.type,xr(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function md(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Ka(e,t,n){(t!=="number"||ci(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Bs=Array.isArray;function is(e,t,n,r){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&r&&(e[n].defaultSelected=!0)}else{for(n=""+xr(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,r&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function Ya(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(V(91));return Ve({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function pd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(V(92));if(Bs(n)){if(1<n.length)throw Error(V(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:xr(n)}}function af(e,t){var n=xr(t.value),r=xr(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function hd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function of(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qa(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?of(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Cl,cf=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Cl=Cl||document.createElement("div"),Cl.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Cl.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function el(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var zs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kh=["Webkit","ms","Moz","O"];Object.keys(zs).forEach(function(e){kh.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),zs[t]=zs[e]})});function df(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||zs.hasOwnProperty(e)&&zs[e]?(""+t).trim():t+"px"}function uf(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,l=df(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,l):e[n]=l}}var Ih=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xa(e,t){if(t){if(Ih[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(V(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(V(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(V(61))}if(t.style!=null&&typeof t.style!="object")throw Error(V(62))}}function qa(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ja=null;function Jo(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Za=null,as=null,os=null;function xd(e){if(e=Sl(e)){if(typeof Za!="function")throw Error(V(280));var t=e.stateNode;t&&(t=Gi(t),Za(e.stateNode,e.type,t))}}function ff(e){as?os?os.push(e):os=[e]:as=e}function mf(){if(as){var e=as,t=os;if(os=as=null,xd(e),t)for(e=0;e<t.length;e++)xd(t[e])}}function pf(e,t){return e(t)}function hf(){}var da=!1;function xf(e,t,n){if(da)return e(t,n);da=!0;try{return pf(e,t,n)}finally{da=!1,(as!==null||os!==null)&&(hf(),mf())}}function tl(e,t){var n=e.stateNode;if(n===null)return null;var r=Gi(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(V(231,t,typeof n));return n}var eo=!1;if(Un)try{var Rs={};Object.defineProperty(Rs,"passive",{get:function(){eo=!0}}),window.addEventListener("test",Rs,Rs),window.removeEventListener("test",Rs,Rs)}catch{eo=!1}function Rh(e,t,n,r,l,i,a,o,c){var d=Array.prototype.slice.call(arguments,3);try{t.apply(n,d)}catch(f){this.onError(f)}}var Vs=!1,di=null,ui=!1,to=null,Th={onError:function(e){Vs=!0,di=e}};function Ah(e,t,n,r,l,i,a,o,c){Vs=!1,di=null,Rh.apply(Th,arguments)}function Ch(e,t,n,r,l,i,a,o,c){if(Ah.apply(this,arguments),Vs){if(Vs){var d=di;Vs=!1,di=null}else throw Error(V(198));ui||(ui=!0,to=d)}}function Hr(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function gf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function gd(e){if(Hr(e)!==e)throw Error(V(188))}function Dh(e){var t=e.alternate;if(!t){if(t=Hr(e),t===null)throw Error(V(188));return t!==e?null:e}for(var n=e,r=t;;){var l=n.return;if(l===null)break;var i=l.alternate;if(i===null){if(r=l.return,r!==null){n=r;continue}break}if(l.child===i.child){for(i=l.child;i;){if(i===n)return gd(l),e;if(i===r)return gd(l),t;i=i.sibling}throw Error(V(188))}if(n.return!==r.return)n=l,r=i;else{for(var a=!1,o=l.child;o;){if(o===n){a=!0,n=l,r=i;break}if(o===r){a=!0,r=l,n=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===n){a=!0,n=i,r=l;break}if(o===r){a=!0,r=i,n=l;break}o=o.sibling}if(!a)throw Error(V(189))}}if(n.alternate!==r)throw Error(V(190))}if(n.tag!==3)throw Error(V(188));return n.stateNode.current===n?e:t}function yf(e){return e=Dh(e),e!==null?Nf(e):null}function Nf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=Nf(e);if(t!==null)return t;e=e.sibling}return null}var vf=zt.unstable_scheduleCallback,yd=zt.unstable_cancelCallback,_h=zt.unstable_shouldYield,Lh=zt.unstable_requestPaint,Qe=zt.unstable_now,Ph=zt.unstable_getCurrentPriorityLevel,Zo=zt.unstable_ImmediatePriority,bf=zt.unstable_UserBlockingPriority,fi=zt.unstable_NormalPriority,Oh=zt.unstable_LowPriority,wf=zt.unstable_IdlePriority,Hi=null,In=null;function Mh(e){if(In&&typeof In.onCommitFiberRoot=="function")try{In.onCommitFiberRoot(Hi,e,void 0,(e.current.flags&128)===128)}catch{}}var un=Math.clz32?Math.clz32:$h,Fh=Math.log,Bh=Math.LN2;function $h(e){return e>>>=0,e===0?32:31-(Fh(e)/Bh|0)|0}var Dl=64,_l=4194304;function $s(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mi(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,l=e.suspendedLanes,i=e.pingedLanes,a=n&268435455;if(a!==0){var o=a&~l;o!==0?r=$s(o):(i&=a,i!==0&&(r=$s(i)))}else a=n&~l,a!==0?r=$s(a):i!==0&&(r=$s(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&l)&&(l=r&-r,i=t&-t,l>=i||l===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-un(t),l=1<<n,r|=e[n],t&=~l;return r}function Uh(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hh(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,i=e.pendingLanes;0<i;){var a=31-un(i),o=1<<a,c=l[a];c===-1?(!(o&n)||o&r)&&(l[a]=Uh(o,t)):c<=t&&(e.expiredLanes|=o),i&=~o}}function no(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Sf(){var e=Dl;return Dl<<=1,!(Dl&4194240)&&(Dl=64),e}function ua(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function bl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-un(t),e[t]=n}function Wh(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-un(n),i=1<<l;t[l]=0,r[l]=-1,e[l]=-1,n&=~i}}function ec(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-un(n),l=1<<r;l&t|e[r]&t&&(e[r]|=t),n&=~l}}var Te=0;function jf(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var Ef,tc,kf,If,Rf,ro=!1,Ll=[],or=null,cr=null,dr=null,nl=new Map,rl=new Map,rr=[],zh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Nd(e,t){switch(e){case"focusin":case"focusout":or=null;break;case"dragenter":case"dragleave":cr=null;break;case"mouseover":case"mouseout":dr=null;break;case"pointerover":case"pointerout":nl.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":rl.delete(t.pointerId)}}function Ts(e,t,n,r,l,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[l]},t!==null&&(t=Sl(t),t!==null&&tc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function Vh(e,t,n,r,l){switch(t){case"focusin":return or=Ts(or,e,t,n,r,l),!0;case"dragenter":return cr=Ts(cr,e,t,n,r,l),!0;case"mouseover":return dr=Ts(dr,e,t,n,r,l),!0;case"pointerover":var i=l.pointerId;return nl.set(i,Ts(nl.get(i)||null,e,t,n,r,l)),!0;case"gotpointercapture":return i=l.pointerId,rl.set(i,Ts(rl.get(i)||null,e,t,n,r,l)),!0}return!1}function Tf(e){var t=Ir(e.target);if(t!==null){var n=Hr(t);if(n!==null){if(t=n.tag,t===13){if(t=gf(n),t!==null){e.blockedOn=t,Rf(e.priority,function(){kf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Jl(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=so(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Ja=r,n.target.dispatchEvent(r),Ja=null}else return t=Sl(n),t!==null&&tc(t),e.blockedOn=n,!1;t.shift()}return!0}function vd(e,t,n){Jl(e)&&n.delete(t)}function Gh(){ro=!1,or!==null&&Jl(or)&&(or=null),cr!==null&&Jl(cr)&&(cr=null),dr!==null&&Jl(dr)&&(dr=null),nl.forEach(vd),rl.forEach(vd)}function As(e,t){e.blockedOn===t&&(e.blockedOn=null,ro||(ro=!0,zt.unstable_scheduleCallback(zt.unstable_NormalPriority,Gh)))}function sl(e){function t(l){return As(l,e)}if(0<Ll.length){As(Ll[0],e);for(var n=1;n<Ll.length;n++){var r=Ll[n];r.blockedOn===e&&(r.blockedOn=null)}}for(or!==null&&As(or,e),cr!==null&&As(cr,e),dr!==null&&As(dr,e),nl.forEach(t),rl.forEach(t),n=0;n<rr.length;n++)r=rr[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<rr.length&&(n=rr[0],n.blockedOn===null);)Tf(n),n.blockedOn===null&&rr.shift()}var cs=Vn.ReactCurrentBatchConfig,pi=!0;function Kh(e,t,n,r){var l=Te,i=cs.transition;cs.transition=null;try{Te=1,nc(e,t,n,r)}finally{Te=l,cs.transition=i}}function Yh(e,t,n,r){var l=Te,i=cs.transition;cs.transition=null;try{Te=4,nc(e,t,n,r)}finally{Te=l,cs.transition=i}}function nc(e,t,n,r){if(pi){var l=so(e,t,n,r);if(l===null)ba(e,t,r,hi,n),Nd(e,r);else if(Vh(l,e,t,n,r))r.stopPropagation();else if(Nd(e,r),t&4&&-1<zh.indexOf(e)){for(;l!==null;){var i=Sl(l);if(i!==null&&Ef(i),i=so(e,t,n,r),i===null&&ba(e,t,r,hi,n),i===l)break;l=i}l!==null&&r.stopPropagation()}else ba(e,t,r,null,n)}}var hi=null;function so(e,t,n,r){if(hi=null,e=Jo(r),e=Ir(e),e!==null)if(t=Hr(e),t===null)e=null;else if(n=t.tag,n===13){if(e=gf(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return hi=e,null}function Af(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ph()){case Zo:return 1;case bf:return 4;case fi:case Oh:return 16;case wf:return 536870912;default:return 16}default:return 16}}var ir=null,rc=null,Zl=null;function Cf(){if(Zl)return Zl;var e,t=rc,n=t.length,r,l="value"in ir?ir.value:ir.textContent,i=l.length;for(e=0;e<n&&t[e]===l[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===l[i-r];r++);return Zl=l.slice(e,1<r?1-r:void 0)}function ei(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Pl(){return!0}function bd(){return!1}function Gt(e){function t(n,r,l,i,a){this._reactName=n,this._targetInst=l,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Pl:bd,this.isPropagationStopped=bd,this}return Ve(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Pl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Pl)},persist:function(){},isPersistent:Pl}),t}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sc=Gt(vs),wl=Ve({},vs,{view:0,detail:0}),Qh=Gt(wl),fa,ma,Cs,Wi=Ve({},wl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Cs&&(Cs&&e.type==="mousemove"?(fa=e.screenX-Cs.screenX,ma=e.screenY-Cs.screenY):ma=fa=0,Cs=e),fa)},movementY:function(e){return"movementY"in e?e.movementY:ma}}),wd=Gt(Wi),Xh=Ve({},Wi,{dataTransfer:0}),qh=Gt(Xh),Jh=Ve({},wl,{relatedTarget:0}),pa=Gt(Jh),Zh=Ve({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),ex=Gt(Zh),tx=Ve({},vs,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),nx=Gt(tx),rx=Ve({},vs,{data:0}),Sd=Gt(rx),sx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ix={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function ax(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=ix[e])?!!t[e]:!1}function lc(){return ax}var ox=Ve({},wl,{key:function(e){if(e.key){var t=sx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=ei(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?lx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lc,charCode:function(e){return e.type==="keypress"?ei(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?ei(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),cx=Gt(ox),dx=Ve({},Wi,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jd=Gt(dx),ux=Ve({},wl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lc}),fx=Gt(ux),mx=Ve({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),px=Gt(mx),hx=Ve({},Wi,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),xx=Gt(hx),gx=[9,13,27,32],ic=Un&&"CompositionEvent"in window,Gs=null;Un&&"documentMode"in document&&(Gs=document.documentMode);var yx=Un&&"TextEvent"in window&&!Gs,Df=Un&&(!ic||Gs&&8<Gs&&11>=Gs),Ed=" ",kd=!1;function _f(e,t){switch(e){case"keyup":return gx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Lf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Qr=!1;function Nx(e,t){switch(e){case"compositionend":return Lf(t);case"keypress":return t.which!==32?null:(kd=!0,Ed);case"textInput":return e=t.data,e===Ed&&kd?null:e;default:return null}}function vx(e,t){if(Qr)return e==="compositionend"||!ic&&_f(e,t)?(e=Cf(),Zl=rc=ir=null,Qr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Df&&t.locale!=="ko"?null:t.data;default:return null}}var bx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Id(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!bx[e.type]:t==="textarea"}function Pf(e,t,n,r){ff(r),t=xi(t,"onChange"),0<t.length&&(n=new sc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Ks=null,ll=null;function wx(e){Gf(e,0)}function zi(e){var t=Jr(e);if(sf(t))return e}function Sx(e,t){if(e==="change")return t}var Of=!1;if(Un){var ha;if(Un){var xa="oninput"in document;if(!xa){var Rd=document.createElement("div");Rd.setAttribute("oninput","return;"),xa=typeof Rd.oninput=="function"}ha=xa}else ha=!1;Of=ha&&(!document.documentMode||9<document.documentMode)}function Td(){Ks&&(Ks.detachEvent("onpropertychange",Mf),ll=Ks=null)}function Mf(e){if(e.propertyName==="value"&&zi(ll)){var t=[];Pf(t,ll,e,Jo(e)),xf(wx,t)}}function jx(e,t,n){e==="focusin"?(Td(),Ks=t,ll=n,Ks.attachEvent("onpropertychange",Mf)):e==="focusout"&&Td()}function Ex(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return zi(ll)}function kx(e,t){if(e==="click")return zi(t)}function Ix(e,t){if(e==="input"||e==="change")return zi(t)}function Rx(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var pn=typeof Object.is=="function"?Object.is:Rx;function il(e,t){if(pn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var l=n[r];if(!$a.call(t,l)||!pn(e[l],t[l]))return!1}return!0}function Ad(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function Cd(e,t){var n=Ad(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ad(n)}}function Ff(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?Ff(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Bf(){for(var e=window,t=ci();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=ci(e.document)}return t}function ac(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Tx(e){var t=Bf(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&Ff(n.ownerDocument.documentElement,n)){if(r!==null&&ac(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,i=Math.min(r.start,l);r=r.end===void 0?i:Math.min(r.end,l),!e.extend&&i>r&&(l=r,r=i,i=l),l=Cd(n,i);var a=Cd(n,r);l&&a&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Ax=Un&&"documentMode"in document&&11>=document.documentMode,Xr=null,lo=null,Ys=null,io=!1;function Dd(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;io||Xr==null||Xr!==ci(r)||(r=Xr,"selectionStart"in r&&ac(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Ys&&il(Ys,r)||(Ys=r,r=xi(lo,"onSelect"),0<r.length&&(t=new sc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Xr)))}function Ol(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var qr={animationend:Ol("Animation","AnimationEnd"),animationiteration:Ol("Animation","AnimationIteration"),animationstart:Ol("Animation","AnimationStart"),transitionend:Ol("Transition","TransitionEnd")},ga={},$f={};Un&&($f=document.createElement("div").style,"AnimationEvent"in window||(delete qr.animationend.animation,delete qr.animationiteration.animation,delete qr.animationstart.animation),"TransitionEvent"in window||delete qr.transitionend.transition);function Vi(e){if(ga[e])return ga[e];if(!qr[e])return e;var t=qr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in $f)return ga[e]=t[n];return e}var Uf=Vi("animationend"),Hf=Vi("animationiteration"),Wf=Vi("animationstart"),zf=Vi("transitionend"),Vf=new Map,_d="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Nr(e,t){Vf.set(e,t),Ur(t,[e])}for(var ya=0;ya<_d.length;ya++){var Na=_d[ya],Cx=Na.toLowerCase(),Dx=Na[0].toUpperCase()+Na.slice(1);Nr(Cx,"on"+Dx)}Nr(Uf,"onAnimationEnd");Nr(Hf,"onAnimationIteration");Nr(Wf,"onAnimationStart");Nr("dblclick","onDoubleClick");Nr("focusin","onFocus");Nr("focusout","onBlur");Nr(zf,"onTransitionEnd");fs("onMouseEnter",["mouseout","mouseover"]);fs("onMouseLeave",["mouseout","mouseover"]);fs("onPointerEnter",["pointerout","pointerover"]);fs("onPointerLeave",["pointerout","pointerover"]);Ur("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ur("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ur("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ur("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ur("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ur("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Us="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),_x=new Set("cancel close invalid load scroll toggle".split(" ").concat(Us));function Ld(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,Ch(r,t,void 0,e),e.currentTarget=null}function Gf(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],l=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],c=o.instance,d=o.currentTarget;if(o=o.listener,c!==i&&l.isPropagationStopped())break e;Ld(l,o,d),i=c}else for(a=0;a<r.length;a++){if(o=r[a],c=o.instance,d=o.currentTarget,o=o.listener,c!==i&&l.isPropagationStopped())break e;Ld(l,o,d),i=c}}}if(ui)throw e=to,ui=!1,to=null,e}function Le(e,t){var n=t[fo];n===void 0&&(n=t[fo]=new Set);var r=e+"__bubble";n.has(r)||(Kf(t,e,2,!1),n.add(r))}function va(e,t,n){var r=0;t&&(r|=4),Kf(n,e,r,t)}var Ml="_reactListening"+Math.random().toString(36).slice(2);function al(e){if(!e[Ml]){e[Ml]=!0,Zu.forEach(function(n){n!=="selectionchange"&&(_x.has(n)||va(n,!1,e),va(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ml]||(t[Ml]=!0,va("selectionchange",!1,t))}}function Kf(e,t,n,r){switch(Af(t)){case 1:var l=Kh;break;case 4:l=Yh;break;default:l=nc}n=l.bind(null,t,n,e),l=void 0,!eo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),r?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function ba(e,t,n,r,l){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===l||o.nodeType===8&&o.parentNode===l)break;if(a===4)for(a=r.return;a!==null;){var c=a.tag;if((c===3||c===4)&&(c=a.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;a=a.return}for(;o!==null;){if(a=Ir(o),a===null)return;if(c=a.tag,c===5||c===6){r=i=a;continue e}o=o.parentNode}}r=r.return}xf(function(){var d=i,f=Jo(n),m=[];e:{var x=Vf.get(e);if(x!==void 0){var b=sc,j=e;switch(e){case"keypress":if(ei(n)===0)break e;case"keydown":case"keyup":b=cx;break;case"focusin":j="focus",b=pa;break;case"focusout":j="blur",b=pa;break;case"beforeblur":case"afterblur":b=pa;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":b=wd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":b=qh;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":b=fx;break;case Uf:case Hf:case Wf:b=ex;break;case zf:b=px;break;case"scroll":b=Qh;break;case"wheel":b=xx;break;case"copy":case"cut":case"paste":b=nx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":b=jd}var S=(t&4)!==0,O=!S&&e==="scroll",h=S?x!==null?x+"Capture":null:x;S=[];for(var p=d,v;p!==null;){v=p;var E=v.stateNode;if(v.tag===5&&E!==null&&(v=E,h!==null&&(E=tl(p,h),E!=null&&S.push(ol(p,E,v)))),O)break;p=p.return}0<S.length&&(x=new b(x,j,null,n,f),m.push({event:x,listeners:S}))}}if(!(t&7)){e:{if(x=e==="mouseover"||e==="pointerover",b=e==="mouseout"||e==="pointerout",x&&n!==Ja&&(j=n.relatedTarget||n.fromElement)&&(Ir(j)||j[Hn]))break e;if((b||x)&&(x=f.window===f?f:(x=f.ownerDocument)?x.defaultView||x.parentWindow:window,b?(j=n.relatedTarget||n.toElement,b=d,j=j?Ir(j):null,j!==null&&(O=Hr(j),j!==O||j.tag!==5&&j.tag!==6)&&(j=null)):(b=null,j=d),b!==j)){if(S=wd,E="onMouseLeave",h="onMouseEnter",p="mouse",(e==="pointerout"||e==="pointerover")&&(S=jd,E="onPointerLeave",h="onPointerEnter",p="pointer"),O=b==null?x:Jr(b),v=j==null?x:Jr(j),x=new S(E,p+"leave",b,n,f),x.target=O,x.relatedTarget=v,E=null,Ir(f)===d&&(S=new S(h,p+"enter",j,n,f),S.target=v,S.relatedTarget=O,E=S),O=E,b&&j)t:{for(S=b,h=j,p=0,v=S;v;v=Vr(v))p++;for(v=0,E=h;E;E=Vr(E))v++;for(;0<p-v;)S=Vr(S),p--;for(;0<v-p;)h=Vr(h),v--;for(;p--;){if(S===h||h!==null&&S===h.alternate)break t;S=Vr(S),h=Vr(h)}S=null}else S=null;b!==null&&Pd(m,x,b,S,!1),j!==null&&O!==null&&Pd(m,O,j,S,!0)}}e:{if(x=d?Jr(d):window,b=x.nodeName&&x.nodeName.toLowerCase(),b==="select"||b==="input"&&x.type==="file")var D=Sx;else if(Id(x))if(Of)D=Ix;else{D=Ex;var M=jx}else(b=x.nodeName)&&b.toLowerCase()==="input"&&(x.type==="checkbox"||x.type==="radio")&&(D=kx);if(D&&(D=D(e,d))){Pf(m,D,n,f);break e}M&&M(e,x,d),e==="focusout"&&(M=x._wrapperState)&&M.controlled&&x.type==="number"&&Ka(x,"number",x.value)}switch(M=d?Jr(d):window,e){case"focusin":(Id(M)||M.contentEditable==="true")&&(Xr=M,lo=d,Ys=null);break;case"focusout":Ys=lo=Xr=null;break;case"mousedown":io=!0;break;case"contextmenu":case"mouseup":case"dragend":io=!1,Dd(m,n,f);break;case"selectionchange":if(Ax)break;case"keydown":case"keyup":Dd(m,n,f)}var P;if(ic)e:{switch(e){case"compositionstart":var H="onCompositionStart";break e;case"compositionend":H="onCompositionEnd";break e;case"compositionupdate":H="onCompositionUpdate";break e}H=void 0}else Qr?_f(e,n)&&(H="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(H="onCompositionStart");H&&(Df&&n.locale!=="ko"&&(Qr||H!=="onCompositionStart"?H==="onCompositionEnd"&&Qr&&(P=Cf()):(ir=f,rc="value"in ir?ir.value:ir.textContent,Qr=!0)),M=xi(d,H),0<M.length&&(H=new Sd(H,e,null,n,f),m.push({event:H,listeners:M}),P?H.data=P:(P=Lf(n),P!==null&&(H.data=P)))),(P=yx?Nx(e,n):vx(e,n))&&(d=xi(d,"onBeforeInput"),0<d.length&&(f=new Sd("onBeforeInput","beforeinput",null,n,f),m.push({event:f,listeners:d}),f.data=P))}Gf(m,t)})}function ol(e,t,n){return{instance:e,listener:t,currentTarget:n}}function xi(e,t){for(var n=t+"Capture",r=[];e!==null;){var l=e,i=l.stateNode;l.tag===5&&i!==null&&(l=i,i=tl(e,n),i!=null&&r.unshift(ol(e,i,l)),i=tl(e,t),i!=null&&r.push(ol(e,i,l))),e=e.return}return r}function Vr(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function Pd(e,t,n,r,l){for(var i=t._reactName,a=[];n!==null&&n!==r;){var o=n,c=o.alternate,d=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&d!==null&&(o=d,l?(c=tl(n,i),c!=null&&a.unshift(ol(n,c,o))):l||(c=tl(n,i),c!=null&&a.push(ol(n,c,o)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var Lx=/\r\n?/g,Px=/\u0000|\uFFFD/g;function Od(e){return(typeof e=="string"?e:""+e).replace(Lx,`
`).replace(Px,"")}function Fl(e,t,n){if(t=Od(t),Od(e)!==t&&n)throw Error(V(425))}function gi(){}var ao=null,oo=null;function co(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var uo=typeof setTimeout=="function"?setTimeout:void 0,Ox=typeof clearTimeout=="function"?clearTimeout:void 0,Md=typeof Promise=="function"?Promise:void 0,Mx=typeof queueMicrotask=="function"?queueMicrotask:typeof Md<"u"?function(e){return Md.resolve(null).then(e).catch(Fx)}:uo;function Fx(e){setTimeout(function(){throw e})}function wa(e,t){var n=t,r=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(r===0){e.removeChild(l),sl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=l}while(n);sl(t)}function ur(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function Fd(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var bs=Math.random().toString(36).slice(2),wn="__reactFiber$"+bs,cl="__reactProps$"+bs,Hn="__reactContainer$"+bs,fo="__reactEvents$"+bs,Bx="__reactListeners$"+bs,$x="__reactHandles$"+bs;function Ir(e){var t=e[wn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Hn]||n[wn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=Fd(e);e!==null;){if(n=e[wn])return n;e=Fd(e)}return t}e=n,n=e.parentNode}return null}function Sl(e){return e=e[wn]||e[Hn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Jr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(V(33))}function Gi(e){return e[cl]||null}var mo=[],Zr=-1;function vr(e){return{current:e}}function Oe(e){0>Zr||(e.current=mo[Zr],mo[Zr]=null,Zr--)}function De(e,t){Zr++,mo[Zr]=e.current,e.current=t}var gr={},wt=vr(gr),Lt=vr(!1),Lr=gr;function ms(e,t){var n=e.type.contextTypes;if(!n)return gr;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l={},i;for(i in n)l[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function Pt(e){return e=e.childContextTypes,e!=null}function yi(){Oe(Lt),Oe(wt)}function Bd(e,t,n){if(wt.current!==gr)throw Error(V(168));De(wt,t),De(Lt,n)}function Yf(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var l in r)if(!(l in t))throw Error(V(108,jh(e)||"Unknown",l));return Ve({},n,r)}function Ni(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||gr,Lr=wt.current,De(wt,e),De(Lt,Lt.current),!0}function $d(e,t,n){var r=e.stateNode;if(!r)throw Error(V(169));n?(e=Yf(e,t,Lr),r.__reactInternalMemoizedMergedChildContext=e,Oe(Lt),Oe(wt),De(wt,e)):Oe(Lt),De(Lt,n)}var _n=null,Ki=!1,Sa=!1;function Qf(e){_n===null?_n=[e]:_n.push(e)}function Ux(e){Ki=!0,Qf(e)}function br(){if(!Sa&&_n!==null){Sa=!0;var e=0,t=Te;try{var n=_n;for(Te=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}_n=null,Ki=!1}catch(l){throw _n!==null&&(_n=_n.slice(e+1)),vf(Zo,br),l}finally{Te=t,Sa=!1}}return null}var es=[],ts=0,vi=null,bi=0,Xt=[],qt=0,Pr=null,On=1,Mn="";function jr(e,t){es[ts++]=bi,es[ts++]=vi,vi=e,bi=t}function Xf(e,t,n){Xt[qt++]=On,Xt[qt++]=Mn,Xt[qt++]=Pr,Pr=e;var r=On;e=Mn;var l=32-un(r)-1;r&=~(1<<l),n+=1;var i=32-un(t)+l;if(30<i){var a=l-l%5;i=(r&(1<<a)-1).toString(32),r>>=a,l-=a,On=1<<32-un(t)+l|n<<l|r,Mn=i+e}else On=1<<i|n<<l|r,Mn=e}function oc(e){e.return!==null&&(jr(e,1),Xf(e,1,0))}function cc(e){for(;e===vi;)vi=es[--ts],es[ts]=null,bi=es[--ts],es[ts]=null;for(;e===Pr;)Pr=Xt[--qt],Xt[qt]=null,Mn=Xt[--qt],Xt[qt]=null,On=Xt[--qt],Xt[qt]=null}var Wt=null,Ht=null,Ue=!1,cn=null;function qf(e,t){var n=Jt(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function Ud(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Wt=e,Ht=ur(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Wt=e,Ht=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Pr!==null?{id:On,overflow:Mn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Jt(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Wt=e,Ht=null,!0):!1;default:return!1}}function po(e){return(e.mode&1)!==0&&(e.flags&128)===0}function ho(e){if(Ue){var t=Ht;if(t){var n=t;if(!Ud(e,t)){if(po(e))throw Error(V(418));t=ur(n.nextSibling);var r=Wt;t&&Ud(e,t)?qf(r,n):(e.flags=e.flags&-4097|2,Ue=!1,Wt=e)}}else{if(po(e))throw Error(V(418));e.flags=e.flags&-4097|2,Ue=!1,Wt=e}}}function Hd(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Wt=e}function Bl(e){if(e!==Wt)return!1;if(!Ue)return Hd(e),Ue=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!co(e.type,e.memoizedProps)),t&&(t=Ht)){if(po(e))throw Jf(),Error(V(418));for(;t;)qf(e,t),t=ur(t.nextSibling)}if(Hd(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(V(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Ht=ur(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Ht=null}}else Ht=Wt?ur(e.stateNode.nextSibling):null;return!0}function Jf(){for(var e=Ht;e;)e=ur(e.nextSibling)}function ps(){Ht=Wt=null,Ue=!1}function dc(e){cn===null?cn=[e]:cn.push(e)}var Hx=Vn.ReactCurrentBatchConfig;function Ds(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(V(309));var r=n.stateNode}if(!r)throw Error(V(147,e));var l=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(a){var o=l.refs;a===null?delete o[i]:o[i]=a},t._stringRef=i,t)}if(typeof e!="string")throw Error(V(284));if(!n._owner)throw Error(V(290,e))}return e}function $l(e,t){throw e=Object.prototype.toString.call(t),Error(V(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Wd(e){var t=e._init;return t(e._payload)}function Zf(e){function t(h,p){if(e){var v=h.deletions;v===null?(h.deletions=[p],h.flags|=16):v.push(p)}}function n(h,p){if(!e)return null;for(;p!==null;)t(h,p),p=p.sibling;return null}function r(h,p){for(h=new Map;p!==null;)p.key!==null?h.set(p.key,p):h.set(p.index,p),p=p.sibling;return h}function l(h,p){return h=hr(h,p),h.index=0,h.sibling=null,h}function i(h,p,v){return h.index=v,e?(v=h.alternate,v!==null?(v=v.index,v<p?(h.flags|=2,p):v):(h.flags|=2,p)):(h.flags|=1048576,p)}function a(h){return e&&h.alternate===null&&(h.flags|=2),h}function o(h,p,v,E){return p===null||p.tag!==6?(p=Aa(v,h.mode,E),p.return=h,p):(p=l(p,v),p.return=h,p)}function c(h,p,v,E){var D=v.type;return D===Yr?f(h,p,v.props.children,E,v.key):p!==null&&(p.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Zn&&Wd(D)===p.type)?(E=l(p,v.props),E.ref=Ds(h,p,v),E.return=h,E):(E=ai(v.type,v.key,v.props,null,h.mode,E),E.ref=Ds(h,p,v),E.return=h,E)}function d(h,p,v,E){return p===null||p.tag!==4||p.stateNode.containerInfo!==v.containerInfo||p.stateNode.implementation!==v.implementation?(p=Ca(v,h.mode,E),p.return=h,p):(p=l(p,v.children||[]),p.return=h,p)}function f(h,p,v,E,D){return p===null||p.tag!==7?(p=Cr(v,h.mode,E,D),p.return=h,p):(p=l(p,v),p.return=h,p)}function m(h,p,v){if(typeof p=="string"&&p!==""||typeof p=="number")return p=Aa(""+p,h.mode,v),p.return=h,p;if(typeof p=="object"&&p!==null){switch(p.$$typeof){case Tl:return v=ai(p.type,p.key,p.props,null,h.mode,v),v.ref=Ds(h,null,p),v.return=h,v;case Kr:return p=Ca(p,h.mode,v),p.return=h,p;case Zn:var E=p._init;return m(h,E(p._payload),v)}if(Bs(p)||Is(p))return p=Cr(p,h.mode,v,null),p.return=h,p;$l(h,p)}return null}function x(h,p,v,E){var D=p!==null?p.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return D!==null?null:o(h,p,""+v,E);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Tl:return v.key===D?c(h,p,v,E):null;case Kr:return v.key===D?d(h,p,v,E):null;case Zn:return D=v._init,x(h,p,D(v._payload),E)}if(Bs(v)||Is(v))return D!==null?null:f(h,p,v,E,null);$l(h,v)}return null}function b(h,p,v,E,D){if(typeof E=="string"&&E!==""||typeof E=="number")return h=h.get(v)||null,o(p,h,""+E,D);if(typeof E=="object"&&E!==null){switch(E.$$typeof){case Tl:return h=h.get(E.key===null?v:E.key)||null,c(p,h,E,D);case Kr:return h=h.get(E.key===null?v:E.key)||null,d(p,h,E,D);case Zn:var M=E._init;return b(h,p,v,M(E._payload),D)}if(Bs(E)||Is(E))return h=h.get(v)||null,f(p,h,E,D,null);$l(p,E)}return null}function j(h,p,v,E){for(var D=null,M=null,P=p,H=p=0,ne=null;P!==null&&H<v.length;H++){P.index>H?(ne=P,P=null):ne=P.sibling;var A=x(h,P,v[H],E);if(A===null){P===null&&(P=ne);break}e&&P&&A.alternate===null&&t(h,P),p=i(A,p,H),M===null?D=A:M.sibling=A,M=A,P=ne}if(H===v.length)return n(h,P),Ue&&jr(h,H),D;if(P===null){for(;H<v.length;H++)P=m(h,v[H],E),P!==null&&(p=i(P,p,H),M===null?D=P:M.sibling=P,M=P);return Ue&&jr(h,H),D}for(P=r(h,P);H<v.length;H++)ne=b(P,h,H,v[H],E),ne!==null&&(e&&ne.alternate!==null&&P.delete(ne.key===null?H:ne.key),p=i(ne,p,H),M===null?D=ne:M.sibling=ne,M=ne);return e&&P.forEach(function(y){return t(h,y)}),Ue&&jr(h,H),D}function S(h,p,v,E){var D=Is(v);if(typeof D!="function")throw Error(V(150));if(v=D.call(v),v==null)throw Error(V(151));for(var M=D=null,P=p,H=p=0,ne=null,A=v.next();P!==null&&!A.done;H++,A=v.next()){P.index>H?(ne=P,P=null):ne=P.sibling;var y=x(h,P,A.value,E);if(y===null){P===null&&(P=ne);break}e&&P&&y.alternate===null&&t(h,P),p=i(y,p,H),M===null?D=y:M.sibling=y,M=y,P=ne}if(A.done)return n(h,P),Ue&&jr(h,H),D;if(P===null){for(;!A.done;H++,A=v.next())A=m(h,A.value,E),A!==null&&(p=i(A,p,H),M===null?D=A:M.sibling=A,M=A);return Ue&&jr(h,H),D}for(P=r(h,P);!A.done;H++,A=v.next())A=b(P,h,H,A.value,E),A!==null&&(e&&A.alternate!==null&&P.delete(A.key===null?H:A.key),p=i(A,p,H),M===null?D=A:M.sibling=A,M=A);return e&&P.forEach(function($){return t(h,$)}),Ue&&jr(h,H),D}function O(h,p,v,E){if(typeof v=="object"&&v!==null&&v.type===Yr&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Tl:e:{for(var D=v.key,M=p;M!==null;){if(M.key===D){if(D=v.type,D===Yr){if(M.tag===7){n(h,M.sibling),p=l(M,v.props.children),p.return=h,h=p;break e}}else if(M.elementType===D||typeof D=="object"&&D!==null&&D.$$typeof===Zn&&Wd(D)===M.type){n(h,M.sibling),p=l(M,v.props),p.ref=Ds(h,M,v),p.return=h,h=p;break e}n(h,M);break}else t(h,M);M=M.sibling}v.type===Yr?(p=Cr(v.props.children,h.mode,E,v.key),p.return=h,h=p):(E=ai(v.type,v.key,v.props,null,h.mode,E),E.ref=Ds(h,p,v),E.return=h,h=E)}return a(h);case Kr:e:{for(M=v.key;p!==null;){if(p.key===M)if(p.tag===4&&p.stateNode.containerInfo===v.containerInfo&&p.stateNode.implementation===v.implementation){n(h,p.sibling),p=l(p,v.children||[]),p.return=h,h=p;break e}else{n(h,p);break}else t(h,p);p=p.sibling}p=Ca(v,h.mode,E),p.return=h,h=p}return a(h);case Zn:return M=v._init,O(h,p,M(v._payload),E)}if(Bs(v))return j(h,p,v,E);if(Is(v))return S(h,p,v,E);$l(h,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,p!==null&&p.tag===6?(n(h,p.sibling),p=l(p,v),p.return=h,h=p):(n(h,p),p=Aa(v,h.mode,E),p.return=h,h=p),a(h)):n(h,p)}return O}var hs=Zf(!0),em=Zf(!1),wi=vr(null),Si=null,ns=null,uc=null;function fc(){uc=ns=Si=null}function mc(e){var t=wi.current;Oe(wi),e._currentValue=t}function xo(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function ds(e,t){Si=e,uc=ns=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(_t=!0),e.firstContext=null)}function en(e){var t=e._currentValue;if(uc!==e)if(e={context:e,memoizedValue:t,next:null},ns===null){if(Si===null)throw Error(V(308));ns=e,Si.dependencies={lanes:0,firstContext:e}}else ns=ns.next=e;return t}var Rr=null;function pc(e){Rr===null?Rr=[e]:Rr.push(e)}function tm(e,t,n,r){var l=t.interleaved;return l===null?(n.next=n,pc(t)):(n.next=l.next,l.next=n),t.interleaved=n,Wn(e,r)}function Wn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var er=!1;function hc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nm(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Bn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function fr(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,ve&2){var l=r.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),r.pending=t,Wn(e,n)}return l=r.interleaved,l===null?(t.next=t,pc(r)):(t.next=l.next,l.next=t),r.interleaved=t,Wn(e,n)}function ti(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ec(e,n)}}function zd(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var l=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?l=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?l=i=t:i=i.next=t}else l=i=t;n={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ji(e,t,n,r){var l=e.updateQueue;er=!1;var i=l.firstBaseUpdate,a=l.lastBaseUpdate,o=l.shared.pending;if(o!==null){l.shared.pending=null;var c=o,d=c.next;c.next=null,a===null?i=d:a.next=d,a=c;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==a&&(o===null?f.firstBaseUpdate=d:o.next=d,f.lastBaseUpdate=c))}if(i!==null){var m=l.baseState;a=0,f=d=c=null,o=i;do{var x=o.lane,b=o.eventTime;if((r&x)===x){f!==null&&(f=f.next={eventTime:b,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var j=e,S=o;switch(x=t,b=n,S.tag){case 1:if(j=S.payload,typeof j=="function"){m=j.call(b,m,x);break e}m=j;break e;case 3:j.flags=j.flags&-65537|128;case 0:if(j=S.payload,x=typeof j=="function"?j.call(b,m,x):j,x==null)break e;m=Ve({},m,x);break e;case 2:er=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,x=l.effects,x===null?l.effects=[o]:x.push(o))}else b={eventTime:b,lane:x,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(d=f=b,c=m):f=f.next=b,a|=x;if(o=o.next,o===null){if(o=l.shared.pending,o===null)break;x=o,o=x.next,x.next=null,l.lastBaseUpdate=x,l.shared.pending=null}}while(!0);if(f===null&&(c=m),l.baseState=c,l.firstBaseUpdate=d,l.lastBaseUpdate=f,t=l.shared.interleaved,t!==null){l=t;do a|=l.lane,l=l.next;while(l!==t)}else i===null&&(l.shared.lanes=0);Mr|=a,e.lanes=a,e.memoizedState=m}}function Vd(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],l=r.callback;if(l!==null){if(r.callback=null,r=n,typeof l!="function")throw Error(V(191,l));l.call(r)}}}var jl={},Rn=vr(jl),dl=vr(jl),ul=vr(jl);function Tr(e){if(e===jl)throw Error(V(174));return e}function xc(e,t){switch(De(ul,t),De(dl,e),De(Rn,jl),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qa(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qa(t,e)}Oe(Rn),De(Rn,t)}function xs(){Oe(Rn),Oe(dl),Oe(ul)}function rm(e){Tr(ul.current);var t=Tr(Rn.current),n=Qa(t,e.type);t!==n&&(De(dl,e),De(Rn,n))}function gc(e){dl.current===e&&(Oe(Rn),Oe(dl))}var We=vr(0);function Ei(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ja=[];function yc(){for(var e=0;e<ja.length;e++)ja[e]._workInProgressVersionPrimary=null;ja.length=0}var ni=Vn.ReactCurrentDispatcher,Ea=Vn.ReactCurrentBatchConfig,Or=0,ze=null,tt=null,at=null,ki=!1,Qs=!1,fl=0,Wx=0;function yt(){throw Error(V(321))}function Nc(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!pn(e[n],t[n]))return!1;return!0}function vc(e,t,n,r,l,i){if(Or=i,ze=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,ni.current=e===null||e.memoizedState===null?Kx:Yx,e=n(r,l),Qs){i=0;do{if(Qs=!1,fl=0,25<=i)throw Error(V(301));i+=1,at=tt=null,t.updateQueue=null,ni.current=Qx,e=n(r,l)}while(Qs)}if(ni.current=Ii,t=tt!==null&&tt.next!==null,Or=0,at=tt=ze=null,ki=!1,t)throw Error(V(300));return e}function bc(){var e=fl!==0;return fl=0,e}function Nn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return at===null?ze.memoizedState=at=e:at=at.next=e,at}function tn(){if(tt===null){var e=ze.alternate;e=e!==null?e.memoizedState:null}else e=tt.next;var t=at===null?ze.memoizedState:at.next;if(t!==null)at=t,tt=e;else{if(e===null)throw Error(V(310));tt=e,e={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},at===null?ze.memoizedState=at=e:at=at.next=e}return at}function ml(e,t){return typeof t=="function"?t(e):t}function ka(e){var t=tn(),n=t.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=e;var r=tt,l=r.baseQueue,i=n.pending;if(i!==null){if(l!==null){var a=l.next;l.next=i.next,i.next=a}r.baseQueue=l=i,n.pending=null}if(l!==null){i=l.next,r=r.baseState;var o=a=null,c=null,d=i;do{var f=d.lane;if((Or&f)===f)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:e(r,d.action);else{var m={lane:f,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(o=c=m,a=r):c=c.next=m,ze.lanes|=f,Mr|=f}d=d.next}while(d!==null&&d!==i);c===null?a=r:c.next=o,pn(r,t.memoizedState)||(_t=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){l=e;do i=l.lane,ze.lanes|=i,Mr|=i,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Ia(e){var t=tn(),n=t.queue;if(n===null)throw Error(V(311));n.lastRenderedReducer=e;var r=n.dispatch,l=n.pending,i=t.memoizedState;if(l!==null){n.pending=null;var a=l=l.next;do i=e(i,a.action),a=a.next;while(a!==l);pn(i,t.memoizedState)||(_t=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function sm(){}function lm(e,t){var n=ze,r=tn(),l=t(),i=!pn(r.memoizedState,l);if(i&&(r.memoizedState=l,_t=!0),r=r.queue,wc(om.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||at!==null&&at.memoizedState.tag&1){if(n.flags|=2048,pl(9,am.bind(null,n,r,l,t),void 0,null),ot===null)throw Error(V(349));Or&30||im(n,t,l)}return l}function im(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function am(e,t,n,r){t.value=n,t.getSnapshot=r,cm(t)&&dm(e)}function om(e,t,n){return n(function(){cm(t)&&dm(e)})}function cm(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!pn(e,n)}catch{return!0}}function dm(e){var t=Wn(e,1);t!==null&&fn(t,e,1,-1)}function Gd(e){var t=Nn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ml,lastRenderedState:e},t.queue=e,e=e.dispatch=Gx.bind(null,ze,e),[t.memoizedState,e]}function pl(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ze.updateQueue,t===null?(t={lastEffect:null,stores:null},ze.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function um(){return tn().memoizedState}function ri(e,t,n,r){var l=Nn();ze.flags|=e,l.memoizedState=pl(1|t,n,void 0,r===void 0?null:r)}function Yi(e,t,n,r){var l=tn();r=r===void 0?null:r;var i=void 0;if(tt!==null){var a=tt.memoizedState;if(i=a.destroy,r!==null&&Nc(r,a.deps)){l.memoizedState=pl(t,n,i,r);return}}ze.flags|=e,l.memoizedState=pl(1|t,n,i,r)}function Kd(e,t){return ri(8390656,8,e,t)}function wc(e,t){return Yi(2048,8,e,t)}function fm(e,t){return Yi(4,2,e,t)}function mm(e,t){return Yi(4,4,e,t)}function pm(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function hm(e,t,n){return n=n!=null?n.concat([e]):null,Yi(4,4,pm.bind(null,t,e),n)}function Sc(){}function xm(e,t){var n=tn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Nc(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function gm(e,t){var n=tn();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Nc(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ym(e,t,n){return Or&21?(pn(n,t)||(n=Sf(),ze.lanes|=n,Mr|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,_t=!0),e.memoizedState=n)}function zx(e,t){var n=Te;Te=n!==0&&4>n?n:4,e(!0);var r=Ea.transition;Ea.transition={};try{e(!1),t()}finally{Te=n,Ea.transition=r}}function Nm(){return tn().memoizedState}function Vx(e,t,n){var r=pr(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},vm(e))bm(t,n);else if(n=tm(e,t,n,r),n!==null){var l=Et();fn(n,e,r,l),wm(n,t,r)}}function Gx(e,t,n){var r=pr(e),l={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(vm(e))bm(t,l);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var a=t.lastRenderedState,o=i(a,n);if(l.hasEagerState=!0,l.eagerState=o,pn(o,a)){var c=t.interleaved;c===null?(l.next=l,pc(t)):(l.next=c.next,c.next=l),t.interleaved=l;return}}catch{}finally{}n=tm(e,t,l,r),n!==null&&(l=Et(),fn(n,e,r,l),wm(n,t,r))}}function vm(e){var t=e.alternate;return e===ze||t!==null&&t===ze}function bm(e,t){Qs=ki=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function wm(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,ec(e,n)}}var Ii={readContext:en,useCallback:yt,useContext:yt,useEffect:yt,useImperativeHandle:yt,useInsertionEffect:yt,useLayoutEffect:yt,useMemo:yt,useReducer:yt,useRef:yt,useState:yt,useDebugValue:yt,useDeferredValue:yt,useTransition:yt,useMutableSource:yt,useSyncExternalStore:yt,useId:yt,unstable_isNewReconciler:!1},Kx={readContext:en,useCallback:function(e,t){return Nn().memoizedState=[e,t===void 0?null:t],e},useContext:en,useEffect:Kd,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,ri(4194308,4,pm.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ri(4194308,4,e,t)},useInsertionEffect:function(e,t){return ri(4,2,e,t)},useMemo:function(e,t){var n=Nn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Nn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Vx.bind(null,ze,e),[r.memoizedState,e]},useRef:function(e){var t=Nn();return e={current:e},t.memoizedState=e},useState:Gd,useDebugValue:Sc,useDeferredValue:function(e){return Nn().memoizedState=e},useTransition:function(){var e=Gd(!1),t=e[0];return e=zx.bind(null,e[1]),Nn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ze,l=Nn();if(Ue){if(n===void 0)throw Error(V(407));n=n()}else{if(n=t(),ot===null)throw Error(V(349));Or&30||im(r,t,n)}l.memoizedState=n;var i={value:n,getSnapshot:t};return l.queue=i,Kd(om.bind(null,r,i,e),[e]),r.flags|=2048,pl(9,am.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=Nn(),t=ot.identifierPrefix;if(Ue){var n=Mn,r=On;n=(r&~(1<<32-un(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=fl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=Wx++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Yx={readContext:en,useCallback:xm,useContext:en,useEffect:wc,useImperativeHandle:hm,useInsertionEffect:fm,useLayoutEffect:mm,useMemo:gm,useReducer:ka,useRef:um,useState:function(){return ka(ml)},useDebugValue:Sc,useDeferredValue:function(e){var t=tn();return ym(t,tt.memoizedState,e)},useTransition:function(){var e=ka(ml)[0],t=tn().memoizedState;return[e,t]},useMutableSource:sm,useSyncExternalStore:lm,useId:Nm,unstable_isNewReconciler:!1},Qx={readContext:en,useCallback:xm,useContext:en,useEffect:wc,useImperativeHandle:hm,useInsertionEffect:fm,useLayoutEffect:mm,useMemo:gm,useReducer:Ia,useRef:um,useState:function(){return Ia(ml)},useDebugValue:Sc,useDeferredValue:function(e){var t=tn();return tt===null?t.memoizedState=e:ym(t,tt.memoizedState,e)},useTransition:function(){var e=Ia(ml)[0],t=tn().memoizedState;return[e,t]},useMutableSource:sm,useSyncExternalStore:lm,useId:Nm,unstable_isNewReconciler:!1};function an(e,t){if(e&&e.defaultProps){t=Ve({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function go(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Ve({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Qi={isMounted:function(e){return(e=e._reactInternals)?Hr(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Et(),l=pr(e),i=Bn(r,l);i.payload=t,n!=null&&(i.callback=n),t=fr(e,i,l),t!==null&&(fn(t,e,l,r),ti(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Et(),l=pr(e),i=Bn(r,l);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=fr(e,i,l),t!==null&&(fn(t,e,l,r),ti(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Et(),r=pr(e),l=Bn(n,r);l.tag=2,t!=null&&(l.callback=t),t=fr(e,l,r),t!==null&&(fn(t,e,r,n),ti(t,e,r))}};function Yd(e,t,n,r,l,i,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,a):t.prototype&&t.prototype.isPureReactComponent?!il(n,r)||!il(l,i):!0}function Sm(e,t,n){var r=!1,l=gr,i=t.contextType;return typeof i=="object"&&i!==null?i=en(i):(l=Pt(t)?Lr:wt.current,r=t.contextTypes,i=(r=r!=null)?ms(e,l):gr),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Qi,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=i),t}function Qd(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Qi.enqueueReplaceState(t,t.state,null)}function yo(e,t,n,r){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},hc(e);var i=t.contextType;typeof i=="object"&&i!==null?l.context=en(i):(i=Pt(t)?Lr:wt.current,l.context=ms(e,i)),l.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(go(e,t,i,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&Qi.enqueueReplaceState(l,l.state,null),ji(e,n,l,r),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function gs(e,t){try{var n="",r=t;do n+=Sh(r),r=r.return;while(r);var l=n}catch(i){l=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:l,digest:null}}function Ra(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function No(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var Xx=typeof WeakMap=="function"?WeakMap:Map;function jm(e,t,n){n=Bn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ti||(Ti=!0,To=r),No(e,t)},n}function Em(e,t,n){n=Bn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var l=t.value;n.payload=function(){return r(l)},n.callback=function(){No(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){No(e,t),typeof r!="function"&&(mr===null?mr=new Set([this]):mr.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Xd(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new Xx;var l=new Set;r.set(t,l)}else l=r.get(t),l===void 0&&(l=new Set,r.set(t,l));l.has(n)||(l.add(n),e=d0.bind(null,e,t,n),t.then(e,e))}function qd(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Jd(e,t,n,r,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Bn(-1,1),t.tag=2,fr(n,t,1))),n.lanes|=1),e)}var qx=Vn.ReactCurrentOwner,_t=!1;function jt(e,t,n,r){t.child=e===null?em(t,null,n,r):hs(t,e.child,n,r)}function Zd(e,t,n,r,l){n=n.render;var i=t.ref;return ds(t,l),r=vc(e,t,n,r,i,l),n=bc(),e!==null&&!_t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,zn(e,t,l)):(Ue&&n&&oc(t),t.flags|=1,jt(e,t,r,l),t.child)}function eu(e,t,n,r,l){if(e===null){var i=n.type;return typeof i=="function"&&!Cc(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,km(e,t,i,r,l)):(e=ai(n.type,null,r,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&l)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:il,n(a,r)&&e.ref===t.ref)return zn(e,t,l)}return t.flags|=1,e=hr(i,r),e.ref=t.ref,e.return=t,t.child=e}function km(e,t,n,r,l){if(e!==null){var i=e.memoizedProps;if(il(i,r)&&e.ref===t.ref)if(_t=!1,t.pendingProps=r=i,(e.lanes&l)!==0)e.flags&131072&&(_t=!0);else return t.lanes=e.lanes,zn(e,t,l)}return vo(e,t,n,r,l)}function Im(e,t,n){var r=t.pendingProps,l=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},De(ss,$t),$t|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,De(ss,$t),$t|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,De(ss,$t),$t|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,De(ss,$t),$t|=r;return jt(e,t,l,n),t.child}function Rm(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function vo(e,t,n,r,l){var i=Pt(n)?Lr:wt.current;return i=ms(t,i),ds(t,l),n=vc(e,t,n,r,i,l),r=bc(),e!==null&&!_t?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,zn(e,t,l)):(Ue&&r&&oc(t),t.flags|=1,jt(e,t,n,l),t.child)}function tu(e,t,n,r,l){if(Pt(n)){var i=!0;Ni(t)}else i=!1;if(ds(t,l),t.stateNode===null)si(e,t),Sm(t,n,r),yo(t,n,r,l),r=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var c=a.context,d=n.contextType;typeof d=="object"&&d!==null?d=en(d):(d=Pt(n)?Lr:wt.current,d=ms(t,d));var f=n.getDerivedStateFromProps,m=typeof f=="function"||typeof a.getSnapshotBeforeUpdate=="function";m||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||c!==d)&&Qd(t,a,r,d),er=!1;var x=t.memoizedState;a.state=x,ji(t,r,a,l),c=t.memoizedState,o!==r||x!==c||Lt.current||er?(typeof f=="function"&&(go(t,n,f,r),c=t.memoizedState),(o=er||Yd(t,n,o,r,x,c,d))?(m||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=d,r=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,nm(e,t),o=t.memoizedProps,d=t.type===t.elementType?o:an(t.type,o),a.props=d,m=t.pendingProps,x=a.context,c=n.contextType,typeof c=="object"&&c!==null?c=en(c):(c=Pt(n)?Lr:wt.current,c=ms(t,c));var b=n.getDerivedStateFromProps;(f=typeof b=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==m||x!==c)&&Qd(t,a,r,c),er=!1,x=t.memoizedState,a.state=x,ji(t,r,a,l);var j=t.memoizedState;o!==m||x!==j||Lt.current||er?(typeof b=="function"&&(go(t,n,b,r),j=t.memoizedState),(d=er||Yd(t,n,d,r,x,j,c)||!1)?(f||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,j,c),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,j,c)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=j),a.props=r,a.state=j,a.context=c,r=d):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&x===e.memoizedState||(t.flags|=1024),r=!1)}return bo(e,t,n,r,i,l)}function bo(e,t,n,r,l,i){Rm(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return l&&$d(t,n,!1),zn(e,t,i);r=t.stateNode,qx.current=t;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=hs(t,e.child,null,i),t.child=hs(t,null,o,i)):jt(e,t,o,i),t.memoizedState=r.state,l&&$d(t,n,!0),t.child}function Tm(e){var t=e.stateNode;t.pendingContext?Bd(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Bd(e,t.context,!1),xc(e,t.containerInfo)}function nu(e,t,n,r,l){return ps(),dc(l),t.flags|=256,jt(e,t,n,r),t.child}var wo={dehydrated:null,treeContext:null,retryLane:0};function So(e){return{baseLanes:e,cachePool:null,transitions:null}}function Am(e,t,n){var r=t.pendingProps,l=We.current,i=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(l&2)!==0),o?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),De(We,l&1),e===null)return ho(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,i?(r=t.mode,i=t.child,a={mode:"hidden",children:a},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=a):i=Ji(a,r,0,null),e=Cr(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=So(n),t.memoizedState=wo,e):jc(t,a));if(l=e.memoizedState,l!==null&&(o=l.dehydrated,o!==null))return Jx(e,t,a,r,o,l,n);if(i){i=r.fallback,a=t.mode,l=e.child,o=l.sibling;var c={mode:"hidden",children:r.children};return!(a&1)&&t.child!==l?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=hr(l,c),r.subtreeFlags=l.subtreeFlags&14680064),o!==null?i=hr(o,i):(i=Cr(i,a,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,a=e.child.memoizedState,a=a===null?So(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},i.memoizedState=a,i.childLanes=e.childLanes&~n,t.memoizedState=wo,r}return i=e.child,e=i.sibling,r=hr(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function jc(e,t){return t=Ji({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Ul(e,t,n,r){return r!==null&&dc(r),hs(t,e.child,null,n),e=jc(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function Jx(e,t,n,r,l,i,a){if(n)return t.flags&256?(t.flags&=-257,r=Ra(Error(V(422))),Ul(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,l=t.mode,r=Ji({mode:"visible",children:r.children},l,0,null),i=Cr(i,l,a,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&hs(t,e.child,null,a),t.child.memoizedState=So(a),t.memoizedState=wo,i);if(!(t.mode&1))return Ul(e,t,a,null);if(l.data==="$!"){if(r=l.nextSibling&&l.nextSibling.dataset,r)var o=r.dgst;return r=o,i=Error(V(419)),r=Ra(i,r,void 0),Ul(e,t,a,r)}if(o=(a&e.childLanes)!==0,_t||o){if(r=ot,r!==null){switch(a&-a){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(r.suspendedLanes|a)?0:l,l!==0&&l!==i.retryLane&&(i.retryLane=l,Wn(e,l),fn(r,e,l,-1))}return Ac(),r=Ra(Error(V(421))),Ul(e,t,a,r)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=u0.bind(null,e),l._reactRetry=t,null):(e=i.treeContext,Ht=ur(l.nextSibling),Wt=t,Ue=!0,cn=null,e!==null&&(Xt[qt++]=On,Xt[qt++]=Mn,Xt[qt++]=Pr,On=e.id,Mn=e.overflow,Pr=t),t=jc(t,r.children),t.flags|=4096,t)}function ru(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),xo(e.return,t,n)}function Ta(e,t,n,r,l){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:l}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=l)}function Cm(e,t,n){var r=t.pendingProps,l=r.revealOrder,i=r.tail;if(jt(e,t,r.children,n),r=We.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ru(e,n,t);else if(e.tag===19)ru(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(De(We,r),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&Ei(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),Ta(t,!1,l,n,i);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&Ei(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}Ta(t,!0,n,null,i);break;case"together":Ta(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function si(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function zn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Mr|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(V(153));if(t.child!==null){for(e=t.child,n=hr(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=hr(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Zx(e,t,n){switch(t.tag){case 3:Tm(t),ps();break;case 5:rm(t);break;case 1:Pt(t.type)&&Ni(t);break;case 4:xc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,l=t.memoizedProps.value;De(wi,r._currentValue),r._currentValue=l;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(De(We,We.current&1),t.flags|=128,null):n&t.child.childLanes?Am(e,t,n):(De(We,We.current&1),e=zn(e,t,n),e!==null?e.sibling:null);De(We,We.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return Cm(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),De(We,We.current),r)break;return null;case 22:case 23:return t.lanes=0,Im(e,t,n)}return zn(e,t,n)}var Dm,jo,_m,Lm;Dm=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};jo=function(){};_m=function(e,t,n,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,Tr(Rn.current);var i=null;switch(n){case"input":l=Va(e,l),r=Va(e,r),i=[];break;case"select":l=Ve({},l,{value:void 0}),r=Ve({},r,{value:void 0}),i=[];break;case"textarea":l=Ya(e,l),r=Ya(e,r),i=[];break;default:typeof l.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=gi)}Xa(n,r);var a;n=null;for(d in l)if(!r.hasOwnProperty(d)&&l.hasOwnProperty(d)&&l[d]!=null)if(d==="style"){var o=l[d];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Zs.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var c=r[d];if(o=l!=null?l[d]:void 0,r.hasOwnProperty(d)&&c!==o&&(c!=null||o!=null))if(d==="style")if(o){for(a in o)!o.hasOwnProperty(a)||c&&c.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in c)c.hasOwnProperty(a)&&o[a]!==c[a]&&(n||(n={}),n[a]=c[a])}else n||(i||(i=[]),i.push(d,n)),n=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Zs.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Le("scroll",e),i||o===c||(i=[])):(i=i||[]).push(d,c))}n&&(i=i||[]).push("style",n);var d=i;(t.updateQueue=d)&&(t.flags|=4)}};Lm=function(e,t,n,r){n!==r&&(t.flags|=4)};function _s(e,t){if(!Ue)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Nt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags&14680064,r|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function e0(e,t,n){var r=t.pendingProps;switch(cc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Nt(t),null;case 1:return Pt(t.type)&&yi(),Nt(t),null;case 3:return r=t.stateNode,xs(),Oe(Lt),Oe(wt),yc(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Bl(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,cn!==null&&(Do(cn),cn=null))),jo(e,t),Nt(t),null;case 5:gc(t);var l=Tr(ul.current);if(n=t.type,e!==null&&t.stateNode!=null)_m(e,t,n,r,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(V(166));return Nt(t),null}if(e=Tr(Rn.current),Bl(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[wn]=t,r[cl]=i,e=(t.mode&1)!==0,n){case"dialog":Le("cancel",r),Le("close",r);break;case"iframe":case"object":case"embed":Le("load",r);break;case"video":case"audio":for(l=0;l<Us.length;l++)Le(Us[l],r);break;case"source":Le("error",r);break;case"img":case"image":case"link":Le("error",r),Le("load",r);break;case"details":Le("toggle",r);break;case"input":fd(r,i),Le("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Le("invalid",r);break;case"textarea":pd(r,i),Le("invalid",r)}Xa(n,i),l=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?r.textContent!==o&&(i.suppressHydrationWarning!==!0&&Fl(r.textContent,o,e),l=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(i.suppressHydrationWarning!==!0&&Fl(r.textContent,o,e),l=["children",""+o]):Zs.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Le("scroll",r)}switch(n){case"input":Al(r),md(r,i,!0);break;case"textarea":Al(r),hd(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=gi)}r=l,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=of(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[wn]=t,e[cl]=r,Dm(e,t,!1,!1),t.stateNode=e;e:{switch(a=qa(n,r),n){case"dialog":Le("cancel",e),Le("close",e),l=r;break;case"iframe":case"object":case"embed":Le("load",e),l=r;break;case"video":case"audio":for(l=0;l<Us.length;l++)Le(Us[l],e);l=r;break;case"source":Le("error",e),l=r;break;case"img":case"image":case"link":Le("error",e),Le("load",e),l=r;break;case"details":Le("toggle",e),l=r;break;case"input":fd(e,r),l=Va(e,r),Le("invalid",e);break;case"option":l=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=Ve({},r,{value:void 0}),Le("invalid",e);break;case"textarea":pd(e,r),l=Ya(e,r),Le("invalid",e);break;default:l=r}Xa(n,l),o=l;for(i in o)if(o.hasOwnProperty(i)){var c=o[i];i==="style"?uf(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&cf(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&el(e,c):typeof c=="number"&&el(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Zs.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Le("scroll",e):c!=null&&Yo(e,i,c,a))}switch(n){case"input":Al(e),md(e,r,!1);break;case"textarea":Al(e),hd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+xr(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?is(e,!!r.multiple,i,!1):r.defaultValue!=null&&is(e,!!r.multiple,r.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=gi)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Nt(t),null;case 6:if(e&&t.stateNode!=null)Lm(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(V(166));if(n=Tr(ul.current),Tr(Rn.current),Bl(t)){if(r=t.stateNode,n=t.memoizedProps,r[wn]=t,(i=r.nodeValue!==n)&&(e=Wt,e!==null))switch(e.tag){case 3:Fl(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Fl(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[wn]=t,t.stateNode=r}return Nt(t),null;case 13:if(Oe(We),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ue&&Ht!==null&&t.mode&1&&!(t.flags&128))Jf(),ps(),t.flags|=98560,i=!1;else if(i=Bl(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(V(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(V(317));i[wn]=t}else ps(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Nt(t),i=!1}else cn!==null&&(Do(cn),cn=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||We.current&1?nt===0&&(nt=3):Ac())),t.updateQueue!==null&&(t.flags|=4),Nt(t),null);case 4:return xs(),jo(e,t),e===null&&al(t.stateNode.containerInfo),Nt(t),null;case 10:return mc(t.type._context),Nt(t),null;case 17:return Pt(t.type)&&yi(),Nt(t),null;case 19:if(Oe(We),i=t.memoizedState,i===null)return Nt(t),null;if(r=(t.flags&128)!==0,a=i.rendering,a===null)if(r)_s(i,!1);else{if(nt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=Ei(e),a!==null){for(t.flags|=128,_s(i,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,e=a.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return De(We,We.current&1|2),t.child}e=e.sibling}i.tail!==null&&Qe()>ys&&(t.flags|=128,r=!0,_s(i,!1),t.lanes=4194304)}else{if(!r)if(e=Ei(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),_s(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!Ue)return Nt(t),null}else 2*Qe()-i.renderingStartTime>ys&&n!==1073741824&&(t.flags|=128,r=!0,_s(i,!1),t.lanes=4194304);i.isBackwards?(a.sibling=t.child,t.child=a):(n=i.last,n!==null?n.sibling=a:t.child=a,i.last=a)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=Qe(),t.sibling=null,n=We.current,De(We,r?n&1|2:n&1),t):(Nt(t),null);case 22:case 23:return Tc(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?$t&1073741824&&(Nt(t),t.subtreeFlags&6&&(t.flags|=8192)):Nt(t),null;case 24:return null;case 25:return null}throw Error(V(156,t.tag))}function t0(e,t){switch(cc(t),t.tag){case 1:return Pt(t.type)&&yi(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return xs(),Oe(Lt),Oe(wt),yc(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return gc(t),null;case 13:if(Oe(We),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(V(340));ps()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Oe(We),null;case 4:return xs(),null;case 10:return mc(t.type._context),null;case 22:case 23:return Tc(),null;case 24:return null;default:return null}}var Hl=!1,vt=!1,n0=typeof WeakSet=="function"?WeakSet:Set,se=null;function rs(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ye(e,t,r)}else n.current=null}function Eo(e,t,n){try{n()}catch(r){Ye(e,t,r)}}var su=!1;function r0(e,t){if(ao=pi,e=Bf(),ac(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var l=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,o=-1,c=-1,d=0,f=0,m=e,x=null;t:for(;;){for(var b;m!==n||l!==0&&m.nodeType!==3||(o=a+l),m!==i||r!==0&&m.nodeType!==3||(c=a+r),m.nodeType===3&&(a+=m.nodeValue.length),(b=m.firstChild)!==null;)x=m,m=b;for(;;){if(m===e)break t;if(x===n&&++d===l&&(o=a),x===i&&++f===r&&(c=a),(b=m.nextSibling)!==null)break;m=x,x=m.parentNode}m=b}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(oo={focusedElem:e,selectionRange:n},pi=!1,se=t;se!==null;)if(t=se,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,se=e;else for(;se!==null;){t=se;try{var j=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(j!==null){var S=j.memoizedProps,O=j.memoizedState,h=t.stateNode,p=h.getSnapshotBeforeUpdate(t.elementType===t.type?S:an(t.type,S),O);h.__reactInternalSnapshotBeforeUpdate=p}break;case 3:var v=t.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(V(163))}}catch(E){Ye(t,t.return,E)}if(e=t.sibling,e!==null){e.return=t.return,se=e;break}se=t.return}return j=su,su=!1,j}function Xs(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&e)===e){var i=l.destroy;l.destroy=void 0,i!==void 0&&Eo(t,n,i)}l=l.next}while(l!==r)}}function Xi(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function ko(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function Pm(e){var t=e.alternate;t!==null&&(e.alternate=null,Pm(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[wn],delete t[cl],delete t[fo],delete t[Bx],delete t[$x])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function Om(e){return e.tag===5||e.tag===3||e.tag===4}function lu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||Om(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Io(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=gi));else if(r!==4&&(e=e.child,e!==null))for(Io(e,t,n),e=e.sibling;e!==null;)Io(e,t,n),e=e.sibling}function Ro(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Ro(e,t,n),e=e.sibling;e!==null;)Ro(e,t,n),e=e.sibling}var dt=null,on=!1;function Jn(e,t,n){for(n=n.child;n!==null;)Mm(e,t,n),n=n.sibling}function Mm(e,t,n){if(In&&typeof In.onCommitFiberUnmount=="function")try{In.onCommitFiberUnmount(Hi,n)}catch{}switch(n.tag){case 5:vt||rs(n,t);case 6:var r=dt,l=on;dt=null,Jn(e,t,n),dt=r,on=l,dt!==null&&(on?(e=dt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):dt.removeChild(n.stateNode));break;case 18:dt!==null&&(on?(e=dt,n=n.stateNode,e.nodeType===8?wa(e.parentNode,n):e.nodeType===1&&wa(e,n),sl(e)):wa(dt,n.stateNode));break;case 4:r=dt,l=on,dt=n.stateNode.containerInfo,on=!0,Jn(e,t,n),dt=r,on=l;break;case 0:case 11:case 14:case 15:if(!vt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){l=r=r.next;do{var i=l,a=i.destroy;i=i.tag,a!==void 0&&(i&2||i&4)&&Eo(n,t,a),l=l.next}while(l!==r)}Jn(e,t,n);break;case 1:if(!vt&&(rs(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){Ye(n,t,o)}Jn(e,t,n);break;case 21:Jn(e,t,n);break;case 22:n.mode&1?(vt=(r=vt)||n.memoizedState!==null,Jn(e,t,n),vt=r):Jn(e,t,n);break;default:Jn(e,t,n)}}function iu(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new n0),t.forEach(function(r){var l=f0.bind(null,e,r);n.has(r)||(n.add(r),r.then(l,l))})}}function ln(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var l=n[r];try{var i=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:dt=o.stateNode,on=!1;break e;case 3:dt=o.stateNode.containerInfo,on=!0;break e;case 4:dt=o.stateNode.containerInfo,on=!0;break e}o=o.return}if(dt===null)throw Error(V(160));Mm(i,a,l),dt=null,on=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(d){Ye(l,t,d)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Fm(t,e),t=t.sibling}function Fm(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(ln(t,e),yn(e),r&4){try{Xs(3,e,e.return),Xi(3,e)}catch(S){Ye(e,e.return,S)}try{Xs(5,e,e.return)}catch(S){Ye(e,e.return,S)}}break;case 1:ln(t,e),yn(e),r&512&&n!==null&&rs(n,n.return);break;case 5:if(ln(t,e),yn(e),r&512&&n!==null&&rs(n,n.return),e.flags&32){var l=e.stateNode;try{el(l,"")}catch(S){Ye(e,e.return,S)}}if(r&4&&(l=e.stateNode,l!=null)){var i=e.memoizedProps,a=n!==null?n.memoizedProps:i,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&i.type==="radio"&&i.name!=null&&lf(l,i),qa(o,a);var d=qa(o,i);for(a=0;a<c.length;a+=2){var f=c[a],m=c[a+1];f==="style"?uf(l,m):f==="dangerouslySetInnerHTML"?cf(l,m):f==="children"?el(l,m):Yo(l,f,m,d)}switch(o){case"input":Ga(l,i);break;case"textarea":af(l,i);break;case"select":var x=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!i.multiple;var b=i.value;b!=null?is(l,!!i.multiple,b,!1):x!==!!i.multiple&&(i.defaultValue!=null?is(l,!!i.multiple,i.defaultValue,!0):is(l,!!i.multiple,i.multiple?[]:"",!1))}l[cl]=i}catch(S){Ye(e,e.return,S)}}break;case 6:if(ln(t,e),yn(e),r&4){if(e.stateNode===null)throw Error(V(162));l=e.stateNode,i=e.memoizedProps;try{l.nodeValue=i}catch(S){Ye(e,e.return,S)}}break;case 3:if(ln(t,e),yn(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sl(t.containerInfo)}catch(S){Ye(e,e.return,S)}break;case 4:ln(t,e),yn(e);break;case 13:ln(t,e),yn(e),l=e.child,l.flags&8192&&(i=l.memoizedState!==null,l.stateNode.isHidden=i,!i||l.alternate!==null&&l.alternate.memoizedState!==null||(Ic=Qe())),r&4&&iu(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(vt=(d=vt)||f,ln(t,e),vt=d):ln(t,e),yn(e),r&8192){if(d=e.memoizedState!==null,(e.stateNode.isHidden=d)&&!f&&e.mode&1)for(se=e,f=e.child;f!==null;){for(m=se=f;se!==null;){switch(x=se,b=x.child,x.tag){case 0:case 11:case 14:case 15:Xs(4,x,x.return);break;case 1:rs(x,x.return);var j=x.stateNode;if(typeof j.componentWillUnmount=="function"){r=x,n=x.return;try{t=r,j.props=t.memoizedProps,j.state=t.memoizedState,j.componentWillUnmount()}catch(S){Ye(r,n,S)}}break;case 5:rs(x,x.return);break;case 22:if(x.memoizedState!==null){ou(m);continue}}b!==null?(b.return=x,se=b):ou(m)}f=f.sibling}e:for(f=null,m=e;;){if(m.tag===5){if(f===null){f=m;try{l=m.stateNode,d?(i=l.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(o=m.stateNode,c=m.memoizedProps.style,a=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=df("display",a))}catch(S){Ye(e,e.return,S)}}}else if(m.tag===6){if(f===null)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(S){Ye(e,e.return,S)}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===e)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;m.sibling===null;){if(m.return===null||m.return===e)break e;f===m&&(f=null),m=m.return}f===m&&(f=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:ln(t,e),yn(e),r&4&&iu(e);break;case 21:break;default:ln(t,e),yn(e)}}function yn(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(Om(n)){var r=n;break e}n=n.return}throw Error(V(160))}switch(r.tag){case 5:var l=r.stateNode;r.flags&32&&(el(l,""),r.flags&=-33);var i=lu(e);Ro(e,i,l);break;case 3:case 4:var a=r.stateNode.containerInfo,o=lu(e);Io(e,o,a);break;default:throw Error(V(161))}}catch(c){Ye(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function s0(e,t,n){se=e,Bm(e)}function Bm(e,t,n){for(var r=(e.mode&1)!==0;se!==null;){var l=se,i=l.child;if(l.tag===22&&r){var a=l.memoizedState!==null||Hl;if(!a){var o=l.alternate,c=o!==null&&o.memoizedState!==null||vt;o=Hl;var d=vt;if(Hl=a,(vt=c)&&!d)for(se=l;se!==null;)a=se,c=a.child,a.tag===22&&a.memoizedState!==null?cu(l):c!==null?(c.return=a,se=c):cu(l);for(;i!==null;)se=i,Bm(i),i=i.sibling;se=l,Hl=o,vt=d}au(e)}else l.subtreeFlags&8772&&i!==null?(i.return=l,se=i):au(e)}}function au(e){for(;se!==null;){var t=se;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vt||Xi(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!vt)if(n===null)r.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:an(t.type,n.memoizedProps);r.componentDidUpdate(l,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&Vd(t,i,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Vd(t,a,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var d=t.alternate;if(d!==null){var f=d.memoizedState;if(f!==null){var m=f.dehydrated;m!==null&&sl(m)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(V(163))}vt||t.flags&512&&ko(t)}catch(x){Ye(t,t.return,x)}}if(t===e){se=null;break}if(n=t.sibling,n!==null){n.return=t.return,se=n;break}se=t.return}}function ou(e){for(;se!==null;){var t=se;if(t===e){se=null;break}var n=t.sibling;if(n!==null){n.return=t.return,se=n;break}se=t.return}}function cu(e){for(;se!==null;){var t=se;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Xi(4,t)}catch(c){Ye(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var l=t.return;try{r.componentDidMount()}catch(c){Ye(t,l,c)}}var i=t.return;try{ko(t)}catch(c){Ye(t,i,c)}break;case 5:var a=t.return;try{ko(t)}catch(c){Ye(t,a,c)}}}catch(c){Ye(t,t.return,c)}if(t===e){se=null;break}var o=t.sibling;if(o!==null){o.return=t.return,se=o;break}se=t.return}}var l0=Math.ceil,Ri=Vn.ReactCurrentDispatcher,Ec=Vn.ReactCurrentOwner,Zt=Vn.ReactCurrentBatchConfig,ve=0,ot=null,Je=null,ft=0,$t=0,ss=vr(0),nt=0,hl=null,Mr=0,qi=0,kc=0,qs=null,Dt=null,Ic=0,ys=1/0,Dn=null,Ti=!1,To=null,mr=null,Wl=!1,ar=null,Ai=0,Js=0,Ao=null,li=-1,ii=0;function Et(){return ve&6?Qe():li!==-1?li:li=Qe()}function pr(e){return e.mode&1?ve&2&&ft!==0?ft&-ft:Hx.transition!==null?(ii===0&&(ii=Sf()),ii):(e=Te,e!==0||(e=window.event,e=e===void 0?16:Af(e.type)),e):1}function fn(e,t,n,r){if(50<Js)throw Js=0,Ao=null,Error(V(185));bl(e,n,r),(!(ve&2)||e!==ot)&&(e===ot&&(!(ve&2)&&(qi|=n),nt===4&&sr(e,ft)),Ot(e,r),n===1&&ve===0&&!(t.mode&1)&&(ys=Qe()+500,Ki&&br()))}function Ot(e,t){var n=e.callbackNode;Hh(e,t);var r=mi(e,e===ot?ft:0);if(r===0)n!==null&&yd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&yd(n),t===1)e.tag===0?Ux(du.bind(null,e)):Qf(du.bind(null,e)),Mx(function(){!(ve&6)&&br()}),n=null;else{switch(jf(r)){case 1:n=Zo;break;case 4:n=bf;break;case 16:n=fi;break;case 536870912:n=wf;break;default:n=fi}n=Km(n,$m.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function $m(e,t){if(li=-1,ii=0,ve&6)throw Error(V(327));var n=e.callbackNode;if(us()&&e.callbackNode!==n)return null;var r=mi(e,e===ot?ft:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=Ci(e,r);else{t=r;var l=ve;ve|=2;var i=Hm();(ot!==e||ft!==t)&&(Dn=null,ys=Qe()+500,Ar(e,t));do try{o0();break}catch(o){Um(e,o)}while(!0);fc(),Ri.current=i,ve=l,Je!==null?t=0:(ot=null,ft=0,t=nt)}if(t!==0){if(t===2&&(l=no(e),l!==0&&(r=l,t=Co(e,l))),t===1)throw n=hl,Ar(e,0),sr(e,r),Ot(e,Qe()),n;if(t===6)sr(e,r);else{if(l=e.current.alternate,!(r&30)&&!i0(l)&&(t=Ci(e,r),t===2&&(i=no(e),i!==0&&(r=i,t=Co(e,i))),t===1))throw n=hl,Ar(e,0),sr(e,r),Ot(e,Qe()),n;switch(e.finishedWork=l,e.finishedLanes=r,t){case 0:case 1:throw Error(V(345));case 2:Er(e,Dt,Dn);break;case 3:if(sr(e,r),(r&130023424)===r&&(t=Ic+500-Qe(),10<t)){if(mi(e,0)!==0)break;if(l=e.suspendedLanes,(l&r)!==r){Et(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=uo(Er.bind(null,e,Dt,Dn),t);break}Er(e,Dt,Dn);break;case 4:if(sr(e,r),(r&4194240)===r)break;for(t=e.eventTimes,l=-1;0<r;){var a=31-un(r);i=1<<a,a=t[a],a>l&&(l=a),r&=~i}if(r=l,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*l0(r/1960))-r,10<r){e.timeoutHandle=uo(Er.bind(null,e,Dt,Dn),r);break}Er(e,Dt,Dn);break;case 5:Er(e,Dt,Dn);break;default:throw Error(V(329))}}}return Ot(e,Qe()),e.callbackNode===n?$m.bind(null,e):null}function Co(e,t){var n=qs;return e.current.memoizedState.isDehydrated&&(Ar(e,t).flags|=256),e=Ci(e,t),e!==2&&(t=Dt,Dt=n,t!==null&&Do(t)),e}function Do(e){Dt===null?Dt=e:Dt.push.apply(Dt,e)}function i0(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var l=n[r],i=l.getSnapshot;l=l.value;try{if(!pn(i(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function sr(e,t){for(t&=~kc,t&=~qi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-un(t),r=1<<n;e[n]=-1,t&=~r}}function du(e){if(ve&6)throw Error(V(327));us();var t=mi(e,0);if(!(t&1))return Ot(e,Qe()),null;var n=Ci(e,t);if(e.tag!==0&&n===2){var r=no(e);r!==0&&(t=r,n=Co(e,r))}if(n===1)throw n=hl,Ar(e,0),sr(e,t),Ot(e,Qe()),n;if(n===6)throw Error(V(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Er(e,Dt,Dn),Ot(e,Qe()),null}function Rc(e,t){var n=ve;ve|=1;try{return e(t)}finally{ve=n,ve===0&&(ys=Qe()+500,Ki&&br())}}function Fr(e){ar!==null&&ar.tag===0&&!(ve&6)&&us();var t=ve;ve|=1;var n=Zt.transition,r=Te;try{if(Zt.transition=null,Te=1,e)return e()}finally{Te=r,Zt.transition=n,ve=t,!(ve&6)&&br()}}function Tc(){$t=ss.current,Oe(ss)}function Ar(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,Ox(n)),Je!==null)for(n=Je.return;n!==null;){var r=n;switch(cc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&yi();break;case 3:xs(),Oe(Lt),Oe(wt),yc();break;case 5:gc(r);break;case 4:xs();break;case 13:Oe(We);break;case 19:Oe(We);break;case 10:mc(r.type._context);break;case 22:case 23:Tc()}n=n.return}if(ot=e,Je=e=hr(e.current,null),ft=$t=t,nt=0,hl=null,kc=qi=Mr=0,Dt=qs=null,Rr!==null){for(t=0;t<Rr.length;t++)if(n=Rr[t],r=n.interleaved,r!==null){n.interleaved=null;var l=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=l,r.next=a}n.pending=r}Rr=null}return e}function Um(e,t){do{var n=Je;try{if(fc(),ni.current=Ii,ki){for(var r=ze.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}ki=!1}if(Or=0,at=tt=ze=null,Qs=!1,fl=0,Ec.current=null,n===null||n.return===null){nt=1,hl=t,Je=null;break}e:{var i=e,a=n.return,o=n,c=t;if(t=ft,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,f=o,m=f.tag;if(!(f.mode&1)&&(m===0||m===11||m===15)){var x=f.alternate;x?(f.updateQueue=x.updateQueue,f.memoizedState=x.memoizedState,f.lanes=x.lanes):(f.updateQueue=null,f.memoizedState=null)}var b=qd(a);if(b!==null){b.flags&=-257,Jd(b,a,o,i,t),b.mode&1&&Xd(i,d,t),t=b,c=d;var j=t.updateQueue;if(j===null){var S=new Set;S.add(c),t.updateQueue=S}else j.add(c);break e}else{if(!(t&1)){Xd(i,d,t),Ac();break e}c=Error(V(426))}}else if(Ue&&o.mode&1){var O=qd(a);if(O!==null){!(O.flags&65536)&&(O.flags|=256),Jd(O,a,o,i,t),dc(gs(c,o));break e}}i=c=gs(c,o),nt!==4&&(nt=2),qs===null?qs=[i]:qs.push(i),i=a;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var h=jm(i,c,t);zd(i,h);break e;case 1:o=c;var p=i.type,v=i.stateNode;if(!(i.flags&128)&&(typeof p.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(mr===null||!mr.has(v)))){i.flags|=65536,t&=-t,i.lanes|=t;var E=Em(i,o,t);zd(i,E);break e}}i=i.return}while(i!==null)}zm(n)}catch(D){t=D,Je===n&&n!==null&&(Je=n=n.return);continue}break}while(!0)}function Hm(){var e=Ri.current;return Ri.current=Ii,e===null?Ii:e}function Ac(){(nt===0||nt===3||nt===2)&&(nt=4),ot===null||!(Mr&268435455)&&!(qi&268435455)||sr(ot,ft)}function Ci(e,t){var n=ve;ve|=2;var r=Hm();(ot!==e||ft!==t)&&(Dn=null,Ar(e,t));do try{a0();break}catch(l){Um(e,l)}while(!0);if(fc(),ve=n,Ri.current=r,Je!==null)throw Error(V(261));return ot=null,ft=0,nt}function a0(){for(;Je!==null;)Wm(Je)}function o0(){for(;Je!==null&&!_h();)Wm(Je)}function Wm(e){var t=Gm(e.alternate,e,$t);e.memoizedProps=e.pendingProps,t===null?zm(e):Je=t,Ec.current=null}function zm(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=t0(n,t),n!==null){n.flags&=32767,Je=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{nt=6,Je=null;return}}else if(n=e0(n,t,$t),n!==null){Je=n;return}if(t=t.sibling,t!==null){Je=t;return}Je=t=e}while(t!==null);nt===0&&(nt=5)}function Er(e,t,n){var r=Te,l=Zt.transition;try{Zt.transition=null,Te=1,c0(e,t,n,r)}finally{Zt.transition=l,Te=r}return null}function c0(e,t,n,r){do us();while(ar!==null);if(ve&6)throw Error(V(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(V(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(Wh(e,i),e===ot&&(Je=ot=null,ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Wl||(Wl=!0,Km(fi,function(){return us(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Zt.transition,Zt.transition=null;var a=Te;Te=1;var o=ve;ve|=4,Ec.current=null,r0(e,n),Fm(n,e),Tx(oo),pi=!!ao,oo=ao=null,e.current=n,s0(n),Lh(),ve=o,Te=a,Zt.transition=i}else e.current=n;if(Wl&&(Wl=!1,ar=e,Ai=l),i=e.pendingLanes,i===0&&(mr=null),Mh(n.stateNode),Ot(e,Qe()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],r(l.value,{componentStack:l.stack,digest:l.digest});if(Ti)throw Ti=!1,e=To,To=null,e;return Ai&1&&e.tag!==0&&us(),i=e.pendingLanes,i&1?e===Ao?Js++:(Js=0,Ao=e):Js=0,br(),null}function us(){if(ar!==null){var e=jf(Ai),t=Zt.transition,n=Te;try{if(Zt.transition=null,Te=16>e?16:e,ar===null)var r=!1;else{if(e=ar,ar=null,Ai=0,ve&6)throw Error(V(331));var l=ve;for(ve|=4,se=e.current;se!==null;){var i=se,a=i.child;if(se.flags&16){var o=i.deletions;if(o!==null){for(var c=0;c<o.length;c++){var d=o[c];for(se=d;se!==null;){var f=se;switch(f.tag){case 0:case 11:case 15:Xs(8,f,i)}var m=f.child;if(m!==null)m.return=f,se=m;else for(;se!==null;){f=se;var x=f.sibling,b=f.return;if(Pm(f),f===d){se=null;break}if(x!==null){x.return=b,se=x;break}se=b}}}var j=i.alternate;if(j!==null){var S=j.child;if(S!==null){j.child=null;do{var O=S.sibling;S.sibling=null,S=O}while(S!==null)}}se=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,se=a;else e:for(;se!==null;){if(i=se,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Xs(9,i,i.return)}var h=i.sibling;if(h!==null){h.return=i.return,se=h;break e}se=i.return}}var p=e.current;for(se=p;se!==null;){a=se;var v=a.child;if(a.subtreeFlags&2064&&v!==null)v.return=a,se=v;else e:for(a=p;se!==null;){if(o=se,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Xi(9,o)}}catch(D){Ye(o,o.return,D)}if(o===a){se=null;break e}var E=o.sibling;if(E!==null){E.return=o.return,se=E;break e}se=o.return}}if(ve=l,br(),In&&typeof In.onPostCommitFiberRoot=="function")try{In.onPostCommitFiberRoot(Hi,e)}catch{}r=!0}return r}finally{Te=n,Zt.transition=t}}return!1}function uu(e,t,n){t=gs(n,t),t=jm(e,t,1),e=fr(e,t,1),t=Et(),e!==null&&(bl(e,1,t),Ot(e,t))}function Ye(e,t,n){if(e.tag===3)uu(e,e,n);else for(;t!==null;){if(t.tag===3){uu(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(mr===null||!mr.has(r))){e=gs(n,e),e=Em(t,e,1),t=fr(t,e,1),e=Et(),t!==null&&(bl(t,1,e),Ot(t,e));break}}t=t.return}}function d0(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Et(),e.pingedLanes|=e.suspendedLanes&n,ot===e&&(ft&n)===n&&(nt===4||nt===3&&(ft&130023424)===ft&&500>Qe()-Ic?Ar(e,0):kc|=n),Ot(e,t)}function Vm(e,t){t===0&&(e.mode&1?(t=_l,_l<<=1,!(_l&130023424)&&(_l=4194304)):t=1);var n=Et();e=Wn(e,t),e!==null&&(bl(e,t,n),Ot(e,n))}function u0(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Vm(e,n)}function f0(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(V(314))}r!==null&&r.delete(t),Vm(e,n)}var Gm;Gm=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Lt.current)_t=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return _t=!1,Zx(e,t,n);_t=!!(e.flags&131072)}else _t=!1,Ue&&t.flags&1048576&&Xf(t,bi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;si(e,t),e=t.pendingProps;var l=ms(t,wt.current);ds(t,n),l=vc(null,t,r,e,l,n);var i=bc();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Pt(r)?(i=!0,Ni(t)):i=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,hc(t),l.updater=Qi,t.stateNode=l,l._reactInternals=t,yo(t,r,e,n),t=bo(null,t,r,!0,i,n)):(t.tag=0,Ue&&i&&oc(t),jt(null,t,l,n),t=t.child),t;case 16:r=t.elementType;e:{switch(si(e,t),e=t.pendingProps,l=r._init,r=l(r._payload),t.type=r,l=t.tag=p0(r),e=an(r,e),l){case 0:t=vo(null,t,r,e,n);break e;case 1:t=tu(null,t,r,e,n);break e;case 11:t=Zd(null,t,r,e,n);break e;case 14:t=eu(null,t,r,an(r.type,e),n);break e}throw Error(V(306,r,""))}return t;case 0:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:an(r,l),vo(e,t,r,l,n);case 1:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:an(r,l),tu(e,t,r,l,n);case 3:e:{if(Tm(t),e===null)throw Error(V(387));r=t.pendingProps,i=t.memoizedState,l=i.element,nm(e,t),ji(t,r,null,n);var a=t.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){l=gs(Error(V(423)),t),t=nu(e,t,r,n,l);break e}else if(r!==l){l=gs(Error(V(424)),t),t=nu(e,t,r,n,l);break e}else for(Ht=ur(t.stateNode.containerInfo.firstChild),Wt=t,Ue=!0,cn=null,n=em(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ps(),r===l){t=zn(e,t,n);break e}jt(e,t,r,n)}t=t.child}return t;case 5:return rm(t),e===null&&ho(t),r=t.type,l=t.pendingProps,i=e!==null?e.memoizedProps:null,a=l.children,co(r,l)?a=null:i!==null&&co(r,i)&&(t.flags|=32),Rm(e,t),jt(e,t,a,n),t.child;case 6:return e===null&&ho(t),null;case 13:return Am(e,t,n);case 4:return xc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=hs(t,null,r,n):jt(e,t,r,n),t.child;case 11:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:an(r,l),Zd(e,t,r,l,n);case 7:return jt(e,t,t.pendingProps,n),t.child;case 8:return jt(e,t,t.pendingProps.children,n),t.child;case 12:return jt(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,i=t.memoizedProps,a=l.value,De(wi,r._currentValue),r._currentValue=a,i!==null)if(pn(i.value,a)){if(i.children===l.children&&!Lt.current){t=zn(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Bn(-1,n&-n),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var f=d.pending;f===null?c.next=c:(c.next=f.next,f.next=c),d.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),xo(i.return,n,t),o.lanes|=n;break}c=c.next}}else if(i.tag===10)a=i.type===t.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(V(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),xo(a,n,t),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===t){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}jt(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,r=t.pendingProps.children,ds(t,n),l=en(l),r=r(l),t.flags|=1,jt(e,t,r,n),t.child;case 14:return r=t.type,l=an(r,t.pendingProps),l=an(r.type,l),eu(e,t,r,l,n);case 15:return km(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:an(r,l),si(e,t),t.tag=1,Pt(r)?(e=!0,Ni(t)):e=!1,ds(t,n),Sm(t,r,l),yo(t,r,l,n),bo(null,t,r,!0,e,n);case 19:return Cm(e,t,n);case 22:return Im(e,t,n)}throw Error(V(156,t.tag))};function Km(e,t){return vf(e,t)}function m0(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Jt(e,t,n,r){return new m0(e,t,n,r)}function Cc(e){return e=e.prototype,!(!e||!e.isReactComponent)}function p0(e){if(typeof e=="function")return Cc(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Xo)return 11;if(e===qo)return 14}return 2}function hr(e,t){var n=e.alternate;return n===null?(n=Jt(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function ai(e,t,n,r,l,i){var a=2;if(r=e,typeof e=="function")Cc(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case Yr:return Cr(n.children,l,i,t);case Qo:a=8,l|=8;break;case Ua:return e=Jt(12,n,t,l|2),e.elementType=Ua,e.lanes=i,e;case Ha:return e=Jt(13,n,t,l),e.elementType=Ha,e.lanes=i,e;case Wa:return e=Jt(19,n,t,l),e.elementType=Wa,e.lanes=i,e;case nf:return Ji(n,l,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case ef:a=10;break e;case tf:a=9;break e;case Xo:a=11;break e;case qo:a=14;break e;case Zn:a=16,r=null;break e}throw Error(V(130,e==null?e:typeof e,""))}return t=Jt(a,n,t,l),t.elementType=e,t.type=r,t.lanes=i,t}function Cr(e,t,n,r){return e=Jt(7,e,r,t),e.lanes=n,e}function Ji(e,t,n,r){return e=Jt(22,e,r,t),e.elementType=nf,e.lanes=n,e.stateNode={isHidden:!1},e}function Aa(e,t,n){return e=Jt(6,e,null,t),e.lanes=n,e}function Ca(e,t,n){return t=Jt(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function h0(e,t,n,r,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ua(0),this.expirationTimes=ua(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ua(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function Dc(e,t,n,r,l,i,a,o,c){return e=new h0(e,t,n,o,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Jt(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},hc(i),e}function x0(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Ym(e){if(!e)return gr;e=e._reactInternals;e:{if(Hr(e)!==e||e.tag!==1)throw Error(V(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Pt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(V(171))}if(e.tag===1){var n=e.type;if(Pt(n))return Yf(e,n,t)}return t}function Qm(e,t,n,r,l,i,a,o,c){return e=Dc(n,r,!0,e,l,i,a,o,c),e.context=Ym(null),n=e.current,r=Et(),l=pr(n),i=Bn(r,l),i.callback=t??null,fr(n,i,l),e.current.lanes=l,bl(e,l,r),Ot(e,r),e}function Zi(e,t,n,r){var l=t.current,i=Et(),a=pr(l);return n=Ym(n),t.context===null?t.context=n:t.pendingContext=n,t=Bn(i,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=fr(l,t,a),e!==null&&(fn(e,l,a,i),ti(e,l,a)),a}function Di(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function fu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function _c(e,t){fu(e,t),(e=e.alternate)&&fu(e,t)}function g0(){return null}var Xm=typeof reportError=="function"?reportError:function(e){console.error(e)};function Lc(e){this._internalRoot=e}ea.prototype.render=Lc.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(V(409));Zi(e,t,null,null)};ea.prototype.unmount=Lc.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fr(function(){Zi(null,e,null,null)}),t[Hn]=null}};function ea(e){this._internalRoot=e}ea.prototype.unstable_scheduleHydration=function(e){if(e){var t=If();e={blockedOn:null,target:e,priority:t};for(var n=0;n<rr.length&&t!==0&&t<rr[n].priority;n++);rr.splice(n,0,e),n===0&&Tf(e)}};function Pc(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function ta(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function mu(){}function y0(e,t,n,r,l){if(l){if(typeof r=="function"){var i=r;r=function(){var d=Di(a);i.call(d)}}var a=Qm(t,r,e,0,null,!1,!1,"",mu);return e._reactRootContainer=a,e[Hn]=a.current,al(e.nodeType===8?e.parentNode:e),Fr(),a}for(;l=e.lastChild;)e.removeChild(l);if(typeof r=="function"){var o=r;r=function(){var d=Di(c);o.call(d)}}var c=Dc(e,0,!1,null,null,!1,!1,"",mu);return e._reactRootContainer=c,e[Hn]=c.current,al(e.nodeType===8?e.parentNode:e),Fr(function(){Zi(t,c,n,r)}),c}function na(e,t,n,r,l){var i=n._reactRootContainer;if(i){var a=i;if(typeof l=="function"){var o=l;l=function(){var c=Di(a);o.call(c)}}Zi(t,a,e,l)}else a=y0(n,t,e,l,r);return Di(a)}Ef=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=$s(t.pendingLanes);n!==0&&(ec(t,n|1),Ot(t,Qe()),!(ve&6)&&(ys=Qe()+500,br()))}break;case 13:Fr(function(){var r=Wn(e,1);if(r!==null){var l=Et();fn(r,e,1,l)}}),_c(e,1)}};tc=function(e){if(e.tag===13){var t=Wn(e,134217728);if(t!==null){var n=Et();fn(t,e,134217728,n)}_c(e,134217728)}};kf=function(e){if(e.tag===13){var t=pr(e),n=Wn(e,t);if(n!==null){var r=Et();fn(n,e,t,r)}_c(e,t)}};If=function(){return Te};Rf=function(e,t){var n=Te;try{return Te=e,t()}finally{Te=n}};Za=function(e,t,n){switch(t){case"input":if(Ga(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=Gi(r);if(!l)throw Error(V(90));sf(r),Ga(r,l)}}}break;case"textarea":af(e,n);break;case"select":t=n.value,t!=null&&is(e,!!n.multiple,t,!1)}};pf=Rc;hf=Fr;var N0={usingClientEntryPoint:!1,Events:[Sl,Jr,Gi,ff,mf,Rc]},Ls={findFiberByHostInstance:Ir,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},v0={bundleType:Ls.bundleType,version:Ls.version,rendererPackageName:Ls.rendererPackageName,rendererConfig:Ls.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=yf(e),e===null?null:e.stateNode},findFiberByHostInstance:Ls.findFiberByHostInstance||g0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!zl.isDisabled&&zl.supportsFiber)try{Hi=zl.inject(v0),In=zl}catch{}}Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N0;Vt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pc(t))throw Error(V(200));return x0(e,t,null,n)};Vt.createRoot=function(e,t){if(!Pc(e))throw Error(V(299));var n=!1,r="",l=Xm;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=Dc(e,1,!1,null,null,n,!1,r,l),e[Hn]=t.current,al(e.nodeType===8?e.parentNode:e),new Lc(t)};Vt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(V(188)):(e=Object.keys(e).join(","),Error(V(268,e)));return e=yf(t),e=e===null?null:e.stateNode,e};Vt.flushSync=function(e){return Fr(e)};Vt.hydrate=function(e,t,n){if(!ta(t))throw Error(V(200));return na(null,e,t,!0,n)};Vt.hydrateRoot=function(e,t,n){if(!Pc(e))throw Error(V(405));var r=n!=null&&n.hydratedSources||null,l=!1,i="",a=Xm;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=Qm(t,null,e,1,n??null,l,!1,i,a),e[Hn]=t.current,al(e),r)for(e=0;e<r.length;e++)n=r[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new ea(t)};Vt.render=function(e,t,n){if(!ta(t))throw Error(V(200));return na(null,e,t,!1,n)};Vt.unmountComponentAtNode=function(e){if(!ta(e))throw Error(V(40));return e._reactRootContainer?(Fr(function(){na(null,null,e,!1,function(){e._reactRootContainer=null,e[Hn]=null})}),!0):!1};Vt.unstable_batchedUpdates=Rc;Vt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ta(n))throw Error(V(200));if(e==null||e._reactInternals===void 0)throw Error(V(38));return na(e,t,n,!1,r)};Vt.version="18.3.1-next-f1338f8080-20240426";function qm(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(qm)}catch(e){console.error(e)}}qm(),Xu.exports=Vt;var b0=Xu.exports,pu=b0;Ba.createRoot=pu.createRoot,Ba.hydrateRoot=pu.hydrateRoot;/**
 * @license
 * (c) Copyright 2023 Grammarly, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vl(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var hu=new Map;class xl extends Error{constructor(t,n){super(),Vl(this,"args",void 0),Vl(this,"code",void 0),Vl(this,"url",void 0),Vl(this,"_c",void 0);var r=new URL("https://developer.grammarly.com/docs/error-explainer");r.searchParams.set("code",t.toString()),n.forEach(l=>r.searchParams.append("args",function(i){if(i instanceof Error)return i.message+`
`+String(i.stack);if(i==null)return"null";if(typeof i=="object")try{return Object.prototype.toString.call(i)}catch{}return String(i)}(l))),this.stack!=null&&r.searchParams.set("trace",this.stack),this.message="Minified error #".concat(t,": See ").concat(r.toString()," for details."),this.args=n,this.code=t,this.url=r.toString()}toUserMessage(){var t=hu.get("".concat(this.code));if(t==null)return[this];var n=new Map(this.args.map((l,i)=>["${".concat(i,"}"),l])),r=t.split(/(\${\d+})/).filter(l=>l!=="");return r.map(l=>{var i;return(i=n.get(l))!==null&&i!==void 0?i:l})}toJSON(){return{name:"InvariantError",message:this.message,description:this._m,code:this.code,args:this.args,stack:this.stack}}static setMessages(t){hu=t}static create(t,n,r,l){l!=null&&n.push(l);var i=new xl(t,n,r);return i.stack=l==null?void 0:l.stack,i._m=r,i}}const xu=new WeakMap;async function w0(e,t){const n=xu.get(e);if(n!=null)return await n;(function(l){l.Grammarly==null&&(l.Grammarly={})})(e);const r=new Promise((l,i)=>{try{let o=function(c,d){return c.document.querySelectorAll(`script[src^="${d.replace(/\?.*$/,"")}"]`)[0]}(e,t);o!=null?a():(o=function(c,d){const f=c.document.createElement("script");return f.src=d,c.document.head.appendChild(f),f}(e,t),o.addEventListener("load",a),o.addEventListener("error",function(){try{throw new xl(23,[])}catch(c){i(c)}}))}catch(o){return i(o)}function a(){try{if(e.Grammarly==null||typeof e.Grammarly.EditorSDK!="function")throw new xl(22,[]);l(e.Grammarly)}catch(o){i(o)}}});return xu.set(e,r),await r}async function gu(e,t,n,r){if(typeof window>"u"&&r===void 0)throw new xl(21,[]);const l=function(o){return o.location.origin!=="null"?o.location.origin:o.origin!=="null"?o.origin:"null"}(r??window);l==="null"&&(r??window).top!==(r??window)&&console.warn("Grammarly is not supported in IFrames with `null` origin. Consider adding `sandbox='allow-same-origin allow-scripts'` to <iframe> element.");const i=new URL("https://js.grammarly.com/grammarly-editor-sdk@2.5",l);t!=null&&i.searchParams.set("clientId",t),i.searchParams.set("packageName",e);const a=await w0(r??window,i.toString());if(t!=null)return new a.EditorSDK(t,n)}const Da={onBeforeSuggestionCardOpen:"before-suggestion-card-open",onSuggestionCardOpen:"suggestion-card-open",onSuggestionCardClose:"suggestion-card-close",onSuggestionCardAction:"suggestion-card-action",onPluginTurnedOff:"plugin-turned-off",onPluginError:"plugin-error",onDocumentStats:"document-stats",onSessionStats:"session-stats"};/**
 * @license
 * (c) Copyright 2023 Grammarly, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S0=Vo.createContext({});function j0(e,t,n){const r=w.useCallback(l=>e==null?void 0:e(new CustomEvent("plugin-error",{detail:l})),[e]);w.useEffect(()=>{var l;typeof navigator<"u"&&(t!=null&&((l=n==null?void 0:n.current)===null||l===void 0?void 0:l.ownerDocument.defaultView)!=null&&window!==n.current.ownerDocument.defaultView?gu("@grammarly/editor-sdk-react",t,void 0,n.current.ownerDocument.defaultView).catch(r):gu("@grammarly/editor-sdk-react").catch(r))},n!=null&&t!=null?[n,t]:[])}function yu(e){return typeof e=="function"}const gl=e=>{const[t,{clientId:n,config:r,children:l,className:i,...a}]=function(S){const O={},h={...S};return Object.keys(Da).forEach(p=>{O[p]=S[p],p in h&&delete h[p]}),[O,h]}(e),o=w.useContext(S0),c=w.useRef(),d=w.useRef(),f=w.useRef(),m=w.useCallback(S=>{c.current=S,b()},[]),x=function(S){const[O,h]=w.useState({}),p=w.useCallback(()=>{customElements.whenDefined(S).then(()=>h(v=>({...v,[S]:!0}))).catch(()=>{})},[S]);return w.useEffect(p,[p]),!!O[S]}("grammarly-editor-plugin"),b=w.useCallback(()=>{var S;c.current!=null&&d.current!=null&&x&&c.current.connect(d.current,(S=f.current)!==null&&S!==void 0?S:void 0)},[x]),j=w.useMemo(()=>({...o.config,...r}),[o.config,r]);return w.useEffect(()=>{c.current&&(c.current.config=j)},[c,j]),w.useEffect(()=>{if(c.current==null)return;const{current:S}=c,O=[];return Object.keys(Da).forEach(h=>{const p=t[h],v=Da[h];p!=null&&(S.addEventListener(v,p),O.push(()=>S.removeEventListener(v,p)))}),()=>O.forEach(h=>h())},[...Object.values(t),x,c.current]),j0(e.onPluginError,n??o.clientId,c),Vo.createElement("grammarly-editor-plugin",{...a,ref:m,clientId:n??o.clientId,autodetect:yu(l)?"off":"on",class:i},yu(l)?l({setEditor:S=>{d.current=S,b()},setViewport:S=>{f.current=S,b()}}):l)};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var E0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k0=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),me=(e,t)=>{const n=w.forwardRef(({color:r="currentColor",size:l=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:o="",children:c,...d},f)=>w.createElement("svg",{ref:f,...E0,width:l,height:l,stroke:r,strokeWidth:a?Number(i)*24/Number(l):i,className:["lucide",`lucide-${k0(e)}`,o].join(" "),...d},[...t.map(([m,x])=>w.createElement(m,x)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I0=me("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _i=me("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oc=me("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Li=me("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R0=me("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T0=me("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jm=me("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zm=me("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pi=me("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=me("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A0=me("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C0=me("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D0=me("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _0=me("FilePlus2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Br=me("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mc=me("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=me("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fc=me("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _o=me("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bc=me("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P0=me("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O0=me("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M0=me("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jn=me("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ep=me("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $c=me("NotebookPen",[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M18.4 2.6a2.17 2.17 0 0 1 3 3L16 11l-4 1 1-4Z",key:"1dba1m"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F0=me("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uc=me("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tp=me("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const np=me("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oi=me("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B0=me("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $0=me("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rp=me("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sp=me("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sn=me("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mi=me("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U0=me("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H0=me("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W0=me("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mt=me("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),lp=["The facts outlined in the statement of claim","Statement of Claim  Factual Summary"],Fn="Factual background  Statement of Claim",ip=["Factual Summary from the Letter of Demand"],ws="Factual background  Letter of Demand",Hc="The plaintiff's expert opinion",Wc="The claimant's expert opinion",Dr=[{id:"u1",username:"lior",password:"lior123",name:"Lior Perry",email:"lior@lp-law.co.il",role:"ADMIN"},{id:"u2",username:"lidor",password:"lidor123",name:"Lidor Kabilo",email:"Lidor@lp-law.co.il",role:"SUB_ADMIN"},{id:"u3",username:"iris",password:"iris123",name:"Iris Alfman",email:"Iris@lp-law.co.il",role:"FINANCE"},{id:"u4",username:"hava",password:"hava123",name:"Hava Kabilo",email:"Hava@lp-law.co.il",role:"LAWYER"},{id:"u5",username:"may",password:"may123",name:"May Harari",email:"May@lp-law.co.il",role:"LAWYER"},{id:"u6",username:"vlada",password:"vlada123",name:"Vlada Boltach",email:"Vlada@lp-law.co.il",role:"LAWYER"},{id:"u7",username:"orly",password:"orly123",name:"Orly Day",email:"Orly@lp-law.co.il",role:"LAWYER"}],Nu=["W/R/B Underwriting","QBE Insurance Group","Market Form Underwriting","Dale Underwriting Partners","MedPro & CNA Syndicate","Hardy (Underwriting Agencies) Limited"],z0=[Fn,ws,Hc,Wc,"The insured's expert opinion","Insurance Coverage","Risk Assessment","MPL","Strategy","Expenses breakdown","Expenses & Compensation breakdown","Recommendations","Strategy & Recommendations","Request for Approval of a Settlement Agreement"],ap=["New lawsuit","Letter of demand","New third-party notice","Caution Notice"],_a={Update:["    .","    [DATE]      .","       .","        ."],"Insurance Coverage":[`The policy period is from [policyStartDate] to [policyEndDate].

The retroactive date is [retroactiveDate].

    _______________, ,   .

      ,     ____________  ____________.

,         .`],"Risk Assessment":[",       ( 50%).","        .","     ,      .","     ,    ."],Recommendations:["         .","         .","      .","    '     ."],[Fn]:[", {plaintiff},    [DATE]    .","    , {insured},     .","    ."],[ws]:[", {plaintiff},         [DATE].","         .","        ."],Strategy:["         .","          .","         ."]},zc=e=>e===Hc,Vc=e=>e===Wc,vu=e=>zc(e)||Vc(e),V0=e=>zc(e)||e===Fn?"PLAINTIFF":Vc(e)||e===ws?"CLAIMANT":null,bu=(e,t="SINGLE")=>`${t==="MULTIPLE"?"Expert opinions":"Expert opinion"}  ${e==="PLAINTIFF"?"Statement of Claim":"Letter of Demand"}`,G0=(e,t)=>zc(e)?bu("PLAINTIFF",t):Vc(e)?bu("CLAIMANT",t):e,K0=({data:e})=>{const[t,n]=w.useState(""),[r,l]=w.useState(!1),[i,a]=w.useState(null);if(w.useEffect(()=>{let c=!1;return(async()=>{l(!0),a(null);try{const f=await fetch("/api/render-report-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report:e})});if(!f.ok)throw new Error("Failed to load report HTML");const m=await f.text();c||n(m)}catch(f){console.error(f),c||a("   ")}finally{c||l(!1)}})(),()=>{c=!0}},[e]),i)return s.jsx("div",{className:"w-[210mm] min-h-[297mm] bg-white shadow-2xl mx-auto flex items-center justify-center text-sm text-red-600",children:i});if(r&&!t)return s.jsx("div",{className:"w-[210mm] min-h-[297mm] bg-white shadow-2xl mx-auto flex flex-col items-center justify-center text-sm text-gray-500",children:s.jsx("span",{children:"  ..."})});const o=!!e.policyFile&&(e.attachPolicyAsAppendix??!0);return s.jsxs("div",{className:"space-y-2",children:[s.jsx("iframe",{title:"Report Preview",className:"w-[210mm] min-h-[297mm] bg-white shadow-2xl mx-auto border-none print:shadow-none print:w-full",srcDoc:t}),o&&s.jsx("p",{className:"w-[210mm] mx-auto text-[11px] text-gray-500 text-right",children:"The policy file will be attached as Appendix A in the final PDF (not shown in this preview)."})]})},op=e=>{switch(e){case"HEBREW_SUBMITTED":return" ";case"HEBREW_CHANGES_REQUESTED":return" ";case"HEBREW_APPROVED":return" ";case"HEBREW_REOPENED_EXTERNAL":return"  ()";case"HEBREW_DRAFT":default:return" "}},Y0=e=>{switch(e){case"SUBMITTED":return"  ";case"CHANGES_REQUESTED":return"  ";case"APPROVED":return"  ";case"DRAFT":default:return"  (  )"}},oi="report-review-panel",Lo="external-feedback-panel",Q0=({report:e,currentUser:t,onSubmitToAdmin:n,onApproveHebrew:r,onRequestChanges:l,onMarkIssueDone:i,onAddExternalFeedbackIssues:a,onReopenHebrewDueToExternalFeedback:o})=>{const[c,d]=w.useState(!1),[f,m]=w.useState(""),[x,b]=w.useState(""),[j,S]=w.useState("NORMAL"),[O,h]=w.useState(""),[p,v]=w.useState("INTERNAL"),[E,D]=w.useState("ENGLISH_ONLY"),M=w.useMemo(()=>{const U=e.reportReview;return U||{status:"DRAFT",issues:[]}},[e.reportReview]),P=w.useMemo(()=>{const U={};return M.issues.filter(te=>(te.origin??"INTERNAL")==="INTERNAL").forEach(te=>{const I=te.sectionKey||"GENERAL";U[I]||(U[I]=[]),U[I]=[...U[I],te]}),U},[M.issues]),H=w.useMemo(()=>{const U={};return M.issues.filter(te=>te.origin==="EXTERNAL").forEach(te=>{const I=te.sectionKey||"GENERAL";U[I]||(U[I]=[]),U[I]=[...U[I],te]}),U},[M.issues]),ne=(t==null?void 0:t.role)==="LAWYER",A=(t==null?void 0:t.role)==="ADMIN",y=M.issues.some(U=>(U.origin??"INTERNAL")==="EXTERNAL"&&U.status!=="DONE"&&U.externalAction==="REQUIRES_HEBREW"),$=U=>{v(U),m(""),b(""),S("NORMAL"),h(""),D("ENGLISH_ONLY"),d(!0)},_=()=>{const U=f.trim(),te=x.trim();if(!U||!te)return;const I={title:U,instruction:te,severity:j,type:"OTHER",sectionKey:void 0,externalAction:p==="EXTERNAL"?E:void 0};p==="EXTERNAL"&&a?a([I],O.trim()||void 0):l([I]),d(!1)},R=Y0(M.status),z=op(e.hebrewWorkflowStatus);return s.jsxs("section",{id:oi,className:"mt-4 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3",dir:"rtl",lang:"he",children:[s.jsxs("div",{className:"mb-2 flex items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-semibold text-slate-500",children:" "}),s.jsx("div",{className:"text-sm font-medium text-slate-900",children:R})]}),s.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-700",children:z})]}),ne&&s.jsx("div",{className:"mb-3 text-xs text-amber-700",children:e.hebrewWorkflowStatus==="HEBREW_REOPENED_EXTERNAL"?"            .":M.status==="SUBMITTED"?"   .       .":M.status==="CHANGES_REQUESTED"?"   .      .":null}),A&&y&&s.jsx("div",{className:"mb-3 text-xs font-semibold text-red-700",children:"      .    ."}),M.issues.length>0&&s.jsxs("div",{className:"mb-3 space-y-3",children:[Object.keys(P).length>0&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-1 text-xs font-semibold text-slate-600",children:"  ()"}),Object.entries(P).map(([U,te])=>s.jsxs("div",{className:"rounded-lg bg-white p-2 mb-1",children:[U!=="GENERAL"&&s.jsxs("div",{className:"mb-1 text-[11px] font-semibold text-slate-500",children:[": ",U]}),s.jsx("ul",{className:"space-y-1",children:te.map(I=>s.jsxs("li",{className:"flex items-start justify-between gap-2 rounded-md border border-slate-100 bg-slate-50 px-2 py-1.5",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ${I.severity==="CRITICAL"?"bg-red-100 text-red-700":I.severity==="NORMAL"?"bg-amber-50 text-amber-700":"bg-slate-100 text-slate-600"}`,children:I.severity==="CRITICAL"?"":I.severity==="NORMAL"?"":""}),s.jsx("span",{className:"text-xs font-medium text-slate-900",children:I.title})]}),s.jsx("div",{className:"mt-1 text-[11px] text-slate-700",children:I.instruction})]}),(ne||A)&&s.jsx("button",{type:"button",className:"mt-1 inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 hover:bg-emerald-100 disabled:opacity-50",disabled:I.status==="DONE",onClick:()=>i(I.id),children:I.status==="DONE"?"":" "})]},I.id))})]},U))]}),Object.keys(H).length>0&&s.jsxs("div",{id:Lo,children:[s.jsx("div",{className:"mb-1 text-xs font-semibold text-slate-600",children:"  "}),Object.entries(H).map(([U,te])=>s.jsxs("div",{className:"rounded-lg bg-white p-2 mb-1",children:[U!=="GENERAL"&&s.jsxs("div",{className:"mb-1 text-[11px] font-semibold text-slate-500",children:[": ",U]}),s.jsx("ul",{className:"space-y-1",children:te.map(I=>s.jsxs("li",{className:"flex items-start justify-between gap-2 rounded-md border border-slate-100 bg-slate-50 px-2 py-1.5",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ${I.severity==="CRITICAL"?"bg-red-100 text-red-700":I.severity==="NORMAL"?"bg-amber-50 text-amber-700":"bg-slate-100 text-slate-600"}`,children:I.severity==="CRITICAL"?"":I.severity==="NORMAL"?"":""}),s.jsx("span",{className:"text-xs font-medium text-slate-900",children:I.title})]}),s.jsx("div",{className:"mt-1 text-[11px] text-slate-700",children:I.instruction})]}),(ne||A)&&s.jsx("button",{type:"button",className:"mt-1 inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 hover:bg-emerald-100 disabled:opacity-50",disabled:I.status==="DONE",onClick:()=>i(I.id),children:I.status==="DONE"?"":" "})]},I.id))})]},U))]})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[ne&&s.jsx("button",{type:"button",className:"rounded-md bg-sky-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-sky-800 disabled:opacity-50",onClick:n,disabled:M.status==="SUBMITTED"||M.status==="APPROVED",children:"  "}),A&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",className:"rounded-md bg-emerald-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-emerald-800 disabled:opacity-50",onClick:r,children:"  "}),s.jsx("button",{type:"button",className:"rounded-md bg-amber-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-amber-800",onClick:()=>$("INTERNAL"),children:" "}),a&&s.jsx("button",{type:"button",className:"rounded-md bg-slate-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-slate-800",onClick:()=>$("EXTERNAL"),children:"   "}),o&&e.status==="SENT"&&s.jsx("button",{type:"button",className:"rounded-md bg-red-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-red-800",onClick:o,children:"   ( )"}),o&&e.status!=="SENT"&&s.jsx("span",{className:"text-[11px] text-slate-500",children:"       (SENT)."})]})]}),c&&s.jsx("div",{className:"fixed inset-0 z-[180] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-4 shadow-2xl",dir:"rtl",lang:"he",children:[s.jsx("h3",{className:"mb-3 text-sm font-bold text-slate-900",children:"   "}),s.jsxs("div",{className:"mb-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:"  ()"}),s.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-sm",value:f,onChange:U=>m(U.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:"  ()"}),s.jsx("textarea",{className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-sm",rows:3,value:x,onChange:U=>b(U.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:" "}),s.jsxs("select",{className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs",value:j,onChange:U=>S(U.target.value),children:[s.jsx("option",{value:"NORMAL",children:""}),s.jsx("option",{value:"CRITICAL",children:""}),s.jsx("option",{value:"STYLE",children:""})]})]}),p==="EXTERNAL"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:"    ()"}),s.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-sm",value:O,onChange:U=>h(U.target.value)}),s.jsx("label",{className:"mb-1 mt-3 block text-xs font-semibold text-slate-700",children:" "}),s.jsxs("select",{className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs",value:E,onChange:U=>D(U.target.value),children:[s.jsx("option",{value:"ENGLISH_ONLY",children:"  "}),s.jsx("option",{value:"REQUIRES_HEBREW",children:"  "})]})]})]}),s.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[s.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-100",onClick:()=>d(!1),children:""}),s.jsx("button",{type:"button",className:"rounded-md bg-amber-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-amber-800 disabled:opacity-50",onClick:_,disabled:!f.trim()||!x.trim(),children:" "})]})]})})]})},yl="REPLACE_WITH_GRAMMARLY_CLIENT_ID",Gc={[Fn]:"Statement of Claim",[ws]:"Letter of Demand",[Hc]:"Statement of Claim Expert Opinion",[Wc]:"Letter of Demand Expert Opinion","The plaintiff's expert opinion":"Plaintiff Expert Opinion","The claimant's expert opinion":"Claimant Expert Opinion","The insured's expert opinion":"Insured Expert Opinion","Insurance Coverage":"Insurance Coverage","Risk Assessment":"Risk Assessment",MPL:"MPL",Strategy:"Strategy","Expenses breakdown":"Expenses Breakdown","Expenses & Compensation breakdown":"Expenses & Compensation",Recommendations:"Recommendations","Strategy & Recommendations":"Strategy & Recommendations","Request for Approval of a Settlement Agreement":"Settlement Approval",Update:"Update"};lp.forEach(e=>{Gc[e]="Statement of Claim"});ip.forEach(e=>{Gc[e]="Letter of Demand"});const X0=e=>(Gc[e]||e||"").trim(),cp=e=>e.map(X0).filter(Boolean),Po=e=>{const t=new Set;return e.map(n=>n.trim()).filter(n=>{if(!n)return!1;const r=n.toLowerCase();return t.has(r)?!1:(t.add(r),!0)})},Kc=/[\\/:*?"<>|]/g,La=e=>(e||"").trim(),q0=e=>{const t=(e.filenameTag||"").toLowerCase(),n=(e.plaintiffTitle||"").toLowerCase();return t.includes("demand")||n==="claimant"},J0=e=>{var t;return(((t=e.reportHistory)==null?void 0:t.length)||0)+1},Z0=120,Hs=e=>{const t=La(e.insurerName),n=La(e.insuredName),r=La(e.plaintiffName),l=J0(e);let i=[];const a=Array.isArray(e.fileNameTitles)?bt(e.fileNameTitles.map(j=>ut(j))):[];a.length>0?i=Po(a):l===1?i=[q0(e)?"New Letter of demand":"New Lawsuit"]:(i=Po(cp(e.selectedSections||[])),i.length||(i=["Update"]));const o=i.join(" & "),c=`Report ${l}`;let f=[t||void 0,n||void 0,r||void 0,o||void 0].filter(Boolean).join(" - ");if(f=f.replace(Kc," ").replace(/\s+/g," ").replace(/-+/g,"-").trim(),!f){const j=c;return j.toLowerCase().endsWith(".pdf")?j:`${j}.pdf`}const m=` - ${c}`,x=Math.max(0,Z0-m.length);f.length>x&&(f=f.slice(0,x).trim());let b=`${f}${m}`;return b=b.replace(/\s+/g," ").replace(/-+/g,"-").trim(),b||(b=`Report-${Date.now()}`),b.toLowerCase().endsWith(".pdf")?b:`${b}.pdf`},dp=e=>`fileNameTopics:${e||"default"}`,eg=["Update","Expenses","New Lawsuit","New Third Party Notice","New Letter of Demand","Risk Assessment","Strategy","Recommendation","Request for Settlement Approval","Judgment","Request to Reopen a Claim","Dismissal for Inaction"],ut=e=>{const t=(e||"").trim();return t?t.replace(Kc," ").replace(/\s+/g," ").trim():""},Fi=e=>ut(e).trim().toLowerCase(),bt=e=>{const t=new Set,n=[];for(const r of e){const l=ut(r),i=Fi(l);i&&(t.has(i)||(t.add(i),n.push(l)))}return n},tg=e=>{if(typeof window>"u")return[];try{const t=window.localStorage.getItem(dp(e));if(!t)return[];const n=JSON.parse(t);return Array.isArray(n)?bt(n.map(r=>typeof r=="string"?r:"").map(ut)):[]}catch{return[]}},ng=(e,t)=>{if(!(typeof window>"u"))try{const n=bt(t.map(ut)).filter(Boolean);window.localStorage.setItem(dp(e),JSON.stringify(n))}catch{}},rg=(e,t,n=15)=>{const r=ut(t),l=Fi(r);if(!l)return bt(e).slice(0,n);const i=(e||[]).filter(o=>Fi(o)!==l),a=[r,...i];return bt(a).slice(0,n)},up=e=>`topicCombos:${e||"default"}`,fp=e=>`insurerDefaultTopics:${e||"default"}`,mp=e=>{if(!e)return null;try{return JSON.parse(e)}catch{return null}},Oo=e=>{if(typeof window>"u")return[];const t=window.localStorage.getItem(up(e)),n=mp(t);return Array.isArray(n)?n.filter(l=>Array.isArray(l)).map(l=>l.map(i=>ut(i)).filter(Boolean)).filter(l=>l.length>0):[]},wu=(e,t)=>{if(typeof window>"u")return;const n=t.map(r=>bt(r.map(l=>ut(l))).filter(Boolean)).filter(r=>r.length>0);try{window.localStorage.setItem(up(e),JSON.stringify(n))}catch{}},Su=e=>e.map(n=>Fi(n)).filter(Boolean).sort().join("|"),ju=(e,t,n=6)=>{const r=bt(t.map(o=>ut(o))).filter(Boolean);if(!r.length)return e;const l=Su(r),i=[],a=new Set;i.push(r),a.add(l);for(const o of e){const c=Su(o);if(!a.has(c)&&(i.push(bt(o.map(d=>ut(d))).filter(Boolean)),a.add(c),i.length>=n))break}return i.slice(0,n)},Yc=e=>(e||"").trim().toLowerCase(),Qc=e=>{if(typeof window>"u")return{};const t=window.localStorage.getItem(fp(e)),n=mp(t);if(!n||typeof n!="object")return{};const r={};for(const[l,i]of Object.entries(n)){if(!Array.isArray(i))continue;const a=bt(i.map(o=>ut(o))).filter(Boolean).slice(0,8);a.length&&(r[l]=a)}return r},pp=(e,t)=>{if(typeof window>"u")return;const n={};for(const[r,l]of Object.entries(t)){const i=bt((l||[]).map(a=>ut(a))).filter(Boolean).slice(0,8);i.length&&(n[r]=i)}try{window.localStorage.setItem(fp(e),JSON.stringify(n))}catch{}},sg=(e,t)=>{const n=Qc(e),r=Yc(t);return n[r]||[]},lg=(e,t,n)=>{if(!t)return;const r=Yc(t),l=Qc(e),i=bt(n.map(a=>ut(a))).filter(Boolean).slice(0,8);i.length?l[r]=i:delete l[r],pp(e,l)},ig=(e,t)=>{if(!t)return;const n=Yc(t),r=Qc(e);r[n]&&(delete r[n],pp(e,r))},Eu=[{id:"general_update",label:"General Update",body:`Dear Sir/Madam,

Please find below our general update regarding the above-captioned matter.

Best regards,
Lior Perry, Adv.`},{id:"risk_assessment",label:"Risk Assessment",body:`Dear Sir/Madam,

Kindly review the following risk assessment prepared for the insurer.

Best regards,
Lior Perry, Adv.`},{id:"expert_opinion",label:"Expert Opinion",body:`Dear Sir/Madam,

Please find our expert opinion summary for your review and records.

Best regards,
Lior Perry, Adv.`},{id:"full_report",label:"Full Report Delivery",body:`Dear Sir/Madam,

Attached is the full report for the current update, including all relevant sections.

Best regards,
Lior Perry, Adv.`},{id:"zeev_new_demand",label:"Zeev  New demand letter",body:`Dear Zeev,

I've attached a report regarding a new demand letter.

Sincerely,
Lior`},{id:"zeev_claim_update",label:"Zeev  Claim update",body:`Dear Zeev,

I've attached a report on the claim in question.

Sincerely,
Lior`},{id:"zeev_new_lawsuit",label:"Zeev  New lawsuit",body:`Dear Zeev,

I've attached a report regarding a new lawsuit.

Sincerely,
Lior`},{id:"zeev_lawsuit_update",label:"Zeev  Lawsuit update",body:`Dear Zeev,

I've attached a report on the lawsuit in question.

Sincerely,
Lior`}],ku=e=>`emailTemplates:${e||"default"}`,ag=({isOpen:e,report:t,userId:n,isSending:r=!1,recipientsPreview:l,defaultSubject:i,subjectDraft:a,onSubjectDraftChange:o,selectedTopics:c,onSelectedTopicsChange:d,onClose:f,onSend:m})=>{const x=Eu[0],[b,j]=w.useState(x.id),[S,O]=w.useState(x.body),[h,p]=w.useState([]),[v,E]=w.useState([]),[D,M]=w.useState(a),[P,H]=w.useState(""),[ne,A]=w.useState(""),[y,$]=w.useState([]),[_,R]=w.useState([]),z=Q=>{if(typeof window>"u")return[];try{const pe=localStorage.getItem(ku(Q));if(!pe)return[];const Fe=JSON.parse(pe);return Array.isArray(Fe)?Fe.filter(je=>typeof(je==null?void 0:je.id)=="string"&&typeof(je==null?void 0:je.label)=="string"&&typeof(je==null?void 0:je.body)=="string"):[]}catch{return[]}},U=Q=>{typeof window>"u"||localStorage.setItem(ku(n),JSON.stringify(Q))},te=w.useMemo(()=>[...Eu,...h],[h]),I=w.useMemo(()=>te.reduce((Q,pe)=>(Q[pe.id]=pe,Q),{}),[te]);w.useEffect(()=>{if(!e)return;const Q=z(n);p(Q);const pe=tg(n);E(pe),$(Oo(n)),R(sg(n,t.insurerName)),M(a)},[e,n,a,t.insurerName]),w.useEffect(()=>{if(!e)return;const Q=t.selectedEmailTemplate&&I[t.selectedEmailTemplate]?t.selectedEmailTemplate:x.id;j(Q),O(t.emailBodyDraft||I[Q].body)},[e,x.id,t.emailBodyDraft,t.selectedEmailTemplate,I]);const K=Q=>{j(Q);const pe=I[Q];pe&&O(pe.body)},q=()=>{const Q=window.prompt("  ?");if(!Q)return;const pe=Q.trim();if(!pe)return;const Fe={id:`custom_${Date.now()}`,label:pe,body:S},je=[...h,Fe];p(je),U(je),j(Fe.id)},F=w.useMemo(()=>bt([...v,...eg]),[v]),Z=w.useMemo(()=>{const Q=ne.trim().toLowerCase();return Q?F.filter(pe=>pe.toLowerCase().includes(Q)):F},[F,ne]),Ie=Q=>{const pe=ut(Q);if(!pe)return;const Fe=pe.toLowerCase(),je=c.some(Xe=>Xe.trim().toLowerCase()===Fe)?c.filter(Xe=>Xe.trim().toLowerCase()!==Fe):[...c,pe];d(bt(je))},be=()=>{const Q=ut(P);if(!Q)return;const pe=rg(v,Q,15);E(pe),ng(n,pe);const Fe=bt([...c,Q]);d(Fe),H("")},Me=w.useMemo(()=>Hs({...t,fileNameTitles:c}),[t,c]),St=!l.cc.some(Q=>Q.toLowerCase()!=="reports@lp-law.co.il");return e?s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[999] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-4",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Compose Email"}),s.jsx("button",{onClick:f,className:"text-gray-500 hover:text-gray-700",children:s.jsx(Mt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[St&&s.jsxs("div",{className:"flex items-start gap-2 text-xs text-amber-800 bg-amber-50 border border-amber-200 rounded-md px-3 py-2",children:[s.jsx(_i,{className:"w-3.5 h-3.5 mt-[1px]"}),s.jsx("p",{children:"         .     zeev@ reports@."})]}),s.jsxs("div",{className:"text-xs text-gray-600 space-y-1 border rounded-md border-gray-200 bg-gray-50 px-3 py-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-semibold",children:"To:"})," ",s.jsx("span",{children:l.to.join("; ")||""})]}),l.cc.length>0&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-semibold",children:"CC:"})," ",s.jsx("span",{children:l.cc.join("; ")})]}),s.jsx("p",{className:"text-[11px] text-gray-500 mt-1",children:"To: Zeev (primary), CC: Office + report owner ( )."}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Subject:"})," ",D||"(will be generated from case data)"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Attachment:"})," ",Me]}),s.jsx("p",{className:"text-[11px] text-amber-700 mt-1",children:" :       ,        -PDF ."})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject"}),s.jsx("button",{type:"button",onClick:()=>{M(i),o(void 0)},className:"text-[11px] text-blue-700 hover:underline disabled:opacity-50",disabled:r,children:"Reset"})]}),s.jsx("input",{type:"text",value:D,onChange:Q=>{const pe=Q.target.value;M(pe),o(pe)},className:"w-full border rounded-md p-2 text-sm",disabled:r})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("select",{value:b,onChange:Q=>K(Q.target.value),className:"flex-1 border rounded-md p-2",children:te.map(Q=>s.jsx("option",{value:Q.id,children:Q.label},Q.id))}),s.jsx("button",{type:"button",onClick:q,className:"px-3 py-2 bg-white border rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100",disabled:r,children:"Save Template"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PDF Filename Topics"}),y.length>0&&s.jsxs("div",{className:"mb-2",children:[s.jsx("p",{className:"text-[11px] font-semibold text-gray-700 mb-1",children:"Recent combinations"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((Q,pe)=>s.jsx("button",{type:"button",onClick:()=>d(Q),className:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 text-[11px] text-gray-800 border border-gray-300 hover:bg-gray-200",children:Q.join(" + ")},pe))})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:c.length===0?s.jsx("span",{className:"text-xs text-gray-400",children:"No topics selected yet. You can choose from the list below or add your own."}):c.map(Q=>s.jsxs("button",{type:"button",onClick:()=>Ie(Q),className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 text-xs text-blue-800 border border-blue-200 hover:bg-blue-100",children:[s.jsx("span",{children:Q}),s.jsx("span",{className:"text-[10px]",children:""})]},Q))}),s.jsx("button",{type:"button",onClick:()=>d([]),className:"mb-2 text-[11px] text-blue-700 hover:underline",disabled:r||c.length===0,children:"  "}),s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("input",{type:"text",value:ne,onChange:Q=>A(Q.target.value),placeholder:"  ...",className:"flex-1 border rounded-md p-1.5 text-[11px]",disabled:r})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-1 mb-2 max-h-32 overflow-y-auto border rounded-md p-2 bg-white",children:Z.map(Q=>{const pe=`topic-${Q}`,Fe=Q.toLowerCase(),je=c.some(Xe=>Xe.trim().toLowerCase()===Fe);return s.jsxs("label",{htmlFor:pe,className:"flex items-center gap-1 text-xs text-gray-700 cursor-pointer",children:[s.jsx("input",{id:pe,type:"checkbox",className:"h-3 w-3",checked:je,onChange:()=>Ie(Q),disabled:r}),s.jsx("span",{className:"truncate",children:Q})]},Q)})}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[s.jsx("input",{type:"text",value:P,onChange:Q=>H(Q.target.value),placeholder:"Add custom topic",className:"flex-1 border rounded-md p-2 text-xs",disabled:r}),s.jsx("button",{type:"button",onClick:be,className:"px-3 py-1.5 bg-white border rounded-md text-xs font-medium text-gray-700 hover:bg-gray-100 disabled:opacity-50",disabled:r,children:"Add"})]}),s.jsxs("div",{className:"mt-3 space-y-1 text-[11px] text-gray-700",children:[s.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[s.jsx("button",{type:"button",onClick:()=>{const Q=bt(c.map(pe=>ut(pe)));Q.length&&(lg(n,t.insurerName,Q),R(Q))},className:"px-2 py-1 rounded-full border border-gray-300 bg-white hover:bg-gray-100",disabled:r||c.length===0,children:"     "}),_.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:()=>d(_),className:"px-2 py-1 rounded-full border border-blue-300 bg-blue-50 text-blue-800 hover:bg-blue-100 disabled:opacity-50",disabled:r,children:"     "}),s.jsx("button",{type:"button",onClick:()=>{ig(n,t.insurerName),R([])},className:"text-[11px] text-red-600 hover:underline",disabled:r,children:"    "})]})]}),_.length>0&&c.length===0&&s.jsx("p",{className:"text-[11px] text-gray-500",children:"     .       ."})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Body"}),s.jsx(gl,{clientId:yl,children:s.jsx("textarea",{value:S,onChange:Q=>O(Q.target.value),rows:12,dir:"ltr",className:"w-full border rounded-md p-3 text-sm",style:{direction:"ltr",textAlign:"left",unicodeBidi:"plaintext"}})})]}),s.jsxs("div",{className:"border-t pt-4 text-right",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Signature"}),s.jsxs("div",{className:"inline-flex flex-col items-end",children:[s.jsx("img",{src:"/assets/branding/signature.png",alt:"Signature placeholder",className:"h-16 object-contain mb-2 opacity-80",onError:Q=>{Q.currentTarget.style.display="none"}}),s.jsx("span",{className:"text-sm text-gray-700 font-semibold",children:"Adv. Lior Perry"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 border-t px-6 py-4 bg-gray-50",children:[s.jsx("button",{onClick:f,className:"px-4 py-2 rounded-md text-gray-600 hover:bg-gray-200",disabled:r,children:"Cancel"}),s.jsx("button",{onClick:()=>m({body:S,templateId:b,subjectBase:D.trim(),topics:bt(c.map(Q=>ut(Q)))}),className:"px-5 py-2 rounded-md bg-lpBlue text-white font-semibold hover:bg-blue-900 disabled:opacity-60 disabled:cursor-not-allowed",disabled:r,children:r?"Sending":"Send Email"})]})]})}):null},og=({isOpen:e,availableTitles:t,selectedTitles:n,onClose:r,onSave:l})=>{const i=w.useMemo(()=>x=>{const b=new Set,j=[];return x.forEach(S=>{const O=t.find(h=>h.label===S&&!b.has(h.id));O&&(j.push(O.id),b.add(O.id))}),j},[t]),a=w.useCallback(()=>{const x=i(n);return x.length?x:t.map(b=>b.id)},[i,n,t]),[o,c]=w.useState(a);if(w.useEffect(()=>{e&&c(a())},[e,a]),!e)return null;const d=x=>{c(b=>b.includes(x)?b.filter(j=>j!==x):[...b,x])},f=()=>{c(t.map(x=>x.id))},m=()=>{const x=o.map(b=>{var j;return(j=t.find(S=>S.id===b))==null?void 0:j.label}).filter(Boolean);l(x)};return s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[900] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b bg-gray-50",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Select File Name Titles"}),s.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-800",children:s.jsx(Mt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-3",children:[t.length===0&&s.jsx("p",{className:"text-sm text-gray-500",children:"No sections available to include."}),t.map(x=>s.jsxs("label",{className:"flex items-center gap-3 border rounded-lg px-3 py-2 text-sm",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 text-lpBlue",checked:o.includes(x.id),onChange:()=>d(x.id)}),s.jsx("span",{className:"text-gray-800",children:x.label||"[Untitled Section]"})]},x.id)),t.length>0&&s.jsx("button",{type:"button",className:"text-xs text-lpBlue hover:underline",onClick:f,children:"Select All"})]}),s.jsxs("div",{className:"flex justify-end gap-3 border-t px-5 py-4 bg-gray-50",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:bg-gray-200 rounded-md",children:"Cancel"}),s.jsx("button",{onClick:m,className:"px-5 py-2 bg-lpBlue text-white rounded-md font-semibold hover:bg-blue-900",children:"Save"})]})]})})},cg={dashboardTitle:" ",brandName:"Lior Perry",brandSubtitle:"  ",welcomeBack:" ",roleLawyer:"",gettingStartedTitle:" ",gettingStartedBodyLine1:"  .",gettingStartedBodyLine2:"   .          .",gettingStartedStep1:"  ",gettingStartedStep2:" ",gettingStartedStep3:"  ",gettingStartedCta:"  ",searchSectionLabel:" ",searchLabel:" ",searchPlaceholder:"  , ,     ...",statusLabel:"",sortByLabel:" ",sortByUpdated:" ",sortByReportDate:" ",sortByInsured:"",onlyMyCases:"  ",clearFilters:" ",searchByOdakanit:"    ",searchOdakanitPlaceholder:"    ...",noCaseFolderFound:"       .",statsSectionLabel:"  ",statsActiveCases:" ",statsActionRequired:"  ",statsWaitingOnOthers:"  / ",statsDraftsReady:" /  ",bucketActionRequiredTitle:"  ",bucketActionRequiredDescription:"    .",bucketWaitingTitle:"  / ",bucketWaitingDescription:"     .",bucketInProgressTitle:"",bucketInProgressDescription:"   .",bucketSentTitle:" / ",bucketSentDescription:"     .",emptyActionRequiredTitle:"    ",emptyActionRequiredDesc:"    ,   .",emptyWaitingTitle:"    / ",emptyWaitingDesc:"       .",emptyInProgressTitle:"  ",emptyInProgressDesc:"    .",emptySentTitle:"   ",emptySentDesc:"  ,     .",emptyInProgressCta:"  ",defaultEmptyTitle:"  ",defaultEmptyDescription:"     .",untitledCase:"  ",labelInsured:"",labelPlaintiff:"",labelInsurer:" ",labelFile:" ",labelUpdated:":",labelNextStep:" :",nextStepReview:"  ",nextStepWaitingInvoices:" ",nextStepReadyToSend:" ",nextStepDraft:"  ",nextStepSent:"",nextStepContinue:" ",openContinue:" / ",preview:" ",viewSections:"  ",deleteDraftConfirm:"   ?     .",deleteDraftAria:" ",deleteTitle:"",pin:" ",unpin:" ",alertTimeBreach:" ",alertResponseDelay:" ",openNotificationsAria:" ",openNotificationsTitle:"",openNewCaseFolderAria:"  ",openNewCaseFolderTitle:"  ",openHelpCenterAria:"  ",openHelpCenterTitle:" ",logoutAria:"",logoutTitle:"",workQueuesAria:"  ",expand:"",collapse:"",statusDraft:"",statusActionRequired:" ",statusWaitingInvoices:" ",statusPendingReview:" ",statusApproved:"",statusReadyToSend:" ",statusSent:"",densityLabel:" :",densityComfortable:"",densityCompact:"",resumeLastCase:"   ",resumeLabel:"",internalFile:" ",workloadTitle:"  ",workloadActionLabel:"  ",workloadWaitingLabel:" ",workloadDraftLabel:"",focusModeLabel:"    ",tagNewCase:" ",tagOngoingCase:" ",notificationTitle:" ",dailySummary:" ",noNotifications:"  .",clearAll:" ",footerArchiveNote:"      "},B=e=>cg[e],Gl=({label:e,value:t,icon:n,accentClass:r,selected:l,onClick:i})=>{const a=s.jsxs("div",{className:["flex items-center justify-between rounded-2xl border px-4 py-3 shadow-sm transition","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",l?"border-lpBlue bg-blue-50/80":"border-gray-200 bg-white hover:bg-gray-50"].join(" "),children:[s.jsxs("div",{children:[s.jsx("p",{className:["text-[11px] uppercase tracking-wide",l?"font-bold text-gray-800":"font-semibold text-gray-500"].join(" "),children:e}),s.jsx("p",{className:"mt-1 text-xl font-bold text-gray-900",children:t})]}),s.jsx("div",{className:["inline-flex h-9 w-9 items-center justify-center rounded-full",r].join(" "),"aria-hidden":"true",children:n})]});return i?s.jsx("button",{type:"button",onClick:i,className:"w-full text-left",children:a}):a},dg=({activeCases:e,actionRequired:t,waitingOnOthers:n,draftsAndReady:r,selectedFilter:l,onChangeFilter:i})=>{const a=o=>{i&&i(l===o?null:o)};return s.jsxs("section",{"aria-label":B("statsSectionLabel"),className:"mb-6 grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[s.jsx(Gl,{label:B("statsActiveCases"),value:e,icon:s.jsx(Mc,{className:"h-4 w-4 text-lpBlue"}),accentClass:"bg-blue-50",selected:l==="ACTIVE",onClick:()=>a("ACTIVE")}),s.jsx(Gl,{label:B("statsActionRequired"),value:t,icon:s.jsx(_i,{className:"h-4 w-4 text-orange-600"}),accentClass:"bg-orange-50",selected:l==="ACTION",onClick:()=>a("ACTION")}),s.jsx(Gl,{label:B("statsWaitingOnOthers"),value:n,icon:s.jsx(C0,{className:"h-4 w-4 text-yellow-600"}),accentClass:"bg-yellow-50",selected:l==="WAITING",onClick:()=>a("WAITING")}),s.jsx(Gl,{label:B("statsDraftsReady"),value:r,icon:s.jsx(Oi,{className:"h-4 w-4 text-emerald-600"}),accentClass:"bg-emerald-50",selected:l==="DRAFTS",onClick:()=>a("DRAFTS")})]})},ug=[{value:"ALL",label:" "},{value:"DRAFT",label:""},{value:"TASK_ASSIGNED",label:" "},{value:"WAITING_FOR_INVOICES",label:" "},{value:"PENDING_REVIEW",label:" "},{value:"APPROVED",label:""},{value:"READY_TO_SEND",label:" "},{value:"SENT",label:""}],fg=({searchQuery:e,onSearchQueryChange:t,statusFilter:n,onStatusFilterChange:r,onlyMyCases:l,onOnlyMyCasesChange:i,sortBy:a,onSortByChange:o,hasActiveFilter:c,onClearFilters:d})=>s.jsx("section",{"aria-label":B("searchSectionLabel"),className:"mb-4 flex flex-col gap-3 rounded-2xl border border-gray-200 bg-white p-4 shadow-sm",children:s.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center",children:[s.jsxs("div",{className:"relative flex-1",children:[s.jsx("label",{className:"sr-only",htmlFor:"lawyer-dashboard-search",children:B("searchLabel")}),s.jsx(np,{className:"pointer-events-none absolute right-3 top-2.5 h-4 w-4 text-gray-400","aria-hidden":"true"}),s.jsx("input",{id:"lawyer-dashboard-search",type:"search",className:"w-full rounded-full border border-gray-300 py-2 pr-9 pl-3 text-sm text-gray-900 placeholder:text-gray-400 focus:border-lpBlue focus:outline-none focus:ring-1 focus:ring-lpBlue",placeholder:B("searchPlaceholder"),value:e,onChange:f=>t(f.target.value)})]}),s.jsxs("div",{className:"flex flex-1 flex-col gap-3 md:flex-row md:items-center md:justify-end",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{htmlFor:"lawyer-dashboard-status-filter",className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:B("statusLabel")}),s.jsx("select",{id:"lawyer-dashboard-status-filter",className:"rounded-full border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-800 focus:border-lpBlue focus:outline-none focus:ring-1 focus:ring-lpBlue",value:n,onChange:f=>r(f.target.value),children:ug.map(f=>s.jsx("option",{value:f.value,children:f.label},f.value))})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("label",{htmlFor:"lawyer-dashboard-sort-by",className:"text-xs font-semibold uppercase tracking-wide text-gray-500",children:B("sortByLabel")}),s.jsxs("select",{id:"lawyer-dashboard-sort-by",className:"rounded-full border border-gray-300 bg-white px-3 py-1.5 text-xs font-medium text-gray-800 focus:border-lpBlue focus:outline-none focus:ring-1 focus:ring-lpBlue",value:a,onChange:f=>o(f.target.value),children:[s.jsx("option",{value:"UPDATED",children:B("sortByUpdated")}),s.jsx("option",{value:"REPORT_DATE",children:B("sortByReportDate")}),s.jsx("option",{value:"INSURED",children:B("sortByInsured")})]})]}),s.jsxs("label",{className:"inline-flex items-center gap-2 text-xs font-medium text-gray-700",children:[s.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-gray-300 text-lpBlue focus:ring-lpBlue",checked:l,onChange:f=>i(f.target.checked)}),s.jsx("span",{children:B("onlyMyCases")})]}),c&&d&&s.jsx("button",{type:"button",onClick:d,className:"text-[11px] font-medium text-gray-600 underline-offset-2 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:B("clearFilters")})]})]})}),mg={DRAFT:{label:B("statusDraft"),bg:"bg-blue-50",text:"text-blue-800",border:"border-blue-200"},TASK_ASSIGNED:{label:B("statusActionRequired"),bg:"bg-orange-50",text:"text-orange-800",border:"border-orange-200"},WAITING_FOR_INVOICES:{label:B("statusWaitingInvoices"),bg:"bg-yellow-50",text:"text-yellow-800",border:"border-yellow-200"},PENDING_REVIEW:{label:B("statusPendingReview"),bg:"bg-orange-50",text:"text-orange-800",border:"border-orange-200"},APPROVED:{label:B("statusApproved"),bg:"bg-green-50",text:"text-green-800",border:"border-green-200"},READY_TO_SEND:{label:B("statusReadyToSend"),bg:"bg-emerald-50",text:"text-emerald-800",border:"border-emerald-200"},SENT:{label:B("statusSent"),bg:"bg-slate-50",text:"text-slate-800",border:"border-slate-200"}},pg=({status:e,ariaLabel:t})=>{const n=mg[e];return n?s.jsxs("span",{className:["inline-flex items-center px-2.5 py-1 rounded-full border text-[11px] font-semibold tracking-wide",n.bg,n.text,n.border].join(" "),"aria-label":t||`: ${n.label}`,children:[s.jsx("span",{className:"ml-1.5 h-1.5 w-1.5 rounded-full bg-current","aria-hidden":"true"}),n.label]}):null},Ps=e=>(e||"").trim().toLowerCase(),lr=e=>{const t=(e.odakanitNo||"").trim();if(t)return`odakanit:${t}`;const n=[`umr:${Ps(e.marketRef)}`,`line:${Ps(e.lineSlipNo)}`,`cert:${Ps(e.certificateRef)}`,`insured:${Ps(e.insuredName)}`,`plaintiff:${Ps(e.plaintiffName)}`].filter(r=>!r.endsWith(":"));return n.length?n.join("|"):`id:${e.id}`},hp=24*60*60*1e3,hg=e=>{switch(e){case"TASK_ASSIGNED":case"PENDING_REVIEW":return B("nextStepReview");case"WAITING_FOR_INVOICES":return B("nextStepWaitingInvoices");case"READY_TO_SEND":return B("nextStepReadyToSend");case"DRAFT":return B("nextStepDraft");case"SENT":return"";default:return B("nextStepContinue")}},xg=e=>{const t=e.updatedAt||e.reportDate;if(!t)return null;const n=new Date(t).getTime();return Number.isFinite(n)?n:null},xp=e=>{const t=xg(e);return!t||(Date.now()-t)/hp<=3?null:e.status==="DRAFT"?B("alertResponseDelay"):e.status==="WAITING_FOR_INVOICES"||e.status==="READY_TO_SEND"?B("alertTimeBreach"):null},gg=e=>e.status==="TASK_ASSIGNED"||e.status==="PENDING_REVIEW"||e.status==="READY_TO_SEND",yg=(e,t)=>{const n=lr(e);if(!n)return!1;const r=t.filter(a=>!a.deletedAt&&lr(a)===n);if(r.length<=1)return!0;let l=Number.POSITIVE_INFINITY;return r.forEach(a=>{if(!a.reportDate)return;const o=new Date(a.reportDate).getTime();Number.isFinite(o)&&o<l&&(l=o)}),Number.isFinite(l)?Date.now()-l<14*hp:!1},Ng=e=>e.insuredName||e.plaintiffName||e.odakanitNo||B("untitledCase"),vg=e=>{const t=[];return e.plaintiffName&&t.push(`${B("labelPlaintiff")}: ${e.plaintiffName}`),e.insurerName&&t.push(`${B("labelInsurer")}: ${e.insurerName}`),e.odakanitNo&&t.push(`${B("labelFile")}: ${e.odakanitNo}`),t.join("  ")},bg=e=>e==="DRAFT",wg=({report:e,onOpen:t,onDelete:n,pinned:r=!1,onTogglePin:l,density:i="COMFORTABLE",isNewCase:a})=>{const o=Ng(e),c=vg(e),d=n&&bg(e.status),f=e.reportDate?new Date(e.reportDate).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"",m=hg(e.status),x=xp(e),b=j=>{j.key==="Enter"&&(j.preventDefault(),t())};return s.jsxs("article",{tabIndex:0,onKeyDown:b,className:`flex flex-col border border-gray-200 bg-white shadow-sm transition hover:border-gray-300 hover:shadow-md focus-within:ring-2 focus-within:ring-lpBlue focus-within:ring-offset-2 ${i==="COMPACT"?"rounded-xl p-3":"rounded-2xl p-4"}`,children:[s.jsxs("div",{className:"flex items-start justify-between gap-3",children:[s.jsxs("div",{className:"text-right flex-1",children:[s.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-0.5",children:o}),i==="COMPACT"?c&&s.jsx("p",{className:"mt-0.5 text-[11px] text-gray-600",children:c}):s.jsxs(s.Fragment,{children:[c&&s.jsx("p",{className:"text-xs text-gray-600 mb-1.5",children:c}),s.jsxs("div",{className:"space-y-0.5 mt-1",children:[f&&s.jsxs("p",{className:"text-[11px] text-gray-500",children:[B("labelUpdated")," ",f]}),m&&s.jsxs("p",{className:"text-[11px] text-gray-600",children:[s.jsx("span",{className:"font-medium text-gray-700",children:B("labelNextStep")})," ",m]})]})]})]}),s.jsxs("div",{className:"flex items-center gap-1.5",children:[s.jsx(pg,{status:e.status}),e.hebrewWorkflowStatus&&s.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-50 px-2 py-0.5 text-[10px] font-medium text-slate-700",children:op(e.hebrewWorkflowStatus)}),e.policyFile&&(e.attachPolicyAsAppendix??!0)&&s.jsx("span",{className:"inline-flex items-center rounded-full bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700",children:"Policy attached as appendix"}),typeof a=="boolean"&&s.jsx("span",{className:"inline-flex items-center rounded-full border border-gray-200 bg-gray-50 px-2 py-0.5 text-[10px] font-medium text-gray-600",children:B(a?"tagNewCase":"tagOngoingCase")}),x&&s.jsxs("span",{className:"inline-flex items-center gap-1 rounded-full border border-amber-200 bg-amber-50 px-2 py-0.5 text-[10px] font-medium text-amber-800",children:[s.jsx(I0,{className:"h-3 w-3","aria-hidden":"true"}),x]}),l&&s.jsx("button",{type:"button",onClick:l,className:`inline-flex items-center justify-center rounded-full border bg-white p-1.5 text-xs focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-amber-500 focus-visible:ring-offset-2 ${r?"border-amber-300 text-amber-600":"border-gray-200 text-gray-400 hover:bg-gray-50"}`,"aria-label":r?`${B("unpin")} ${o}`:`${B("pin")} ${o}`,title:B(r?"unpin":"pin"),children:s.jsx(rp,{className:`h-3.5 w-3.5 ${r?"fill-amber-400":"fill-none"}`,"aria-hidden":"true"})})]})]}),s.jsxs("div",{className:"mt-3 flex items-center justify-between gap-2",children:[s.jsx("div",{className:"flex flex-row-reverse items-center gap-2",children:s.jsxs("button",{type:"button",onClick:t,className:"inline-flex items-center rounded-full bg-lpBlue px-3 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":`${B("openContinue")} ${o}`,children:[s.jsx(Oc,{className:"ml-1 h-3.5 w-3.5","aria-hidden":"true"}),B("openContinue")]})}),s.jsxs("div",{className:"flex flex-row-reverse items-center gap-1.5",children:[s.jsx("button",{type:"button",onClick:t,className:"inline-flex items-center justify-center rounded-full border border-gray-200 bg-white p-1.5 text-gray-600 hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":`${B("preview")} ${o}`,children:s.jsx(D0,{className:"h-3.5 w-3.5","aria-hidden":"true"})}),s.jsx("button",{type:"button",onClick:t,className:"inline-flex items-center justify-center rounded-full border border-gray-200 bg-white p-1.5 text-gray-600 hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":`${B("viewSections")} ${o}`,children:s.jsx(Br,{className:"h-3.5 w-3.5","aria-hidden":"true"})}),d&&s.jsx("button",{type:"button",onClick:n,className:"inline-flex items-center justify-center rounded-full border border-red-200 bg-white p-1.5 text-red-600 hover:bg-red-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2","aria-label":B("deleteDraftAria"),title:B("deleteTitle"),children:s.jsx(Sn,{className:"h-3.5 w-3.5","aria-hidden":"true"})})]})]})]})},Sg=({title:e,description:t,actionLabel:n,onAction:r})=>s.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-8 px-4 text-sm text-gray-500",children:[s.jsx("div",{className:"mb-3 inline-flex h-10 w-10 items-center justify-center rounded-full bg-gray-100 text-gray-500",children:s.jsx(Br,{className:"h-5 w-5","aria-hidden":"true"})}),s.jsx("p",{className:"font-semibold text-gray-700 mb-1",children:e}),s.jsx("p",{className:"max-w-sm mb-3",children:t}),n&&r&&s.jsx("button",{type:"button",onClick:r,className:"inline-flex items-center rounded-full bg-lpBlue px-4 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:n})]}),Kl=({id:e,title:t,description:n,reports:r,defaultCollapsed:l=!1,onOpenReport:i,onDeleteReport:a,emptyTitle:o,emptyDescription:c,emptyActionLabel:d,onEmptyAction:f,pinnedIds:m,onTogglePin:x,density:b="COMFORTABLE",stickyOffsetPx:j,isNewCase:S})=>{const[O,h]=w.useState(l),p=r.length,v=w.useMemo(()=>r,[r]),E=w.useCallback(()=>{h(D=>!D)},[]);return s.jsxs("section",{"aria-labelledby":`lawyer-section-${e}`,className:"rounded-2xl border border-gray-200 bg-white shadow-sm",children:[s.jsxs("header",{className:["flex items-center justify-between gap-3 border-b px-4 py-3",typeof j=="number"?"sticky z-10 bg-white/90 backdrop-blur-sm":""].join(" "),style:typeof j=="number"?{top:j}:void 0,children:[s.jsxs("div",{children:[s.jsxs("h2",{id:`lawyer-section-${e}`,className:"text-sm font-semibold text-gray-900",children:[t," ",s.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["(",p,")"]})]}),s.jsx("p",{className:"text-xs text-gray-500",children:n})]}),s.jsx("button",{type:"button",onClick:E,className:"inline-flex items-center rounded-full border border-gray-200 bg-white px-2.5 py-1 text-xs font-medium text-gray-600 hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-expanded":!O,"aria-controls":`lawyer-section-body-${e}`,children:O?s.jsxs(s.Fragment,{children:[s.jsx(dn,{className:"ml-1 h-3 w-3","aria-hidden":"true"}),B("expand")]}):s.jsxs(s.Fragment,{children:[s.jsx(Zm,{className:"ml-1 h-3 w-3","aria-hidden":"true"}),B("collapse")]})})]}),s.jsx("div",{id:`lawyer-section-body-${e}`,className:O?"hidden":"",children:v.length===0?s.jsx(Sg,{title:o||B("defaultEmptyTitle"),description:c||B("defaultEmptyDescription"),actionLabel:d,onAction:f}):s.jsx("div",{className:"space-y-3 p-4",children:v.map(D=>s.jsx(wg,{report:D,onOpen:()=>i(D),onDelete:a?()=>a(D):void 0,pinned:m?m.includes(lr(D)):!1,onTogglePin:x?()=>x(D):void 0,density:b,isNewCase:S?S(D):void 0},D.id))})})]})},jg=B("brandName"),Eg=B("brandSubtitle"),kg=e=>e==="TASK_ASSIGNED"||e==="PENDING_REVIEW"?"ACTION_REQUIRED":e==="WAITING_FOR_INVOICES"||e==="APPROVED"||e==="READY_TO_SEND"?"WAITING_ON_OTHERS":e==="SENT"?"SENT_COMPLETED":"IN_PROGRESS",Yl=e=>`lp_pins:${e}`,Iu=e=>`lp_dashboard_density:${e}`,Ig="lp_current_report",Ru=e=>`lp_pins_migrated:${e}`,Rg=({user:e,reports:t,caseFolders:n,notifications:r,showNotifications:l,setShowNotifications:i,onClearNotifications:a,dailySummaryOptIn:o,setDailySummaryOptIn:c,archiveAfterMs:d,onSelectReport:f,onNewReport:m,onOpenCaseFolder:x,onLogout:b,deleteReportById:j})=>{const[S,O]=w.useState(""),[h,p]=w.useState("ALL"),[v,E]=w.useState(!0),[D,M]=w.useState(null),[P,H]=w.useState("UPDATED"),[ne,A]=w.useState(()=>{if(typeof window>"u")return[];try{const X=window.localStorage.getItem(Yl(e.id)),ce=X?JSON.parse(X):[];return Array.isArray(ce)?ce.filter(fe=>typeof fe=="string"):[]}catch{return[]}}),[y,$]=w.useState(()=>{if(typeof window>"u")return"COMFORTABLE";try{return window.localStorage.getItem(Iu(e.id))==="COMPACT"?"COMPACT":"COMFORTABLE"}catch{return"COMFORTABLE"}}),_=Date.now(),R=d??Number.MAX_SAFE_INTEGER,[z,U]=w.useState(!1),{mine:te,activeCasesCount:I,buckets:K,filteredReports:q}=w.useMemo(()=>{const X=t.filter(J=>!J.deletedAt),ce=X.filter(J=>J.createdBy===e.id),fe=v?ce:X,Ae=h==="ALL"?fe:fe.filter(J=>J.status===h),T=(()=>{const J=S.trim().toLowerCase();return J?Ae.filter(oe=>[oe.odakanitNo,oe.insuredName,oe.plaintiffName,oe.insurerName,oe.marketRef].filter(Boolean).join(" ").toLowerCase().includes(J)):Ae})(),G=z?T.filter(J=>gg(J)||!!xp(J)):T,Y={ACTION_REQUIRED:[],WAITING_ON_OTHERS:[],IN_PROGRESS:[],SENT_COMPLETED:[]};G.forEach(J=>{const oe=kg(J.status);Y[oe].push(J)});const W=new Set;return fe.forEach(J=>{(J.status!=="SENT"||J.sentAt&&_-new Date(J.sentAt).getTime()<R)&&W.add(lr(J))}),{mine:ce,activeCasesCount:W.size,buckets:Y,filteredReports:G}},[t,e.id,S,h,v,z,_,R]),F=K.ACTION_REQUIRED.length,Z=K.WAITING_ON_OTHERS.length,Ie=q.filter(X=>X.status==="DRAFT"||X.status==="READY_TO_SEND").length,be=q.filter(X=>X.status==="DRAFT").length,Me=w.useMemo(()=>new Set(ne),[ne]),Se=X=>{f(X.id)},St=X=>{const ce=D===X?null:X;switch(M(ce),ce){case"ACTION":p("TASK_ASSIGNED");break;case"WAITING":p("READY_TO_SEND");break;case"DRAFTS":p("DRAFT");break;case"ACTIVE":p("ALL");break;default:p("ALL");break}},Q=h!=="ALL"||!!S.trim()||!v,pe=()=>{O(""),p("ALL"),E(!0),M(null)},Fe=X=>{H(X)},je=X=>{A(ce=>{const fe=new Set(ce);fe.has(X)?fe.delete(X):fe.add(X);const Ae=Array.from(fe);if(typeof window<"u")try{window.localStorage.setItem(Yl(e.id),JSON.stringify(Ae))}catch{}return Ae})},Xe=X=>{if($(X),typeof window<"u")try{window.localStorage.setItem(Iu(e.id),X)}catch{}},rt=X=>yg(X,t),sn=X=>{j&&window.confirm(B("deleteDraftConfirm"))&&j(X.id)},Kt=X=>[...X].sort((fe,Ae)=>{const T=lr(fe),G=lr(Ae),Y=Me.has(T),W=Me.has(G);if(Y!==W)return Y?-1:1;const J=Be=>{const Ee=Be.updatedAt||Be.reportDate;return Ee&&new Date(Ee).getTime()||0},oe=Be=>Be.reportDate&&new Date(Be.reportDate).getTime()||0;if(P==="INSURED"){const Be=qe=>(qe.insuredName||qe.plaintiffName||"").toLowerCase(),Ee=Be(fe),_e=Be(Ae);return Ee<_e?-1:Ee>_e?1:0}const ye=P==="REPORT_DATE"?oe(fe):J(fe);return(P==="REPORT_DATE"?oe(Ae):J(Ae))-ye});w.useEffect(()=>{if(!l)return;const X=ce=>{ce.key==="Escape"&&i(!1)};return window.addEventListener("keydown",X),()=>window.removeEventListener("keydown",X)},[l,i]),w.useEffect(()=>{if(typeof window>"u"||!t.length)return;const X=Ru(e.id);if(window.localStorage.getItem(X)!=="1")try{const fe=window.localStorage.getItem(Yl(e.id));if(!fe){window.localStorage.setItem(X,"1");return}const Ae=JSON.parse(fe);if(!Array.isArray(Ae)){window.localStorage.setItem(X,"1");return}const T=[],G=Y=>{Y&&(T.includes(Y)||T.push(Y))};Ae.forEach(Y=>{if(typeof Y!="string")return;const W=Y.trim();if(!W)return;const J=W.toLowerCase();if(J.startsWith("odakanit:")||J.startsWith("umr:")||J.startsWith("line:")||J.startsWith("cert:")||J.startsWith("insured:")||J.startsWith("plaintiff:")||J.startsWith("id:")){G(W);return}const ye=t.find(we=>lr(we)===W?!0:we.id===W||we.odakanitNo&&we.odakanitNo===W||we.marketRef&&we.marketRef===W);G(ye?lr(ye):`odakanit:${W}`)}),A(T),window.localStorage.setItem(Yl(e.id),JSON.stringify(T)),window.localStorage.setItem(X,"1")}catch{window.localStorage.setItem(Ru(e.id),"1")}},[t,e.id]);const pt=w.useMemo(()=>{if(!te.length)return null;if(typeof window<"u")try{const ce=window.localStorage.getItem(Ig),fe=ce?te.find(Ae=>Ae.id===ce&&!Ae.deletedAt):null;if(fe)return fe}catch{}return[...te].sort((ce,fe)=>{const Ae=Y=>{const W=Y.updatedAt||Y.reportDate;return W&&new Date(W).getTime()||0},T=Ae(ce);return Ae(fe)-T})[0]||null},[te]),wr=()=>s.jsxs("div",{className:"relative",children:[s.jsxs("button",{type:"button",onClick:()=>i(!l),className:"relative inline-flex h-9 w-9 items-center justify-center rounded-full bg-blue-50 text-xs font-medium text-blue-700 hover:bg-blue-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":B("openNotificationsAria"),title:B("openNotificationsTitle"),children:[s.jsx(Li,{className:"h-4 w-4","aria-hidden":"true"}),r.length>0&&s.jsx("span",{className:"absolute -top-1.5 -right-1.5 inline-flex h-4 min-w-[16px] items-center justify-center rounded-full bg-red-500 px-1 text-[10px] font-bold text-white",children:r.length})]}),l&&s.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-lg border border-gray-200 bg-white text-xs shadow-xl z-50",children:[s.jsxs("div",{className:"flex items-center justify-between border-b px-3 py-2",children:[s.jsx("span",{className:"font-semibold text-gray-800",children:B("notificationTitle")}),s.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-500",children:[s.jsx("input",{type:"checkbox",checked:o,onChange:X=>c(X.target.checked),className:"h-3 w-3 rounded border-gray-300 text-lpBlue focus:ring-lpBlue"}),B("dailySummary")]})]}),s.jsxs("div",{className:"max-h-64 overflow-auto divide-y",children:[r.length===0&&s.jsx("div",{className:"p-4 text-center text-gray-400",children:B("noNotifications")}),r.map(X=>s.jsxs("div",{className:"p-3",children:[s.jsx("p",{className:"font-medium text-gray-800",children:X.message}),s.jsx("p",{className:"text-[10px] text-gray-400",children:new Date(X.createdAt).toLocaleString()})]},X.id))]}),s.jsx("div",{className:"px-3 py-2 text-right",children:s.jsx("button",{type:"button",onClick:a,className:"text-[11px] font-medium text-red-500 hover:underline",children:B("clearAll")})})]})]}),[ht,An]=w.useState(""),[Ft,Rt]=w.useState(!1),[Tt,xt]=w.useState(-1),et=w.useMemo(()=>{const X=ht.trim();if(!X)return[];const ce=X.toLowerCase(),fe=Object.values(n),Ae=fe.filter(Y=>Y.odakanitNo.toLowerCase().startsWith(ce)),T=fe.filter(Y=>!Y.odakanitNo.toLowerCase().startsWith(ce)&&Y.odakanitNo.toLowerCase().includes(ce));return[...Ae,...T].slice(0,8).map(Y=>({odakanitNo:Y.odakanitNo,insuredName:Y.insuredName,plaintiffName:Y.plaintiffName}))},[ht,n]);w.useEffect(()=>{if(!ht.trim()){Rt(!1),xt(-1);return}et.length>0?(Rt(!0),xt(0)):(Rt(!1),xt(-1))},[ht,et.length]);const Yt=X=>{An(X),Rt(!1),xt(-1),x(X)};return s.jsx("div",{className:"min-h-screen bg-gray-100 px-0 pb-6",dir:"rtl",lang:"he",children:s.jsxs("div",{className:"mx-auto max-w-6xl px-4",children:[s.jsxs("header",{className:"sticky top-0 z-20 mb-4 flex flex-col gap-3 border-b border-gray-200 bg-white/80 pb-3 pt-2 backdrop-blur-sm md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-lpBlue font-heebo",children:B("dashboardTitle")}),s.jsxs("p",{className:"text-sm text-gray-600 text-right",children:[s.jsx("span",{className:"font-semibold",children:jg})," ",s.jsx("span",{className:"text-gray-500",children:Eg}),s.jsx("span",{className:"text-gray-400",children:"  "}),B("welcomeBack"),","," ",s.jsx("span",{className:"font-semibold",children:e.name})," ",s.jsxs("span",{className:"text-gray-500",children:["(",B("roleLawyer"),")"]})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-start gap-2 md:justify-end",children:[s.jsx("button",{type:"button",onClick:m,className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-lpBlue text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":B("openNewCaseFolderAria"),title:B("openNewCaseFolderTitle"),children:s.jsx(Uc,{className:"h-4 w-4","aria-hidden":"true"})}),wr(),s.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-blue-50 text-xs font-medium text-blue-700 hover:bg-blue-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",onClick:()=>{const X=new CustomEvent("openUserGuide");window.dispatchEvent(X)},"aria-label":B("openHelpCenterAria"),title:B("openHelpCenterTitle"),children:s.jsx(Fc,{className:"h-4 w-4","aria-hidden":"true"})}),s.jsx("button",{type:"button",onClick:b,className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-xs font-semibold text-red-600 hover:bg-red-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2","aria-label":B("logoutAria"),title:B("logoutTitle"),children:s.jsx(ep,{className:"h-4 w-4","aria-hidden":"true"})})]})]}),te.length===0&&s.jsxs("section",{className:"mb-4 rounded-2xl border border-dashed border-gray-300 bg-white px-4 py-4 text-sm text-gray-700 shadow-sm text-right",children:[s.jsx("h2",{className:"mb-1 text-sm font-semibold text-gray-900",children:B("gettingStartedTitle")}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[B("gettingStartedBodyLine1"),s.jsx("br",{}),B("gettingStartedBodyLine2")]}),s.jsxs("ul",{className:"mb-3 mr-4 list-disc text-xs text-gray-600",children:[s.jsx("li",{children:B("gettingStartedStep1")}),s.jsx("li",{children:B("gettingStartedStep2")}),s.jsx("li",{children:B("gettingStartedStep3")})]}),s.jsx("button",{type:"button",onClick:m,className:"inline-flex items-center rounded-full bg-lpBlue px-4 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":B("gettingStartedCta"),children:B("gettingStartedCta")})]}),s.jsxs("section",{className:"mb-3 rounded-2xl border border-gray-200 bg-white px-4 py-3 text-xs text-gray-700 shadow-sm",children:[s.jsx("h2",{className:"mb-1 text-sm font-semibold text-gray-900",children:B("workloadTitle")}),s.jsxs("div",{className:"flex flex-wrap gap-3 text-[11px] text-gray-700",children:[s.jsxs("span",{children:[F," ",B("workloadActionLabel")]}),s.jsxs("span",{children:[Z," ",B("workloadWaitingLabel")]}),s.jsxs("span",{children:[be," ",B("workloadDraftLabel")]})]})]}),s.jsx("section",{className:"mb-3 flex flex-col gap-2 rounded-2xl border border-gray-200 bg-white px-4 py-3 shadow-sm md:flex-row md:items-center md:justify-between",children:s.jsxs("div",{className:"relative flex-1",children:[s.jsx("label",{htmlFor:"case-folder-search",className:"text-[11px] font-semibold uppercase tracking-wide text-gray-500",children:B("searchByOdakanit")}),s.jsx("input",{id:"case-folder-search",type:"text",className:"mt-1 w-full rounded-full border border-gray-300 px-3 py-1.5 text-xs text-gray-900 placeholder:text-gray-400 focus:border-lpBlue focus:outline-none focus:ring-1 focus:ring-lpBlue",placeholder:B("searchOdakanitPlaceholder"),value:ht,onChange:X=>{An(X.target.value)},onFocus:()=>{et.length>0&&Rt(!0)},onKeyDown:X=>{if(!Ft&&X.key==="ArrowDown"&&et.length>0){Rt(!0),xt(0);return}if(!Ft){if(X.key==="Enter"){const ce=ht.trim();ce&&n[ce]&&Yt(ce)}X.key==="Escape"&&Rt(!1);return}if(X.key==="ArrowDown")X.preventDefault(),xt(ce=>{const fe=ce+1;return fe>=et.length?et.length-1:fe});else if(X.key==="ArrowUp")X.preventDefault(),xt(ce=>{const fe=ce-1;return fe<0?0:fe});else if(X.key==="Enter"){X.preventDefault();const ce=Tt>=0?Tt:0,fe=et[ce];fe&&Yt(fe.odakanitNo)}else X.key==="Escape"&&(X.preventDefault(),Rt(!1),xt(-1))},role:"combobox","aria-autocomplete":"list","aria-expanded":Ft,"aria-controls":"case-folder-search-listbox"}),Ft&&et.length>0&&s.jsx("ul",{id:"case-folder-search-listbox",role:"listbox",className:"absolute z-20 mt-1 max-h-56 w-full overflow-y-auto rounded-2xl border border-gray-200 bg-white py-1 text-xs shadow-lg",children:et.map((X,ce)=>s.jsxs("li",{role:"option","aria-selected":ce===Tt,className:`cursor-pointer px-3 py-2 flex flex-col gap-0.5 ${ce===Tt?"bg-blue-50 text-gray-900":"text-gray-700 hover:bg-gray-50"}`,onMouseDown:fe=>{fe.preventDefault()},onClick:()=>Yt(X.odakanitNo),children:[s.jsx("span",{className:"font-semibold text-[11px] text-gray-900",children:X.odakanitNo}),s.jsxs("span",{className:"text-[11px] text-gray-600",children:[X.insuredName||"",X.plaintiffName?`  ${X.plaintiffName}`:""]})]},X.odakanitNo))}),ht.trim()&&!Ft&&et.length===0&&s.jsx("p",{className:"mt-1 text-[11px] text-red-500",children:B("noCaseFolderFound")})]})}),pt&&s.jsx("section",{className:"mb-3 rounded-2xl border border-blue-100 bg-blue-50/60 px-4 py-3 text-xs text-gray-800 shadow-sm",children:s.jsxs("div",{className:"flex items-center justify-between gap-3",children:[s.jsxs("div",{className:"text-right flex-1",children:[s.jsx("p",{className:"font-semibold text-lpBlue text-sm",children:B("resumeLastCase")}),s.jsxs("p",{className:"text-[11px] text-gray-600",children:[pt.insuredName||pt.plaintiffName||""," ",pt.odakanitNo?` ${B("internalFile")}: ${pt.odakanitNo}`:""]})]}),s.jsx("button",{type:"button",onClick:()=>Se(pt),className:"inline-flex items-center rounded-full bg-lpBlue px-3 py-1.5 text-[11px] font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":B("resumeLastCase"),children:B("resumeLabel")})]})}),s.jsx(dg,{activeCases:I,actionRequired:F,waitingOnOthers:Z,draftsAndReady:Ie,selectedFilter:D,onChangeFilter:St}),s.jsx(fg,{searchQuery:S,onSearchQueryChange:O,statusFilter:h,onStatusFilterChange:p,onlyMyCases:v,onOnlyMyCasesChange:E,sortBy:P,onSortByChange:Fe,hasActiveFilter:Q,onClearFilters:Q?pe:void 0}),s.jsxs("div",{className:"mb-3 flex items-center justify-start gap-3 text-[11px] text-gray-600",children:[s.jsx("span",{className:"text-gray-500",children:B("densityLabel")}),s.jsx("button",{type:"button",onClick:()=>Xe("COMFORTABLE"),className:`rounded-full px-3 py-1 text-[11px] font-semibold focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2 ${y==="COMFORTABLE"?"bg-gray-200 text-gray-900":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50"}`,"aria-pressed":y==="COMFORTABLE",children:B("densityComfortable")}),s.jsx("button",{type:"button",onClick:()=>Xe("COMPACT"),className:`rounded-full px-3 py-1 text-[11px] font-semibold focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2 ${y==="COMPACT"?"bg-gray-200 text-gray-900":"bg-white text-gray-600 border border-gray-200 hover:bg-gray-50"}`,"aria-pressed":y==="COMPACT",children:B("densityCompact")}),s.jsxs("label",{className:"inline-flex items-center gap-2 text-[11px] text-gray-700",children:[s.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-gray-300 text-lpBlue focus:ring-lpBlue",checked:z,onChange:X=>U(X.target.checked)}),s.jsx("span",{children:B("focusModeLabel")})]})]}),s.jsxs("main",{className:"space-y-4","aria-label":B("workQueuesAria"),children:[s.jsx(Kl,{id:"action-required",title:B("bucketActionRequiredTitle"),description:B("bucketActionRequiredDescription"),reports:Kt(K.ACTION_REQUIRED),emptyTitle:B("emptyActionRequiredTitle"),emptyDescription:B("emptyActionRequiredDesc"),pinnedIds:ne,onTogglePin:je,density:y,onOpenReport:Se,onDeleteReport:sn,isNewCase:rt}),s.jsx(Kl,{id:"waiting-others",title:B("bucketWaitingTitle"),description:B("bucketWaitingDescription"),reports:Kt(K.WAITING_ON_OTHERS),emptyTitle:B("emptyWaitingTitle"),emptyDescription:B("emptyWaitingDesc"),pinnedIds:ne,onTogglePin:je,density:y,onOpenReport:Se,onDeleteReport:sn,isNewCase:rt}),s.jsx(Kl,{id:"in-progress",title:B("bucketInProgressTitle"),description:B("bucketInProgressDescription"),reports:Kt(K.IN_PROGRESS),emptyTitle:B("emptyInProgressTitle"),emptyDescription:B("emptyInProgressDesc"),emptyActionLabel:B("emptyInProgressCta"),onEmptyAction:m,pinnedIds:ne,onTogglePin:je,density:y,onOpenReport:Se,onDeleteReport:sn,isNewCase:rt}),s.jsx(Kl,{id:"sent-completed",title:B("bucketSentTitle"),description:B("bucketSentDescription"),reports:Kt(K.SENT_COMPLETED),defaultCollapsed:!0,emptyTitle:B("emptySentTitle"),emptyDescription:B("emptySentDesc"),pinnedIds:ne,onTogglePin:je,density:y,onOpenReport:Se,onDeleteReport:sn,isNewCase:rt})]}),s.jsxs("footer",{className:"mt-6 text-[11px] text-gray-400 flex items-center gap-2 justify-start",children:[s.jsx(Sn,{className:"h-3 w-3","aria-hidden":"true"}),s.jsxs("span",{children:[B("footerArchiveNote")," ",R/(1e3*60*60)," ","."]})]})]})})},Re={title:"    ",subtitle:"     ,    ",actions:{openNewReport:"  ",allReports:" ",clearFilter:" "},kpis:{hebrewPending:"  ",insurerFeedbackOpen:"  ",resendReady:"  ",missingPolicyAppendix:"  ",sentLast7Days:" 7  "},queues:{hebrewReview:{title:"   ",subtitle:"       ",empty:"     ."},insurerFeedback:{title:"   ",subtitle:"      ",empty:"      ."},resend:{title:"    ",subtitle:"      ",empty:"     ."}},table:{title:" ",filterLabel:" :",filterAll:" ",filterHebrew:" ",filterFeedback:" ",filterResend:" ",filterMissingPolicy:"  ",columns:{id:"  / ",status:" ",hebrewStatus:"  / ",insurer:"",insured:"",plaintiff:"",updatedAt:" "},empty:"      ."},queueItem:{openReport:" ",noDate:" "},attention:{title:"   ",subtitle:"    ,  ",empty:"    ",openReport:" ",reasons:":",jumpToReview:"  ",jumpToExternal:"  ",markExternalDone:"   ",confirmMarkExternalDone:"        ?",reopenHebrew:"   ( )",confirmReopenHebrew:"         ?",markExternalDoneTitle:"  ",reopenHebrewTitle:"   "},dialog:{confirmTitle:" ",cancel:"",confirm:""},insights:{title:"     ",subtitle:"       (>0)",empty:"     .",column:{reason:"",count:"",share:""},hint:"   ,    ."},toast:{reportNotFound:"    .  .",actionCompleted:"  .",actionCancelled:" ."}},Tg=({open:e,title:t,message:n,confirmText:r,cancelText:l,destructive:i=!1,onConfirm:a,onCancel:o})=>{const c=w.useRef(null);if(w.useEffect(()=>{if(!e)return;const m=x=>{x.key==="Escape"&&(x.stopPropagation(),o())};if(typeof window<"u"&&window.addEventListener("keydown",m),c.current)try{c.current.focus()}catch{}return()=>{typeof window<"u"&&window.removeEventListener("keydown",m)}},[e,o]),!e)return null;const d=m=>{m.target===m.currentTarget&&o()},f=i?"bg-red-600 text-white hover:bg-red-700":"bg-lpBlue text-white hover:bg-blue-800";return s.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/30",onClick:d,children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 p-5 space-y-3",dir:"rtl",children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900 text-right",children:t}),n&&s.jsx("p",{className:"text-xs text-slate-600 text-right whitespace-pre-line",children:n}),s.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[s.jsx("button",{type:"button",onClick:o,className:"px-3 py-1.5 rounded-md border border-slate-300 text-xs text-slate-700 bg-white hover:bg-slate-50",children:l}),s.jsx("button",{type:"button",ref:c,onClick:a,className:`px-3 py-1.5 rounded-md text-xs font-semibold ${f}`,children:r})]})]})})},gp=w.createContext(void 0);let Ag=0;const Cg=({children:e})=>{const[t,n]=w.useState([]),r=w.useCallback(a=>{n(o=>o.filter(c=>c.id!==a))},[]),l=w.useCallback(({message:a,type:o="info"})=>{const c=++Ag;n(d=>[...d,{id:c,message:a,type:o}]),window.setTimeout(()=>{r(c)},3e3)},[r]),i=a=>a==="success"?"border-green-500 text-green-900":a==="error"?"border-red-500 text-red-900":"border-blue-500 text-blue-900";return s.jsxs(gp.Provider,{value:{showToast:l},children:[e,s.jsx("div",{className:"fixed top-4 right-4 z-[260] flex flex-col gap-2 items-end pointer-events-none",dir:"rtl",children:t.map(a=>s.jsxs("div",{className:`pointer-events-auto max-w-xs bg-white rounded-lg shadow-lg px-3 py-2 border-l-4 text-xs flex items-center gap-2 ${i(a.type)}`,children:[s.jsx("span",{className:"whitespace-pre-line",children:a.message}),s.jsx("button",{type:"button",onClick:()=>r(a.id),className:"ml-1 p-1 rounded hover:bg-slate-100 text-slate-500",children:s.jsx(Mt,{className:"w-3 h-3"})})]},a.id))})]})},Dg=()=>{const e=w.useContext(gp);if(!e)throw new Error("useToast must be used within a ToastProvider");return e},_g=({items:e,adminHe:t,onSelectReport:n,onSelectReportWithFocus:r,onRequestPendingAction:l})=>e.length?s.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4",children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900 mb-1",children:t.attention.title}),s.jsx("p",{className:"text-xs text-slate-500 mb-3",children:t.attention.subtitle}),s.jsx("div",{className:"flex flex-col gap-2",children:e.map(i=>{var M,P,H,ne,A;const{report:a,reasons:o,score:c}=i,d=a.odakanitNo||a.marketRef||a.id,f=a.insuredName||a.plaintiffName||"",m=a.insurerName||"",x=a.updatedAt||a.reportDate,b=x?new Date(x).toLocaleDateString("he-IL",{day:"2-digit",month:"2-digit",year:"2-digit"}):t.queueItem.noDate,S=o.slice(0,3),O=o.length-S.length,h=a.hebrewWorkflowStatus||((M=a.reportReview)==null?void 0:M.status),p=h==="HEBREW_SUBMITTED"||h==="HEBREW_CHANGES_REQUESTED"||h==="HEBREW_REOPENED_EXTERNAL"||h==="SUBMITTED"||h==="CHANGES_REQUESTED",v=((H=(P=a.reportReview)==null?void 0:P.issues)==null?void 0:H.some(y=>(y.origin??"INTERNAL")==="EXTERNAL"&&y.status!=="DONE"))??!1,E=((A=(ne=a.reportReview)==null?void 0:ne.issues)==null?void 0:A.some(y=>(y.origin??"INTERNAL")==="EXTERNAL"&&y.status!=="DONE"&&y.externalAction==="REQUIRES_HEBREW"))??!1,D=d||f||m||a.reportSubject||a.id;return s.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-2 rounded-lg border border-amber-100 bg-amber-50 px-3 py-2",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex flex-wrap items-center gap-2 text-sm",children:[s.jsxs("span",{className:"font-semibold text-amber-900 truncate max-w-[220px]",children:[d,f?`  ${f}`:""]}),m&&s.jsxs("span",{className:"text-xs text-amber-800 truncate max-w-[180px]",children:["(",m,")"]}),s.jsx("span",{className:"text-[11px] text-amber-700 mr-auto",children:` : ${b}`})]}),s.jsxs("div",{className:"flex flex-wrap items-center gap-1 mt-1",children:[s.jsx("span",{className:"text-[11px] text-amber-900 mr-1",children:t.attention.reasons}),S.map(y=>s.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-amber-600 text-white",children:y.labelHe},y.code)),O>0&&s.jsx("span",{className:"text-[11px] px-2 py-0.5 rounded-full bg-amber-100 text-amber-800",children:`+${O}`}),s.jsx("span",{className:"text-[10px] text-amber-700 ml-auto",children:`Score: ${c}`})]})]}),s.jsx("button",{type:"button",onClick:()=>n(a.id),className:"text-[11px] px-3 py-1.5 rounded-md bg-amber-600 text-white hover:bg-amber-700 whitespace-nowrap",children:t.attention.openReport}),p&&s.jsx("button",{type:"button",onClick:()=>r?r(a.id,"REVIEW"):n(a.id),className:"mt-1 text-[11px] px-3 py-1.5 rounded-md border border-amber-300 text-amber-800 bg-white hover:bg-amber-50 whitespace-nowrap",children:t.attention.jumpToReview}),v&&s.jsxs("div",{className:"flex flex-col gap-1 mt-1",children:[s.jsx("button",{type:"button",onClick:()=>r?r(a.id,"EXTERNAL_FEEDBACK"):n(a.id),className:"text-[11px] px-3 py-1.5 rounded-md border border-amber-300 text-amber-800 bg-white hover:bg-amber-50 whitespace-nowrap",children:t.attention.jumpToExternal}),E&&l&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:()=>l({kind:"REOPEN_HEBREW",reportId:a.id,reportLabel:D}),className:"text-[11px] px-3 py-1.5 rounded-md border border-amber-300 text-amber-800 bg-amber-50 hover:bg-amber-100 whitespace-nowrap",children:t.attention.reopenHebrew}),s.jsx("button",{type:"button",onClick:()=>l({kind:"MARK_EXTERNAL_DONE",reportId:a.id,reportLabel:D}),className:"text-[11px] px-3 py-1.5 rounded-md border border-red-200 text-red-700 bg-white hover:bg-red-50 whitespace-nowrap",children:t.attention.markExternalDone})]}),!E&&l&&s.jsx("button",{type:"button",onClick:()=>l({kind:"MARK_EXTERNAL_DONE",reportId:a.id,reportLabel:D}),className:"text-[11px] px-3 py-1.5 rounded-md border border-red-200 text-red-700 bg-white hover:bg-red-50 whitespace-nowrap",children:t.attention.markExternalDone})]})]},a.id)})})]}):s.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4",children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900 mb-1",children:t.attention.title}),s.jsx("p",{className:"text-xs text-slate-500 mb-2",children:t.attention.subtitle}),s.jsx("p",{className:"text-xs text-emerald-600 mt-2",children:t.attention.empty})]}),Lg=({insights:e,adminHe:t})=>s.jsx("section",{className:"mb-6",children:s.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4",children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900 mb-1",children:t.insights.title}),s.jsx("p",{className:"text-xs text-slate-500 mb-3",children:t.insights.subtitle}),e.totalScoredReports===0?s.jsx("p",{className:"text-xs text-slate-400",children:t.insights.empty}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-[260px] text-xs text-right",children:[s.jsx("thead",{className:"bg-slate-100 text-slate-700",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:t.insights.column.reason}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:t.insights.column.count}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:t.insights.column.share})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100",children:e.topReasons.map(n=>{const r=Math.round(n.share*100);return s.jsxs("tr",{className:"hover:bg-slate-50",children:[s.jsx("td",{className:"px-3 py-1.5 whitespace-nowrap",children:n.labelHe}),s.jsx("td",{className:"px-3 py-1.5 whitespace-nowrap",children:n.count}),s.jsx("td",{className:"px-3 py-1.5 whitespace-nowrap",children:`${r}%`})]},n.code)})})]})}),s.jsx("p",{className:"text-[11px] text-slate-500 mt-2",children:t.insights.hint})]})}),Pg=({filter:e,kpis:t,activeReportsCount:n,onChangeFilter:r,adminHe:l})=>s.jsxs("section",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 mb-6",children:[s.jsxs("button",{type:"button",onClick:()=>r("ALL"),className:`flex flex-col items-start p-3 rounded-xl border text-right transition ${e==="ALL"?"border-lpBlue bg-blue-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[s.jsx("span",{className:"text-xs text-slate-500",children:l.table.filterAll}),s.jsx("span",{className:"text-lg font-bold text-slate-900 mt-1",children:n})]}),s.jsxs("button",{type:"button",onClick:()=>r("HEBREW"),className:`flex flex-col items-start p-3 rounded-xl border text-right transition ${e==="HEBREW"?"border-amber-500 bg-amber-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[s.jsx("span",{className:"text-xs text-slate-500",children:l.kpis.hebrewPending}),s.jsx("span",{className:"text-lg font-bold text-amber-700 mt-1",children:t.hebrewPending})]}),s.jsxs("button",{type:"button",onClick:()=>r("FEEDBACK"),className:`flex flex-col items-start p-3 rounded-xl border text-right transition ${e==="FEEDBACK"?"border-purple-500 bg-purple-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[s.jsx("span",{className:"text-xs text-slate-500",children:l.kpis.insurerFeedbackOpen}),s.jsx("span",{className:"text-lg font-bold text-purple-700 mt-1",children:t.insurerFeedbackOpen})]}),s.jsxs("button",{type:"button",onClick:()=>r("RESEND"),className:`flex flex-col items-start p-3 rounded-xl border text-right transition ${e==="RESEND"?"border-emerald-500 bg-emerald-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[s.jsx("span",{className:"text-xs text-slate-500",children:l.kpis.resendReady}),s.jsx("span",{className:"text-lg font-bold text-emerald-700 mt-1",children:t.resendReady})]}),s.jsxs("button",{type:"button",onClick:()=>r("MISSING_POLICY"),className:`flex flex-col items-start p-3 rounded-xl border text-right transition ${e==="MISSING_POLICY"?"border-rose-500 bg-rose-50":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[s.jsx("span",{className:"text-xs text-slate-500",children:l.kpis.missingPolicyAppendix}),s.jsx("span",{className:"text-lg font-bold text-rose-700 mt-1",children:t.missingPolicyAppendix})]})]}),Og=({reports:e,search:t,currentFilterLabel:n,onSearchChange:r,onResetUiState:l,onFilterAll:i,onNewReport:a,getHebrewStatusLabel:o,formatDateTime:c,onSelectReport:d,adminHe:f})=>{const m=t.trim();return s.jsxs("section",{className:"bg-white rounded-xl shadow-sm border border-slate-200 p-4",children:[s.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-3 mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900",children:f.table.title}),s.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[f.table.filterLabel," ",s.jsx("span",{className:"font-semibold text-slate-800",children:n})]})]}),s.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 items-stretch sm:items-center w-full md:w-auto",children:[s.jsx("input",{dir:"rtl",type:"text",value:t,onChange:x=>r(x.target.value),placeholder:"   /  /  /   / UMR",className:"flex-1 min-w-[220px] px-3 py-1.5 rounded-full border border-slate-200 text-xs text-slate-700 bg-white focus:outline-none focus:ring-1 focus:ring-lpBlue"}),s.jsxs("div",{className:"flex flex-wrap gap-2 justify-end",children:[s.jsx("button",{type:"button",onClick:l,className:"px-3 py-1.5 rounded-full border border-slate-200 text-xs text-slate-600 hover:bg-slate-50",children:" "}),s.jsx("button",{type:"button",onClick:i,className:"px-3 py-1.5 rounded-full border border-slate-200 text-xs text-slate-700 hover:bg-slate-50",children:f.actions.allReports}),s.jsx("button",{type:"button",onClick:i,className:"px-3 py-1.5 rounded-full border border-slate-200 text-xs text-slate-700 hover:bg-slate-50",children:f.actions.clearFilter}),s.jsx("button",{type:"button",onClick:a,className:"px-3 py-1.5 rounded-full bg-lpBlue text-white text-xs hover:bg-blue-800",children:f.actions.openNewReport})]})]})]}),e.length===0?s.jsx("p",{className:"text-xs text-slate-400 text-center py-8",children:m?"    .":f.table.empty}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-xs text-right",children:[s.jsx("thead",{className:"bg-slate-100 text-slate-700",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:f.table.columns.id}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:f.table.columns.status}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:f.table.columns.hebrewStatus}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:f.table.columns.insurer}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:f.table.columns.insured}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:f.table.columns.plaintiff}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200",children:f.table.columns.updatedAt}),s.jsx("th",{className:"px-3 py-2 font-semibold border-b border-slate-200"})]})}),s.jsx("tbody",{className:"divide-y divide-slate-100",children:e.map(x=>s.jsxs("tr",{className:"hover:bg-slate-50",children:[s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:x.odakanitNo||x.id}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:x.status}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:o(x)}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:x.insurerName}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:x.insuredName}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:x.plaintiffName}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:c(x.updatedAt||x.reportDate)}),s.jsx("td",{className:"px-3 py-2 whitespace-nowrap",children:s.jsx("button",{type:"button",onClick:()=>d(x.id),className:"px-2 py-1 rounded-md border border-slate-300 text-[11px] hover:bg-slate-100",children:f.queueItem.openReport})})]},x.id))})]})})]})},yr=e=>{const t=e.updatedAt||e.sentAt||e.reportDate;return t?new Date(t).getTime():0},Mg=e=>{var n;return(((n=e.reportReview)==null?void 0:n.issues)??[]).some(r=>(r.origin??"INTERNAL")==="EXTERNAL"&&r.status!=="DONE")},Mo=e=>{var n;return(((n=e.reportReview)==null?void 0:n.issues)??[]).some(r=>(r.origin??"INTERNAL")==="EXTERNAL"&&r.status!=="DONE"&&r.externalAction==="REQUIRES_HEBREW")},Fg=e=>{var n;return(((n=e.reportReview)==null?void 0:n.issues)??[]).some(r=>(r.origin??"INTERNAL")==="INTERNAL"&&r.status!=="DONE")},Bg=e=>{var r;const t=e.hebrewWorkflowStatus,n=(r=e.reportReview)==null?void 0:r.status;return t==="HEBREW_SUBMITTED"||t==="HEBREW_CHANGES_REQUESTED"||n==="SUBMITTED"||n==="CHANGES_REQUESTED"},yp=e=>e.filter(t=>!t.deletedAt&&Bg(t)).sort((t,n)=>yr(n)-yr(t)),Np=e=>e.filter(t=>t.deletedAt?!1:t.hebrewWorkflowStatus==="HEBREW_REOPENED_EXTERNAL"?!0:Mg(t)).sort((t,n)=>yr(n)-yr(t)),vp=(e,t)=>e.filter(n=>!(n.deletedAt||n.status!=="SENT"||!t(n)||Mo(n))).sort((n,r)=>yr(r)-yr(n)),bp=e=>e.filter(t=>{if(t.deletedAt)return!1;const n=!t.reportHistory||t.reportHistory.length===0,r=t.attachPolicyAsAppendix===!0,l=!!t.policyFile;return n&&r&&!l}).sort((t,n)=>yr(n)-yr(t)),$g=e=>{const t=e.sentAt||e.updatedAt||e.reportDate;return t?new Date(t).getTime():0},Ug=(e,t)=>{const n=e.filter(f=>!f.deletedAt),r=yp(n).length,l=Np(n).length,i=vp(n,t).length,a=bp(n).length,o=Date.now(),c=7*24*60*60*1e3,d=n.filter(f=>{if(f.status!=="SENT")return!1;const m=$g(f);return m?o-m<=c:!1}).length;return{hebrewPending:r,insurerFeedbackOpen:l,resendReady:i,missingPolicyAppendix:a,sentLast7Days:d}},ls={EXTERNAL_REQUIRES_HEBREW:{code:"EXTERNAL_REQUIRES_HEBREW",labelHe:"    ",weight:100},HEBREW_REOPENED_EXTERNAL:{code:"HEBREW_REOPENED_EXTERNAL",labelHe:"    ",weight:80},HEBREW_SUBMITTED:{code:"HEBREW_SUBMITTED",labelHe:"  ",weight:60},HEBREW_CHANGES_REQUESTED:{code:"HEBREW_CHANGES_REQUESTED",labelHe:"  ",weight:50},INTERNAL_CRITICAL_ISSUE:{code:"INTERNAL_CRITICAL_ISSUE",labelHe:"Issue   ",weight:40},WAITING_FOR_INVOICES:{code:"WAITING_FOR_INVOICES",labelHe:" ",weight:30},RESEND_ELIGIBLE:{code:"RESEND_ELIGIBLE",labelHe:"  ",weight:20},AGING_OVER_7_DAYS:{code:"AGING_OVER_7_DAYS",labelHe:"   7 ",weight:20},AGING_OVER_3_DAYS:{code:"AGING_OVER_3_DAYS",labelHe:"   ",weight:10}},Fo=e=>{const t=e.updatedAt||e.sentAt||e.reportDate;return t?new Date(t).getTime():0},Hg=e=>{var n;return(((n=e.reportReview)==null?void 0:n.issues)??[]).some(r=>(r.origin??"INTERNAL")==="INTERNAL"&&r.status!=="DONE"&&r.severity==="CRITICAL")},Wg=(e,t)=>{if(e.deletedAt)return{score:0,reasons:[]};let n=0;const r=[],l=c=>{const d=ls[c];d&&(r.some(f=>f.code===d.code)||(n+=d.weight,r.push({code:d.code,labelHe:d.labelHe})))};Mo(e)&&l("EXTERNAL_REQUIRES_HEBREW"),e.hebrewWorkflowStatus==="HEBREW_REOPENED_EXTERNAL"&&l("HEBREW_REOPENED_EXTERNAL"),e.hebrewWorkflowStatus==="HEBREW_SUBMITTED"&&l("HEBREW_SUBMITTED"),e.hebrewWorkflowStatus==="HEBREW_CHANGES_REQUESTED"&&l("HEBREW_CHANGES_REQUESTED"),e.status==="WAITING_FOR_INVOICES"&&l("WAITING_FOR_INVOICES"),Fg(e)&&Hg(e)&&l("INTERNAL_CRITICAL_ISSUE"),e.status==="SENT"&&t(e)&&!Mo(e)&&l("RESEND_ELIGIBLE");const a=Date.now(),o=Fo(e);if(o){const c=a-o,d=3*24*60*60*1e3,f=7*24*60*60*1e3;c>=f?l("AGING_OVER_7_DAYS"):c>=d&&l("AGING_OVER_3_DAYS")}return{score:n,reasons:r}},zg=(e,t=5)=>{const n=e.filter(r=>r.score>0);return n.sort((r,l)=>{if(l.score!==r.score)return l.score-r.score;const i=Fo(r.report);return Fo(l.report)-i}),n.slice(0,t)},Vg=(e,t,n)=>{if(t===0)return{totalScoredReports:0,topReasons:[]};const r=Object.keys(ls).filter(l=>e[l]).map(l=>{const i=ls[l],a=e[l]||0,o=a>0&&t>0?a/t:0;return{code:l,labelHe:i.labelHe,count:a,share:o}});return r.sort((l,i)=>{if(i.count!==l.count)return i.count-l.count;const a=ls[l.code].weight,o=ls[i.code].weight;return o!==a?o-a:l.labelHe.localeCompare(i.labelHe,"he-IL")}),{totalScoredReports:t,topReasons:r.slice(0,n)}};function Gg(e,t=5){const n={};let r=0;for(const l of e)if(!(l.score<=0)){r+=1;for(const i of l.reasons){const a=i.code;ls[a]&&(n[a]=(n[a]||0)+1)}}return Vg(n,r,t)}const Ws="adminDashboardUiState:v1";function Kg(e,t){if(!e)return{title:t.dialog.confirmTitle,message:""};let n,r;e.kind==="MARK_EXTERNAL_DONE"?(n=t.attention.markExternalDoneTitle,r=t.attention.confirmMarkExternalDone):(n=t.attention.reopenHebrewTitle,r=t.attention.confirmReopenHebrew);const l=e.reportLabel?`
: ${e.reportLabel}`:"";return{title:n,message:`${r}${l}`}}const Yg=({user:e,reports:t,onSelectReport:n,onSelectReportWithFocus:r,onMarkExternalIssuesDone:l,onReopenHebrewDueToExternalFeedback:i,onNewReport:a,canTranslate:o,onLogout:c})=>{const{showToast:d}=Dg(),[f,m]=w.useState(()=>{if(typeof window>"u")return"ALL";try{const F=localStorage.getItem(Ws);if(!F)return"ALL";const Z=JSON.parse(F),Ie=Z==null?void 0:Z.filter;return["ALL","HEBREW","FEEDBACK","RESEND","MISSING_POLICY"].includes(Ie)?Ie:"ALL"}catch{return"ALL"}}),[x,b]=w.useState(()=>{if(typeof window>"u")return"";try{const F=localStorage.getItem(Ws);if(!F)return"";const Z=JSON.parse(F);return typeof(Z==null?void 0:Z.search)=="string"?Z.search:""}catch{return""}}),j=w.useMemo(()=>t.filter(F=>!F.deletedAt),[t]),S=w.useMemo(()=>{const F=new Map;return j.forEach(Z=>{const{score:Ie,reasons:be}=Wg(Z,o);F.set(Z.id,{report:Z,score:Ie,reasons:be})}),F},[j,o]),O=w.useMemo(()=>yp(j),[j]),h=w.useMemo(()=>Np(j),[j]),p=w.useMemo(()=>vp(j,o),[j,o]),v=w.useMemo(()=>bp(j),[j]),E=w.useMemo(()=>Ug(j,o),[j,o]),D=F=>{var Z;return F.hebrewWorkflowStatus?F.hebrewWorkflowStatus:((Z=F.reportReview)==null?void 0:Z.status)??"-"},M=F=>{if(!F)return Re.queueItem.noDate;try{const Z=new Date(F);return`${Z.toLocaleDateString("he-IL")} ${Z.toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"}).replace(":00","")}`}catch{return F}},P=w.useMemo(()=>[...j].sort((F,Z)=>{const Ie=new Date(F.updatedAt||F.reportDate).getTime();return new Date(Z.updatedAt||Z.reportDate).getTime()-Ie}),[j]),H=w.useMemo(()=>{let F;switch(f){case"HEBREW":F=O;break;case"FEEDBACK":F=h;break;case"RESEND":F=p;break;case"MISSING_POLICY":F=v;break;case"ALL":default:F=P}return F},[f,O,h,p,v,P]),ne=w.useMemo(()=>{const F=x.trim().toLowerCase();return F?H.filter(Z=>[Z.insuredName,Z.plaintiffName,Z.insurerName,Z.odakanitNo,Z.marketRef,Z.lineSlipNo,Z.reportSubject].filter(Boolean).map(be=>String(be).toLowerCase()).some(be=>be.includes(F))).slice(0,80):H.slice(0,80)},[H,x]);w.useEffect(()=>{if(!(typeof window>"u"))try{const F={filter:f,search:x,savedAt:new Date().toISOString()};localStorage.setItem(Ws,JSON.stringify(F))}catch{}},[f,x]);const A=(()=>{switch(f){case"HEBREW":return Re.table.filterHebrew;case"FEEDBACK":return Re.table.filterFeedback;case"RESEND":return Re.table.filterResend;case"MISSING_POLICY":return Re.table.filterMissingPolicy;case"ALL":default:return Re.table.filterAll}})(),y=()=>{if(m("ALL"),b(""),typeof window<"u")try{localStorage.removeItem(Ws)}catch{}},$=w.useMemo(()=>Array.from(S.values()),[S]),_=w.useMemo(()=>zg($,5),[$]),R=w.useMemo(()=>Gg($.map(F=>({score:F.score,reasons:F.reasons.map(Z=>({code:Z.code}))})),5),[$]),[z,U]=w.useState(null),{title:te,message:I}=Kg(z,Re),K=()=>{U(null)},q=()=>{if(!z)return;if(!t.find(Z=>Z.id===z.reportId&&!Z.deletedAt)){U(null),d({message:Re.toast.reportNotFound,type:"info"});return}z.kind==="MARK_EXTERNAL_DONE"?l==null||l(z.reportId):z.kind==="REOPEN_HEBREW"&&(i==null||i(z.reportId)),U(null)};return s.jsx("div",{className:"min-h-screen bg-slate-50",dir:"rtl",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[s.jsxs("header",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:Re.title}),s.jsx("p",{className:"text-sm text-slate-600 mt-1",children:Re.subtitle}),s.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["/ ",s.jsx("span",{className:"font-semibold",children:e.name})," (ADMIN)"]})]}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("button",{type:"button",onClick:c,className:"inline-flex items-center justify-center px-3 py-2 rounded-lg border border-red-200 bg-white text-sm font-semibold text-red-700 hover:bg-red-50 transition",children:""}),s.jsx("button",{onClick:a,className:"inline-flex items-center justify-center px-4 py-2 rounded-lg bg-lpBlue text-white text-sm font-semibold shadow-sm hover:bg-blue-800 transition",children:Re.actions.openNewReport})]})]}),s.jsx("section",{className:"mb-6",children:s.jsx(_g,{items:_,adminHe:Re,onSelectReport:n,onSelectReportWithFocus:r,onRequestPendingAction:U})}),s.jsx(Lg,{insights:R,adminHe:Re}),s.jsx(Pg,{filter:f,kpis:E,activeReportsCount:j.length,onChangeFilter:m,adminHe:Re}),s.jsx(Tg,{open:!!z,title:te,message:I,confirmText:Re.dialog.confirm,cancelText:Re.dialog.cancel,destructive:(z==null?void 0:z.kind)==="MARK_EXTERNAL_DONE"||(z==null?void 0:z.kind)==="REOPEN_HEBREW",onCancel:K,onConfirm:q}),s.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 mb-8",children:[s.jsxs("div",{className:"bg-white rounded-xl border border-amber-100 shadow-sm p-4 flex flex-col",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h2",{className:"text-sm font-bold text-amber-700",children:Re.queues.hebrewReview.title}),s.jsx("p",{className:"text-xs text-slate-500",children:Re.queues.hebrewReview.subtitle})]}),O.length===0?s.jsx("p",{className:"text-xs text-slate-400 mt-4",children:Re.queues.hebrewReview.empty}):s.jsx("ul",{className:"space-y-2 text-sm",children:O.slice(0,6).map(F=>s.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-lg border border-amber-100 bg-amber-50 px-2 py-1.5",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-amber-900 truncate",children:(F.odakanitNo||F.marketRef||F.id)+(F.insuredName?`  ${F.insuredName}`:"")}),s.jsxs("p",{className:"text-[11px] text-amber-800",children:[D(F),"  ",M(F.updatedAt||F.reportDate)]})]}),s.jsx("button",{type:"button",onClick:()=>n(F.id),className:"text-[11px] px-2 py-1 rounded-md bg-amber-600 text-white hover:bg-amber-700",children:Re.queueItem.openReport})]},F.id))})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-purple-100 shadow-sm p-4 flex flex-col",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h2",{className:"text-sm font-bold text-purple-700",children:Re.queues.insurerFeedback.title}),s.jsx("p",{className:"text-xs text-slate-500",children:Re.queues.insurerFeedback.subtitle})]}),h.length===0?s.jsx("p",{className:"text-xs text-slate-400 mt-4",children:Re.queues.insurerFeedback.empty}):s.jsx("ul",{className:"space-y-2 text-sm",children:h.slice(0,6).map(F=>s.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-lg border border-purple-100 bg-purple-50 px-2 py-1.5",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-purple-900 truncate",children:(F.odakanitNo||F.marketRef||F.id)+(F.insuredName?`  ${F.insuredName}`:"")}),s.jsxs("p",{className:"text-[11px] text-purple-800",children:[D(F),"  ",M(F.updatedAt||F.reportDate)]})]}),s.jsx("button",{type:"button",onClick:()=>n(F.id),className:"text-[11px] px-2 py-1 rounded-md bg-purple-600 text-white hover:bg-purple-700",children:Re.queueItem.openReport})]},F.id))})]}),s.jsxs("div",{className:"bg-white rounded-xl border border-emerald-100 shadow-sm p-4 flex flex-col",children:[s.jsxs("div",{className:"mb-2",children:[s.jsx("h2",{className:"text-sm font-bold text-emerald-700",children:Re.queues.resend.title}),s.jsx("p",{className:"text-xs text-slate-500",children:Re.queues.resend.subtitle})]}),p.length===0?s.jsx("p",{className:"text-xs text-slate-400 mt-4",children:Re.queues.resend.empty}):s.jsx("ul",{className:"space-y-2 text-sm",children:p.slice(0,6).map(F=>s.jsxs("li",{className:"flex items-center justify-between gap-2 rounded-lg border border-emerald-100 bg-emerald-50 px-2 py-1.5",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("p",{className:"font-semibold text-emerald-900 truncate",children:(F.odakanitNo||F.marketRef||F.id)+(F.insuredName?`  ${F.insuredName}`:"")}),s.jsxs("p",{className:"text-[11px] text-emerald-800",children:[F.status,"  ",M(F.sentAt||F.updatedAt||F.reportDate)]})]}),s.jsx("button",{type:"button",onClick:()=>n(F.id),className:"text-[11px] px-2 py-1 rounded-md bg-emerald-600 text-white hover:bg-emerald-700",children:Re.queueItem.openReport})]},F.id))})]})]}),s.jsx(Og,{reports:ne,search:x,currentFilterLabel:A,onSearchChange:b,onResetUiState:y,onFilterAll:()=>m("ALL"),onNewReport:a,getHebrewStatusLabel:D,formatDateTime:M,onSelectReport:n,adminHe:Re})]})})},wp="financial_expenses_store_v1",Ql=()=>({sheets:{},lineItems:{},attachments:{},auditEvents:{},insurerRulesets:{}}),rn=()=>{if(typeof window>"u")return Ql();try{const e=window.localStorage.getItem(wp);if(!e)return Ql();const t=JSON.parse(e);return!t||typeof t!="object"?Ql():{sheets:t.sheets||{},lineItems:t.lineItems||{},attachments:t.attachments||{},auditEvents:t.auditEvents||{},insurerRulesets:t.insurerRulesets||{}}}catch(e){return console.error("Failed to load financial expenses store",e),Ql()}},Gn=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(wp,JSON.stringify(e))}catch(t){console.error("Failed to persist financial expenses store",t)}},Qg=e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t).toString(16)},Xg=(e,t,n)=>{const r={sheet:e,lineItems:t.map(l=>({id:l.id,sheetId:l.sheetId,kind:l.kind,expenseType:l.expenseType,providerName:l.providerName,description:l.description,date:l.date,quantity:l.quantity,unitPrice:l.unitPrice,vatRate:l.vatRate,isIncludedInRequestedAmount:l.isIncludedInRequestedAmount,lineNetAmount:l.lineNetAmount,lineVatAmount:l.lineVatAmount,lineTotalAmount:l.lineTotalAmount,attachmentId:l.attachmentId})),attachments:n.map(l=>({id:l.id,sheetId:l.sheetId,fileKey:l.fileKey,originalFileName:l.originalFileName,mimeType:l.mimeType,sizeBytes:l.sizeBytes,linkedLineItemId:l.linkedLineItemId}))};return Qg(JSON.stringify(r))},hn=()=>new Date().toISOString(),ra=e=>`${e}_${Math.random().toString(36).slice(2,10)}_${Date.now().toString(36)}`,Sp=(e,t)=>{const n=Object.values(e.lineItems).filter(l=>l.sheetId===t),r=Object.values(e.attachments).filter(l=>l.sheetId===t);return{lineItems:n,attachments:r}},qg=e=>rn().insurerRulesets[e]||null,Tu=()=>{const e=rn();return Object.values(e.sheets).sort((t,n)=>{const r=new Date(t.updatedAt||t.createdAt).getTime();return new Date(n.updatedAt||n.createdAt).getTime()-r})},Jg=e=>{const t=rn(),n=t.sheets[e];if(!n)return null;const{lineItems:r,attachments:l}=Sp(t,e);return{sheet:n,lineItems:r,attachments:l}},Kn=(e,t)=>{const n=e.sheets[t];if(!n)return e;const{lineItems:r,attachments:l}=Sp(e,t),i={...n,sheetVersionNumber:n.sheetVersionNumber+1,sheetVersionHash:Xg(n,r,l),updatedAt:hn()};return{...e,sheets:{...e.sheets,[t]:i}}},Yn=(e,t,n,r,l,i,a,o)=>{const c=e.sheets[t];if(!c)return e;const d=ra("fae"),f={id:d,sheetId:t,actorUserId:n,actorRole:r,eventType:l,eventAt:hn(),entityType:i,entityId:a??null,diffJson:o,sheetVersionNumberAtEvent:c.sheetVersionNumber,sheetVersionHashAtEvent:c.sheetVersionHash};return{...e,auditEvents:{...e.auditEvents,[d]:f}}},Zg=e=>{const t=rn(),n=ra("fes"),r=hn(),l={id:n,caseId:e.caseId,insurerId:e.insurerId??null,insurerName:e.insurerName??null,periodStart:e.periodStart??null,periodEnd:e.periodEnd??null,periodLabel:e.periodLabel??null,versionIndex:e.versionIndex,status:"DRAFT",archivedReason:null,currency:e.currency||"ILS",deductibleAmount:e.deductibleAmount??null,alreadyPaidAmount:e.alreadyPaidAmount??null,infoOnly:!!e.infoOnly,attachedToReportId:null,attachedAt:null,createdByUserId:e.createdByUserId,createdAt:r,updatedAt:r,readyAt:null,sheetVersionNumber:1,sheetVersionHash:"",insurerRulesetId:e.insurerRulesetId??null,insurerRulesetVersion:e.insurerRulesetVersion??null};let i={...t,sheets:{...t.sheets,[n]:l}};return i=Kn(i,n),i=Yn(i,n,e.createdByUserId,"FINANCE","SHEET_CREATED","SHEET",n,{caseId:e.caseId,insurerId:e.insurerId??null,insurerName:e.insurerName??null}),Gn(i),i.sheets[n]},ey=e=>{let t=rn();const n=t.sheets[e.sheetId];if(!n)return console.warn("updateFinancialExpenseSheetMeta: sheet not found",e.sheetId),null;const r={...n,...e.patch,updatedAt:hn()};t={...t,sheets:{...t.sheets,[e.sheetId]:r}};const l={};return Object.keys(e.patch).forEach(i=>{const a=n[i],o=r[i];a!==o&&(l[i]={before:a,after:o})}),t=Kn(t,e.sheetId),t=Yn(t,e.sheetId,e.actorUserId,e.actorRole,"SHEET_META_UPDATED","SHEET",e.sheetId,Object.keys(l).length?l:void 0),Gn(t),t.sheets[e.sheetId]},ty=e=>{let t=rn();if(!t.sheets[e.sheetId])return console.warn("addFinancialExpenseLineItem: sheet not found",e.sheetId),null;const n=ra("fli"),r=hn(),l={id:n,sheetId:e.sheetId,kind:e.kind,expenseType:e.expenseType??null,providerName:e.providerName??null,providerId:e.providerId??null,description:e.description,date:e.date??null,quantity:e.quantity??null,unitPrice:e.unitPrice??null,vatRate:e.vatRate??null,isIncludedInRequestedAmount:e.isIncludedInRequestedAmount??!0,lineNetAmount:e.lineNetAmount??null,lineVatAmount:e.lineVatAmount??null,lineTotalAmount:e.lineTotalAmount??null,attachmentId:e.attachmentId??null,createdAt:r,updatedAt:r};return t={...t,lineItems:{...t.lineItems,[n]:l}},t=Kn(t,e.sheetId),t=Yn(t,e.sheetId,e.actorUserId,e.actorRole,"LINE_ITEM_CREATED","LINE_ITEM",n,{kind:e.kind,description:e.description,amount:e.lineTotalAmount??null}),Gn(t),l},ny=e=>{let t=rn();const n=t.lineItems[e.lineItemId];if(!n||n.sheetId!==e.sheetId)return console.warn("updateFinancialExpenseLineItem: line item not found",e.lineItemId),null;const r={...n,...e.patch,updatedAt:hn()};t={...t,lineItems:{...t.lineItems,[e.lineItemId]:r}};const l={};return Object.keys(e.patch).forEach(i=>{const a=n[i],o=r[i];a!==o&&(l[i]={before:a,after:o})}),t=Kn(t,e.sheetId),t=Yn(t,e.sheetId,e.actorUserId,e.actorRole,"LINE_ITEM_UPDATED","LINE_ITEM",e.lineItemId,Object.keys(l).length?l:void 0),Gn(t),t.lineItems[e.lineItemId]},ry=e=>{let t=rn();const n=t.lineItems[e.lineItemId];if(!n||n.sheetId!==e.sheetId)return console.warn("deleteFinancialExpenseLineItem: line item not found",e.lineItemId),!1;const{[e.lineItemId]:r,...l}=t.lineItems;return t={...t,lineItems:l},t=Kn(t,e.sheetId),t=Yn(t,e.sheetId,e.actorUserId,e.actorRole,"LINE_ITEM_DELETED","LINE_ITEM",e.lineItemId,{deleted:r}),Gn(t),!0},sy=e=>{let t=rn();if(!t.sheets[e.sheetId])return console.warn("addFinancialExpenseAttachment: sheet not found",e.sheetId),null;const n=ra("fat"),r=hn(),l={id:n,sheetId:e.sheetId,fileKey:e.fileKey,originalFileName:e.originalFileName,mimeType:e.mimeType??null,sizeBytes:e.sizeBytes??null,uploadedByUserId:e.uploadedByUserId,uploadedAt:r,linkedLineItemId:e.linkedLineItemId??null};return t={...t,attachments:{...t.attachments,[n]:l}},t=Kn(t,e.sheetId),t=Yn(t,e.sheetId,e.uploadedByUserId,"FINANCE","ATTACHMENT_ADDED","ATTACHMENT",n,{fileKey:e.fileKey,originalFileName:e.originalFileName}),Gn(t),l},ly=e=>{let t=rn();const n=t.attachments[e.attachmentId];if(!n||n.sheetId!==e.sheetId)return console.warn("linkAttachmentToLineItem: attachment not found",e.attachmentId),null;const r=n.linkedLineItemId??null,l={...n,linkedLineItemId:e.lineItemId};if(t={...t,attachments:{...t.attachments,[e.attachmentId]:l}},e.lineItemId){const i=t.lineItems[e.lineItemId];i&&(t={...t,lineItems:{...t.lineItems,[e.lineItemId]:{...i,attachmentId:e.attachmentId,updatedAt:hn()}}})}else if(r){const i=t.lineItems[r];i&&i.attachmentId===e.attachmentId&&(t={...t,lineItems:{...t.lineItems,[r]:{...i,attachmentId:null,updatedAt:hn()}}})}return t=Kn(t,e.sheetId),t=Yn(t,e.sheetId,e.actorUserId,e.actorRole,"ATTACHMENT_LINKED","ATTACHMENT",e.attachmentId,{before:r,after:e.lineItemId}),Gn(t),t.attachments[e.attachmentId]},iy=e=>{let t=rn();const n=t.sheets[e.sheetId];if(!n)return console.warn("recordSheetReadyAttempt: sheet not found",e.sheetId),null;let r=n;if(e.success){const l=hn();r={...n,status:"READY_FOR_REPORT",readyAt:l,updatedAt:l,insurerRulesetId:e.decisionLog.rulesetId??n.insurerRulesetId??null,insurerRulesetVersion:e.decisionLog.rulesetVersion??n.insurerRulesetVersion??null},t={...t,sheets:{...t.sheets,[e.sheetId]:r}},t=Kn(t,e.sheetId)}return t=Yn(t,e.sheetId,e.actorUserId,e.actorRole,"SHEET_READY_ATTEMPT","SHEET",e.sheetId,{success:e.success,decisionLog:e.decisionLog}),Gn(t),t.sheets[e.sheetId]},ay=e=>{let t=rn();const n=t.sheets[e.sheetId];if(!n||n.status!=="READY_FOR_REPORT")return n||null;const r=hn(),l={...n,status:"DRAFT",readyAt:null,updatedAt:r};return t={...t,sheets:{...t.sheets,[e.sheetId]:l}},t=Kn(t,e.sheetId),t=Yn(t,e.sheetId,e.actorUserId,e.actorRole,"SHEET_REVERTED_TO_DRAFT","SHEET",e.sheetId,{from:"READY_FOR_REPORT",to:"DRAFT"}),Gn(t),t.sheets[e.sheetId]},Os=e=>({actorUserId:e.id,actorRole:e.role}),vn={async listSheets(){return Tu()},async isNewFinancialModel(e){return e?(await Tu()).some(n=>n.caseId===e):!1},logIfMixedModel(e){if(!!!e.expensesSheetId)return;(e.expensesItems&&e.expensesItems.length>0||!!e.expenseWorksheet||!!e.expensesSum)&&console.error("[FinancialExpenses] Mixed model detected for report",e.id," expensesSheetId is set but legacy expenses fields are also populated.")},async getSheet(e){return Jg(e)},async getRulesetForSheet(e){const t=e.insurerRulesetId||e.insurerId||"default",n=qg(t);if(n)return n;const r=new Date().toISOString();return{insurerId:t,policyFamily:"FLEXIBLE",requiredAttachmentTypes:[],requireAttachmentPerLine:!1,requireAttachmentForExpenseTypes:[],amountThresholdRequiringAttachment:null,infoOnlyTextVariant:null,notesInternal:null,rulesetVersion:"default",updatedAt:r}},async createSheet(e,t){const n={...t,createdByUserId:e.id};return Zg(n)},async updateSheetMeta(e,t,n){const r={sheetId:t,...Os(e),patch:n};return ey(r)},async addLineItem(e,t,n){const r={...n,sheetId:t,...Os(e)};return ty(r)},async updateLineItem(e,t,n,r){const l={sheetId:t,lineItemId:n,...Os(e),patch:r};return ny(l)},async deleteLineItem(e,t,n){const r={sheetId:t,lineItemId:n,...Os(e)};return ry(r)},async addAttachment(e,t,n){const r={...n,sheetId:t,uploadedByUserId:e.id};return sy(r)},async linkAttachmentToLineItem(e,t,n,r){const l={sheetId:t,attachmentId:n,lineItemId:r,...Os(e)};return ly(l)},async recordReadyAttempt(e,t){const n={...t,actorUserId:e.id,actorRole:e.role};return iy(n)},async revertSheetToDraft(e,t){return ay({sheetId:t,actorUserId:e.id,actorRole:e.role})}};var Ss=1e9,oy={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},qc,He=!0,nn="[DecimalError] ",_r=nn+"Invalid argument: ",Xc=nn+"Exponent out of range: ",js=Math.floor,kr=Math.pow,cy=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ut,it=1e7,Pe=7,jp=9007199254740991,Bi=js(jp/Pe),le={};le.absoluteValue=le.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};le.comparedTo=le.cmp=function(e){var t,n,r,l,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(r=i.d.length,l=e.d.length,t=0,n=r<l?r:l;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return r===l?0:r>l^i.s<0?1:-1};le.decimalPlaces=le.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Pe;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};le.dividedBy=le.div=function(e){return $n(this,new this.constructor(e))};le.dividedToIntegerBy=le.idiv=function(e){var t=this,n=t.constructor;return Ce($n(t,new n(e),0,1),n.precision)};le.equals=le.eq=function(e){return!this.cmp(e)};le.exponent=function(){return Ze(this)};le.greaterThan=le.gt=function(e){return this.cmp(e)>0};le.greaterThanOrEqualTo=le.gte=function(e){return this.cmp(e)>=0};le.isInteger=le.isint=function(){return this.e>this.d.length-2};le.isNegative=le.isneg=function(){return this.s<0};le.isPositive=le.ispos=function(){return this.s>0};le.isZero=function(){return this.s===0};le.lessThan=le.lt=function(e){return this.cmp(e)<0};le.lessThanOrEqualTo=le.lte=function(e){return this.cmp(e)<1};le.logarithm=le.log=function(e){var t,n=this,r=n.constructor,l=r.precision,i=l+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(Ut))throw Error(nn+"NaN");if(n.s<1)throw Error(nn+(n.s?"NaN":"-Infinity"));return n.eq(Ut)?new r(0):(He=!1,t=$n(Nl(n,i),Nl(e,i),i),He=!0,Ce(t,l))};le.minus=le.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Ip(t,e):Ep(t,(e.s=-e.s,e))};le.modulo=le.mod=function(e){var t,n=this,r=n.constructor,l=r.precision;if(e=new r(e),!e.s)throw Error(nn+"NaN");return n.s?(He=!1,t=$n(n,e,0,1).times(e),He=!0,n.minus(t)):Ce(new r(n),l)};le.naturalExponential=le.exp=function(){return kp(this)};le.naturalLogarithm=le.ln=function(){return Nl(this)};le.negated=le.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};le.plus=le.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?Ep(t,e):Ip(t,(e.s=-e.s,e))};le.precision=le.sd=function(e){var t,n,r,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(_r+e);if(t=Ze(l)+1,r=l.d.length-1,n=r*Pe+1,r=l.d[r],r){for(;r%10==0;r/=10)n--;for(r=l.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};le.squareRoot=le.sqrt=function(){var e,t,n,r,l,i,a,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(nn+"NaN")}for(e=Ze(o),He=!1,l=Math.sqrt(+o),l==0||l==1/0?(t=En(o.d),(t.length+e)%2==0&&(t+="0"),l=Math.sqrt(t),e=js((e+1)/2)-(e<0||e%2),l==1/0?t="5e"+e:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(l.toString()),n=c.precision,l=a=n+3;;)if(i=r,r=i.plus($n(o,i,a+2)).times(.5),En(i.d).slice(0,a)===(t=En(r.d)).slice(0,a)){if(t=t.slice(a-3,a+1),l==a&&t=="4999"){if(Ce(i,n+1,0),i.times(i).eq(o)){r=i;break}}else if(t!="9999")break;a+=4}return He=!0,Ce(r,n)};le.times=le.mul=function(e){var t,n,r,l,i,a,o,c,d,f=this,m=f.constructor,x=f.d,b=(e=new m(e)).d;if(!f.s||!e.s)return new m(0);for(e.s*=f.s,n=f.e+e.e,c=x.length,d=b.length,c<d&&(i=x,x=b,b=i,a=c,c=d,d=a),i=[],a=c+d,r=a;r--;)i.push(0);for(r=d;--r>=0;){for(t=0,l=c+r;l>r;)o=i[l]+b[r]*x[l-r-1]+t,i[l--]=o%it|0,t=o/it|0;i[l]=(i[l]+t)%it|0}for(;!i[--a];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,He?Ce(e,m.precision):e};le.toDecimalPlaces=le.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Tn(e,0,Ss),t===void 0?t=r.rounding:Tn(t,0,8),Ce(n,e+Ze(n)+1,t))};le.toExponential=function(e,t){var n,r=this,l=r.constructor;return e===void 0?n=$r(r,!0):(Tn(e,0,Ss),t===void 0?t=l.rounding:Tn(t,0,8),r=Ce(new l(r),e+1,t),n=$r(r,!0,e+1)),n};le.toFixed=function(e,t){var n,r,l=this,i=l.constructor;return e===void 0?$r(l):(Tn(e,0,Ss),t===void 0?t=i.rounding:Tn(t,0,8),r=Ce(new i(l),e+Ze(l)+1,t),n=$r(r.abs(),!1,e+Ze(r)+1),l.isneg()&&!l.isZero()?"-"+n:n)};le.toInteger=le.toint=function(){var e=this,t=e.constructor;return Ce(new t(e),Ze(e)+1,t.rounding)};le.toNumber=function(){return+this};le.toPower=le.pow=function(e){var t,n,r,l,i,a,o=this,c=o.constructor,d=12,f=+(e=new c(e));if(!e.s)return new c(Ut);if(o=new c(o),!o.s){if(e.s<1)throw Error(nn+"Infinity");return o}if(o.eq(Ut))return o;if(r=c.precision,e.eq(Ut))return Ce(o,r);if(t=e.e,n=e.d.length-1,a=t>=n,i=o.s,a){if((n=f<0?-f:f)<=jp){for(l=new c(Ut),t=Math.ceil(r/Pe+4),He=!1;n%2&&(l=l.times(o),Cu(l.d,t)),n=js(n/2),n!==0;)o=o.times(o),Cu(o.d,t);return He=!0,e.s<0?new c(Ut).div(l):Ce(l,r)}}else if(i<0)throw Error(nn+"NaN");return i=i<0&&e.d[Math.max(t,n)]&1?-1:1,o.s=1,He=!1,l=e.times(Nl(o,r+d)),He=!0,l=kp(l),l.s=i,l};le.toPrecision=function(e,t){var n,r,l=this,i=l.constructor;return e===void 0?(n=Ze(l),r=$r(l,n<=i.toExpNeg||n>=i.toExpPos)):(Tn(e,1,Ss),t===void 0?t=i.rounding:Tn(t,0,8),l=Ce(new i(l),e,t),n=Ze(l),r=$r(l,e<=n||n<=i.toExpNeg,e)),r};le.toSignificantDigits=le.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Tn(e,1,Ss),t===void 0?t=r.rounding:Tn(t,0,8)),Ce(new r(n),e,t)};le.toString=le.valueOf=le.val=le.toJSON=le[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Ze(e),n=e.constructor;return $r(e,t<=n.toExpNeg||t>=n.toExpPos)};function Ep(e,t){var n,r,l,i,a,o,c,d,f=e.constructor,m=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),He?Ce(t,m):t;if(c=e.d,d=t.d,a=e.e,l=t.e,c=c.slice(),i=a-l,i){for(i<0?(r=c,i=-i,o=d.length):(r=d,l=a,o=c.length),a=Math.ceil(m/Pe),o=a>o?a+1:o+1,i>o&&(i=o,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(o=c.length,i=d.length,o-i<0&&(i=o,r=d,d=c,c=r),n=0;i;)n=(c[--i]=c[i]+d[i]+n)/it|0,c[i]%=it;for(n&&(c.unshift(n),++l),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=l,He?Ce(t,m):t}function Tn(e,t,n){if(e!==~~e||e<t||e>n)throw Error(_r+e)}function En(e){var t,n,r,l=e.length-1,i="",a=e[0];if(l>0){for(i+=a,t=1;t<l;t++)r=e[t]+"",n=Pe-r.length,n&&(i+=tr(n)),i+=r;a=e[t],r=a+"",n=Pe-r.length,n&&(i+=tr(n))}else if(a===0)return"0";for(;a%10===0;)a/=10;return i+a}var $n=function(){function e(r,l){var i,a=0,o=r.length;for(r=r.slice();o--;)i=r[o]*l+a,r[o]=i%it|0,a=i/it|0;return a&&r.unshift(a),r}function t(r,l,i,a){var o,c;if(i!=a)c=i>a?1:-1;else for(o=c=0;o<i;o++)if(r[o]!=l[o]){c=r[o]>l[o]?1:-1;break}return c}function n(r,l,i){for(var a=0;i--;)r[i]-=a,a=r[i]<l[i]?1:0,r[i]=a*it+r[i]-l[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,l,i,a){var o,c,d,f,m,x,b,j,S,O,h,p,v,E,D,M,P,H,ne=r.constructor,A=r.s==l.s?1:-1,y=r.d,$=l.d;if(!r.s)return new ne(r);if(!l.s)throw Error(nn+"Division by zero");for(c=r.e-l.e,P=$.length,D=y.length,b=new ne(A),j=b.d=[],d=0;$[d]==(y[d]||0);)++d;if($[d]>(y[d]||0)&&--c,i==null?p=i=ne.precision:a?p=i+(Ze(r)-Ze(l))+1:p=i,p<0)return new ne(0);if(p=p/Pe+2|0,d=0,P==1)for(f=0,$=$[0],p++;(d<D||f)&&p--;d++)v=f*it+(y[d]||0),j[d]=v/$|0,f=v%$|0;else{for(f=it/($[0]+1)|0,f>1&&($=e($,f),y=e(y,f),P=$.length,D=y.length),E=P,S=y.slice(0,P),O=S.length;O<P;)S[O++]=0;H=$.slice(),H.unshift(0),M=$[0],$[1]>=it/2&&++M;do f=0,o=t($,S,P,O),o<0?(h=S[0],P!=O&&(h=h*it+(S[1]||0)),f=h/M|0,f>1?(f>=it&&(f=it-1),m=e($,f),x=m.length,O=S.length,o=t(m,S,x,O),o==1&&(f--,n(m,P<x?H:$,x))):(f==0&&(o=f=1),m=$.slice()),x=m.length,x<O&&m.unshift(0),n(S,m,O),o==-1&&(O=S.length,o=t($,S,P,O),o<1&&(f++,n(S,P<O?H:$,O))),O=S.length):o===0&&(f++,S=[0]),j[d++]=f,o&&S[0]?S[O++]=y[E]||0:(S=[y[E]],O=1);while((E++<D||S[0]!==void 0)&&p--)}return j[0]||j.shift(),b.e=c,Ce(b,a?i+Ze(b)+1:i)}}();function kp(e,t){var n,r,l,i,a,o,c=0,d=0,f=e.constructor,m=f.precision;if(Ze(e)>16)throw Error(Xc+Ze(e));if(!e.s)return new f(Ut);for(He=!1,o=m,a=new f(.03125);e.abs().gte(.1);)e=e.times(a),d+=5;for(r=Math.log(kr(2,d))/Math.LN10*2+5|0,o+=r,n=l=i=new f(Ut),f.precision=o;;){if(l=Ce(l.times(e),o),n=n.times(++c),a=i.plus($n(l,n,o)),En(a.d).slice(0,o)===En(i.d).slice(0,o)){for(;d--;)i=Ce(i.times(i),o);return f.precision=m,t==null?(He=!0,Ce(i,m)):i}i=a}}function Ze(e){for(var t=e.e*Pe,n=e.d[0];n>=10;n/=10)t++;return t}function Pa(e,t,n){if(t>e.LN10.sd())throw He=!0,n&&(e.precision=n),Error(nn+"LN10 precision limit exceeded");return Ce(new e(e.LN10),t)}function tr(e){for(var t="";e--;)t+="0";return t}function Nl(e,t){var n,r,l,i,a,o,c,d,f,m=1,x=10,b=e,j=b.d,S=b.constructor,O=S.precision;if(b.s<1)throw Error(nn+(b.s?"NaN":"-Infinity"));if(b.eq(Ut))return new S(0);if(t==null?(He=!1,d=O):d=t,b.eq(10))return t==null&&(He=!0),Pa(S,d);if(d+=x,S.precision=d,n=En(j),r=n.charAt(0),i=Ze(b),Math.abs(i)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)b=b.times(e),n=En(b.d),r=n.charAt(0),m++;i=Ze(b),r>1?(b=new S("0."+n),i++):b=new S(r+"."+n.slice(1))}else return c=Pa(S,d+2,O).times(i+""),b=Nl(new S(r+"."+n.slice(1)),d-x).plus(c),S.precision=O,t==null?(He=!0,Ce(b,O)):b;for(o=a=b=$n(b.minus(Ut),b.plus(Ut),d),f=Ce(b.times(b),d),l=3;;){if(a=Ce(a.times(f),d),c=o.plus($n(a,new S(l),d)),En(c.d).slice(0,d)===En(o.d).slice(0,d))return o=o.times(2),i!==0&&(o=o.plus(Pa(S,d+2,O).times(i+""))),o=$n(o,new S(m),d),S.precision=O,t==null?(He=!0,Ce(o,O)):o;o=c,l+=2}}function Au(e,t){var n,r,l;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(l=t.length;t.charCodeAt(l-1)===48;)--l;if(t=t.slice(r,l),t){if(l-=r,n=n-r-1,e.e=js(n/Pe),e.d=[],r=(n+1)%Pe,n<0&&(r+=Pe),r<l){for(r&&e.d.push(+t.slice(0,r)),l-=Pe;r<l;)e.d.push(+t.slice(r,r+=Pe));t=t.slice(r),r=Pe-t.length}else r-=l;for(;r--;)t+="0";if(e.d.push(+t),He&&(e.e>Bi||e.e<-Bi))throw Error(Xc+n)}else e.s=0,e.e=0,e.d=[0];return e}function Ce(e,t,n){var r,l,i,a,o,c,d,f,m=e.d;for(a=1,i=m[0];i>=10;i/=10)a++;if(r=t-a,r<0)r+=Pe,l=t,d=m[f=0];else{if(f=Math.ceil((r+1)/Pe),i=m.length,f>=i)return e;for(d=i=m[f],a=1;i>=10;i/=10)a++;r%=Pe,l=r-Pe+a}if(n!==void 0&&(i=kr(10,a-l-1),o=d/i%10|0,c=t<0||m[f+1]!==void 0||d%i,c=n<4?(o||c)&&(n==0||n==(e.s<0?3:2)):o>5||o==5&&(n==4||c||n==6&&(r>0?l>0?d/kr(10,a-l):0:m[f-1])%10&1||n==(e.s<0?8:7))),t<1||!m[0])return c?(i=Ze(e),m.length=1,t=t-i-1,m[0]=kr(10,(Pe-t%Pe)%Pe),e.e=js(-t/Pe)||0):(m.length=1,m[0]=e.e=e.s=0),e;if(r==0?(m.length=f,i=1,f--):(m.length=f+1,i=kr(10,Pe-r),m[f]=l>0?(d/kr(10,a-l)%kr(10,l)|0)*i:0),c)for(;;)if(f==0){(m[0]+=i)==it&&(m[0]=1,++e.e);break}else{if(m[f]+=i,m[f]!=it)break;m[f--]=0,i=1}for(r=m.length;m[--r]===0;)m.pop();if(He&&(e.e>Bi||e.e<-Bi))throw Error(Xc+Ze(e));return e}function Ip(e,t){var n,r,l,i,a,o,c,d,f,m,x=e.constructor,b=x.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new x(e),He?Ce(t,b):t;if(c=e.d,m=t.d,r=t.e,d=e.e,c=c.slice(),a=d-r,a){for(f=a<0,f?(n=c,a=-a,o=m.length):(n=m,r=d,o=c.length),l=Math.max(Math.ceil(b/Pe),o)+2,a>l&&(a=l,n.length=1),n.reverse(),l=a;l--;)n.push(0);n.reverse()}else{for(l=c.length,o=m.length,f=l<o,f&&(o=l),l=0;l<o;l++)if(c[l]!=m[l]){f=c[l]<m[l];break}a=0}for(f&&(n=c,c=m,m=n,t.s=-t.s),o=c.length,l=m.length-o;l>0;--l)c[o++]=0;for(l=m.length;l>a;){if(c[--l]<m[l]){for(i=l;i&&c[--i]===0;)c[i]=it-1;--c[i],c[l]+=it}c[l]-=m[l]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,He?Ce(t,b):t):new x(0)}function $r(e,t,n){var r,l=Ze(e),i=En(e.d),a=i.length;return t?(n&&(r=n-a)>0?i=i.charAt(0)+"."+i.slice(1)+tr(r):a>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(l<0?"e":"e+")+l):l<0?(i="0."+tr(-l-1)+i,n&&(r=n-a)>0&&(i+=tr(r))):l>=a?(i+=tr(l+1-a),n&&(r=n-l-1)>0&&(i=i+"."+tr(r))):((r=l+1)<a&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-a)>0&&(l+1===a&&(i+="."),i+=tr(r))),e.s<0?"-"+i:i}function Cu(e,t){if(e.length>t)return e.length=t,!0}function Rp(e){var t,n,r;function l(i){var a=this;if(!(a instanceof l))return new l(i);if(a.constructor=l,i instanceof l){a.s=i.s,a.e=i.e,a.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(_r+i);if(i>0)a.s=1;else if(i<0)i=-i,a.s=-1;else{a.s=0,a.e=0,a.d=[0];return}if(i===~~i&&i<1e7){a.e=0,a.d=[i];return}return Au(a,i.toString())}else if(typeof i!="string")throw Error(_r+i);if(i.charCodeAt(0)===45?(i=i.slice(1),a.s=-1):a.s=1,cy.test(i))Au(a,i);else throw Error(_r+i)}if(l.prototype=le,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=Rp,l.config=l.set=dy,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return l.config(e),l}function dy(e){if(!e||typeof e!="object")throw Error(nn+"Object expected");var t,n,r,l=["precision",1,Ss,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<l.length;t+=3)if((r=e[n=l[t]])!==void 0)if(js(r)===r&&r>=l[t+1]&&r<=l[t+2])this[n]=r;else throw Error(_r+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(_r+n+": "+r);return this}var qc=Rp(oy);Ut=new qc(1);const Ln=qc;Ln.set({precision:20,rounding:Ln.ROUND_HALF_UP});const mn=e=>new Ln(e??0),Pn=e=>e.toDecimalPlaces(2).toNumber(),uy=(e,t)=>{const n=mn(e),r=mn(t);return Pn(n.mul(r))},fy=(e,t)=>{const n=mn(e),r=mn(t).div(100);return Pn(n.mul(r))},my=(e,t)=>{const n=mn(e),r=mn(t);return Pn(n.add(r))},Oa=e=>{if(e.lineTotalAmount!=null)return mn(e.lineTotalAmount);const t=e.lineNetAmount!=null?e.lineNetAmount:uy(e.quantity??0,e.unitPrice??0),n=e.lineVatAmount!=null?e.lineVatAmount:fy(t,e.vatRate??0);return mn(my(t,n))},Tp=(e,t)=>{const n=t.reduce((b,j)=>b.add(Oa(j)),new Ln(0)),r=t.reduce((b,j)=>j.isIncludedInRequestedAmount===!1?b:b.add(Oa(j)),new Ln(0)),l=t.reduce((b,j)=>j.lineVatAmount==null?b:b.add(mn(j.lineVatAmount)),new Ln(0)),a=t.filter(b=>(b.kind==="ADJUSTMENT"||b.kind==="COMPENSATION")&&b.isIncludedInRequestedAmount===!1).reduce((b,j)=>b.add(Oa(j)),new Ln(0)),o=mn(e.deductibleAmount??0),c=mn(e.alreadyPaidAmount??0),d=o.add(c).add(a),f=r.sub(d),m=!!e.infoOnly,x=m?new Ln(0):Ln.max(f,0);return{grossExpensesTotal:Pn(n),includedExpensesTotal:Pn(r),vatTotal:Pn(l),adjustmentsTotal:Pn(d),amountBeforeInfoOnly:Pn(f),amountToRequest:Pn(x),infoOnlyApplied:m}},py=e=>{if(!e)return!1;const t=new Date(e);return Number.isNaN(t.getTime())?!1:t.getTime()>Date.now()},bn=e=>{const{messageHe:t,...n}=e;return t?{...n,messageHe:t}:{...n,messageHe:{MISSING_PROVIDER:"    .",MISSING_DESCRIPTION:"  .",INVALID_DATE_FUTURE:"     .",INVALID_QUANTITY:"     -0.",INVALID_UNIT_PRICE:"     .",INVALID_VAT_RATE:"     .",NEGATIVE_AMOUNT:"     .",MISSING_ATTACHMENT_REQUIRED:"      .",SHEET_STATUS_INVALID_FOR_READY:"     -READY_FOR_REPORT.",SHEET_STATUS_INVALID_FOR_ATTACH:"     .",SHEET_STATUS_INVALID_FOR_SEND:"    .",SUMS_INCONSISTENT:"     .",INFO_ONLY_INCONSISTENT:'  " "     0.',SNAPSHOT_HASH_MISMATCH:"-Hash        ."}[n.code]||"  ."}},hy=(e,t,n)=>{const r=n.filter(d=>d.severity==="ERROR").map(d=>d.code),l=n.filter(d=>d.severity==="WARNING").map(d=>d.code),i=!n.some(d=>d.code==="SUMS_INCONSISTENT"),a=!n.some(d=>d.code==="MISSING_ATTACHMENT_REQUIRED"&&d.severity==="ERROR"),o=!n.some(d=>["MISSING_PROVIDER","MISSING_DESCRIPTION"].includes(d.code)),c=!n.some(d=>d.code==="INFO_ONLY_INCONSISTENT");return{evaluatedAt:new Date().toISOString(),insurerId:e.insurerId||void 0,rulesetId:t==null?void 0:t.insurerId,rulesetVersion:t==null?void 0:t.rulesetVersion,checks:{sumsValid:i,attachmentsOk:a,requiredFieldsOk:o,infoOnlyConsistent:c},blockingIssueCodes:r,warningIssueCodes:l}},xy=e=>{const t=[];return e.kind==="EXPENSE"&&!e.providerName&&t.push(bn({code:"MISSING_PROVIDER",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),e.description||t.push(bn({code:"MISSING_DESCRIPTION",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),py(e.date)&&t.push(bn({code:"INVALID_DATE_FUTURE",severity:"WARNING",scope:"LINE_ITEM",entityId:e.id})),e.quantity!=null&&e.quantity<=0&&t.push(bn({code:"INVALID_QUANTITY",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),e.unitPrice!=null&&e.unitPrice<0&&t.push(bn({code:"INVALID_UNIT_PRICE",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),e.vatRate!=null&&e.vatRate<0&&t.push(bn({code:"INVALID_VAT_RATE",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),[e.lineNetAmount,e.lineVatAmount,e.lineTotalAmount].filter(r=>r!=null).some(r=>r<0)&&t.push(bn({code:"NEGATIVE_AMOUNT",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),t},gy=(e,t,n,r)=>{if(!r)return[];const l=[],i={};n.forEach(o=>{i[o.id]=o});const a=r.amountThresholdRequiringAttachment??null;return t.forEach(o=>{const c=o.isIncludedInRequestedAmount!==!1,d=!!(o.attachmentId&&i[o.attachmentId]),f=o.lineTotalAmount??0;let m=!1;if(r.policyFamily==="STRICT")c&&o.kind==="EXPENSE"&&(!a||f>=a)&&(m=!0);else if(r.policyFamily==="PARTIAL"){const x=!!o.expenseType&&r.requireAttachmentForExpenseTypes.includes(o.expenseType),b=!!a&&f>=a;c&&(x||b)&&(m=!0)}else r.policyFamily==="FLEXIBLE"&&c&&o.kind==="EXPENSE"&&(!a||f>=a)&&(m=!0);if(m&&!d){const x=r.policyFamily==="FLEXIBLE"?"WARNING":"ERROR";l.push(bn({code:"MISSING_ATTACHMENT_REQUIRED",severity:x,scope:"LINE_ITEM",entityId:o.id,messageHe:x==="ERROR"?"      .":"       ."}))}}),r.requiredAttachmentTypes.length>0&&l.push(bn({code:"ATTACHMENT_TYPES_NOT_ENFORCED",severity:"INFO",scope:"SHEET",messageHe:"     ,      ."})),e.infoOnly&&l.length&&r.policyFamily,l},yy=e=>{const{sheet:t,lineItems:n,attachments:r,ruleset:l}=e,i=[];n.forEach(c=>{i.push(...xy(c))});const a=Tp(t,n);t.infoOnly&&a.amountToRequest!==0&&i.push(bn({code:"INFO_ONLY_INCONSISTENT",severity:"ERROR",scope:"SHEET"})),i.push(...gy(t,n,r,l));const o=hy(t,l,i);return{issues:i,decisionLog:o}},Ny=e=>yy(e),vy={DRAFT:"",READY_FOR_REPORT:" ",ATTACHED_TO_REPORT:" ",ARCHIVED:""},by=({user:e,sheetWithRelations:t,onSheetUpdated:n,onBack:r})=>{const[l,i]=w.useState(t.sheet),[a,o]=w.useState(t.lineItems),[c,d]=w.useState(!1),[f,m]=w.useState([]),[x,b]=w.useState(t.attachments);w.useEffect(()=>{i(t.sheet),o(t.lineItems),b(t.attachments)},[t]);const j=w.useMemo(()=>Tp(l,a),[l,a]),S=w.useMemo(()=>{const A=new Set;return f.forEach(y=>{y.scope==="LINE_ITEM"&&y.entityId&&A.add(y.entityId)}),A},[f]),O=()=>{const A=Ny({sheet:l,lineItems:a,attachments:x,ruleset:void 0});m(A.issues)};w.useEffect(()=>{O()},[l,a]);const h=A=>{i(y=>({...y,...A}))},p=(A,y)=>{o($=>{const _=[...$];return _[A]={..._[A],...y,sheetId:l.id},_})},v=()=>{const A={id:`tmp-${Date.now()}`,sheetId:l.id,kind:"EXPENSE",expenseType:null,providerName:"",providerId:null,description:"",date:new Date().toISOString().slice(0,10),quantity:1,unitPrice:0,vatRate:17,isIncludedInRequestedAmount:!0,lineNetAmount:null,lineVatAmount:null,lineTotalAmount:null,attachmentId:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};o(y=>[...y,A])},E=A=>{const y=a[A];y&&(o($=>$.filter((_,R)=>R!==A)),y.id.startsWith("tmp-")||vn.deleteLineItem(e,l.id,y.id))},D=async A=>{const y=A.target.files;if(!(!y||!y.length)){for(let $=0;$<y.length;$++){const _=y[$],R=new FileReader,z=await new Promise((te,I)=>{R.onload=()=>te(String(R.result)),R.onerror=()=>I(R.error),R.readAsDataURL(_)}),U=await vn.addAttachment(e,l.id,{fileKey:z,originalFileName:_.name,mimeType:_.type||"application/octet-stream",sizeBytes:_.size});U&&b(te=>[...te,U])}A.target.value=""}},M=async(A,y)=>{const $=await vn.linkAttachmentToLineItem(e,l.id,y||"",y?A.id:null);$&&(b(_=>_.map(R=>R.id===$.id?$:R)),o(_=>_.map(R=>R.id===A.id?{...R,attachmentId:y||null}:R.id===A.attachmentId&&!y?{...R,attachmentId:null}:R)))},P=async()=>{d(!0);try{const A=await vn.updateSheetMeta(e,l.id,{insurerName:l.insurerName,periodLabel:l.periodLabel,deductibleAmount:l.deductibleAmount??0,alreadyPaidAmount:l.alreadyPaidAmount??0,infoOnly:l.infoOnly}),y=[];for(const _ of a)if(_.id.startsWith("tmp-")){const R=await vn.addLineItem(e,l.id,{kind:_.kind,expenseType:_.expenseType,providerName:_.providerName,providerId:_.providerId,description:_.description,date:_.date,quantity:_.quantity,unitPrice:_.unitPrice,vatRate:_.vatRate,isIncludedInRequestedAmount:_.isIncludedInRequestedAmount,lineNetAmount:_.lineNetAmount,lineVatAmount:_.lineVatAmount,lineTotalAmount:_.lineTotalAmount,attachmentId:_.attachmentId});R&&y.push(R)}else{const R=await vn.updateLineItem(e,l.id,_.id,{kind:_.kind,expenseType:_.expenseType,providerName:_.providerName,providerId:_.providerId,description:_.description,date:_.date,quantity:_.quantity,unitPrice:_.unitPrice,vatRate:_.vatRate,isIncludedInRequestedAmount:_.isIncludedInRequestedAmount,lineNetAmount:_.lineNetAmount,lineVatAmount:_.lineVatAmount,lineTotalAmount:_.lineTotalAmount,attachmentId:_.attachmentId});R&&y.push(R)}const $=await vn.getSheet(l.id)||{sheet:A||l,lineItems:y,attachments:[]};n($)}finally{d(!1)}},H=A=>S.has(A),ne=w.useMemo(()=>{const A=new Set;return a.forEach(y=>{y.providerName&&A.add(y.providerName)}),Array.from(A).sort((y,$)=>y.localeCompare($,"he-IL"))},[a]);return s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["  : ",s.jsx("span",{className:"font-mono",children:l.caseId})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[": ",s.jsx("span",{children:vy[l.status]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"button",className:"px-3 py-1 text-sm rounded border border-gray-300 text-gray-700 hover:bg-gray-50",onClick:r,children:" "}),s.jsx("button",{type:"button",className:"px-4 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",onClick:P,disabled:c,children:c?"":" "})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-white border rounded-lg p-4 shadow-sm",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:l.insurerName||"",onChange:A=>h({insurerName:A.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" / "}),s.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:l.periodLabel||"",onChange:A=>h({periodLabel:A.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1 text-sm",value:l.deductibleAmount??0,onChange:A=>h({deductibleAmount:Number(A.target.value)||0})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1 text-sm",value:l.alreadyPaidAmount??0,onChange:A=>h({alreadyPaidAmount:Number(A.target.value)||0})})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("input",{id:"infoOnly",type:"checkbox",checked:l.infoOnly,onChange:A=>h({infoOnly:A.target.checked})}),s.jsx("label",{htmlFor:"infoOnly",className:"text-sm text-gray-800",children:"   (  )"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:" "}),s.jsxs("div",{className:"font-semibold",children:[j.grossExpensesTotal.toLocaleString("he-IL")," "]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:" (  +  + )"}),s.jsxs("div",{className:"font-semibold",children:[j.adjustmentsTotal.toLocaleString("he-IL")," "]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:"   INFO_ONLY"}),s.jsxs("div",{className:"font-semibold",children:[j.amountBeforeInfoOnly.toLocaleString("he-IL")," "]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:" "}),s.jsxs("div",{className:"font-semibold text-blue-700",children:[j.amountToRequest.toLocaleString("he-IL")," "]})]}),j.infoOnlyApplied&&s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"INFO_ONLY    (  )"})]}),s.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm flex flex-col gap-2 text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"font-medium text-gray-900",children:""}),s.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer text-xs text-blue-700 hover:text-blue-800",children:[s.jsx("span",{className:"px-2 py-1 border border-blue-400 rounded bg-blue-50",children:" "}),s.jsx("input",{type:"file",className:"hidden",multiple:!0,onChange:D})]})]}),x.length===0?s.jsx("div",{className:"text-gray-500 text-xs",children:"    ."}):s.jsx("ul",{className:"divide-y divide-gray-100",children:x.map(A=>s.jsxs("li",{className:"py-1 flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-900 text-xs",children:A.originalFileName}),s.jsxs("span",{className:"text-gray-500 text-[11px]",children:[": ",A.sizeBytes!=null?`${(A.sizeBytes/1024).toFixed(1)} KB`:" ","  "," ",A.uploadedAt?new Date(A.uploadedAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"}):""]})]}),s.jsx("button",{type:"button",className:"text-xs text-blue-700 hover:underline",onClick:()=>{A.fileKey.startsWith("data:")&&window.open(A.fileKey,"_blank")},children:" / "})]},A.id))})]}),f.length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm",children:[s.jsx("div",{className:"font-semibold text-red-800 mb-1",children:"  :"}),s.jsx("ul",{className:"list-disc pr-5 space-y-0.5",children:f.map(A=>s.jsxs("li",{children:[s.jsxs("span",{className:"font-mono text-xs text-gray-500 ml-1",children:["[",A.severity,"]"]}),s.jsxs("span",{className:"text-red-900",children:[" ",A.messageHe]})]},`${A.code}-${A.scope}-${A.entityId||"sheet"}`))})]}),s.jsxs("div",{className:"bg-white border rounded-lg shadow-sm overflow-x-auto",children:[s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" "}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" %"}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" "}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" "}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b"})]})}),s.jsx("tbody",{children:a.map((A,y)=>{const $=H(A.id);return s.jsxs("tr",{className:$?"bg-red-50":y%2===0?"bg-white":"bg-gray-50",children:[s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsxs("select",{className:"border rounded px-1 py-0.5 text-xs",value:A.kind,onChange:_=>p(y,{kind:_.target.value}),children:[s.jsx("option",{value:"EXPENSE",children:""}),s.jsx("option",{value:"COMPENSATION",children:""}),s.jsx("option",{value:"ADJUSTMENT",children:""})]})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{list:"provider-suggestions",className:"border rounded px-1 py-0.5 w-32 text-xs",placeholder:" ",value:A.providerName||"",onChange:_=>p(y,{providerName:_.target.value})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{className:"border rounded px-1 py-0.5 w-64 text-xs",value:A.description,onChange:_=>p(y,{description:_.target.value})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"date",className:"border rounded px-1 py-0.5 text-xs",value:A.date||"",onChange:_=>p(y,{date:_.target.value||null})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"number",className:"border rounded px-1 py-0.5 w-20 text-xs",value:A.quantity??1,onChange:_=>p(y,{quantity:Number(_.target.value)||0})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"number",className:"border rounded px-1 py-0.5 w-24 text-xs",value:A.unitPrice??0,onChange:_=>p(y,{unitPrice:Number(_.target.value)||0})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"number",className:"border rounded px-1 py-0.5 w-16 text-xs",value:A.vatRate??0,onChange:_=>p(y,{vatRate:Number(_.target.value)||0})})}),s.jsx("td",{className:"px-2 py-1 border-b text-center",children:s.jsx("input",{type:"checkbox",checked:A.isIncludedInRequestedAmount!==!1,onChange:_=>p(y,{isIncludedInRequestedAmount:_.target.checked})})}),s.jsx("td",{className:"px-2 py-1 border-b text-left font-mono text-xs",children:A.lineTotalAmount!=null?A.lineTotalAmount.toLocaleString("he-IL"):""}),s.jsx("td",{className:"px-2 py-1 border-b text-right",children:s.jsxs("select",{className:"border rounded px-1 py-0.5 text-xs max-w-[180px]",value:A.attachmentId||"",onChange:_=>void M(A,_.target.value?_.target.value:null),children:[s.jsx("option",{value:"",children:A.attachmentId?" ":"  "}),x.map(_=>s.jsx("option",{value:_.id,children:_.originalFileName},_.id))]})}),s.jsx("td",{className:"px-2 py-1 border-b text-center",children:s.jsx("button",{type:"button",className:"text-xs text-red-600 hover:underline",onClick:()=>E(y),children:""})})]},A.id)})})]}),s.jsx("datalist",{id:"provider-suggestions",children:ne.map(A=>s.jsx("option",{value:A},A))}),s.jsx("div",{className:"p-2",children:s.jsx("button",{type:"button",className:"px-3 py-1 text-xs rounded border border-dashed border-gray-400 text-gray-700 hover:bg-gray-50",onClick:v,children:" "})})]})]})},wy={DRAFT:"",READY_FOR_REPORT:" ",ATTACHED_TO_REPORT:" ",ARCHIVED:""},Sy=({user:e,onLogout:t})=>{const[n,r]=w.useState([]),[l,i]=w.useState(!1),[a,o]=w.useState("ALL"),[c,d]=w.useState(""),[f,m]=w.useState(null),[x,b]=w.useState(null),j=async()=>{i(!0);try{const E=await vn.listSheets();r(E)}finally{i(!1)}};w.useEffect(()=>{j()},[]);const S=w.useMemo(()=>n.filter(E=>{if(a!=="ALL"&&E.status!==a)return!1;const D=c.trim().toLowerCase();return!(D&&!(E.insurerName||"").toLowerCase().includes(D))}),[n,a,c]),O=async E=>{const D=await vn.getSheet(E);D&&(m(E),b(D))},h=async()=>{const E=window.prompt("  / :")||"";if(!E.trim())return;const D=window.prompt(" ():")||"",M=await vn.createSheet(e,{caseId:E.trim(),insurerId:null,insurerName:D||null,periodLabel:"",versionIndex:1,currency:"ILS",deductibleAmount:0,alreadyPaidAmount:0,infoOnly:!1});await j(),await O(M.id)},p=E=>{b(E),r(D=>D.map(M=>M.id===E.sheet.id?E.sheet:M))},v=()=>{m(null),b(null)};return f&&x?s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:s.jsx(by,{user:e,sheetWithRelations:x,onSheetUpdated:p,onBack:v})}):s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:" "}),s.jsx("p",{className:"text-sm text-gray-600",children:"        ()."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"button",className:"px-3 py-1.5 text-sm rounded border border-gray-300 text-gray-700 hover:bg-gray-50",onClick:t,children:""}),s.jsx("button",{type:"button",className:"px-4 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700",onClick:h,children:"   "})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-3 mb-4 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"  "}),s.jsxs("select",{className:"border rounded px-2 py-1 text-sm",value:a,onChange:E=>o(E.target.value==="ALL"?"ALL":E.target.value),children:[s.jsx("option",{value:"ALL",children:""}),s.jsx("option",{value:"DRAFT",children:""}),s.jsx("option",{value:"READY_FOR_REPORT",children:" "}),s.jsx("option",{value:"ATTACHED_TO_REPORT",children:" "}),s.jsx("option",{value:"ARCHIVED",children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:""}),s.jsx("input",{className:"border rounded px-2 py-1 text-sm",placeholder:"   ",value:c,onChange:E=>d(E.target.value)})]})]}),s.jsx("div",{className:"bg-white border rounded-lg shadow-sm overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:" "}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:" "}),s.jsx("th",{className:"px-3 py-2 border-b"})]})}),s.jsxs("tbody",{children:[l&&s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-gray-500",children:" "})}),!l&&S.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:7,className:"px-3 py-4 text-center text-gray-500",children:"    ."})}),!l&&S.map(E=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-2 border-b font-mono text-xs text-gray-800",children:E.caseId}),s.jsx("td",{className:"px-3 py-2 border-b text-gray-800",children:E.insurerName||""}),s.jsxs("td",{className:"px-3 py-2 border-b text-gray-800",children:[" #",E.versionIndex]}),s.jsx("td",{className:"px-3 py-2 border-b",children:s.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full text-xs bg-gray-100 text-gray-700 border border-gray-200",children:wy[E.status]})}),s.jsx("td",{className:"px-3 py-2 border-b text-gray-700",children:E.updatedAt?new Date(E.updatedAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"}):""}),s.jsx("td",{className:"px-3 py-2 border-b text-blue-700 font-semibold",children:""}),s.jsx("td",{className:"px-3 py-2 border-b text-left",children:s.jsx("button",{type:"button",className:"px-3 py-1 text-xs rounded border border-blue-500 text-blue-700 hover:bg-blue-50",onClick:()=>void O(E.id),children:""})})]},E.id))]})]})})]})},jy=({folder:e,reports:t,onBack:n,onUpdateReTemplate:r,onCreateReportInCase:l,onOpenReport:i})=>{const[a,o]=w.useState(e.reTemplate||""),c=()=>{const m=a.trim();m!==e.reTemplate&&r(m)},d=t.filter(m=>m.odakanitNo&&m.odakanitNo.trim()===e.odakanitNo),f=w.useMemo(()=>{const m=[],x=(b,j,S)=>{if(!b)return;const O=new Date(b).getTime();if(!Number.isFinite(O))return;const h=new Date(b).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"});m.push({date:h,sortKey:O,icon:j,label:S})};return d.forEach(b=>{x(b.reportDate,""," ")}),e.sentReports.forEach(b=>{x(b.sentAt,""," ")}),m.sort((b,j)=>b.sortKey-j.sortKey)},[d,e.sentReports]);return s.jsx("div",{className:"min-h-screen bg-gray-100 px-0 pb-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl px-4 pt-4",children:[s.jsx("button",{type:"button",onClick:n,className:"mb-4 inline-flex items-center rounded-full bg-white px-3 py-1.5 text-xs font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:" Back to dashboard"}),s.jsxs("header",{className:"mb-4 rounded-2xl bg-white px-5 py-4 shadow-sm border border-gray-200",children:[s.jsxs("h1",{className:"text-xl font-serif font-bold text-lpBlue",children:["Case Folder  ",e.odakanitNo]}),s.jsx("p",{className:"mt-1 text-xs text-gray-600",children:"Central view for all reports and metadata in this case."})]}),s.jsxs("section",{className:"mb-4 grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Case Metadata"}),s.jsxs("dl",{className:"space-y-1 text-xs text-gray-700",children:[s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Insured"}),s.jsx("dd",{children:e.insuredName||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Plaintiff"}),s.jsx("dd",{children:e.plaintiffName||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Insurer"}),s.jsx("dd",{children:e.insurerName||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"UMR / Market Ref"}),s.jsx("dd",{children:e.marketRef||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Line Slip"}),s.jsx("dd",{children:e.lineSlipNo||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Certificate Ref"}),s.jsx("dd",{children:e.certificateRef||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Reports in case"}),s.jsx("dd",{children:e.reportIds.length})]})]})]}),s.jsxs("div",{className:"rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"RE Template"}),s.jsx("textarea",{className:"w-full rounded-lg border border-gray-300 p-2 text-xs text-gray-900 placeholder:text-gray-400 focus:border-lpBlue focus:outline-none focus:ring-1 focus:ring-lpBlue",rows:4,value:a,onChange:m=>o(m.target.value),onBlur:c,placeholder:"e.g. John Doe v. XYZ Medical Center  Claim Update"}),s.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"This subject line will be used as the default RE for new reports in this case."})]})]}),s.jsxs("section",{className:"mb-4 rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Timeline"}),f.length===0?s.jsx("p",{className:"text-xs text-gray-400",children:"No activity recorded for this case yet."}):s.jsx("ol",{className:"border-r border-gray-200 pr-3 text-xs text-gray-700 space-y-2",children:f.map((m,x)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"ml-1",children:m.icon}),s.jsxs("span",{children:[m.date,"  ",m.label]})]},`${m.sortKey}-${x}`))})]}),s.jsxs("section",{className:"mb-4 rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"mb-3 flex items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Previously sent reports"}),s.jsx("p",{className:"text-xs text-gray-500",children:"History of reports that were marked as SENT in this case."})]}),s.jsx("button",{type:"button",onClick:l,className:"inline-flex items-center rounded-full bg-lpBlue px-4 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:"Create new report in this case"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-xs text-left text-gray-700",children:[s.jsx("thead",{className:"bg-gray-50 text-[11px] uppercase tracking-wide text-gray-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2",children:"Report #"}),s.jsx("th",{className:"px-3 py-2",children:"Sent at"}),s.jsx("th",{className:"px-3 py-2",children:"File name"}),s.jsx("th",{className:"px-3 py-2",children:"Actions"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-100",children:[e.sentReports.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-gray-400",children:"No sent reports recorded for this case yet."})}),e.sentReports.map(m=>{const x=m.sentAt?new Date(m.sentAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return s.jsxs("tr",{children:[s.jsx("td",{className:"px-3 py-2",children:m.reportNo?`#${m.reportNo}`:""}),s.jsx("td",{className:"px-3 py-2",children:x}),s.jsx("td",{className:"px-3 py-2",children:m.fileName||""}),s.jsx("td",{className:"px-3 py-2",children:s.jsx("button",{type:"button",onClick:()=>i(m.reportId),className:"inline-flex items-center rounded-full bg-white px-3 py-1 text-[11px] font-semibold text-lpBlue ring-1 ring-lpBlue hover:bg-blue-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":`Open report ${m.reportId}`,children:"Open"})})]},`${m.reportId}-${m.sentAt}`)})]})]})})]}),s.jsxs("section",{className:"rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"All reports in this case"}),s.jsxs("ul",{className:"space-y-1 text-xs text-gray-700",children:[d.length===0&&s.jsx("li",{className:"text-gray-400",children:"No reports are currently linked to this case."}),d.map(m=>s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[m.reportDate?new Date(m.reportDate).toLocaleDateString("en-GB"):""," "," ",m.status," "," ",m.reportSubject||"No subject"]}),s.jsx("button",{type:"button",onClick:()=>i(m.id),className:"inline-flex items-center rounded-full bg-gray-100 px-3 py-0.5 text-[11px] font-semibold text-gray-700 hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:"Open"})]},m.id))]})]})]})})},Ap="lp_case_folders",Cp="lp_case_folders_migrated",Ey=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(Ap),t=e?JSON.parse(e):{};return!t||typeof t!="object"?{}:t}catch(e){return console.error("Failed to load case folders",e),{}}},Ms=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(Ap,JSON.stringify(e))}catch(t){console.error("Failed to persist case folders",t)}},Bo=(e,t,n)=>{if(!t.odakanitNo)return e;const r=t.odakanitNo.trim();if(!r)return e;const l=n||new Date().toISOString(),i=e[r],a=i||{odakanitNo:r,reTemplate:"",insuredName:"",insurerName:"",plaintiffName:"",marketRef:"",lineSlipNo:"",certificateRef:"",createdAt:(i==null?void 0:i.createdAt)||l,updatedAt:(i==null?void 0:i.updatedAt)||l,reportIds:[],sentReports:(i==null?void 0:i.sentReports)||[]},o={...a,insuredName:t.insuredName||a.insuredName,insurerName:t.insurerName||a.insurerName,plaintiffName:t.plaintiffName||a.plaintiffName,marketRef:t.marketRef||a.marketRef,lineSlipNo:t.lineSlipNo||a.lineSlipNo,certificateRef:t.certificateRef||a.certificateRef,updatedAt:l,reportIds:a.reportIds.includes(t.id)?a.reportIds:[...a.reportIds,t.id],sentReports:a.sentReports},c=(t.reportSubject||"").trim();return c&&(!a.reTemplate||c!==a.reTemplate)&&(o.reTemplate=c),{...e,[r]:o}},Dp=(e,t,n,r,l)=>{var x;if(!t.odakanitNo)return e;const i=t.odakanitNo.trim();if(!i)return e;const a=n||new Date().toISOString(),o=e[i];if(!o)return e;const c=(((x=t.reportHistory)==null?void 0:x.length)||0)+1,d={id:t.id,odakanitNo:t.odakanitNo,insuredName:t.insuredName,plaintiffName:t.plaintiffName,insurerName:t.insurerName,marketRef:t.marketRef,lineSlipNo:t.lineSlipNo,certificateRef:t.certificateRef,reportDate:t.reportDate,status:"SENT",reportSubject:t.reportSubject},f={reportId:t.id,sentAt:a,reportNo:c,fileName:r,snapshot:d,isResend:!!l,resendIndex:c},m={...o,updatedAt:a,sentReports:[...o.sentReports,f]};return{...e,[i]:m}},ky=(e,t)=>{let n={...e};return t.forEach(r=>{if(r.odakanitNo&&(n=Bo(n,r,r.updatedAt||r.reportDate),r.status==="SENT")){const l=r.sentAt||r.reportDate||new Date().toISOString();n=Dp(n,r,l)}}),n},Iy=()=>{if(!(typeof window>"u"))try{window.localStorage.setItem(Cp,"1")}catch{}},Ry=()=>{if(typeof window>"u")return!0;try{return window.localStorage.getItem(Cp)==="1"}catch{return!0}},Ty=async e=>{if(!e||!e.trim())return"";try{const t=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!t.ok)throw new Error(`Server error: ${t.statusText}`);return(await t.json()).translation||""}catch(t){return console.error("Translation error:",t),"Error translation."}},Ay=async(e,t)=>{try{const n=await fetch("/api/extract-policy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:e,mimeType:t})});if(!n.ok)throw new Error("Server error");return await n.json()}catch(n){return console.error(n),{}}},Cy=async e=>{try{const t=await fetch("/api/refine-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!t.ok)throw new Error("Refinement failed");return(await t.json()).refined||e}catch(t){return console.error(t),e}},Dy=async(e,t,n="CLAIM",r)=>{try{const l=await fetch("/api/analyze-medical-complaint",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileBase64:e,mimeType:t,analysisType:n,expertCountMode:r==null?void 0:r.expertCountMode,partyRole:r==null?void 0:r.partyRole,sectionKey:r==null?void 0:r.sectionKey,plaintiffName:r==null?void 0:r.plaintiffName,insuredName:r==null?void 0:r.insuredName,insurerName:r==null?void 0:r.insurerName,reportSubject:r==null?void 0:r.reportSubject})});if(!l.ok)throw new Error("Medical analysis failed");return await l.json()}catch(l){throw console.error("Medical complaint analysis error:",l),l}},_y=async(e,t)=>{try{const n=await fetch("/api/extract-expenses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileBase64:e,mimeType:t})});if(!n.ok)throw new Error("Expenses extraction failed");return await n.json()}catch(n){return console.error(n),{items:[]}}},Ly=async e=>{try{const t=await fetch("/api/help-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!t.ok)throw new Error("Chat failed");return(await t.json()).answer||"Sorry, I could not answer that."}catch(t){return console.error(t),"System error. Please try again."}},Du=async e=>{try{if(!(await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Email failed");return!0}catch(t){return console.error(t),!1}},Ma=async e=>{try{const t=await fetch("/api/render-report-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report:e})});if(!t.ok)throw new Error("PDF rendering failed");return await t.blob()}catch(t){throw console.error("PDF render error:",t),t}},Py={title:"Final Preview",toggleHide:"Hide Preview",toggleShow:"Show Preview",downloadPdf:"Download PDF",editFileNames:"Edit file name titles",finalize:"Finalize & Close",backToEditing:"Back to Editing",backToStep2:"Back to Step 2",backToDashboard:"Back to dashboard",helperScroll:"Scroll to review entire document",collapsedHint:'Click "Show Preview" to review the document before sending.'},Oy={title:" ",toggleHide:" ",toggleShow:" ",downloadPdf:" PDF",editFileNames:"  ",finalize:" ",backToEditing:" ",backToStep2:"  2",backToDashboard:"  ",helperScroll:"    ",collapsedHint:'  " "     .'},My=e=>e==="LAWYER"?Oy:Py,Fy=({message:e,type:t,onClose:n})=>s.jsxs("div",{className:`fixed top-4 right-4 z-[100] p-4 rounded-lg shadow-xl border-l-4 flex items-center gap-3 animate-slide-in bg-white ${t==="success"?"border-green-500 text-green-800":t==="error"?"border-red-500 text-red-800":"border-blue-500 text-blue-800"}`,children:[s.jsx("span",{children:e}),s.jsx("button",{onClick:n,className:"hover:bg-gray-100 p-1 rounded",children:s.jsx(Mt,{className:"w-4 h-4"})})]}),_u=({value:e,onChange:t,placeholder:n,disabled:r,dir:l="ltr",className:i,style:a={}})=>{const o=w.useRef(null);return w.useEffect(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=o.current.scrollHeight+"px")},[e]),s.jsx(gl,{clientId:yl,children:s.jsx("textarea",{ref:o,className:i,dir:l,value:e,onChange:t,placeholder:n,disabled:r,rows:3,style:{...a,overflow:"hidden",resize:"none"}})})},By=({onClose:e})=>{const[t,n]=w.useState("MANUAL"),[r,l]=w.useState(""),[i,a]=w.useState([]),[o,c]=w.useState(!1),d=async()=>{if(!r.trim())return;c(!0);const f=await Ly(r);a(m=>[...m,{q:r,a:f}]),l(""),c(!1)};return s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[200] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white w-full max-w-3xl h-[600px] rounded-xl shadow-2xl flex flex-col overflow-hidden animate-scale-in",children:[s.jsxs("div",{className:"bg-lpBlue p-4 text-white flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Fc,{className:"w-6 h-6"}),s.jsx("h2",{className:"font-bold text-lg",children:"  "})]}),s.jsx("button",{onClick:e,className:"hover:bg-white/20 rounded p-1",children:s.jsx(Mt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex border-b",children:[s.jsx("button",{onClick:()=>n("MANUAL"),className:`flex-1 p-3 font-bold ${t==="MANUAL"?"text-lpBlue border-b-2 border-lpBlue":"text-gray-500"}`,children:" "}),s.jsx("button",{onClick:()=>n("CHAT"),className:`flex-1 p-3 font-bold ${t==="CHAT"?"text-lpBlue border-b-2 border-lpBlue":"text-gray-500"}`,children:"   "})]}),s.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-50",dir:"rtl",children:t==="MANUAL"?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:["   ",s.jsx(dn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:"1.       (CRM / Finance /    )."}),s.jsx("p",{children:"2.       +  Notifications   ."}),s.jsx("p",{children:`3.  ""     ' .`})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:['    " ',s.jsx(dn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsxs("p",{children:["1.   ",s.jsx("strong",{children:"Open New Case Folder"}),",      ."]}),s.jsx("p",{children:"2.  ,   4  (Word/PDF)    ."}),s.jsx("p",{children:"3.   FINANCE FINALIZE     ."})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:["   ",s.jsx(dn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:'   View Worksheet  , ,   " .'}),s.jsx("p",{children:" /     ( ADD),    ."}),s.jsx("p",{children:'  ,      "     Expenses.'})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:["    ",s.jsx(dn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:"  Manage Favorite Providers     ."}),s.jsx("p",{children:"        ."}),s.jsx("p",{children:'    4   (PDF/Word)  "    .'})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:[' "     ',s.jsx(dn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:"       -FINANCE   FINALIZE."}),s.jsx("p",{children:' FINALIZE  "     (READY TO SEND)   .'}),s.jsx("p",{children:"     (48   , 30   )     ."})]})]})]}):s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex-1 space-y-4 mb-4 overflow-auto",children:[i.length===0&&s.jsx("div",{className:"text-center text-gray-400 mt-10",children:"     !"}),i.map((f,m)=>s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"bg-blue-100 text-blue-900 p-2 rounded-lg rounded-tr-none self-end w-fit ml-auto max-w-[80%]",children:f.q}),s.jsx("div",{className:"bg-white border text-gray-800 p-2 rounded-lg rounded-tl-none self-start w-fit mr-auto max-w-[80%]",children:f.a})]},m))]}),s.jsxs("div",{className:"flex gap-2",dir:"ltr",children:[s.jsx("input",{className:"flex-1 border p-2 rounded",placeholder:"/   ...",value:r,onChange:f=>l(f.target.value),onKeyDown:f=>f.key==="Enter"&&d()}),s.jsx("button",{onClick:d,disabled:o,className:"bg-lpBlue text-white px-4 rounded hover:bg-blue-800",children:o?s.jsx(jn,{className:"w-5 h-5 animate-spin"}):s.jsx(Oi,{className:"w-5 h-5"})})]})]})})]})})},$y=({reports:e,currentUser:t,onMarkPaid:n})=>{const r=e.filter(a=>a.expensesSum&&!a.isPaid),l=r.reduce((a,o)=>{var d;const c=parseFloat(((d=o.expensesSum)==null?void 0:d.replace(/,/g,""))||"0");return a+(isNaN(c)?0:c)},0),i=t.role==="SUB_ADMIN";return r.length?s.jsxs("div",{className:"mb-8 bg-white rounded-xl shadow-sm border border-indigo-100 overflow-hidden",children:[s.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-800 p-4 text-white flex justify-between items-center",children:[s.jsxs("h3",{className:"font-bold text-lg flex items-center",children:[s.jsx(R0,{className:"w-6 h-6 mr-2"})," Financial Control - Outstanding Expenses"]}),s.jsxs("div",{className:"text-xl font-bold bg-white/20 px-4 py-1 rounded",children:["Total: ",l.toLocaleString()]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left text-sm",children:[s.jsx("thead",{className:"bg-indigo-50 text-indigo-800",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Report Date"}),s.jsx("th",{className:"p-3",children:"Insured / File"}),s.jsx("th",{className:"p-3",children:"Amount Requested"}),s.jsx("th",{className:"p-3",children:"Action"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:r.map(a=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"p-3",children:new Date(a.reportDate).toLocaleDateString()}),s.jsxs("td",{className:"p-3 font-medium",children:[a.insuredName," (",a.marketRef,")"]}),s.jsxs("td",{className:"p-3 font-bold text-indigo-700",children:["",a.expensesSum]}),s.jsx("td",{className:"p-3",children:i?s.jsx("button",{onClick:()=>n(a.id),className:"text-red-400 hover:text-red-600 hover:bg-red-50 p-1.5 rounded transition",title:"Mark as Paid",children:s.jsx(Sn,{className:"w-4 h-4"})}):s.jsx("span",{className:"text-gray-400 cursor-not-allowed",children:s.jsx(Sn,{className:"w-4 h-4"})})})]},a.id))})]})})]}):null},Uy=[{id:"statement_of_claim",name:"Statement of Claim",src:new URL("/assets/statement%20of%20claim-BbEIHM0L.jpg",import.meta.url).href},{id:"statement_of_defence",name:"Statement of Defence",src:new URL("/assets/statement%20of%20defence-BIigMwUC.jpg",import.meta.url).href},{id:"preliminary",name:"Preliminary Proceedings",src:new URL("/assets/preliminary%20proceedings-BoY9iCcP.jpg",import.meta.url).href},{id:"evidence_submission",name:"Evidence Submission",src:new URL("/assets/evidence%20submission-CZIKo1E1.jpg",import.meta.url).href},{id:"evidentiary",name:"Evidentiary Hearing",src:new URL("/assets/evidentiary%20hearing-BibkA_Ru.jpg",import.meta.url).href},{id:"summaries",name:"Summaries",src:new URL("/assets/summaries-BEUvavav.jpg",import.meta.url).href},{id:"judgment",name:"Judgment",src:new URL("/assets/judgment-cIMuyU1R.jpg",import.meta.url).href}],kn=[{value:"EXPERT_OUR",label:"Expert fees on our behalf",type:"EXPENSE"},{value:"EXPERT_COURT",label:"Expert fees on behalf of the court",type:"EXPENSE"},{value:"INVESTIGATION",label:"Private Investigation fees",type:"EXPENSE"},{value:"SECONDARY_FEE",label:"Payment of secondary procedure fee",type:"EXPENSE"},{value:"COURT_FEES",label:"Court fees",type:"EXPENSE"},{value:"PHOTOCOPY",label:"Photocopying and binding of documents",type:"EXPENSE"},{value:"MEDICAL_RECORDS",label:"Medical Records Collection",type:"EXPENSE"},{value:"ATTORNEY_PHASE_1",label:"Attorney fees for phase 1",type:"EXPENSE"},{value:"ATTORNEY_PHASE_2",label:"Attorney fees for phase 2",type:"EXPENSE"},{value:"ATTORNEY_PHASE_3",label:"Attorney fees for phase 3",type:"EXPENSE"},{value:"ATTORNEY_PHASE_4",label:"Attorney fees for phase 4",type:"EXPENSE"},{value:"ATTORNEY_PHASE_5",label:"Attorney fees for phase 5",type:"EXPENSE"},{value:"ATTORNEY_EXTRA_HEARING",label:"Attorney fees for extra court hearing",type:"EXPENSE"},{value:"ATTORNEY_THIRD_PARTY",label:"Attorney fees for third party notice",type:"EXPENSE"},{value:"OTHER",label:"Other",type:"EXPENSE"},{value:"COMPENSATION_JUDGMENT",label:"Compensation by Judgment",type:"ADJUSTMENT"},{value:"COMPENSATION_SETTLEMENT",label:"Compensation under Settlement",type:"ADJUSTMENT"},{value:"DEDUCTIBLE",label:"Deductible paid by the insured",type:"ADJUSTMENT"},{value:"PAID_BY_INSURER",label:"Expenses already paid by the insurer",type:"ADJUSTMENT"}],nr=()=>({status:"DRAFT",rows:[],history:[],notes:[],favorites:[],totals:{totalExpenses:0,totalAdjustments:0,totalBalance:0}}),Hy=1e3*60*60*48,_p=1e3*60*60*24*30,Lp=7*24*60*60*1e3,Lu={lineSlip:"UNIQUE MARKET REF",certificate:"CERTIFICATE REF"},Ke={REPORTS:"lp_reports",USER:"lp_current_user",VIEW:"lp_view",CURRENT_REPORT:"lp_current_report",CASE_FOLDERS:"lp_case_folders"},Pp=()=>{},Pu=(e,t,n)=>{if(!e)return e;let r=!1;const l={...e};if(l.content&&t.forEach(i=>{var o;const a=(o=l.content)==null?void 0:o[i];a!==void 0&&(l.content={...l.content},!l.content[n]&&a&&(l.content[n]=a),delete l.content[i],r=!0)}),l.translatedContent&&t.forEach(i=>{var o;const a=(o=l.translatedContent)==null?void 0:o[i];a!==void 0&&(l.translatedContent={...l.translatedContent},!l.translatedContent[n]&&a&&(l.translatedContent[n]=a),delete l.translatedContent[i],r=!0)}),Array.isArray(l.selectedSections)&&l.selectedSections.some(a=>t.includes(a))){const a=l.selectedSections.map(o=>t.includes(o)?n:o);l.selectedSections=Array.from(new Set(a)),r=!0}return l.expertSummaryMode&&t.forEach(i=>{var o;const a=(o=l.expertSummaryMode)==null?void 0:o[i];a&&(l.expertSummaryMode={...l.expertSummaryMode,[n]:a},delete l.expertSummaryMode[i],r=!0)}),r?l:e},Wy=e=>{let t=Pu(e,lp,Fn);return t=Pu(t,ip,ws),t},zy=e=>{const t={...e};return t.reportReview||(t.reportReview={status:"DRAFT",issues:[]}),t.hebrewWorkflowStatus||(t.hebrewWorkflowStatus="HEBREW_DRAFT"),Array.isArray(t.reportReview.issues)&&t.reportReview.issues.length>0&&(t.reportReview={...t.reportReview,issues:t.reportReview.issues.map(n=>{const r=n.origin??"INTERNAL";let l=n.externalAction;return r==="EXTERNAL"&&!l&&(l="ENGLISH_ONLY"),{...n,origin:r,externalAction:l}})}),t},Vy=()=>{if(typeof window>"u")return[];try{Pp();const e=localStorage.getItem(Ke.REPORTS);return(e?JSON.parse(e):[]).map(Wy).map(zy)}catch(e){return console.error("Failed to load stored reports",e),[]}},Gy=()=>{if(typeof window>"u")return null;try{Pp();const e=localStorage.getItem(Ke.USER);return e&&Dr.find(t=>t.username===e)||null}catch(e){return console.error("Failed to load stored user",e),null}},Ky=()=>{if(typeof window>"u")return"DASHBOARD";const e=localStorage.getItem(Ke.VIEW);return e&&(e==="STEP1"||e==="STEP2"||e==="PREVIEW"||e==="DASHBOARD"||e==="CASE_FOLDER")?e:"DASHBOARD"},$i=e=>{const t=e.filter(r=>r.type==="EXPENSE").reduce((r,l)=>r+(l.amount||0),0),n=e.filter(r=>r.type==="ADJUSTMENT").reduce((r,l)=>r+(l.amount||0),0);return{totalExpenses:t,totalAdjustments:n,totalBalance:t-n}},Ou=e=>{var t,n;if((t=e.expenseWorksheet)!=null&&t.totals)return e.expenseWorksheet.totals.totalBalance;if(e.expensesSum){const r=parseFloat(e.expensesSum.replace(/,/g,""));if(!isNaN(r))return r}return(n=e.expensesItems)!=null&&n.length?e.expensesItems.reduce((r,l)=>r+(l.amount||0),0):0},Mu=e=>{var t,n,r;return(((n=(t=e.expenseWorksheet)==null?void 0:t.rows)==null?void 0:n.length)??0)>0||(((r=e.expensesItems)==null?void 0:r.length)??0)>0||!!(e.expensesSum&&e.expensesSum!=="0")},Qt=()=>Math.random().toString(36).slice(2,10),Gr=e=>e==null?e:JSON.parse(JSON.stringify(e)),Fu=e=>new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>{const l=r.result,i=l.includes(",")?l.split(",")[1]:l;t(i)},r.onerror=()=>n(new Error("Failed to convert blob")),r.readAsDataURL(e)}),Op=e=>e?e.replace(/\r\n/g,`
`).replace(/\t/g," ").split(`
`).map(r=>r.replace(/\s+$/g,"").replace(/ {2,}/g," ")).join(`
`).trim().replace(/\n{3,}/g,`

`):"",Fa=e=>{const t=e||{};return Object.keys(t).reduce((n,r)=>(n[r]=Op(t[r]),n),{})},Yy=`
               . ,   ,          .

          , ,  ,            .

      -  ,     .

   ,     ,                .

      .
`.trim(),Qy=["The policy period is from [policyStartDate] to [policyEndDate].","","The retroactive date is [retroactiveDate].","","    _______________, ,   .","","      ,     ____________  ____________.","",",         ."].join(`
`),Mp=(e,t,n,r,l)=>{const i=Qy,a=E=>`${E}`,o=t||"",c=n||"",d=r||l||"",f=a(`The policy period is from ${o} to ${c}.`),m=a(`The retroactive date is ${d}.`),x=["    _______________, ,   .","","      ,     ____________  ____________.","",",         ."].join(`
`),b=E=>E.replace(/\[policyStartDate\]/gi,o).replace(/\[policyEndDate\]/gi,c).replace(/\[retroactiveDate\]/gi,d),j=`${f}

${m}

${x}`,S=i?b(i):"";if(!S&&!e)return j;let h=e&&e.trim().length?e:S||j;(/\[policyStartDate\]/i.test(h)||/\[policyEndDate\]/i.test(h)||/\[retroactiveDate\]/i.test(h))&&(h=b(h));const p=/The policy period is[^\n]*/i;p.test(h)?h=h.replace(p,f):(!e||!e.trim())&&(h=`${f}

${h}`);const v=/The retroactive date is[^\n]*/i;return v.test(h)?h=h.replace(v,m):(!e||!e.trim())&&(h=h.includes(f)?h.replace(f,`${f}

${m}`):`${m}

${h}`),h.includes("   ")||(h=`${h.trim()}

${x}`),h},$o=(e,t)=>e.map(n=>{var a;const r=kn.find(o=>o.value===n.category),l=(r==null?void 0:r.type)||"EXPENSE",i=n.category==="OTHER"?((a=n.customLabel)==null?void 0:a.trim())||"Other expense":(r==null?void 0:r.label)||"Expense";return{id:n.id||Qt(),type:l,category:n.category,label:i,serviceProvider:l==="EXPENSE"?n.serviceProvider:void 0,amount:Number(n.amount)||0,locked:!1,createdBy:t==null?void 0:t.id,createdAt:new Date().toISOString(),updatedBy:t==null?void 0:t.id,updatedAt:new Date().toISOString()}}),Xy=e=>e.filter(t=>t.type==="EXPENSE").map(t=>({id:t.id,date:new Date().toISOString().split("T")[0],description:`${t.label}${t.serviceProvider?` (${t.serviceProvider})`:""}`,amount:t.amount,currency:"NIS"})),qy=({data:e,updateData:t,onNext:n,currentUser:r,timelineGallery:l,onAddTimelineImages:i,onRemoveTimelineImage:a,onSaveAndExit:o})=>{const[c,d]=w.useState(""),[f,m]=w.useState(!1),x=e.insurerName===""||Nu.includes(e.insurerName),[b,j]=w.useState(!x),[S,O]=w.useState(!1),[h,p]=w.useState(!1);w.useRef(null);const v=R=>R?new Date(R).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],E=R=>R.trim().replace(/\s+/g," "),D=R=>{const z=e,U="plaintiffName"in R?R.plaintiffName??z.plaintiffName:z.plaintiffName,te="insuredName"in R?R.insuredName??z.insuredName:z.insuredName;if(!(!!U&&!!te))return R;const K=E(U),q=E(te),F=`${K} v. ${q}`,Z="reportSubject"in R?R.reportSubject??z.reportSubject:z.reportSubject,Ie="isSubjectAuto"in R?R.isSubjectAuto??z.isSubjectAuto:z.isSubjectAuto;return!Z||!Z.trim()||Ie?{...R,reportSubject:F,isSubjectAuto:!0}:R},M=R=>{R==="OTHER"?(j(!0),t(D({insurerName:""}))):(j(!1),t(D({insurerName:R})))},P=R=>{e.selectedSections.includes(R)||t({selectedSections:[...e.selectedSections,R]}),m(!1)},H=R=>{R!=="Update"&&t({selectedSections:e.selectedSections.filter(z=>z!==R)})},ne=()=>{c.trim()&&!e.selectedSections.includes(c)&&(t({selectedSections:[...e.selectedSections,c]}),d(""))},A=(R,z)=>{const U=z==="UP"?R-1:R+1;if(U<0||U>=e.selectedSections.length)return;const te=[...e.selectedSections];[te[R],te[U]]=[te[U],te[R]],t({selectedSections:te})},y=R=>{t({selectedTimeline:R.id,selectedTimelineImage:R.src}),l.some(z=>z.name===R.name)||i([{name:R.name,src:R.src}])},$=async R=>{var U;const z=(U=R.target.files)==null?void 0:U[0];if(z){O(!0);try{const te=new FileReader;te.onload=async()=>{var Z;const I=te.result.split(",")[1],K=await Ay(I,z.type);let q={};K.insuredName&&(q=D({...q,insuredName:K.insuredName})),K.marketRef?(q.marketRef=K.marketRef,q.lineSlipNo=K.marketRef):K.lineSlipNo&&!q.lineSlipNo&&(q.lineSlipNo=K.lineSlipNo),K.certificateRef&&(q.certificateRef=K.certificateRef),typeof K.policyPeriodStart=="string"&&(q.policyPeriodStart=K.policyPeriodStart),typeof K.policyPeriodEnd=="string"&&(q.policyPeriodEnd=K.policyPeriodEnd),typeof K.retroStart=="string"&&(q.retroStart=K.retroStart),typeof K.retroEnd=="string"&&(q.retroEnd=K.retroEnd),q.policyFile={id:"policy-doc",name:z.name,data:I,type:z.type};const F=Mp((Z=e.content)==null?void 0:Z["Insurance Coverage"],q.policyPeriodStart||e.policyPeriodStart,q.policyPeriodEnd||e.policyPeriodEnd,q.retroStart||e.retroStart,q.retroEnd||e.retroEnd);F&&(q.content={...e.content,"Insurance Coverage":F}),t(q),O(!1)},te.readAsDataURL(z)}catch(te){console.error("Error reading file",te),O(!1)}}},_=(R,z,U)=>s.jsxs("div",{className:"relative group",children:[s.jsx("input",{className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-lpBlue outline-none pr-8",placeholder:U,value:R,onChange:te=>z(te.target.value)}),R&&s.jsx("button",{onClick:()=>z(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-500 transition-colors",children:s.jsx(Sn,{className:"w-4 h-4"})})]});return s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:o,className:"flex items-center text-sm text-lpBlue hover:text-blue-900 bg-blue-50 px-3 py-1.5 rounded-full",children:[s.jsx(Bc,{className:"w-4 h-4 mr-1"}),"  "]})}),s.jsx("h2",{className:"text-3xl font-bold text-lpBlue font-serif border-b pb-2",children:"1. Case Setup & Structure"}),e.odakanitNo&&s.jsx("div",{className:"bg-indigo-50 border-l-4 border-indigo-600 p-4 mb-6",children:s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-indigo-900 flex items-center",children:[s.jsx(Mc,{className:"w-5 h-5 mr-2"})," Odakanit Case #",e.odakanitNo]}),s.jsx("p",{className:"text-sm text-indigo-700",children:"This report folder was initiated by Finance."})]})})}),s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-lpGold"}),s.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 flex items-center",children:[s.jsx(Br,{className:"w-5 h-5 mr-2 text-lpGold"}),"Re: Case Details (Mandatory Fields - English)"]}),s.jsx("div",{className:"mb-6 bg-blue-50 border-2 border-dashed border-blue-200 rounded-lg p-4 text-center relative group",children:S?s.jsxs("div",{className:"flex flex-col items-center justify-center py-2",children:[s.jsx(jn,{className:"w-8 h-8 text-lpBlue animate-spin mb-2"}),s.jsx("span",{className:"text-sm font-bold text-lpBlue",children:"Analyzing Policy Document..."})]}):s.jsx(s.Fragment,{children:e.policyFile?s.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsxs("div",{className:"flex flex-col items-center text-green-700 font-bold text-center",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Jm,{className:"w-6 h-6 mr-2"}),"Policy Document Attached"]}),s.jsxs("span",{className:"text-xs font-normal text-green-800",children:["Original file: ",e.policyFile.name]})]}),s.jsx("button",{className:"text-xs text-red-500 hover:underline",onClick:()=>t({policyFile:void 0}),children:"Remove"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-700 bg-white/70 px-3 py-1 rounded-full border border-gray-200",children:[s.jsx("input",{id:"attach-policy-appendix",type:"checkbox",className:"h-3 w-3 accent-lpBlue",checked:e.attachPolicyAsAppendix??!0,onChange:R=>t({attachPolicyAsAppendix:R.target.checked})}),s.jsx("label",{htmlFor:"attach-policy-appendix",className:"cursor-pointer",children:"Attach policy as Appendix A to final PDF"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col items-center justify-center cursor-pointer text-center px-4",children:[s.jsx(Mi,{className:"w-8 h-8 text-lpBlue mb-2 group-hover:scale-110 transition-transform"}),s.jsx("span",{className:"text-sm font-bold text-gray-700",children:"Upload Policy Document"}),s.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Any file uploaded here (PDF/DOCX/scan) is treated as the official policy for this case."})]}),s.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",accept:"application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,image/*",onChange:$})]})})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase flex items-center",children:[s.jsx(T0,{className:"w-3 h-3 mr-1"})," Report Date"]}),s.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded",value:v(e.reportDate),onChange:R=>t({reportDate:new Date(R.target.value).toISOString()})})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"RE (Subject)"}),s.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded text-sm",placeholder:"e.g. John Doe v. XYZ Medical Center  Claim Update",value:e.reportSubject||"",onChange:R=>t({reportSubject:R.target.value,isSubjectAuto:!1})})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Insurer Name"}),s.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded",value:b?"OTHER":e.insurerName,onChange:R=>M(R.target.value),children:[s.jsx("option",{value:"",disabled:!0,children:"-- Select Insurer --"}),Nu.map(R=>s.jsx("option",{value:R,children:R},R)),s.jsx("option",{value:"OTHER",children:"Other (Enter Manually)"})]}),b&&s.jsx("div",{className:"mt-2 animate-fade-in",children:_(e.insurerName,R=>t({insurerName:R}),"Type custom insurer name...")})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:Lu.lineSlip}),_(e.lineSlipNo,R=>t({lineSlipNo:R,marketRef:R}),"e.g., B0180PD2391439")]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:Lu.certificate}),_(e.certificateRef||"",R=>t({certificateRef:R}),"e.g., 516902624")]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Insured Name"}),_(e.insuredName,R=>t(D({insuredName:R})),"e.g., Dr. Cohen")]}),s.jsxs("div",{className:"space-y-1 md:col-span-2",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Party Name"}),s.jsxs("div",{className:"flex bg-gray-100 rounded p-0.5 text-xs",children:[s.jsx("button",{className:`px-3 py-1 rounded-sm transition-all ${e.plaintiffTitle==="Plaintiff"?"bg-white shadow text-lpBlue font-bold":"text-gray-500"}`,onClick:()=>t({plaintiffTitle:"Plaintiff"}),children:"Plaintiff"}),s.jsx("button",{className:`px-3 py-1 rounded-sm transition-all ${e.plaintiffTitle==="Claimant"?"bg-white shadow text-lpBlue font-bold":"text-gray-500"}`,onClick:()=>t({plaintiffTitle:"Claimant"}),children:"Claimant"})]})]}),_(e.plaintiffName,R=>t(D({plaintiffName:R})),"e.g., Mr. Levi")]})]})]}),s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"flex justify-between items-center mb-4",children:s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center",children:[s.jsx(_o,{className:"w-5 h-5 mr-2 text-lpBlue"}),"Timeline Selection"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"       (   )."})]})}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:Uy.map(R=>{const z=e.selectedTimeline===R.id;return s.jsxs("button",{type:"button",onClick:()=>y(R),className:`text-left border rounded-xl p-4 transition hover:shadow-lg focus:outline-none ${z?"border-lpBlue ring-2 ring-lpBlue/30 shadow-lg bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("p",{className:"font-semibold text-gray-800",children:R.name}),s.jsx("p",{className:"text-xs text-gray-500",children:"     "}),z&&s.jsx("span",{className:"text-xs font-bold text-lpBlue mt-1 inline-block",children:""})]},R.id)})}),l.length>0&&s.jsxs("div",{className:"mt-6",children:[s.jsxs("h4",{className:"text-sm font-bold text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(_o,{className:"w-3 h-3 text-lpBlue"})," Selected Timeline Slides"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(R=>s.jsxs("div",{className:"px-3 py-1.5 border border-gray-200 rounded-full bg-white text-xs font-semibold text-gray-700 flex items-center gap-2",children:[s.jsx("span",{children:R.name}),a&&s.jsx("button",{onClick:()=>a(R.id),className:"text-red-400 hover:text-red-600",children:s.jsx(Mt,{className:"w-3 h-3"})})]},R.id))})]})]}),s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 flex items-center",children:[s.jsx(M0,{className:"w-5 h-5 mr-2 text-green-600"}),"Current Report Sections"]}),s.jsx("div",{className:"space-y-2 mb-6",children:e.selectedSections.map((R,z)=>{const U=z>0,te=z<e.selectedSections.length-1,I=R==="Update";return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center text-xs font-bold",children:z+1}),s.jsx("span",{className:"font-medium text-gray-800",children:R}),I&&s.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded",children:"Fixed"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("button",{onClick:()=>A(z,"UP"),disabled:!U,className:`p-1 rounded border ${U?"text-gray-600 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,title:" ",children:s.jsx(A0,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>A(z,"DOWN"),disabled:!te,className:`p-1 rounded border ${te?"text-gray-600 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,title:" ",children:s.jsx(Zm,{className:"w-4 h-4"})})]}),!I&&s.jsx("button",{onClick:()=>H(R),className:"text-gray-400 hover:text-red-500 transition",title:" ",children:s.jsx(Mt,{className:"w-4 h-4"})})]})]},`${R}-${z}`)})}),f?s.jsxs("div",{className:"bg-gray-50 p-4 rounded border animate-fade-in",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{className:"flex-1 border p-2 rounded",onChange:R=>P(R.target.value),defaultValue:"",children:[s.jsx("option",{value:"",disabled:!0,children:"-- Select a Header --"}),z0.filter(R=>!e.selectedSections.includes(R)).map(R=>s.jsx("option",{value:R,children:R},R))]}),s.jsx("button",{onClick:()=>m(!1),className:"px-4 py-2 bg-gray-200 text-gray-600 rounded hover:bg-gray-300",children:"Cancel"})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{className:"flex-1 border p-2 rounded",placeholder:"Type custom header name...",value:c,onChange:R=>d(R.target.value)}),s.jsx("button",{onClick:()=>{ne(),m(!1)},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Add Custom"})]})})]}):s.jsxs("button",{onClick:()=>m(!0),className:"w-full py-2 border-2 border-dashed border-gray-300 text-gray-500 rounded hover:border-green-500 hover:text-green-600 transition flex items-center justify-center font-medium",children:[s.jsx(Uc,{className:"w-4 h-4 mr-2"})," Add Report Section"]})]}),s.jsxs("div",{className:"flex flex-wrap justify-between gap-2",children:[s.jsxs("button",{onClick:o,className:"flex items-center text-gray-600 px-4 py-2 border rounded hover:bg-gray-50 transition",children:[s.jsx(Pi,{className:"mr-2 w-4 h-4"})," Back to Dashboard"]}),s.jsxs("button",{onClick:n,className:"flex items-center bg-lpBlue text-white px-6 py-2 rounded hover:bg-blue-900 transition shadow-md",children:["Next Step ",s.jsx(dn,{className:"ml-2 w-4 h-4"})]})]})]})},Jy=({data:e,updateData:t,onBack:n,onNext:r,currentUser:l,onSaveAndExit:i,onTranslate:a,onFormatContent:o,onSubmitHebrewForReview:c,onApproveHebrewForTranslation:d,onAddReviewIssues:f,onMarkReviewIssueDone:m,onAddExternalFeedbackIssues:x,onReopenHebrewDueToExternalFeedback:b,step1Focus:j,onStep1FocusConsumed:S})=>{var Ae;const O=Fn,h=ws,[p,v]=w.useState(null),[E,D]=w.useState(!1),[M,P]=w.useState(null),[H,ne]=w.useState(null),[A,y]=w.useState(null),[$,_]=w.useState(null),[R,z]=w.useState(null),U=w.useRef(null),te=w.useRef(null),[I,K]=w.useState({date:new Date().toISOString().split("T")[0],description:"",amount:0,currency:"NIS"}),q=l.role==="SUB_ADMIN"||l.role==="FINANCE",F=e.selectedSections.some(T=>T.toLowerCase().includes("expenses")),Z=l.role==="LAWYER"&&e.requiresExpenses===!0&&F,Ie=l.role==="ADMIN"&&e.isTranslated,be=l.role==="LAWYER"||l.role==="ADMIN",Me=l.role==="FINANCE"||l.role==="SUB_ADMIN"||l.role==="ADMIN",Se=((Ae=e.reportReview)==null?void 0:Ae.status)==="APPROVED"||e.hebrewWorkflowStatus==="HEBREW_APPROVED",St=T=>vu(T)?"EXPERT":T===h?"DEMAND":"CLAIM";w.useEffect(()=>{if(!j)return;const T=()=>{let G=null;j==="EXTERNAL_FEEDBACK"?G=Lo:j==="REVIEW"&&(G=oi);let Y=null;if(G&&(Y=document.getElementById(G)),Y||(Y=document.getElementById(oi)),Y)try{Y.scrollIntoView({behavior:"smooth",block:"start"})}catch{}S&&S()};typeof window<"u"?window.requestAnimationFrame(()=>{const G=j==="EXTERNAL_FEEDBACK"&&document.getElementById(Lo)||document.getElementById(oi);if(G){try{G.scrollIntoView({behavior:"smooth",block:"start"})}catch{}S&&S()}else setTimeout(T,0)}):T()},[j,S]);const Q=()=>{if(!Me||!I.description||!I.amount)return;const T={id:Date.now().toString(),date:I.date||"",description:I.description,amount:Number(I.amount),currency:I.currency||"NIS"},G=[...e.expensesItems,T],Y=G.reduce((W,J)=>W+J.amount,0);t({expensesItems:G,expensesSum:Y.toLocaleString()}),K({date:new Date().toISOString().split("T")[0],description:"",amount:0,currency:"NIS"})},pe=T=>{const G=e.expensesItems.filter(W=>W.id!==T),Y=G.reduce((W,J)=>W+J.amount,0);t({expensesItems:G,expensesSum:Y.toLocaleString()})},Fe=async T=>{const G=T.target.files;if(!G)return;const Y=e.invoiceFiles.length;if(Y>=4){P({msg:"   4   (PDF  Word).",type:"info"}),T.target.value="";return}const W=Array.from(G).slice(0,4-Y),J=[];for(let Ee=0;Ee<W.length;Ee++){const _e=W[Ee],qe=new FileReader;await new Promise($e=>{qe.onload=Ge=>{var gt;J.push({id:`inv-${Date.now()}-${Ee}`,name:_e.name,data:((gt=Ge.target)==null?void 0:gt.result).split(",")[1],type:_e.type}),$e()},qe.readAsDataURL(_e)})}const oe=[...e.invoiceFiles,...J],ye=oe.length>0,Be=Me&&e.status==="WAITING_FOR_INVOICES"&&ye?"TASK_ASSIGNED":e.status;t({invoiceFiles:oe,isWaitingForInvoices:!ye,status:Be}),P({msg:"   ( 4 ).",type:"success"})},je=T=>{const G=e.invoiceFiles.filter(oe=>oe.id!==T),Y=G.length>0,J=Me&&!Y&&e.status==="TASK_ASSIGNED"?"WAITING_FOR_INVOICES":e.status;t({invoiceFiles:G,isWaitingForInvoices:!Y,status:J})},Xe=(T,G)=>{q||t({content:{...e.content,[T]:G}})},rt=(T,G)=>{Ie&&t({translatedContent:{...e.translatedContent,[T]:G}})},sn=(T,G)=>{if(q)return;let Y=G.replace(/{plaintiff}/g,e.plaintiffName||"").replace(/{insured}/g,e.insuredName||"").replace(/\[DATE\]/g,new Date().toLocaleDateString("he-IL"));const W=e.content[T]||"";Xe(T,W?`${W}

${Y}`:Y),v(null)},Kt=async T=>{if(q)return;const G=e.content[T];if(G){_(T),D(!0);try{const Y=await Cy(G);Xe(T,Y)}finally{D(!1),_(null)}}},pt=async(T,G,Y)=>{var W;D(!0);try{const J=await _y(G,Y);if((W=J.items)!=null&&W.length){const oe=[...e.expensesItems,...J.items],ye=oe.reduce((we,Be)=>we+(Be.amount||0),0);t({expensesItems:oe,expensesSum:ye.toLocaleString()}),P({msg:`  "${T}"  .`,type:"success"})}else P({msg:"    .",type:"info"})}catch(J){console.error("Expenses extraction failed",J),P({msg:" .   PDF/Word .",type:"error"})}finally{D(!1)}},wr=T=>new Promise((G,Y)=>{const W=new FileReader;W.onload=()=>G(W.result.split(",")[1]),W.onerror=()=>Y(new Error("Failed to read file")),W.readAsDataURL(T)}),ht=T=>{var Be,Ee,_e,qe,$e,Ge,gt,xn;if(!T)return;const G=[...e.selectedSections],Y=ge=>{G.includes(ge)||G.push(ge)},W=ge=>ge&&ge.length?ge.map(st=>` ${st}`).join(`
`):"",J=(Be=T.timeline)!=null&&Be.length?T.timeline.map(ge=>` ${(ge==null?void 0:ge.date)||"  "}  ${(ge==null?void 0:ge.event)||""}`).join(`
`):"",oe={...e.content};if(T.briefSummary||J||(Ee=T.injuries)!=null&&Ee.length){Y("Update");const ge=W(T.injuries),st=W(T.requestedRelief),Bt=[T.briefSummary||"",ge?`
 :
${ge}`:"",st?`
 :
${st}`:"",J?`
 :
${J}`:""].filter(Boolean);oe.Update=Bt.join(`
`).trim()}if((_e=T.facts)!=null&&_e.length){const ge=Fn;Y(ge),oe[ge]=W(T.facts)}const ye=[];if((qe=T.allegations)!=null&&qe.length&&ye.push(` :
${W(T.allegations)}`),($e=T.negligenceTheory)!=null&&$e.length&&ye.push(` :
${W(T.negligenceTheory)}`),(Ge=T.medicalFindings)!=null&&Ge.length&&ye.push(` :
${W(T.medicalFindings)}`),ye.length){const ge=e.selectedSections.includes("Strategy & Recommendations")?"Strategy & Recommendations":"Strategy";Y(ge),oe[ge]=ye.join(`

`)}T.riskAssessment&&(Y("Risk Assessment"),oe["Risk Assessment"]=T.riskAssessment);const we=[];(gt=T.recommendedActions)!=null&&gt.length&&we.push(W(T.recommendedActions)),(xn=T.requestedRelief)!=null&&xn.length&&we.push(` :
${W(T.requestedRelief)}`),we.length&&(Y("Recommendations"),oe.Recommendations=we.join(`

`)),t({content:oe,selectedSections:G,complaintAnalysis:T}),P({msg:"     .",type:"success"})},An=(T,G)=>{var gn,Sr,Wr,g,ie;if(!T)return"";const Y=(G==null?void 0:G.analysisType)==="DEMAND"||(G==null?void 0:G.section)===h?"DEMAND":"CLAIM",W=Y==="DEMAND"?"":"",J=Y==="DEMAND"?"   ":"  ",oe=(Sr=(gn=T.entities)==null?void 0:gn.plaintiff)==null?void 0:Sr.trim(),ye=(T.defendants||[]).filter(Boolean).join(", "),we=[];we.push(oe?`${W}, ${oe}`:W),ye&&we.push(`${J} ${ye}`);const Be=`${we.join(" ")}.`.replace(/\s+/g," ").trim(),Ee=(ae,de,ke,Ne=!1)=>{const At=de.map(ks=>ks.trim()).filter(Boolean);if(!At.length&&Ne)return"";const Cn=At.length?At:ke?[ke]:[];if(!Cn.length)return"";const Es=Cn.map((ks,sa)=>`${sa+1}. ${ks}`.trim()).join(`
`);return`${ae}
${Es}`},_e=((Wr=T.timeline)==null?void 0:Wr.map(ae=>!(ae!=null&&ae.event)&&!(ae!=null&&ae.date)?"":`${ae!=null&&ae.date?` ${ae.date} `:""}${(ae==null?void 0:ae.event)||""}`.trim()).filter(Boolean))||[],qe=((g=T.facts)==null?void 0:g.filter(Boolean))||[],$e=_e.length?_e:qe,gt=Ee(Y==="DEMAND"?"    :":"    :",$e,"    ."),xn=Y==="DEMAND"?"    :":"    :",ge=((ie=T.allegations)==null?void 0:ie.filter(Boolean))||[],st=Ee(xn,ge,"    ."),Bt=[...T.injuries||[],...T.medicalFindings||[],...T.requestedRelief||[]].filter(Boolean),Qn=Ee(Y==="DEMAND"?"      :":"      :",Bt,void 0,!0);return[Be,gt,st,Qn].filter(Boolean).join(`

`).trim()},Ft=()=>{Xe("Strategy",Yy),P({msg:' " "  .',type:"success"})},Rt=(T,G)=>{var J;const Y=(J=T.target.files)==null?void 0:J[0];if(!Y)return;if(!G.includes("Expenses")){T.target.value="";return}const W=new FileReader;W.onload=async oe=>{var we;const ye=((we=oe.target)==null?void 0:we.result).split(",")[1];await pt(Y.name,ye,Y.type)},W.readAsDataURL(Y),T.target.value=""},Tt=T=>{z(null),ne(T),setTimeout(()=>{var G;(G=U.current)==null||G.click()},0)},xt=async T=>{var W,J;const G=(W=T.target.files)==null?void 0:W[0];if(!G||!H){ne(null),T.target.value="";return}const Y=H.section||H.mode;y(Y);try{const oe=await wr(G),ye=H.mode==="SECTION"&&H.section||Fn,we=ye===O||ye===h,Be=vu(ye),Ee={expertCountMode:H.analysisType==="EXPERT"?((J=e.expertSummaryMode)==null?void 0:J[ye])||"SINGLE":void 0,partyRole:V0(ye)||void 0};(we||Be)&&(Ee.sectionKey=ye,Ee.plaintiffName=e.plaintiffName||"",Ee.insuredName=e.insuredName||"",Ee.insurerName=e.insurerName||"",Ee.reportSubject=e.reportSubject||"");const _e=await Dy(oe,G.type||"application/octet-stream",H.analysisType||"CLAIM",Ee),qe=(_e==null?void 0:_e.analysis)||null;if(H.mode==="SECTION"){const $e=((_e==null?void 0:_e.claimSummary)||"").trim()||An(qe,{analysisType:H.analysisType,section:H.section});if(!$e)P({msg:"      .",type:"error"});else{const Ge=H.section||O,gt=e.content[Ge]||"",xn=gt?`${gt}

${$e}`:$e,ge={content:{...e.content,[Ge]:xn},selectedSections:e.selectedSections.includes(Ge)?e.selectedSections:[...e.selectedSections,Ge]};if(H.analysisType==="EXPERT"&&H.section){const Bt=!!gt.trim()?"MULTIPLE":"SINGLE";ge.expertSummaryMode={...e.expertSummaryMode||{},[Ge]:Bt}}qe&&(ge.complaintAnalysis=qe),t(ge),P({msg:"     .",type:"success"})}}else qe?(ht(qe),H.mode==="POLICY"&&t({policyFile:{id:`policy-${Date.now()}`,name:G.name,data:oe,type:G.type}})):P({msg:"   .   .",type:"error"})}catch(oe){console.error(oe),P({msg:" .    .",type:"error"})}finally{y(null),ne(null),T.target.value=""}},et=()=>{const{policyPeriodStart:T,policyPeriodEnd:G,retroStart:Y,retroEnd:W}=e;if(!T&&!G&&!Y&&!W){P({msg:"    .  POLCY .",type:"info"});return}const J=Mp(e.content["Insurance Coverage"],T,G,Y,W);Xe("Insurance Coverage",J),P({msg:"   .",type:"success"})},Yt=!!(e.policyPeriodStart||e.policyPeriodEnd||e.retroStart||e.retroEnd),X=T=>{const G=e.expenseWorksheet;if(!G||!G.rows||G.rows.length===0){P({msg:"    .",type:"info"});return}if(G.status!=="LOCKED"){P({msg:'       ".',type:"info"});return}const Y=fe(G);Xe(T,Y),P({msg:'   ".',type:"success"})},ce=()=>{o&&(o(),P({msg:"    .",type:"success"}))},fe=T=>{const G=T.rows.filter(oe=>oe.type==="EXPENSE"),Y=T.rows.filter(oe=>oe.type==="ADJUSTMENT"),W=G.map(oe=>` ${oe.label}${oe.serviceProvider?` (${oe.serviceProvider})`:""}  ${oe.amount.toLocaleString()}`),J=Y.map(oe=>` ${oe.label}  ${oe.amount.toLocaleString()}`);return["     ","",":",W.length?W.join(`
`):"   ",""," / :",J.length?J.join(`
`):"  ","",`" : ${T.totals.totalExpenses.toLocaleString()}`,`" : ${T.totals.totalAdjustments.toLocaleString()}`,` : ${T.totals.totalBalance.toLocaleString()}`].join(`
`)};return s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"file",ref:U,className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,image/*",onChange:xt}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2",children:[s.jsxs("button",{onClick:n,className:"flex items-center text-sm text-gray-600 bg-gray-100 px-3 py-1.5 rounded-full hover:bg-gray-200",children:[s.jsx(Pi,{className:"w-4 h-4 mr-1"}),"   1"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[l.role==="ADMIN"&&a&&s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsxs("button",{onClick:a,disabled:!Se,className:`flex items-center text-sm px-3 py-1.5 rounded-full transition ${Se?"text-indigo-700 bg-indigo-50 hover:bg-indigo-100":"text-slate-400 bg-slate-100 cursor-not-allowed"}`,children:[s.jsx(L0,{className:"w-4 h-4 mr-1"})," Auto-Translate"]}),!Se&&s.jsx("p",{className:"text-[11px] text-slate-600",children:"      ."})]}),l.role==="ADMIN"&&o&&s.jsxs("button",{onClick:ce,className:"flex items-center text-sm text-purple-700 bg-purple-50 px-3 py-1.5 rounded-full hover:bg-purple-100",children:[s.jsx($c,{className:"w-4 h-4 mr-1"})," Format Text"]}),s.jsxs("button",{onClick:i,className:"flex items-center text-sm text-lpBlue bg-blue-50 px-3 py-1.5 rounded-full hover:bg-blue-100",children:[s.jsx(Bc,{className:"w-4 h-4 mr-1"}),"  "]})]})]}),M&&s.jsx(Fy,{message:M.msg,type:M.type,onClose:()=>P(null)}),s.jsx("h2",{className:"text-2xl font-bold text-lpBlue font-serif",children:"2. Draft Content"}),q&&s.jsxs("div",{className:"bg-orange-100 border-l-4 border-orange-500 p-4 text-orange-800",children:[s.jsxs("p",{className:"font-bold flex items-center",children:[s.jsx(B0,{className:"w-5 h-5 mr-2"})," Restricted Access Mode"]}),s.jsxs("p",{className:"text-sm",children:["You are logged in as ",l.role,". You can only modify the Invoice Attachments in the Expenses section."]})]}),e.financeInstructions&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-600 p-4 shadow-md rounded-r-lg animate-pulse-slow",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(_i,{className:"h-5 w-5 text-red-600"})}),s.jsxs("div",{className:"ml-3 w-full",children:[s.jsx("h3",{className:"text-sm font-bold text-red-800",children:"Instruction from Finance"}),s.jsx("div",{className:"mt-2 text-sm text-red-700 whitespace-pre-wrap",children:e.financeInstructions}),e.expensesSourceFile&&s.jsxs("div",{className:"mt-4 pt-2 border-t border-red-200",children:[s.jsx("p",{className:"text-xs font-bold text-red-800 mb-1",children:"Attached Expenses Source File (Word/Excel):"}),s.jsxs("div",{className:"flex items-center bg-white p-2 rounded border border-red-200 max-w-md",children:[s.jsx(Br,{className:"w-4 h-4 text-blue-600 mr-2"}),s.jsx("span",{className:"text-sm text-gray-700 flex-1",children:e.expensesSourceFile.name}),s.jsx("a",{href:`data:${e.expensesSourceFile.type};base64,${e.expensesSourceFile.data}`,download:e.expensesSourceFile.name,className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 font-bold",children:"Download"})]})]})]})]})}),Z&&s.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-500 p-4 shadow rounded-r-lg flex gap-3 items-start",children:[s.jsx(_i,{className:"w-5 h-5 text-amber-600 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-amber-900",children:"    "}),s.jsx("p",{className:"text-sm text-amber-800",children:"  /   .              ."})]})]}),s.jsx(Q0,{report:e,currentUser:l,onSubmitToAdmin:()=>c&&c(),onApproveHebrew:()=>d&&d(),onRequestChanges:T=>f&&f(T),onMarkIssueDone:T=>m&&m(T),onAddExternalFeedbackIssues:(T,G)=>x&&x(T,G),onReopenHebrewDueToExternalFeedback:()=>b&&b()}),s.jsx("div",{className:"space-y-8",children:e.selectedSections.map(T=>{var G,Y;return s.jsxs("div",{className:`bg-white p-6 rounded-lg shadow-sm border transition-all ${q&&!T.includes("Expenses")?"opacity-60 pointer-events-none border-gray-100":"border-gray-200"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-3 pb-2 border-b border-gray-100",children:[s.jsx("h3",{className:"font-bold text-lg text-lpBlue uppercase tracking-wide",children:G0(T,(G=e.expertSummaryMode)==null?void 0:G[T])}),!q&&s.jsxs("div",{className:"flex items-center gap-2",children:[!T.includes("Expenses")&&s.jsx("button",{className:"p-1.5 hover:bg-gray-100 rounded text-gray-500",onClick:()=>Tt({mode:"SECTION",section:T,analysisType:St(T)}),title:"   ",children:A===T?s.jsx(jn,{className:"w-4 h-4 animate-spin"}):s.jsx(F0,{className:"w-4 h-4"})}),T.includes("Expenses")&&be&&s.jsx("button",{onClick:()=>X(T),className:"p-1.5 hover:bg-green-50 rounded text-gray-500 hover:text-green-600",title:"   ",children:s.jsx(sp,{className:"w-4 h-4"})}),!T.includes("Expenses")&&s.jsxs(s.Fragment,{children:[T==="Strategy"&&!q&&s.jsx("button",{onClick:Ft,className:"px-3 py-1 text-xs font-semibold text-blue-700 bg-blue-50 border border-blue-200 rounded-full hover:bg-blue-100",children:" "}),s.jsx("button",{onClick:()=>Kt(T),className:"p-1.5 hover:bg-purple-50 rounded text-gray-500 hover:text-purple-600",title:"  ",children:$===T?s.jsx(jn,{className:"w-4 h-4 animate-spin"}):s.jsx($0,{className:"w-4 h-4"})}),T==="Insurance Coverage"&&Yt&&s.jsx("button",{onClick:et,className:"p-1.5 hover:bg-blue-50 rounded text-gray-500 hover:text-blue-600",title:"Auto-fill policy data",children:s.jsx(W0,{className:"w-4 h-4"})})]}),_a[T]&&s.jsxs("button",{onClick:()=>v(p===T?null:T),className:"flex items-center gap-1 px-2 py-1 rounded text-xs font-bold bg-gray-50 text-gray-500 border",children:[s.jsx(O0,{className:"w-3 h-3"})," Ideas"]})]})]}),p===T&&_a[T]&&!q&&s.jsx("div",{className:"mb-4 p-3 bg-yellow-50 rounded border border-yellow-200",children:s.jsx("div",{className:"grid grid-cols-1 gap-2",children:_a[T].map((W,J)=>s.jsx("button",{onClick:()=>sn(T,W),className:"text-right text-xs p-2 bg-white border border-yellow-100 rounded hover:bg-yellow-100 text-gray-700",dir:"rtl",children:W},J))})}),T.includes("Expenses")?s.jsxs("div",{className:"space-y-4",children:[Me&&s.jsxs("div",{className:"bg-blue-50 p-4 rounded border border-blue-100 mb-4",children:[s.jsx("h4",{className:"text-sm font-bold text-blue-800 mb-2",children:"Add Expense Item"}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[s.jsx("input",{type:"date",className:"border p-2 rounded text-sm",value:I.date,onChange:W=>K({...I,date:W.target.value})}),s.jsx("input",{type:"text",className:"border p-2 rounded text-sm flex-1",placeholder:"Description (e.g. Court Fee)",value:I.description,onChange:W=>K({...I,description:W.target.value})}),s.jsx("input",{type:"number",className:"border p-2 rounded text-sm w-24",placeholder:"Amount",value:I.amount,onChange:W=>K({...I,amount:Number(W.target.value)})}),s.jsx("button",{onClick:Q,className:"bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold hover:bg-blue-700",children:"Add"})]})]}),Me&&s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"relative text-xs",children:[s.jsxs("button",{className:"flex items-center text-indigo-600 bg-white px-2 py-1 rounded hover:bg-indigo-50",onClick:()=>z(R===T?null:T),children:[s.jsx(Mi,{className:"w-3 h-3 mr-1"})," Auto-extract"]}),R===T&&s.jsxs("div",{className:"absolute right-0 mt-2 w-44 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[s.jsxs("label",{className:"w-full block px-3 py-2 hover:bg-gray-50 cursor-pointer text-right",children:["  ",s.jsx("input",{type:"file",className:"hidden",onChange:W=>{z(null),Rt(W,T)},accept:".pdf,.jpg,.png"})]}),s.jsx("button",{className:"w-full text-right px-3 py-2 hover:bg-gray-50",onClick:()=>Tt({mode:"EXPENSES",section:T}),children:"  OCR"})]})]}),E&&s.jsxs("span",{className:"text-xs text-indigo-500 flex items-center",children:[s.jsx(jn,{className:"w-3 h-3 animate-spin mr-1"})," Extracting..."]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center bg-indigo-50 p-2 rounded border border-indigo-200",children:[s.jsxs("span",{className:"text-sm font-bold text-indigo-900",children:["Total Extracted: ",e.expensesSum||"0"," NIS"]}),Me&&s.jsx("button",{onClick:()=>t({expensesItems:[],expensesSum:"0"}),className:"text-xs text-red-500 hover:underline",children:"Clear All"})]}),s.jsx("div",{className:"overflow-x-auto border rounded",children:s.jsxs("table",{className:"w-full text-sm border-collapse border-gray-300",children:[s.jsx("thead",{className:"bg-gray-100",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 text-left text-gray-600",children:"Date"}),s.jsx("th",{className:"p-2 text-left text-gray-600",children:"Description"}),s.jsx("th",{className:"p-2 text-right text-gray-600",children:"Amount"}),!q&&s.jsx("th",{className:"p-2 w-8"})]})}),s.jsxs("tbody",{children:[e.expensesItems.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-400 italic",children:"No expenses added."})}),e.expensesItems.map((W,J)=>s.jsxs("tr",{className:"border-t",children:[s.jsx("td",{className:"p-2",children:W.date}),s.jsx("td",{className:"p-2",children:W.description}),s.jsxs("td",{className:"p-2 text-right",children:[W.amount," ",W.currency]}),Me&&s.jsx("td",{className:"p-2 text-center",children:s.jsx("button",{onClick:()=>pe(W.id),className:"text-red-400 hover:text-red-600",children:s.jsx(Mt,{className:"w-3 h-3"})})})]},J))]})]})}),Me&&s.jsx("div",{className:"bg-indigo-50 p-3 rounded border",children:s.jsxs("select",{className:"w-full text-sm border p-2 rounded",value:e.paymentRecommendation||"",onChange:W=>t({paymentRecommendation:W.target.value}),children:[s.jsx("option",{value:"",children:"-- Select Recommendation --"}),s.jsx("option",{value:"The expenses are lower than the Deductible...",children:"Option A: Lower than Deductible"}),s.jsxs("option",{value:`It would be appreciated... transfer NIS ${e.expensesSum||"..."}`,children:["Option B: Transfer Funds (",e.expensesSum," NIS)"]})]})})]}),s.jsxs("div",{className:`border-t-2 pt-4 mt-6 ${q?"bg-green-50 p-4 rounded border-green-200":""}`,children:[s.jsxs("h4",{className:"font-bold text-sm text-gray-700 mb-2 flex items-center",children:[s.jsx(tp,{className:"w-4 h-4 mr-2"})," Tax Invoices (Appendices)"]}),(Me||!e.isWaitingForInvoices)&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[s.jsxs("button",{onClick:()=>{var W;return(W=te.current)==null?void 0:W.click()},className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200 flex items-center gap-1",children:[s.jsx(Mi,{className:"w-3 h-3"})," "]}),s.jsx("button",{onClick:()=>Tt({mode:"INVOICE"}),className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 flex items-center gap-1",children:A==="INVOICE"?s.jsx(jn,{className:"w-3 h-3 animate-spin"}):" "}),s.jsx("input",{ref:te,type:"file",className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf",onChange:Fe})]}),s.jsx("div",{className:"mt-2 space-y-2",children:e.invoiceFiles.map(W=>s.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border shadow-sm text-xs",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx(Br,{className:"w-3 h-3 mr-2 text-blue-500"})," ",W.name]}),s.jsx("button",{onClick:()=>je(W.id),className:"text-red-400 hover:text-red-600",children:s.jsx(Mt,{className:"w-3 h-3"})})]},W.id))})]})]}):s.jsxs("div",{className:"relative",children:[s.jsx(_u,{className:"w-full border border-gray-300 rounded-md p-4 min-h-[100px] text-right font-sans focus:ring-1 focus:ring-lpBlue outline-none transition-all",dir:"rtl",value:e.content[T]||"",onChange:W=>Xe(T,W.target.value),disabled:q,placeholder:"Type Hebrew content here...",style:{lineHeight:"1.6",textAlign:"justify"}}),Ie&&s.jsxs("div",{className:"mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"English Output (Editable)"}),s.jsx(_u,{className:"w-full border border-indigo-200 rounded-md p-4 min-h-[100px] font-serif focus:ring-1 focus:ring-indigo-300 outline-none transition-all",dir:"ltr",value:((Y=e.translatedContent)==null?void 0:Y[T])||"",onChange:W=>rt(T,W.target.value),placeholder:"Translated text will appear here after Auto-Translate...",style:{lineHeight:"1.6",textAlign:"justify"}})]})]})]},T)})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs("button",{onClick:n,className:"flex items-center text-gray-600 px-4 py-2 hover:bg-gray-100 rounded",children:[s.jsx(Pi,{className:"mr-2 w-4 h-4"})," Back"]}),s.jsxs("button",{onClick:r,className:"flex items-center bg-lpBlue text-white px-6 py-2 rounded hover:bg-blue-900 transition",children:["Next Step ",s.jsx(dn,{className:"ml-2 w-4 h-4"})]})]})]})]})},Zy=({onClose:e,onSubmit:t,currentUser:n,favoriteProviders:r=[],onSaveFavorite:l})=>{const i=n.role==="LAWYER",[a,o]=w.useState(i?n.id:""),[c,d]=w.useState(""),[f,m]=w.useState(""),[x,b]=w.useState(null),[j,S]=w.useState([{id:Qt(),category:"EXPERT_OUR",serviceProvider:"",amount:""}]),[O,h]=w.useState([]),p=4,v=async()=>{if(!a||!f)return;let y=null;const $=_=>t({lawyerId:a,instructions:c,odakanitNo:f,file:_,worksheet:j,invoiceFiles:O});if(x){const _=new FileReader;_.onload=R=>{var z;y={name:x.name,type:x.type,data:((z=R.target)==null?void 0:z.result).split(",")[1]},$(y)},_.readAsDataURL(x)}else $()},E=async y=>{const $=y.target.files;if(!$)return;if(O.length>=p){alert("   4 ."),y.target.value="";return}const _=Array.from($).slice(0,p-O.length),R=await Promise.all(_.map(z=>new Promise(U=>{const te=new FileReader;te.onload=I=>{var K;return U({id:`inv-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,name:z.name,data:((K=I.target)==null?void 0:K.result).split(",")[1],type:z.type})},te.readAsDataURL(z)})));h(z=>[...z,...R]),y.target.value=""},D=y=>{h($=>$.filter(_=>_.id!==y))},M=(y,$,_)=>{S(R=>R.map(z=>z.id===y?{...z,[$]:_}:z))},P=y=>{const $=kn.find(_=>_.type===y)||kn[0];S(_=>[..._,{id:Qt(),category:$.value,serviceProvider:"",amount:"",customLabel:""}])},H=y=>{S($=>$.length===1?$:$.filter(_=>_.id!==y))},ne=$o(j,n),A=$i(ne);return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[200]",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-96 animate-scale-in",children:[s.jsx("h3",{className:"font-bold text-lg mb-4 text-gray-800",children:i?"  ":"Open New Finance Case"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Internal Case # (Odakanit)"}),s.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:y=>m(y.target.value),placeholder:"e.g. 55492"})]}),!i&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Assign Lawyer"}),s.jsxs("select",{className:"w-full border p-2 rounded",value:a,onChange:y=>o(y.target.value),children:[s.jsx("option",{value:"",children:"-- Select --"}),Dr.filter(y=>y.role==="LAWYER").map(y=>s.jsx("option",{value:y.id,children:y.name},y.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Instructions"}),s.jsx(gl,{clientId:yl,children:s.jsx("textarea",{className:"w-full border p-2 rounded",rows:3,value:c,onChange:y=>d(y.target.value),placeholder:"Notes for lawyer..."})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Attach Expenses File"}),s.jsx("input",{type:"file",onChange:y=>{var $;return b((($=y.target.files)==null?void 0:$[0])||null)},className:"text-xs"})]}),s.jsxs("div",{className:"border rounded-lg p-3 bg-amber-50",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"block text-xs font-bold text-amber-700",children:"Expense Worksheet"}),s.jsxs("div",{className:"flex gap-2 text-xs text-amber-700 font-semibold",children:[s.jsx("button",{type:"button",onClick:()=>P("EXPENSE"),className:"hover:underline",children:"+ Expense"}),s.jsx("button",{type:"button",onClick:()=>P("ADJUSTMENT"),className:"hover:underline",children:"+ Adjustment"})]})]}),s.jsx("div",{className:"space-y-2 max-h-48 overflow-auto pr-1",children:j.map(y=>{const $=kn.find(U=>U.value===y.category),_=($==null?void 0:$.type)!=="ADJUSTMENT",R=r.filter(U=>U.category===y.category||U.category==="OTHER"),z=$o([y],n)[0];return s.jsxs("div",{className:"border border-amber-100 bg-white rounded-lg p-2 space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Expense Details"}),s.jsx("select",{value:y.category,onChange:U=>M(y.id,"category",U.target.value),className:"w-full border rounded text-xs p-2",children:kn.map(U=>s.jsx("option",{value:U.value,children:U.label},U.value))})]}),y.category==="OTHER"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Custom Label"}),s.jsx("input",{className:"w-full border rounded text-xs p-2",placeholder:"Describe expense",value:y.customLabel||"",onChange:U=>M(y.id,"customLabel",U.target.value)})]}),_&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Service Provider"}),s.jsx("input",{list:`provider-${y.id}`,className:"w-full border rounded text-xs p-2",placeholder:"Provider name",value:y.serviceProvider,onChange:U=>M(y.id,"serviceProvider",U.target.value)}),s.jsx("datalist",{id:`provider-${y.id}`,children:R.map(U=>s.jsx("option",{value:U.serviceProvider,children:U.label},U.id))}),s.jsx("button",{type:"button",onClick:()=>l&&y.serviceProvider.trim()&&l({id:Qt(),category:y.category,label:(z==null?void 0:z.label)||"Expense",serviceProvider:y.serviceProvider.trim()}),className:"text-[10px] text-amber-600 hover:underline mt-1",children:"Save to favorites"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Cost ()"}),s.jsx("input",{type:"number",min:"0",className:"w-full border rounded text-xs p-2",placeholder:"",value:y.amount,onChange:U=>M(y.id,"amount",U.target.value)})]}),s.jsx("div",{className:"text-right",children:s.jsx("button",{type:"button",onClick:()=>H(y.id),className:"text-[10px] text-red-500 hover:underline",children:"Remove"})})]},y.id)})}),s.jsxs("div",{className:"text-right text-xs font-bold text-amber-800 mt-2",children:["Total balance preview: ",A.totalBalance.toLocaleString()]})]}),s.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-700",children:"Tax Invoices (PDF / Word)"}),s.jsxs("span",{className:"text-[11px] text-gray-500",children:[O.length,"/",p]})]}),s.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-24 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-white hover:bg-gray-50",children:[s.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[s.jsx(Mi,{className:"w-6 h-6 text-gray-400 mb-2"}),s.jsx("p",{className:"text-xs text-gray-500",children:"   ( 4 )"})]}),s.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf",onChange:E})]}),s.jsxs("div",{className:"mt-2 space-y-2 max-h-32 overflow-auto",children:[O.map(y=>s.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded border text-xs",children:[s.jsxs("span",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(Br,{className:"w-3 h-3 text-blue-500"}),y.name]}),s.jsx("button",{type:"button",onClick:()=>D(y.id),className:"text-red-400 hover:text-red-600",children:s.jsx(Mt,{className:"w-3 h-3"})})]},y.id)),O.length===0&&s.jsx("p",{className:"text-xs text-gray-400 text-center",children:"   ."})]})]})]}),i&&s.jsx("p",{className:"text-xs text-gray-500",children:"    .    ."}),s.jsx("button",{onClick:v,className:"w-full bg-indigo-600 text-white py-2 rounded font-bold mt-2 hover:bg-indigo-700",children:i?"Create Personal Folder":"Create Folder"}),s.jsx("button",{onClick:e,className:"w-full text-gray-500 text-sm hover:underline mt-1",children:"Cancel"})]})]})})},eN=({user:e,reports:t,onSelectReport:n,onNewReport:r,onLogout:l,onUpdateReport:i,onDeleteReport:a,onFinanceTaskCreate:o,caseTemplates:c=[],onStartTemplate:d,onStartNextReport:f,archiveAfterMs:m,favoriteProviders:x={},onSaveFavorite:b,onDeleteFavorite:j,onOpenWorksheet:S,onRequestReminder:O,onRequestNote:h,onSoftDeleteReport:p,onRestoreReport:v,notifications:E=[],showNotifications:D,setShowNotifications:M,onClearNotifications:P,dailySummaryOptIn:H,setDailySummaryOptIn:ne,caseFolders:A,onOpenCaseFolder:y})=>{const $=e.role==="ADMIN"||e.role==="SUB_ADMIN"||e.role==="FINANCE",_=e.role==="LAWYER"||e.role==="SUB_ADMIN"||e.role==="FINANCE",[R,z]=w.useState(!1),[U,te]=w.useState(!1),[I,K]=w.useState(!1),[q,F]=w.useState(!1),[Z,Ie]=w.useState({category:"EXPERT_OUR",label:"",provider:""}),[be,Me]=w.useState(""),[Se,St]=w.useState(null),Q=e.role==="ADMIN",pe=e.role==="SUB_ADMIN"||e.role==="FINANCE";if(e.role==="FINANCE")return s.jsx(Sy,{user:e,onLogout:l});if(!$&&e.role==="LAWYER")return s.jsx(Rg,{user:e,reports:t,caseFolders:A||{},notifications:E,showNotifications:D,setShowNotifications:M,onClearNotifications:P,dailySummaryOptIn:H,setDailySummaryOptIn:ne,archiveAfterMs:m,onSelectReport:n,onNewReport:r,onOpenCaseFolder:y,onLogout:l,deleteReportById:a});const Fe=Date.now(),je=m??Number.MAX_SAFE_INTEGER,Xe=g=>g.status==="SENT"&&g.sentAt&&Fe-new Date(g.sentAt).getTime()>=je,rt=$?t:t.filter(g=>g.createdBy===e.id),sn=rt.filter(Xe),Kt=rt.filter(g=>!Xe(g)&&!g.deletedAt),pt=rt.filter(g=>g.deletedAt&&Fe-new Date(g.deletedAt).getTime()<Lp),wr=rt.filter(g=>!g.deletedAt),ht=Q?Kt:_?wr:rt,An=Q?sn:_?pt:[],Ft=$?[]:t.filter(g=>g.status==="READY_TO_SEND"&&g.createdBy===e.id&&!g.deletedAt),Rt=$?[]:t.filter(g=>["TASK_ASSIGNED","WAITING_FOR_INVOICES"].includes(g.status)&&g.createdBy===e.id&&!g.deletedAt),Tt=g=>{var ie;if((ie=g.reportHistory)!=null&&ie.length)return g.reportHistory;if(g.status==="SENT"){const ae=g.sentAt||g.reportDate||new Date().toISOString();return[{id:`${g.id}-legacy`,reportNumber:1,subject:`${g.insurerName||"Report"}${g.insuredName?` - ${g.insuredName}`:""}`,date:ae,sent:!0}]}return[]},xt=$?[]:t.filter(g=>g.createdBy===e.id&&!g.deletedAt).flatMap(g=>{const ie=Tt(g);return ie.length?ie.map((ae,de)=>{var ke;return{parent:g,entry:ae,reportNumber:ae.reportNumber||de+1,sentAt:ae.date||((ke=ae.snapshot)==null?void 0:ke.createdAt)||g.sentAt,isLatest:de===ie.length-1}}):[]}).sort((g,ie)=>{const ae=g.sentAt?new Date(g.sentAt).getTime():0;return(ie.sentAt?new Date(ie.sentAt).getTime():0)-ae}),et=g=>{const ie=Tt(g),ae=ie[ie.length-1],de=(ae==null?void 0:ae.date)||g.sentAt;return de?new Date(de).getTime():0},Yt=$?[]:t.filter(g=>g.createdBy!==e.id||g.deletedAt||g.status!=="SENT"?!1:Tt(g).length>0).sort((g,ie)=>et(ie)-et(g)),X=$?[]:[{id:"ready",title:"  ",subtitle:"    ",items:Ft,empty:"   .",actionLabel:" ",action:g=>n(g.id),tone:"border-red-100"},{id:"finance",title:"   ",subtitle:"  /   ",items:Rt,empty:"   .",actionLabel:" ",action:g=>n(g.id),tone:"border-amber-100"},{id:"followup",title:"  ",subtitle:"        ",items:Yt,empty:"    .",actionLabel:" ",action:f?g=>f(g.id):void 0,tone:"border-blue-100"},{id:"sent",title:" ",subtitle:"         ",items:xt,empty:"     .",tone:"border-green-100"}],ce=$?t.filter(g=>g.odakanitNo&&!g.deletedAt):[],fe=(x==null?void 0:x[e.id])||[],Ae=()=>{if(!Z.provider.trim())return;const g=kn.find(ae=>ae.value===Z.category),ie=Z.label.trim()||(g==null?void 0:g.label)||"Favorite provider";b&&b(e.id,{id:Qt(),category:Z.category,label:ie,serviceProvider:Z.provider.trim()}),Ie({category:Z.category,label:"",provider:""})},T=g=>{j&&j(e.id,g)};c.filter(g=>g.ownerId===e.id);const G=t.filter(g=>Mu(g)&&!g.deletedAt),Y=e.role==="FINANCE"||e.role==="SUB_ADMIN",W=Q||_,J=Q?`Items move here ${m/(1e3*60*60)}h after sending and are deleted after ${_p/(1e3*60*60*24)} days.`:_?"     7    .":"",oe=G.filter(g=>!["READY_TO_SEND","SENT"].includes(g.status)),ye=G.filter(g=>g.status==="READY_TO_SEND"),we=G.filter(g=>g.status==="SENT"),Be=we.reduce((g,ie)=>g+Ou(ie),0),Ee=g=>g==="SENT"?"bg-green-100 text-green-700 border-green-200":g==="READY_TO_SEND"?"bg-red-100 text-red-700 border-red-200":"bg-gray-100 text-gray-600 border-gray-200",_e=g=>g==="READY_TO_SEND"?"READY TO SEND":g.replace(/_/g," "),qe=g=>{i(g,{isPaid:!0})},$e=I?An:ht,Ge=g=>{const ie=g.createdBy||"unknown",ae=g.odakanitNo||g.marketRef||g.id||"unknown",de=(g.plaintiffName||"unknown").toLowerCase();return`${ie}::${ae}::${de}`},gt=Y?$e.filter(Mu):$e,xn=new Set((Y?[]:$e).map(g=>Ge(g))),ge=!$&&!Y?c.filter(g=>g.ownerId===e.id&&!xn.has(g.caseKey)).map(g=>({id:`template-${g.caseKey}`,createdBy:g.ownerId,ownerName:g.ownerName,reportDate:g.lastUpdated,status:"TASK_ASSIGNED",recipientId:"1",insurerName:g.insurerName||"",lineSlipNo:g.lineSlipNo||"",marketRef:g.marketRef||"",insuredName:g.insuredName||"",plaintiffName:g.plaintiffName||"",plaintiffTitle:g.plaintiffTitle||"Plaintiff",odakanitNo:g.odakanitNo,selectedTimeline:"standard",filenameTag:ap[0],selectedSections:["Update"],content:{},translatedContent:{},expertSummaryMode:{},invoiceFiles:[],isWaitingForInvoices:!1,isTranslated:!1,expensesItems:[],expenseWorksheet:nr(),reportNotes:[],__templateKey:g.caseKey})):[],st=Y?gt:[...gt,...ge],Bt=be.trim().toLowerCase(),El=g=>Bt?`${g.odakanitNo||""} ${g.insuredName||""} ${g.plaintiffName||""} ${g.ownerName||""}`.toLowerCase().includes(Bt):!0,Qn=Bt?st.filter(El):st,gn=Y?[]:(()=>{const g=new Map;return Qn.forEach(ie=>{if(ie.__templateKey)return;const ae=ie.odakanitNo||ie.marketRef||ie.insuredName||ie.id,de=ie.reportDate?new Date(ie.reportDate).getTime():0,ke=g.get(ae);ke?(ke.reports.push(ie),de>ke.latestDate&&(ke.latestDate=de),!ke.caseLabel&&(ie.insuredName||ie.plaintiffName)&&(ke.caseLabel=ie.insuredName||ie.plaintiffName||ke.caseLabel),!ke.insuredName&&ie.insuredName&&(ke.insuredName=ie.insuredName),!ke.plaintiffName&&ie.plaintiffName&&(ke.plaintiffName=ie.plaintiffName)):g.set(ae,{key:ae,odakanitNo:ie.odakanitNo||"",caseLabel:ie.insuredName||ie.plaintiffName||ie.marketRef||"",insuredName:ie.insuredName||"",plaintiffName:ie.plaintiffName||"",reports:[ie],latestDate:de})}),Array.from(g.values()).sort((ie,ae)=>ae.latestDate-ie.latestDate)})(),Sr=g=>!["READY_TO_SEND","SENT"].includes(g.status),Wr=g=>{if(!Sr(g)){alert("      -READY TO SEND  .");return}const ie=g.insuredName||g.plaintiffName||g.odakanitNo||g.id;window.confirm(`  " "${ie}"?    .`)&&a&&a(g.id)};return w.useEffect(()=>{Se&&(gn.some(g=>g.key===Se)||St(null))},[Se,gn]),s.jsxs("div",{className:"min-h-screen bg-gray-100 p-6 relative",children:[U&&s.jsx(By,{onClose:()=>te(!1)}),R&&s.jsx(Zy,{currentUser:e,onClose:()=>z(!1),onSubmit:g=>{o(g),z(!1)},favoriteProviders:x[e.id]||[],onSaveFavorite:g=>b&&b(e.id,g)}),q&&s.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[200] p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(rp,{className:"w-4 h-4 text-amber-500"}),"   "]}),s.jsx("button",{onClick:()=>F(!1),className:"text-gray-500 hover:text-gray-800",children:s.jsx(Mt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),s.jsx("select",{value:Z.category,onChange:g=>Ie({...Z,category:g.target.value}),className:"w-full border rounded text-sm p-2",children:kn.filter(g=>g.type==="EXPENSE").map(g=>s.jsx("option",{value:g.value,children:g.label},g.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),s.jsx("input",{className:"w-full border rounded text-sm p-2",value:Z.label,onChange:g=>Ie({...Z,label:g.target.value}),placeholder:":  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),s.jsx("input",{className:"w-full border rounded text-sm p-2",value:Z.provider,onChange:g=>Ie({...Z,provider:g.target.value}),placeholder:'"  '})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("button",{onClick:Ae,className:"bg-amber-500 text-white px-4 py-2 rounded font-bold hover:bg-amber-600",children:" "})}),s.jsxs("div",{className:"max-h-64 overflow-y-auto border rounded-lg divide-y",children:[fe.length===0&&s.jsx("p",{className:"text-sm text-gray-400 text-center py-6",children:"   ."}),fe.map(g=>s.jsxs("div",{className:"p-3 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-bold text-gray-800",children:g.label}),s.jsx("p",{className:"text-xs text-gray-500",children:g.serviceProvider})]}),s.jsx("button",{onClick:()=>T(g.id),className:"text-xs text-red-500 hover:underline",children:""})]},g.id))]})]})}),s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-serif font-bold text-lpBlue",children:"Lior Perry Law Office"}),s.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",s.jsx("span",{className:"font-bold",children:e.name})," (",e.role,")"]})]}),s.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[W&&s.jsxs("button",{onClick:()=>K(g=>!g),className:`flex items-center px-4 py-2 rounded shadow text-sm font-bold ${I?"bg-gray-300 text-gray-800":"bg-gray-200 text-gray-700"} hover:bg-gray-300`,children:[s.jsx(Sn,{className:"w-4 h-4 mr-2"})," ",I?"Back to Reports":`Recycle Bin (${An.length})`]}),s.jsxs("button",{onClick:()=>z(!0),className:"flex items-center bg-indigo-600 text-white px-4 py-2 rounded shadow hover:bg-indigo-700 font-bold",children:[s.jsx(Uc,{className:"w-4 h-4 mr-2"})," Open New Case Folder"]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>M(g=>!g),className:"flex items-center text-blue-600 bg-blue-50 px-3 py-2 rounded hover:bg-blue-100 relative",children:[s.jsx(Li,{className:"w-4 h-4 mr-2"})," Notifications",E.length>0&&s.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-[10px] rounded-full px-1",children:E.length})]}),D&&s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 shadow-xl rounded-lg z-50",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[s.jsx("span",{className:"text-sm font-bold text-gray-700",children:"Smart Notifications"}),s.jsxs("label",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx("input",{type:"checkbox",checked:H,onChange:g=>ne(g.target.checked)}),"Daily summary"]})]}),s.jsxs("div",{className:"max-h-64 overflow-auto divide-y",children:[E.length===0&&s.jsx("div",{className:"p-4 text-xs text-gray-400 text-center",children:"No notifications yet."}),E.map(g=>s.jsxs("div",{className:"p-3 text-sm",children:[s.jsx("p",{className:"font-medium text-gray-800",children:g.message}),s.jsx("p",{className:"text-[10px] text-gray-400",children:new Date(g.createdAt).toLocaleString()})]},g.id))]}),s.jsx("div",{className:"px-3 py-2 text-right text-xs",children:s.jsx("button",{onClick:P,className:"text-red-500 hover:underline",children:"Clear all"})})]})]}),s.jsxs("button",{onClick:()=>te(!0),className:"flex items-center text-blue-600 bg-blue-50 px-3 py-2 rounded hover:bg-blue-100",children:[s.jsx(Fc,{className:"w-4 h-4 mr-2"})," "]}),!1,s.jsxs("button",{onClick:l,className:"flex items-center text-red-600 hover:bg-red-50 px-4 py-2 rounded",children:[s.jsx(ep,{className:"w-4 h-4 mr-2"})," Logout"]})]})]}),$&&s.jsx($y,{reports:t,currentUser:e,onMarkPaid:qe}),pe&&s.jsxs("div",{className:"mb-8 bg-white border border-amber-200 rounded-2xl shadow p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-bold text-amber-700 flex items-center gap-2",children:[s.jsx(tp,{className:"w-5 h-5"})," Expenses Overview"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Tracking all reports that include expense tables."})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.jsx("button",{onClick:()=>F(!0),className:"text-xs text-amber-700 underline hover:text-amber-900",children:"Manage Favorite Providers"}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Assigned to Lawyers"}),s.jsx("p",{className:"text-xl font-bold text-amber-700",children:oe.length})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Waiting for Lior"}),s.jsx("p",{className:"text-xl font-bold text-blue-600",children:ye.length})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Sent to Insurer"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:we.length})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Total Sent Balance"}),s.jsxs("p",{className:"text-xl font-bold text-green-700",children:["",Be.toLocaleString()]})]})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-amber-50 text-amber-800",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 text-left",children:"Case / Lawyer"}),s.jsx("th",{className:"p-2 text-left",children:"Status"}),s.jsx("th",{className:"p-2 text-right",children:"Total Balance ()"}),s.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),s.jsxs("tbody",{className:"divide-y",children:[G.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-400",children:"No expense reports yet."})}),G.map(g=>s.jsxs("tr",{className:"hover:bg-amber-50 transition",children:[s.jsxs("td",{className:"p-2",children:[s.jsx("div",{className:"font-semibold text-gray-800",children:g.insuredName||"Unnamed Case"}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Lawyer: ",g.ownerName]})]}),s.jsx("td",{className:"p-2",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide shadow-sm border ${Ee(g.status)}`,children:_e(g.status)})}),s.jsxs("td",{className:"p-2 text-right font-bold",children:["",Ou(g).toLocaleString()]}),s.jsx("td",{className:"p-2 text-right",children:s.jsx("button",{onClick:()=>n(g.id),className:"text-lpBlue hover:underline text-xs font-bold",children:"Open"})})]},`expense-${g.id}`))]})]})})]}),!$&&X.length>0&&s.jsx("div",{className:"space-y-6 mb-8",children:X.map(g=>s.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm",children:[s.jsx("div",{className:"flex flex-wrap justify-between items-center gap-3 px-4 py-3 border-b",children:s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800",children:g.title}),s.jsx("p",{className:"text-sm text-gray-500",children:g.subtitle})]})}),g.items.length===0?s.jsx("div",{className:"p-6 text-center text-gray-400 text-sm",children:g.empty}):s.jsx("div",{className:"p-4 space-y-3",children:g.items.map(ie=>{var ke;if(g.id==="sent"){const Ne=ie,At=Ne.sentAt?new Date(Ne.sentAt).toLocaleDateString("he-IL"):"",Cn=Ne.isLatest&&Ne.parent.status==="SENT"&&typeof f=="function",Es=Ne.isLatest&&Ne.parent.status!=="SENT";return s.jsxs("div",{className:`border ${g.tone} rounded-xl p-4`,children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:Ne.parent.odakanitNo||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:Ne.parent.insuredName||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:Ne.parent.plaintiffTitle}),s.jsx("p",{className:"font-bold text-gray-900",children:Ne.parent.plaintiffName||""})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs uppercase text-gray-400",children:[" #",Ne.reportNumber]}),s.jsx("p",{className:"font-bold text-gray-900",children:At})]})]}),s.jsxs("div",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold text-gray-800",children:":"})," ",Ne.entry.subject||""]}),Ne.entry.fileName&&s.jsxs("p",{className:"text-xs text-gray-500",children:[" : ",Ne.entry.fileName]})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 justify-end",children:[Cn&&f&&s.jsx("button",{onClick:()=>f(Ne.parent.id),className:"px-4 py-2 rounded-full bg-lpBlue text-white text-sm font-semibold hover:bg-blue-900",children:" "}),Es&&s.jsx("span",{className:"text-xs text-gray-500 font-semibold px-3 py-1 rounded-full bg-gray-100",children:"  "})]})]},`${Ne.parent.id}-${Ne.entry.id}`)}const ae=ie,de=(((ke=ae.reportHistory)==null?void 0:ke.length)||0)+1;return s.jsxs("div",{className:`border ${g.tone} rounded-xl p-4`,children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:ae.odakanitNo||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:ae.plaintiffName||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:ae.insuredName||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsxs("p",{className:"font-bold text-gray-900",children:["#",de]})]})]}),g.id==="followup"&&s.jsx("div",{className:"mt-2 text-xs text-gray-500",children:(()=>{var Cn;const Ne=(Cn=ae.reportHistory)==null?void 0:Cn[ae.reportHistory.length-1],At=Ne!=null&&Ne.date?new Date(Ne.date).toLocaleDateString("he-IL"):ae.sentAt?new Date(ae.sentAt).toLocaleDateString("he-IL"):"";return`  : #${(Ne==null?void 0:Ne.reportNumber)||de-1}  ${At}`})()}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 justify-end",children:[g.id==="finance"&&Sr(ae)&&s.jsxs("button",{onClick:()=>Wr(ae),className:"px-3 py-2 rounded-full border border-red-200 text-red-600 text-sm font-semibold flex items-center gap-1 hover:bg-red-50",title:"  ",children:[s.jsx(Sn,{className:"w-4 h-4"}),""]}),g.action&&s.jsx("button",{onClick:()=>g.action&&g.action(ae),className:"px-4 py-2 rounded-full bg-lpBlue text-white text-sm font-semibold hover:bg-blue-900",children:g.actionLabel})]})]},ae.id)})})]},g.id))}),$&&s.jsxs("div",{className:"mb-8",children:[s.jsx("div",{className:"flex justify-between items-end mb-4",children:s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center",children:[s.jsx(Mc,{className:"w-6 h-6 mr-2 text-indigo-600"})," Active Case Folders"]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[ce.length===0&&s.jsx("p",{className:"text-gray-400 italic col-span-3 text-center py-4",children:"No active finance folders."}),ce.map(g=>{var de;const ie=(()=>{switch(g.status){case"WAITING_FOR_INVOICES":return{badge:"bg-yellow-50 text-yellow-700",text:"Awaiting Finance Finalize",icon:s.jsx(jn,{className:"text-yellow-500 w-5 h-5 animate-spin"})};case"TASK_ASSIGNED":return{badge:"bg-blue-50 text-blue-700",text:"Pending Lawyer Action",icon:s.jsx(Oc,{className:"text-blue-500 w-5 h-5"})};case"READY_TO_SEND":return{badge:"bg-orange-50 text-orange-700",text:"Waiting for Lior",icon:s.jsx(jn,{className:"text-orange-500 w-5 h-5 animate-spin"})};case"SENT":return{badge:"bg-green-50 text-green-700",text:"Completed",icon:s.jsx(Jm,{className:"text-green-500 w-6 h-6"})};default:return{badge:"bg-gray-50 text-gray-600",text:g.status,icon:s.jsx(jn,{className:"text-gray-400 w-5 h-5 animate-spin"})}}})(),ae=(de=Dr.find(ke=>ke.id===g.createdBy))==null?void 0:de.name;return s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-t-4 relative border-indigo-100",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("h4",{className:"font-bold text-lg",children:["Case #",g.odakanitNo]}),ie.icon]}),s.jsxs("div",{className:"text-sm text-gray-600 mb-1 flex items-center",children:[s.jsx(U0,{className:"w-4 h-4 mr-1"})," Assigned to: ",ae]}),s.jsx("div",{className:"text-xs text-gray-500 mb-4",children:new Date(g.reportDate).toLocaleDateString()}),s.jsx("div",{className:"flex justify-end gap-2 mt-2",children:g.status==="SENT"?s.jsxs("button",{onClick:()=>a(g.id),className:"text-red-500 hover:bg-red-50 px-3 py-1 rounded text-sm flex items-center",children:[s.jsx(Sn,{className:"w-4 h-4 mr-1"})," Delete Folder"]}):s.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded ${ie.badge}`,children:ie.text})})]},g.id)})]})]}),($||Y)&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50/50 flex flex-wrap gap-3 items-center justify-between",children:[s.jsxs("h3",{className:"font-bold text-gray-700 flex items-center",children:[s.jsx(_o,{className:"w-4 h-4 mr-2 text-gray-400"})," ",I?"Recycle Bin":"All Reports"]}),s.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[I&&J&&s.jsx("span",{className:"text-xs text-gray-500",children:J}),s.jsxs("div",{className:"relative w-full sm:w-72",children:[s.jsx(np,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),s.jsx("input",{value:be,onChange:g=>Me(g.target.value),placeholder:"     ",className:"w-full border border-gray-300 rounded-full pl-9 pr-10 py-1.5 text-sm focus:ring-2 focus:ring-blue-200 outline-none"}),be&&s.jsx("button",{onClick:()=>Me(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500",children:s.jsx(Mt,{className:"w-4 h-4"})})]})]})]}),Y?s.jsxs("table",{className:"w-full text-left",children:[s.jsx("thead",{className:"bg-gray-50 text-gray-500 text-xs uppercase tracking-wider font-semibold",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-4",children:"Insurer / Subject"}),$&&s.jsx("th",{className:"p-4",children:"Lawyer"}),s.jsx("th",{className:"p-4",children:"Status"}),s.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-100",children:[Qn.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:$?4:3,className:"p-6 text-center text-gray-400 text-sm",children:Bt?"    .":"  ."})}),Qn.map(g=>{const ie=g.status==="READY_TO_SEND",ae=g.status==="SENT",de=!!g.__templateKey;return s.jsxs("tr",{className:`transition cursor-default ${ie?"bg-red-50":ae?"bg-green-50/50":"hover:bg-blue-50/30"}`,children:[s.jsxs("td",{className:"p-4",children:[s.jsx("div",{className:"font-bold text-gray-800",children:g.insurerName||"Untitled"}),s.jsxs("div",{className:"text-xs text-gray-500",children:[g.marketRef," ",g.insuredName?` - ${g.insuredName}`:""]})]}),$&&s.jsx("td",{className:"p-4 text-sm text-gray-600 font-medium",children:g.ownerName}),s.jsx("td",{className:"p-4",children:s.jsx("span",{className:`px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide shadow-sm border ${Ee(g.status)}`,children:_e(g.status)})}),s.jsx("td",{className:"p-4 text-right",children:s.jsxs("div",{className:"flex justify-end gap-2 flex-wrap",children:[s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>S(g.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-3 py-1.5 rounded flex items-center gap-1",children:[s.jsx(sp,{className:"w-3 h-3"})," View Expenses"]}),s.jsxs("button",{onClick:()=>O(g),className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 px-3 py-1.5 rounded flex items-center gap-1",children:[s.jsx(Li,{className:"w-3 h-3"})," Reminder"]}),s.jsxs("button",{onClick:()=>h(g),className:"text-xs bg-purple-50 text-purple-700 hover:bg-purple-100 px-3 py-1.5 rounded flex items-center gap-1",children:[s.jsx($c,{className:"w-3 h-3"})," Add Note"]})]}),_&&!Q&&!I&&s.jsxs("button",{onClick:()=>!de&&p(g.id),disabled:de,className:`text-xs px-3 py-1.5 rounded flex items-center gap-1 ${de?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-700 hover:bg-red-100"}`,children:[s.jsx(Sn,{className:"w-3 h-3"})," Delete"]}),I&&s.jsxs(s.Fragment,{children:[Q&&s.jsx("button",{onClick:()=>i(g.id,{sentAt:new Date().toISOString()}),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-sm font-bold",children:"Restore"}),!Q&&_&&s.jsx("button",{onClick:()=>v(g.id),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-sm font-bold",children:"Restore"})]})]})})]},g.id)})]})]}):s.jsx("div",{children:gn.length===0?s.jsx("div",{className:"p-6 text-center text-gray-400 text-sm",children:Bt?"    .":"  ."}):s.jsx("div",{className:"divide-y divide-gray-100",children:gn.map(g=>{const ie=g.latestDate?new Date(g.latestDate).toLocaleDateString("he-IL"):"-",ae=[...g.reports].sort((de,ke)=>{const Ne=de.reportDate?new Date(de.reportDate).getTime():0;return(ke.reportDate?new Date(ke.reportDate).getTime():0)-Ne});return s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex flex-wrap justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:g.odakanitNo||""}),s.jsxs("p",{className:"text-xs text-gray-500",children:[" : ",s.jsx("span",{className:"font-semibold",children:g.plaintiffName||""}),"   : ",s.jsx("span",{className:"font-semibold",children:g.insuredName||""})]}),s.jsxs("p",{className:"text-xs text-gray-400",children:[" : ",ie]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500",children:'" '}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:g.reports.length}),s.jsx("button",{onClick:()=>St(de=>de===g.key?null:g.key),className:"mt-2 px-4 py-1.5 text-sm font-semibold rounded-full border border-gray-300 text-gray-700 hover:bg-gray-100",children:Se===g.key?" ":" "})]})]}),Se===g.key&&s.jsx("div",{className:"mt-4 bg-gray-50 border border-gray-200 rounded-xl overflow-hidden",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-100 text-gray-600 text-xs uppercase tracking-wide",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3 text-left",children:" "}),s.jsx("th",{className:"p-3 text-left",children:" "}),s.jsx("th",{className:"p-3 text-left",children:" "}),s.jsx("th",{className:"p-3 text-left",children:""}),s.jsx("th",{className:"p-3 text-right",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:ae.map(de=>{const ke=de.status==="READY_TO_SEND",Ne=de.status==="SENT",At=!!de.__templateKey;return s.jsxs("tr",{className:`bg-white ${ke?"bg-red-50":Ne?"bg-green-50/60":""}`,children:[s.jsx("td",{className:"p-3",children:de.reportDate?new Date(de.reportDate).toLocaleDateString("he-IL"):""}),s.jsx("td",{className:"p-3",children:de.plaintiffName||""}),s.jsx("td",{className:"p-3",children:de.insuredName||""}),s.jsx("td",{className:"p-3",children:s.jsx("span",{className:`px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide shadow-sm border ${Ee(de.status)}`,children:_e(de.status)})}),s.jsx("td",{className:"p-3 text-right",children:s.jsxs("div",{className:"flex justify-end gap-2 flex-wrap",children:[s.jsxs("button",{onClick:()=>n(de.id),className:"text-lpBlue hover:bg-blue-50 px-3 py-1.5 rounded transition font-bold text-xs flex items-center",children:["Open ",s.jsx(dn,{className:"w-3 h-3 ml-1"})]}),_&&!Q&&!I&&s.jsxs("button",{onClick:()=>!At&&p(de.id),disabled:At,className:`text-xs px-3 py-1.5 rounded flex items-center gap-1 ${At?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-700 hover:bg-red-100"}`,children:[s.jsx(Sn,{className:"w-3 h-3"})," Delete"]}),I&&s.jsxs(s.Fragment,{children:[Q&&s.jsx("button",{onClick:()=>i(de.id,{sentAt:new Date().toISOString()}),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-xs font-bold",children:"Restore"}),!Q&&_&&s.jsx("button",{onClick:()=>v(de.id),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-xs font-bold",children:"Restore"})]})]})})]},de.id)})})]})})]},g.key)})})})]}),!$&&s.jsx("div",{className:"fixed bottom-8 right-8",children:s.jsx("button",{onClick:r,className:"bg-lpBlue text-white p-4 rounded-full shadow-xl hover:bg-blue-900 transition transform hover:scale-110",children:s.jsx(_0,{className:"w-6 h-6"})})})]})]})},tN=({onLogin:e})=>{const[t,n]=w.useState(""),[r,l]=w.useState(""),i=()=>{const a=Dr.find(o=>o.username===t&&o.password===r);a?e(a):alert("Invalid credentials. Try: lior/lior123")};return s.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 bg-gradient-to-b from-[#08162c] via-[#0b1f3b] to-[#132d52]",children:s.jsxs("div",{className:"w-full max-w-sm bg-white/10 border border-white/15 rounded-[30px] p-10 text-center shadow-2xl backdrop-blur-lg",children:[s.jsx("div",{className:"mx-auto mb-6 h-20 w-20 rounded-full bg-gradient-to-br from-[#f8b733] via-[#f49e1b] to-[#f47b0a] flex items-center justify-center text-4xl font-bold text-[#16305b] shadow-lg",children:"LP"}),s.jsx("div",{className:"text-sm tracking-[0.5em] text-[#f7b23a] uppercase mb-2",children:"Lloyd's"}),s.jsx("div",{className:"text-3xl font-serif text-white mb-1",children:"REPORT"}),s.jsx("div",{className:"text-xs text-blue-200 uppercase tracking-[0.4em] mb-8",children:"Builder System"}),s.jsxs("div",{className:"space-y-4 text-left",children:[s.jsx("label",{className:"text-xs uppercase text-blue-200 tracking-[0.2em]",children:"Username"}),s.jsxs("div",{className:"relative",children:[s.jsx(H0,{className:"w-4 h-4 text-blue-200 absolute left-3 top-1/2 -translate-y-1/2"}),s.jsx("input",{className:"w-full bg-white/10 border border-white/20 rounded-full py-3 pl-10 pr-4 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-[#f7b23a]/60",placeholder:"Username",value:t,onChange:a=>n(a.target.value)})]}),s.jsx("label",{className:"text-xs uppercase text-blue-200 tracking-[0.2em]",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(P0,{className:"w-4 h-4 text-blue-200 absolute left-3 top-1/2 -translate-y-1/2"}),s.jsx("input",{type:"password",className:"w-full bg-white/10 border border-white/20 rounded-full py-3 pl-10 pr-4 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-[#f7b23a]/60",placeholder:"Password",value:r,onChange:a=>l(a.target.value)})]})]}),s.jsxs("button",{onClick:i,className:"mt-8 w-full bg-gradient-to-r from-[#0a6bff] to-[#1740e6] text-white py-3 rounded-full font-semibold tracking-wide flex items-center justify-center gap-2 hover:from-[#0955c6] hover:to-[#1430af] transition-colors",children:["Sign In ",s.jsx(Oc,{className:"w-4 h-4"})]}),s.jsx("div",{className:"mt-6 text-[11px] text-blue-200 tracking-[0.3em] uppercase",children:"Lior Perry Law Office & Notary  2024"})]})})},nN=()=>{var nd,rd;const[e,t]=w.useState(()=>Gy()),[n,r]=w.useState(()=>Ky()),[l,i]=w.useState(()=>Vy()),[a,o]=w.useState(null),c=w.useRef(!1),[d,f]=w.useState(null),[m,x]=w.useState([]),[b,j]=w.useState(!1);e==null||e.role;const[S,O]=w.useState([]),[h,p]=w.useState(!1),[v,E]=w.useState(!1),[D,M]=w.useState([]),[P,H]=w.useState(null),[ne,A]=w.useState(()=>{if(typeof window>"u")return{};try{const u=localStorage.getItem("favoriteProviders");return u?JSON.parse(u):{}}catch(u){return console.error("Failed to load favorite providers",u),{}}}),[y,$]=w.useState(null),[_,R]=w.useState(""),[z,U]=w.useState(null),[te,I]=w.useState(""),[K,q]=w.useState("LAWYER"),[F,Z]=w.useState(!1),[Ie,be]=w.useState(!1),[Me,Se]=w.useState(!1),[St,Q]=w.useState(!1),[pe,Fe]=w.useState(!1),[je,Xe]=w.useState(()=>{if(typeof window>"u")return[];try{const u=localStorage.getItem("caseTemplates");return u?JSON.parse(u):[]}catch(u){return console.error("Failed to load case templates",u),[]}}),[rt,sn]=w.useState(null);w.useEffect(()=>{typeof window>"u"||Ry()||l.length&&pt(u=>{const N=ky(u,l);return Ms(N),Iy(),N})},[l]);const[Kt,pt]=w.useState(()=>Ey());w.useEffect(()=>{n!=="PREVIEW"&&j(!1)},[n]);const wr=u=>u.deletedAt?Date.now()-new Date(u.deletedAt).getTime()>=Lp:u.status==="SENT"&&u.sentAt?Date.now()-new Date(u.sentAt).getTime()>=_p:!1;w.useEffect(()=>{const u=()=>{i(k=>k.filter(L=>!wr(L)))};u();const N=setInterval(u,60*60*1e3);return()=>clearInterval(N)},[]),w.useEffect(()=>{if(!v)return;const u=setInterval(()=>{if(!l.length)return;const N=l.filter(C=>C.status==="READY_TO_SEND").length,k=l.filter(C=>C.status==="SENT").length,L=`Daily summary: ${N} ready to send, ${k} sent reports.`;O(C=>[{id:`daily-${Date.now()}`,message:L,createdAt:new Date().toISOString(),severity:"info"},...C])},1e3*60*60*12);return()=>clearInterval(u)},[v,l]),w.useEffect(()=>{try{localStorage.setItem("caseTemplates",JSON.stringify(je))}catch(u){console.error("Failed to persist case templates",u)}},[je]),w.useEffect(()=>{try{localStorage.setItem("favoriteProviders",JSON.stringify(ne))}catch(u){console.error("Failed to persist favorites",u)}},[ne]),w.useEffect(()=>{if(!(typeof window>"u"))try{localStorage.setItem(Ke.REPORTS,JSON.stringify(l))}catch(u){console.error("Failed to persist reports",u)}},[l]),w.useEffect(()=>{typeof window>"u"||(e?localStorage.setItem(Ke.USER,e.username):localStorage.removeItem(Ke.USER))},[e]),w.useEffect(()=>{typeof window>"u"||localStorage.setItem(Ke.VIEW,n)},[n]),w.useEffect(()=>{typeof window>"u"||(a?localStorage.setItem(Ke.CURRENT_REPORT,a.id):localStorage.removeItem(Ke.CURRENT_REPORT))},[a]),w.useEffect(()=>{if(typeof window>"u"||c.current)return;const u=localStorage.getItem(Ke.CURRENT_REPORT);if(!u){c.current=!0;return}const N=l.find(k=>k.id===u);N&&o(N),c.current=!0},[l,e]),w.useEffect(()=>{n!=="DASHBOARD"&&(a||(r("DASHBOARD"),typeof window<"u"&&(localStorage.setItem(Ke.VIEW,"DASHBOARD"),localStorage.removeItem(Ke.CURRENT_REPORT))))},[a,n]);const ht=()=>({id:Date.now().toString(),createdBy:e.id,ownerName:e.name,ownerEmail:e.email,reportDate:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"DRAFT",reportSubject:"",recipientId:"1",insurerName:"",lineSlipNo:"",marketRef:"",certificateRef:"",insuredName:"",plaintiffName:"",plaintiffTitle:"Plaintiff",policyPeriodStart:"",policyPeriodEnd:"",retroStart:"",retroEnd:"",sentAt:void 0,reportHistory:[],selectedTimeline:"standard",filenameTag:ap[0],selectedSections:["Update","Recommendations"],content:{},translatedContent:{},invoiceFiles:[],isWaitingForInvoices:!1,requiresExpenses:!1,isTranslated:!1,expensesItems:[],expenseWorksheet:nr(),reportNotes:[],complaintAnalysis:void 0,attachPolicyAsAppendix:!0}),An=u=>{const N=u.createdBy||"unknown",k=u.odakanitNo||u.marketRef||u.id,L=(u.plaintiffName||"unknown").toLowerCase();return`${N}::${k}::${L}`},Ft=u=>{const N=An(u),k={caseKey:N,ownerId:u.createdBy,ownerName:u.ownerName,odakanitNo:u.odakanitNo,plaintiffName:u.plaintiffName,plaintiffTitle:u.plaintiffTitle,insurerName:u.insurerName,lineSlipNo:u.lineSlipNo,marketRef:u.marketRef,certificateRef:u.certificateRef,insuredName:u.insuredName,policyPeriodStart:u.policyPeriodStart,policyPeriodEnd:u.policyPeriodEnd,retroStart:u.retroStart,retroEnd:u.retroEnd,lastUpdated:new Date().toISOString()};Xe(L=>L.find(ee=>ee.caseKey===N)?L.map(ee=>ee.caseKey===N?k:ee):[...L,k])},Rt=u=>{if(!e)return;const N=je.find(L=>L.caseKey===u&&L.ownerId===e.id);if(!N)return;const k={...ht(),odakanitNo:N.odakanitNo||"",insurerName:N.insurerName||"",lineSlipNo:N.lineSlipNo||"",marketRef:N.marketRef||"",certificateRef:N.certificateRef||"",insuredName:N.insuredName||"",plaintiffName:N.plaintiffName||"",plaintiffTitle:N.plaintiffTitle||"Plaintiff",policyPeriodStart:N.policyPeriodStart||"",policyPeriodEnd:N.policyPeriodEnd||"",retroStart:N.retroStart||"",retroEnd:N.retroEnd||""};o(k),r("STEP1")},Tt=u=>{var ct;if(!e)return;const N=xt(u);if(!N||N.createdBy!==e.id||(((ct=N.reportHistory)==null?void 0:ct.length)||0)===0||N.status!=="SENT")return;const k=N.reportHistory[N.reportHistory.length-1];if(!k)return;const C=k.snapshot||N,ee=C.selectedSections&&C.selectedSections.length?[...C.selectedSections]:[...N.selectedSections||[]],ue=ee.length?ee:["Update","Recommendations"],he=new Date().toISOString(),re={...N,reportDate:he,updatedAt:he,status:"DRAFT",sentAt:void 0,reportNotes:[],content:{},translatedContent:{},executiveSummary:void 0,complaintAnalysis:void 0,expensesItems:[],expensesSum:void 0,paymentRecommendation:void 0,expenseWorksheet:nr(),invoiceFiles:[],expensesSourceFile:void 0,requiresExpenses:!1,isWaitingForInvoices:!1,isTranslated:!1,selectedEmailTemplate:void 0,emailBodyDraft:void 0,fileNameTitles:[],deletedAt:void 0,deletedBy:void 0,selectedSections:ue,reportHistory:[...N.reportHistory||[]]};re.insurerName=C.insurerName||"",re.lineSlipNo=C.lineSlipNo||"",re.marketRef=C.marketRef||"",re.certificateRef=C.certificateRef||"",re.insuredName=C.insuredName||"",re.plaintiffName=C.plaintiffName||"",re.plaintiffTitle=C.plaintiffTitle||N.plaintiffTitle,re.policyPeriodStart=C.policyPeriodStart||"",re.policyPeriodEnd=C.policyPeriodEnd||"",re.retroStart=C.retroStart||"",re.retroEnd=C.retroEnd||"",re.filenameTag=C.filenameTag||re.filenameTag,re.fileNameTitles=[],re.selectedTimeline=C.selectedTimeline||re.selectedTimeline,re.selectedTimelineImage=C.selectedTimelineImage,re.odakanitNo=C.odakanitNo||N.odakanitNo,re.recipientId=C.recipientId||N.recipientId,i(Ct=>Ct.map(lt=>lt.id===N.id?re:lt)),o(re),Ft(re),r("STEP1")},xt=u=>l.find(N=>N.id===u),et=(u,N)=>{if(u.status!==N.status||u.hebrewWorkflowStatus!==N.hebrewWorkflowStatus||u.insuredName!==N.insuredName||u.plaintiffName!==N.plaintiffName||u.insurerName!==N.insurerName||u.odakanitNo!==N.odakanitNo||u.marketRef!==N.marketRef||u.lineSlipNo!==N.lineSlipNo||u.certificateRef!==N.certificateRef||u.policyPeriodStart!==N.policyPeriodStart||u.policyPeriodEnd!==N.policyPeriodEnd||u.retroStart!==N.retroStart||u.retroEnd!==N.retroEnd||u.reportSubject!==N.reportSubject||u.executiveSummary!==N.executiveSummary)return!0;const k=(L,C)=>JSON.stringify(L)===JSON.stringify(C);return!k(u.content,N.content)||!k(u.translatedContent,N.translatedContent)||!k(u.expenseWorksheet,N.expenseWorksheet)||!k(u.expensesItems,N.expensesItems)||u.expensesSum!==N.expensesSum||u.paymentRecommendation!==N.paymentRecommendation||!k(u.complaintAnalysis,N.complaintAnalysis)||!k(u.reportReview,N.reportReview)},Yt=(u,N)=>{u.odakanitNo&&pt(k=>{const L=Bo(k,u,N);return Ms(L),L})},X=(u,N,k,L)=>{u.odakanitNo&&pt(C=>{const ee=Dp(C,u,N,k,L);return Ms(ee),ee})},ce=(u,N)=>{const k=u.reportReview??{status:"DRAFT",issues:[]};return{...u,reportReview:N(k)}},fe=u=>{J(u,N=>{const k=(e==null?void 0:e.id)||"unknown",L=new Date().toISOString();return{...ce(N,ee=>({...ee,status:"SUBMITTED",submittedAt:L,submittedByUserId:ee.submittedByUserId||k})),hebrewWorkflowStatus:"HEBREW_SUBMITTED"}})},Ae=u=>{(e==null?void 0:e.role)==="ADMIN"&&J(u,N=>{const k=(e==null?void 0:e.id)||"unknown",L=new Date().toISOString();return{...ce(N,ee=>({...ee,status:"APPROVED",reviewedAt:L,reviewedByUserId:k})),hebrewWorkflowStatus:"HEBREW_APPROVED"}})},T=(u,N)=>{N.length&&J(u,k=>{const L=(e==null?void 0:e.id)||"unknown",C=new Date().toISOString();return{...ce(k,ue=>({...ue,status:"CHANGES_REQUESTED",reviewedAt:C,reviewedByUserId:L,issues:[...ue.issues,...N.map(he=>({id:`issue-${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:C,createdByUserId:L,sectionKey:he.sectionKey,severity:he.severity,type:he.type,title:he.title,instruction:he.instruction,status:"OPEN"}))]})),hebrewWorkflowStatus:"HEBREW_CHANGES_REQUESTED"}})},G=(u,N)=>{J(u,k=>{const L=new Date().toISOString();return ce(k,C=>({...C,issues:C.issues.map(ee=>ee.id===N&&ee.status!=="DONE"?{...ee,status:"DONE",doneAt:L}:ee)}))})},Y=u=>{(e==null?void 0:e.role)==="ADMIN"&&J(u,N=>{const k=new Date().toISOString();return ce(N,L=>({...L,issues:L.issues.map(C=>(C.origin??"INTERNAL")==="EXTERNAL"&&C.status!=="DONE"?{...C,status:"DONE",doneAt:k}:C)}))})},W=u=>{var k;return u?((k=u.reportReview)==null?void 0:k.status)==="APPROVED"||u.hebrewWorkflowStatus==="HEBREW_APPROVED":!1},J=(u,N)=>{const k=new Date().toISOString();let L=null,C=null;if(i(ee=>ee.map(ue=>{if(ue.id!==u)return ue;const he=N(ue);return L=ue,C=he,et(ue,he)?{...he,updatedAt:k}:he})),L&&C&&L.odakanitNo&&C.odakanitNo){const ee=L.odakanitNo.trim(),ue=C.odakanitNo.trim();ee&&ue&&ee!==ue&&pt(he=>{let re={...he};const ct=re[ee];if(ct){const Ct=ct.reportIds.filter(lt=>lt!==C.id);re[ee]={...ct,reportIds:Ct}}return re=Bo(re,C,k),Ms(re),re})}o(ee=>{if(!ee||ee.id!==u)return ee;const ue=N(ee);return et(ee,ue)?{...ue,updatedAt:k}:ue})},oe=(u,N,k)=>{N.length&&(e==null?void 0:e.role)==="ADMIN"&&J(u,L=>{const C=(e==null?void 0:e.id)||"unknown",ee=new Date().toISOString();return{...ce(L,he=>({...he,status:"CHANGES_REQUESTED",reviewedAt:ee,reviewedByUserId:C,issues:[...he.issues,...N.map(re=>({id:`issue-${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:ee,createdByUserId:C,sectionKey:re.sectionKey,severity:re.severity,type:re.type,title:re.title,instruction:re.instruction,status:"OPEN",origin:"EXTERNAL",externalRefId:k,externalAction:re.externalAction??"ENGLISH_ONLY"}))]})),postSendFeedbackMeta:{...L.postSendFeedbackMeta||{},lastFeedbackAt:ee}}})},ye=u=>{(e==null?void 0:e.role)==="ADMIN"&&J(u,N=>{const k=new Date().toISOString(),L=N.reportReview??{status:"DRAFT",issues:[]};return{...N,hebrewWorkflowStatus:"HEBREW_REOPENED_EXTERNAL",reportReview:{...L,status:L.status==="CHANGES_REQUESTED"?L.status:"CHANGES_REQUESTED"},postSendFeedbackMeta:{...N.postSendFeedbackMeta||{},reopenedDueToFeedbackAt:k}}})},we=u=>{O(N=>[u,...N])},Be=u=>{M(N=>N.some(k=>k.reportId===u)?N:[...N,{reportId:u}]),H(u)},Ee=u=>{M(N=>N.filter(k=>k.reportId!==u)),H(N=>N===u?null:N)},_e=(u,N)=>{A(k=>{const L=k[u]||[];return L.some(C=>C.serviceProvider.toLowerCase()===N.serviceProvider.toLowerCase()&&C.category===N.category)?k:{...k,[u]:[N,...L]}})},qe=(u,N)=>{A(k=>{const L=k[u]||[];return{...k,[u]:L.filter(C=>C.id!==N)}})},$e=u=>{if(a){const N=a,k={...a,...u},L=et(N,k);o(L?{...k,updatedAt:new Date().toISOString()}:k)}},Ge=()=>{a&&i(u=>{const k=u.find(L=>L.id===a.id)?u.map(L=>L.id===a.id?a:L):[...u,a];return Yt(a),k})},gt=()=>{if(!a)return;const u=Fa(a.content),N=Fa(a.translatedContent);$e({content:u,translatedContent:N})},xn=async()=>{if(!a)return;if(!W(a)){setShowToast({type:"error",msg:"       ."});return}const u=Fa(a.content),N={};for(const k of Object.keys(u)){const L=u[k];if(L){const C=await Ty(L);N[k]=Op(C)}}$e({content:u,translatedContent:N,isTranslated:!0}),alert("Translation Complete!")},ge=u=>{const N=new Set(["zeev@sure.co.il"]),k=new Set(["reports@lp-law.co.il"]);if(u.ownerEmail)k.add(u.ownerEmail);else{const L=Dr.find(C=>C.id===u.createdBy);L!=null&&L.email&&k.add(L.email)}return{to:Array.from(N),cc:Array.from(k)}},st=u=>{var C;const N=u.insurerName||"Report",k=u.insuredName||"Insured",L=(((C=u.reportHistory)==null?void 0:C.length)||0)+1;return`${N} - ${k} - Report ${L}`},Bt=u=>({...u,invoiceFiles:[],policyFile:void 0,expensesSourceFile:void 0}),El=(u,N)=>{var C,ee,ue;const k=u.content?Gr(u.content):{},L=u.translatedContent?Gr(u.translatedContent):{};return{createdAt:N,reportDate:u.reportDate,subject:((C=u.emailSubjectDraft)==null?void 0:C.trim())||st(u),status:"SENT",odakanitNo:u.odakanitNo,recipientId:u.recipientId,insurerName:u.insurerName,lineSlipNo:u.lineSlipNo,marketRef:u.marketRef,insuredName:u.insuredName,plaintiffName:u.plaintiffName,plaintiffTitle:u.plaintiffTitle,policyPeriodStart:u.policyPeriodStart,policyPeriodEnd:u.policyPeriodEnd,retroStart:u.retroStart,retroEnd:u.retroEnd,filenameTag:u.filenameTag,fileNameTitles:u.fileNameTitles?[...u.fileNameTitles]:void 0,selectedSections:[...u.selectedSections||[]],content:k,translatedContent:L,executiveSummary:u.executiveSummary,complaintAnalysis:u.complaintAnalysis?Gr(u.complaintAnalysis):void 0,requiresExpenses:!!u.requiresExpenses,isWaitingForInvoices:!!u.isWaitingForInvoices,isTranslated:!!u.isTranslated,selectedTimeline:u.selectedTimeline,selectedTimelineImage:u.selectedTimelineImage,expensesItems:(ee=u.expensesItems)!=null&&ee.length?Gr(u.expensesItems):void 0,expenseWorksheet:u.expenseWorksheet?Gr(u.expenseWorksheet):void 0,expensesSum:u.expensesSum,paymentRecommendation:u.paymentRecommendation,reportNotes:(ue=u.reportNotes)!=null&&ue.length?Gr(u.reportNotes):void 0,ownerName:u.ownerName,ownerEmail:u.ownerEmail}},Qn=(u,N,k)=>{var C,ee;const L=((C=u.emailSubjectDraft)==null?void 0:C.trim())||st(u);return{id:Qt(),reportNumber:(((ee=u.reportHistory)==null?void 0:ee.length)||0)+1,subject:L,date:k,sent:!0,fileName:N,snapshot:El(u,k)}},gn=(u,N,k)=>{if(typeof window>"u")return;const L=u.to.join(";"),C=new URLSearchParams;u.cc.length&&C.append("cc",u.cc.join(";")),C.append("subject",N),C.append("body",k);const ee=`mailto:${L}?${C.toString()}`;window.location.href=ee},Sr=async()=>{if(a){Z(!0);try{const u=await Ma(a),N=Hs(a),k=URL.createObjectURL(u),L=document.createElement("a");L.href=k,L.download=N,document.body.appendChild(L),L.click(),L.remove(),URL.revokeObjectURL(k)}catch(u){console.error("PDF download failed",u),alert(" -PDF .  .")}finally{Z(!1)}}},Wr=()=>{a&&((e==null?void 0:e.role)==="ADMIN"?(Q(!1),be(!0)):ke())},g=()=>{var k,L;if(!a||(e==null?void 0:e.role)!=="ADMIN")return;if(a.status!=="SENT"){setShowToast({msg:"       (SENT).",type:"error"});return}if(!W(a)){setShowToast({msg:"   /   .       .",type:"error"});return}if(((L=(k=a.reportReview)==null?void 0:k.issues)==null?void 0:L.some(C=>(C.origin??"INTERNAL")==="EXTERNAL"&&C.status!=="DONE"&&C.externalAction==="REQUIRES_HEBREW"))??!1){setShowToast({msg:"      .    /      .",type:"error"});return}if(!(a.isTranslated&&a.translatedContent&&Object.values(a.translatedContent).some(C=>C&&C.trim().length>0))){setShowToast({msg:"    .      .",type:"error"});return}Q(!0),be(!0)},ie=async({body:u,templateId:N,subjectBase:k,topics:L})=>{if(!a)return;const C={...a,selectedEmailTemplate:N,emailBodyDraft:u,emailSubjectDraft:k.trim()?k.trim():void 0,fileNameTitles:L};if($e({selectedEmailTemplate:N,emailBodyDraft:u,emailSubjectDraft:C.emailSubjectDraft,fileNameTitles:L}),e){const Ct=Oo(e.id),lt=ju(Ct,L,6);wu(e.id,lt)}Se(!0);let ee=null,ue="";const he=k.trim()||st(C);let re="",ct=!1;try{const Ct=await Ma(C),lt=await Fu(Ct);re=Hs(C),ee=ge(C),ue=he,ct=await Du({to:ee.to,cc:ee.cc,subject:ue,body:u,attachmentBase64:lt,attachmentName:re}),ct?setShowToast({msg:"  .",type:"success"}):setShowToast({msg:"         .",type:"error"})}catch(Ct){console.error("Email send failed",Ct),setShowToast({msg:"         .",type:"error"})}finally{ee&&(ct||gn(ee,ue||he,u),ke(re||void 0),be(!1)),Se(!1)}},ae=async({body:u,templateId:N,subjectBase:k,topics:L})=>{var Ct;if(!a||(e==null?void 0:e.role)!=="ADMIN")return;const C={...a,selectedEmailTemplate:N,emailBodyDraft:u,emailSubjectDraft:k.trim()?k.trim():void 0,fileNameTitles:L};if($e({selectedEmailTemplate:N,emailBodyDraft:u,emailSubjectDraft:C.emailSubjectDraft,fileNameTitles:L}),e&&L.length){const lt=Oo(e.id),Xn=ju(lt,L,6);wu(e.id,Xn)}Se(!0);let ee=null,ue="",he="";const re=k.trim()||st(C);let ct=!1;try{const lt=await Ma(C),Xn=await Fu(lt);he=Hs(C),ee=ge(C),ue=`UPDATED: ${re}`,ct=await Du({to:ee.to,cc:ee.cc,subject:ue,body:u,attachmentBase64:Xn,attachmentName:he}),ct?setShowToast({msg:"   ( ).",type:"success"}):setShowToast({msg:"         .",type:"error"});const qn=new Date().toISOString(),Il=Qn({...a,status:"SENT",sentAt:qn},he,qn),Kp=(((Ct=a.reportHistory)==null?void 0:Ct.length)||0)+1,sd={...Il,subject:`Resent #${Kp}  ${Il.subject}`},zr={...a,status:"SENT",sentAt:qn,reportHistory:[...a.reportHistory||[],sd],selectedEmailTemplate:void 0,emailBodyDraft:void 0};Ft(zr),Yt(zr,qn),X(zr,qn,sd.fileName||he,!0),o(zr),i(Yp=>Yp.map(ld=>ld.id===zr.id?zr:ld))}catch(lt){console.error("Resend email failed",lt),setShowToast({msg:"         .",type:"error"})}finally{if(ee){const lt=re||st(a),Xn=ue||`UPDATED: ${lt}`;ct||gn(ee,Xn,u),be(!1)}Q(!1),Se(!1)}},de=u=>{if(!u)return;let N=u.trim();if(!(!N||(N=N.replace(Kc," ").replace(/\s+/g," ").trim(),!N)||(N.toLowerCase().endsWith(".pdf.pdf")&&(N=N.slice(0,-4)),N.toLowerCase().endsWith(".pdf")||(N=`${N}.pdf`),N.length>255)))return N},ke=u=>{var ee;if(!a)return;let N="READY_TO_SEND",k=a.sentAt,L=a;if((e==null?void 0:e.role)==="ADMIN"){N="SENT",k=new Date().toISOString();const he=de(u)||Hs(Bt(a)),re=Qn({...a},he,k);L={...a,reportHistory:[...a.reportHistory||[],re],selectedEmailTemplate:void 0,emailBodyDraft:void 0}}else((e==null?void 0:e.role)==="FINANCE"||(e==null?void 0:e.role)==="SUB_ADMIN")&&(N="TASK_ASSIGNED");const C={...L,status:N,sentAt:k};if(Ft(C),Yt(C,k||new Date().toISOString()),N==="SENT"&&k){const ue=(ee=C.reportHistory)==null?void 0:ee[C.reportHistory.length-1];X(C,k,ue==null?void 0:ue.fileName,!1)}o(C),i(ue=>ue.find(re=>re.id===C.id)?ue.map(re=>re.id===C.id?C:re):[...ue,C]),r("DASHBOARD")},Ne=(u,N)=>{e&&(J(u,k=>{const L=[{id:Qt(),authorId:e.id,authorName:e.name,message:N,createdAt:new Date().toISOString()},...k.reportNotes||[]];return{...k,reportNotes:L}}),we({id:`note-${Date.now()}`,message:`${e.name} added a note: "${N}"`,createdAt:new Date().toISOString()}))},At=(u,N)=>{J(u,k=>{const L=k.expenseWorksheet||nr(),C={id:Qt(),timestamp:new Date().toISOString(),userId:(e==null?void 0:e.id)||"system",userName:(e==null?void 0:e.name)||"System",action:N.action||"UPDATE",details:N.details};return{...k,expenseWorksheet:{...L,history:[C,...L.history||[]]}}})},Cn=(u,N,k)=>{e&&(J(u,L=>{const C=L.expenseWorksheet||nr(),ee={id:Qt(),rowId:N,authorId:e.id,authorName:e.name,message:k,createdAt:new Date().toISOString()};return{...L,expenseWorksheet:{...C,notes:[ee,...C.notes||[]]}}}),At(u,{action:"NOTE_ADDED",details:k}))},Es=u=>{const N=new Date().toISOString();J(u,k=>({...k,deletedAt:N,deletedBy:e==null?void 0:e.id}))},ks=u=>{J(u,N=>{const k={...N};return delete k.deletedAt,delete k.deletedBy,k})},sa=(u,N)=>{J(u,k=>{const L=k.expenseWorksheet||nr();return{...k,expenseWorksheet:{...L,notes:L.notes.map(C=>C.id===N?{...C,resolved:!0,resolvedAt:new Date().toISOString()}:C)}}})},Bp=(u,N)=>{!N.amount||N.amount<=0||J(u,k=>{var Xn,qn;const L=k.expenseWorksheet||nr(),C=kn.find(Il=>Il.value===N.category),ee=(C==null?void 0:C.type)||"EXPENSE",ue=N.category==="OTHER"?((Xn=N.customLabel)==null?void 0:Xn.trim())||"Other expense":(C==null?void 0:C.label)||"Expense",he={id:Qt(),type:ee,category:N.category,label:ue,serviceProvider:ee==="EXPENSE"?(qn=N.serviceProvider)==null?void 0:qn.trim():void 0,amount:N.amount,createdBy:e==null?void 0:e.id,createdAt:new Date().toISOString()},re=[...L.rows||[],he],ct=$i(re),Ct=Xy(re),lt={id:Qt(),timestamp:new Date().toISOString(),userId:(e==null?void 0:e.id)||"system",userName:(e==null?void 0:e.name)||"System",action:"ROW_ADDED",details:`${ue} ${he.amount.toLocaleString()}`};return{...k,expenseWorksheet:{...L,rows:re,totals:ct,history:[lt,...L.history||[]]},expensesItems:Ct,expensesSum:ct.totalExpenses.toLocaleString()}})},$p=u=>{const N=Dr.find(re=>re.id===u.lawyerId);if(!N)return;const k=$o(u.worksheet||[],e||void 0),L=$i(k),C=u.invoiceFiles||[],ee=C.length===0,ue={...ht(),createdBy:N.id,ownerName:N.name,ownerEmail:N.email,status:ee?"WAITING_FOR_INVOICES":"TASK_ASSIGNED",odakanitNo:u.odakanitNo,financeInstructions:u.instructions,expensesSourceFile:u.file,selectedSections:["Update","Expenses breakdown"],isWaitingForInvoices:ee,requiresExpenses:!0},he={...ue,expensesItems:k.filter(re=>re.type==="EXPENSE").map(re=>({id:re.id,date:new Date().toISOString().split("T")[0],description:`${re.label}${re.serviceProvider?` (${re.serviceProvider})`:""}`,amount:re.amount,currency:"NIS"})),expensesSum:k.length?L.totalExpenses.toLocaleString():ue.expensesSum,invoiceFiles:C,expenseWorksheet:{status:"DRAFT",rows:k,history:[{id:Qt(),timestamp:new Date().toISOString(),userId:(e==null?void 0:e.id)||"system",userName:(e==null?void 0:e.name)||"System",action:"WORKSHEET_CREATED",details:`${k.length} rows added via finance request`}],notes:[],favorites:ne[u.lawyerId]||[],totals:L}};i(re=>[...re,he]),we({id:`worksheet-${Date.now()}`,message:`New expense worksheet created for case ${u.odakanitNo||he.id}`,createdAt:new Date().toISOString(),reportId:he.id,severity:"info"})},Up=u=>{t(u),r("DASHBOARD"),o(null),c.current=!1,typeof window<"u"&&(localStorage.setItem(Ke.USER,u.username),localStorage.setItem(Ke.VIEW,"DASHBOARD"),localStorage.removeItem(Ke.CURRENT_REPORT))},Jc=()=>{if(t(null),o(null),c.current=!1,r("DASHBOARD"),f(null),j(!1),be(!1),Se(!1),Q(!1),Fe(!1),$(null),R(""),U(null),I(""),q("LAWYER"),M([]),H(null),p(!1),O([]),sn(null),x([]),typeof window<"u")try{localStorage.removeItem(Ke.USER),localStorage.removeItem(Ke.CURRENT_REPORT),localStorage.setItem(Ke.VIEW,"DASHBOARD"),localStorage.removeItem(Ws)}catch(u){console.error("Failed to clear session storage on logout",u)}};if(!e)return s.jsx(tN,{onLogin:Up});if(n==="CASE_FOLDER"&&rt){const u=Kt[rt]||null,N=()=>{r("DASHBOARD")};return u?s.jsx(jy,{folder:u,reports:l,onBack:N,onUpdateReTemplate:k=>{pt(L=>{const C=L[rt];if(!C)return L;const ee={...C,reTemplate:k,updatedAt:new Date().toISOString()},ue={...L,[rt]:ee};return Ms(ue),ue})},onCreateReportInCase:()=>{const k=Kt[rt];if(!k||!e)return;const L=new Date().toISOString(),C={...ht(),odakanitNo:k.odakanitNo,reportSubject:k.reTemplate||"",insuredName:k.insuredName||"",plaintiffName:k.plaintiffName||"",insurerName:k.insurerName||"",marketRef:k.marketRef||"",lineSlipNo:k.lineSlipNo||"",certificateRef:k.certificateRef||"",reportDate:L,updatedAt:L};if(o(C),r("STEP1"),typeof window<"u")try{localStorage.setItem(Ke.CURRENT_REPORT,C.id)}catch{}Yt(C,L)},onOpenReport:k=>{const L=l.find(C=>C.id===k);if(L&&(o(L),r("STEP1"),typeof window<"u"))try{localStorage.setItem(Ke.CURRENT_REPORT,L.id)}catch{}}}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:s.jsxs("div",{className:"max-w-md rounded-2xl bg-white p-6 text-center text-sm text-gray-700 shadow-sm border border-gray-200",children:[s.jsx("p",{className:"mb-3 font-semibold text-gray-900",children:"Case folder not found"}),s.jsx("p",{className:"mb-4 text-xs text-gray-500",children:"The requested case folder is no longer available. You can return to the dashboard and select another case."}),s.jsx("button",{type:"button",onClick:N,className:"inline-flex items-center rounded-full bg-lpBlue px-4 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:"Back to dashboard"})]})})}const Zc=()=>{const u=ht();if(o(u),r("STEP1"),typeof window<"u")try{localStorage.setItem(Ke.CURRENT_REPORT,u.id)}catch{}},la=(u,N)=>{const k=l.find(L=>L.id===u);if(k&&(o(k),r("STEP1"),f(N||null),typeof window<"u"))try{localStorage.setItem(Ke.CURRENT_REPORT,k.id)}catch{}};if(n==="DASHBOARD")return(e==null?void 0:e.role)==="ADMIN"?s.jsx(Yg,{user:e,reports:l,onNewReport:Zc,onSelectReport:la,onSelectReportWithFocus:(u,N)=>la(u,N),onMarkExternalIssuesDone:Y,onReopenHebrewDueToExternalFeedback:u=>ye(u),canTranslate:W,onLogout:Jc}):s.jsx(eN,{user:e,reports:l,onNewReport:Zc,onSelectReport:la,onLogout:Jc,onUpdateReport:(u,N)=>{i(k=>k.map(L=>L.id===u?{...L,...N}:L))},onDeleteReport:u=>i(N=>N.filter(k=>k.id!==u)),onFinanceTaskCreate:$p,caseTemplates:je,onStartTemplate:Rt,onStartNextReport:Tt,archiveAfterMs:Hy,favoriteProviders:ne,onSaveFavorite:_e,onDeleteFavorite:qe,onOpenWorksheet:Be,onRequestReminder:u=>{U(u),I(`Reminder for ${u.insuredName||"case"}`)},onRequestNote:u=>{$(u),R("")},onSoftDeleteReport:Es,onRestoreReport:ks,notifications:S,showNotifications:h,setShowNotifications:p,onClearNotifications:()=>O([]),dailySummaryOptIn:v,setDailySummaryOptIn:E,caseFolders:Kt,onOpenCaseFolder:u=>{sn(u),r("CASE_FOLDER")}});if(!a)return null;const Hp=(((nd=a.reportHistory)==null?void 0:nd.length)||0)+1,ed=cp(a.selectedSections||[]),td=ed.map((u,N)=>({id:`${N}-${u.replace(/\s+/g,"-")||"title"}`,label:u})).filter(u=>!!u.label),Wp=Po(ed),zp=a.fileNameTitles&&a.fileNameTitles.length?a.fileNameTitles:Wp,Vp=Hp!==1&&td.length>0,Gp=D.map(u=>{const N=xt(u.reportId);return N?{...u,report:N,title:`${N.insuredName||"Case"} (${N.ownerName})`}:null}).filter(Boolean),kl=P?xt(P):null;return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"min-h-screen bg-gray-50 pb-12",children:s.jsxs("div",{className:"max-w-5xl mx-auto pt-6 px-4",children:[s.jsx("div",{className:"flex justify-center mb-8",children:s.jsxs("div",{className:"flex items-center bg-white p-2 rounded-full shadow-sm",children:[s.jsx("div",{className:`px-4 py-1 rounded-full ${n==="STEP1"?"bg-lpBlue text-white font-bold":"text-gray-500"}`,children:"1. Setup"}),s.jsx(dn,{className:"w-4 h-4 text-gray-300 mx-2"}),s.jsx("div",{className:`px-4 py-1 rounded-full ${n==="STEP2"?"bg-lpBlue text-white font-bold":"text-gray-500"}`,children:"2. Draft"}),s.jsx(dn,{className:"w-4 h-4 text-gray-300 mx-2"}),s.jsx("div",{className:`px-4 py-1 rounded-full ${n==="PREVIEW"?"bg-lpBlue text-white font-bold":"text-gray-500"}`,children:"3. Preview"})]})}),n==="STEP1"&&s.jsx(qy,{data:a,updateData:$e,onNext:()=>{Ge(),r("STEP2")},onBack:()=>{Ge(),r("DASHBOARD")},currentUser:e,timelineGallery:m,onAddTimelineImages:u=>x(N=>[...N,...u.map(k=>({...k,id:Date.now().toString()}))]),onRemoveTimelineImage:u=>x(N=>N.filter(k=>k.id!==u)),onSaveAndExit:()=>{Ge(),r("DASHBOARD")}}),n==="STEP2"&&s.jsx(Jy,{data:a,updateData:$e,onNext:()=>{Ge(),r("PREVIEW")},onBack:()=>{Ge(),r("STEP1")},currentUser:e,timelineGallery:m,onAddTimelineImages:u=>{},onSaveAndExit:()=>{Ge(),r("DASHBOARD")},onTranslate:xn,onFormatContent:gt,onSubmitHebrewForReview:()=>fe(a.id),onApproveHebrewForTranslation:()=>Ae(a.id),onAddReviewIssues:u=>T(a.id,u),onMarkReviewIssueDone:u=>G(a.id,u),onAddExternalFeedbackIssues:(u,N)=>oe(a.id,u,N),onReopenHebrewDueToExternalFeedback:()=>ye(a.id),step1Focus:d,onStep1FocusConsumed:()=>f(null)}),n==="PREVIEW"&&(()=>{const u=My(e==null?void 0:e.role),N=(e==null?void 0:e.role)==="LAWYER";return s.jsxs("div",{className:"space-y-6 animate-fade-in",dir:N?"rtl":void 0,lang:N?"he":void 0,children:[s.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>{Ge(),r("STEP2")},className:"flex items-center text-sm text-gray-600 bg-gray-100 px-3 py-1.5 rounded-full hover:bg-gray-200",children:[s.jsx(Pi,{className:"w-4 h-4 mr-1"}),u.backToStep2]}),s.jsxs("button",{onClick:()=>{Ge(),r("DASHBOARD")},className:"flex items-center text-sm text-lpBlue bg-blue-50 px-3 py-1.5 rounded-full hover:bg-blue-100",children:[s.jsx(Bc,{className:"w-4 h-4 mr-1"}),u.backToDashboard]})]}),s.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded shadow mb-4",children:[s.jsx("h2",{className:"text-xl font-bold text-lpBlue",children:u.title}),s.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[s.jsx("button",{onClick:()=>j(k=>!k),className:"flex items-center bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300",children:b?u.toggleHide:u.toggleShow}),s.jsxs("button",{onClick:Sr,disabled:F,className:"flex items-center bg-white text-gray-700 border border-gray-300 px-4 py-2 rounded hover:bg-gray-50 disabled:opacity-50",children:[F?s.jsx(jn,{className:"w-4 h-4 mr-2 animate-spin"}):s.jsx(Br,{className:"w-4 h-4 mr-2"}),u.downloadPdf]}),s.jsx("button",{onClick:()=>Fe(!0),disabled:!Vp,className:"flex items-center bg-white text-gray-700 border border-gray-300 px-4 py-2 rounded hover:bg-gray-50 disabled:opacity-40",children:u.editFileNames}),s.jsxs("button",{onClick:Wr,className:"flex items-center bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:[s.jsx(Oi,{className:"w-4 h-4 mr-2"}),u.finalize]}),e.role==="ADMIN"&&s.jsxs("button",{onClick:g,className:"flex items-center bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700",children:[s.jsx(Oi,{className:"w-4 h-4 mr-2"}),"   "]})]})]}),b?s.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-end flex-wrap gap-3",children:s.jsx("span",{className:"text-xs text-gray-500",children:u.helperScroll})}),s.jsx("div",{className:"border rounded-2xl bg-gray-50 p-4 pr-6 max-h-[900px] overflow-auto shadow-inner",children:s.jsx("div",{className:"scale-[0.85] origin-top flex justify-center overflow-visible",children:s.jsx(K0,{data:a})})})]}):s.jsx("div",{className:"text-center text-gray-500 border border-dashed border-gray-300 rounded-2xl p-6 bg-gray-50",children:u.collapsedHint}),s.jsx("div",{className:"flex justify-start mt-4",children:s.jsx("button",{onClick:()=>r("STEP2"),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:u.backToEditing})})]})})()]})}),a&&s.jsx(ag,{isOpen:Ie,isSending:Me,report:a,userId:e==null?void 0:e.id,recipientsPreview:ge(a),defaultSubject:st(a),subjectDraft:((rd=a.emailSubjectDraft)==null?void 0:rd.trim())||st(a),onSubjectDraftChange:u=>$e({emailSubjectDraft:u&&u.trim()?u.trim():void 0}),selectedTopics:a.fileNameTitles||[],onSelectedTopicsChange:u=>$e({fileNameTitles:u}),onClose:()=>{Me||(Q(!1),be(!1))},onSend:St?ae:ie}),a&&s.jsx(og,{isOpen:pe,availableTitles:td,selectedTitles:zp,onClose:()=>Fe(!1),onSave:u=>{const N=u.map(k=>k.trim()).filter(Boolean);$e({fileNameTitles:N}),Fe(!1)}}),y&&s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[200] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 space-y-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx($c,{className:"w-4 h-4"})," Add Note"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Case: ",y.insuredName||y.odakanitNo||y.id]}),s.jsx(gl,{clientId:yl,children:s.jsx("textarea",{className:"w-full border rounded p-3 text-sm",rows:4,value:_,onChange:u=>R(u.target.value),placeholder:"Write your note..."})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>{$(null),R("")},className:"px-4 py-2 text-gray-500 hover:bg-gray-100 rounded",children:"Cancel"}),s.jsx("button",{onClick:()=>{y&&_.trim()&&(Ne(y.id,_.trim()),$(null),R(""))},className:"px-4 py-2 bg-lpBlue text-white rounded hover:bg-blue-900",children:"Save"})]})]})}),z&&s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[200] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 space-y-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(Li,{className:"w-4 h-4"})," Send Reminder"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Case: ",z.insuredName||z.odakanitNo||z.id]}),s.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Recipients"}),s.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:K,onChange:u=>q(u.target.value),children:[s.jsx("option",{value:"LAWYER",children:"Lawyer"}),s.jsx("option",{value:"SUB_ADMIN",children:"Sub-Admin"}),s.jsx("option",{value:"BOTH",children:"Both"})]}),s.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Message"}),s.jsx(gl,{clientId:yl,children:s.jsx("textarea",{className:"w-full border rounded p-3 text-sm",rows:4,value:te,onChange:u=>I(u.target.value),placeholder:"Reminder details..."})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>{U(null),I("")},className:"px-4 py-2 text-gray-500 hover:bg-gray-100 rounded",children:"Cancel"}),s.jsx("button",{onClick:()=>{if(z&&te.trim()){const u=[];(K==="LAWYER"||K==="BOTH")&&u.push(z.ownerName),(K==="SUB_ADMIN"||K==="BOTH")&&u.push(...Dr.filter(N=>N.role==="SUB_ADMIN").map(N=>N.name)),we({id:`reminder-${Date.now()}`,message:`Reminder to ${u.join(", ")}: ${te.trim()}`,createdAt:new Date().toISOString(),reportId:z.id}),U(null),I("")}},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Send"})]})]})}),kl&&s.jsx(rN,{report:kl,sessions:Gp,onSwitch:H,onClose:Ee,currentUser:e,onAddRowNote:Cn,onResolveRowNote:sa,onAddWorksheetRow:Bp,previousReport:l.filter(u=>u.id!==kl.id&&u.odakanitNo&&u.odakanitNo===kl.odakanitNo).sort((u,N)=>new Date(N.reportDate).getTime()-new Date(u.reportDate).getTime())[0]})]})},rN=({report:e,sessions:t,onSwitch:n,onClose:r,currentUser:l,onAddRowNote:i,onResolveRowNote:a,onAddWorksheetRow:o,previousReport:c})=>{const[d,f]=w.useState("table"),[m,x]=w.useState(""),[b,j]=w.useState(null),[S,O]=w.useState({category:"EXPERT_OUR",serviceProvider:"",amount:"",customLabel:""}),h=e.expenseWorksheet||nr(),p=h.rows.filter(y=>y.type==="EXPENSE"),v=h.rows.filter(y=>y.type==="ADJUSTMENT"),E=h.notes.filter(y=>!y.resolved),D=h.totals||$i(h.rows),M=(l==null?void 0:l.role)==="FINANCE"||(l==null?void 0:l.role)==="SUB_ADMIN",P=kn.find(y=>y.value===S.category),H=(P==null?void 0:P.type)!=="ADJUSTMENT",ne=y=>{m.trim()&&(i(e.id,y,m.trim()),x(""),j(null))},A=()=>{const y=parseFloat(S.amount);isNaN(y)||y<=0||(o(e.id,{category:S.category,serviceProvider:H?S.serviceProvider:void 0,amount:y,customLabel:S.customLabel}),O({category:"EXPERT_OUR",serviceProvider:"",amount:"",customLabel:""}))};return s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[220] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-center px-5 py-3 border-b bg-gray-50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Expense Worksheet"}),s.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:[e.insuredName||e.odakanitNo||"Case","  ",e.ownerName]})]}),s.jsx("button",{onClick:()=>r(e.id),className:"text-gray-500 hover:text-gray-800",children:s.jsx(Mt,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex border-b bg-white px-4 overflow-x-auto",children:t.map(y=>s.jsxs("button",{onClick:()=>n(y.reportId),className:`flex items-center gap-2 px-3 py-2 text-sm border-b-2 ${y.reportId===e.id?"border-lpBlue text-lpBlue font-bold":"border-transparent text-gray-400"}`,children:[y.title,s.jsx("span",{onClick:$=>{$.stopPropagation(),r(y.reportId)},className:"text-gray-400 hover:text-red-500",children:s.jsx(Mt,{className:"w-3 h-3"})})]},y.reportId))}),s.jsx("div",{className:"flex gap-2 px-5 pt-4 text-sm font-semibold",children:["table","history","notes","compare"].map(y=>s.jsx("button",{onClick:()=>f(y),className:`px-3 py-1 rounded-full ${d===y?"bg-lpBlue text-white":"bg-gray-100 text-gray-500"}`,children:y==="table"?"Worksheet":y==="history"?"History":y==="notes"?`Notes (${E.length})`:"Compare"},y))}),s.jsxs("div",{className:"flex-1 overflow-auto p-5 space-y-4",children:[d==="table"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center bg-gray-50 rounded-lg py-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Total Expenses"}),s.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["",D.totalExpenses.toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Adjustments"}),s.jsxs("p",{className:"text-lg font-bold text-yellow-700",children:["",D.totalAdjustments.toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Balance Due"}),s.jsxs("p",{className:"text-lg font-bold text-green-700",children:["",D.totalBalance.toLocaleString()]})]})]}),M&&s.jsxs("div",{className:"border rounded-lg p-3 bg-amber-50 space-y-2",children:[s.jsx("p",{className:"text-xs font-bold text-amber-700",children:"  "}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[s.jsx("select",{value:S.category,onChange:y=>O({...S,category:y.target.value}),className:"border rounded text-xs p-2",children:kn.map(y=>s.jsx("option",{value:y.value,children:y.label},y.value))}),S.category==="OTHER"&&s.jsx("input",{className:"border rounded text-xs p-2",placeholder:" ",value:S.customLabel,onChange:y=>O({...S,customLabel:y.target.value})}),H&&s.jsx("input",{className:"border rounded text-xs p-2",placeholder:" ",value:S.serviceProvider,onChange:y=>O({...S,serviceProvider:y.target.value})}),s.jsx("input",{className:"border rounded text-xs p-2",placeholder:" ",type:"number",min:"0",value:S.amount,onChange:y=>O({...S,amount:y.target.value})}),s.jsx("button",{onClick:A,className:"bg-amber-500 text-white rounded text-xs font-bold px-3 py-2 hover:bg-amber-600",children:"Add"})]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Service Expenses"}),s.jsxs("div",{className:"space-y-2",children:[p.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No expenses recorded."}),p.map(y=>{const $=h.notes.filter(_=>_.rowId===y.id&&!_.resolved).length;return s.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-sm",children:y.label}),y.serviceProvider&&s.jsx("p",{className:"text-xs text-gray-500",children:y.serviceProvider})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold text-lpBlue",children:["",y.amount.toLocaleString()]}),s.jsxs("button",{className:"text-[10px] text-gray-400",onClick:()=>j(b===y.id?null:y.id),children:[" Notes (",$,")"]})]})]}),b===y.id&&s.jsxs("div",{className:"mt-2 flex gap-2",children:[s.jsx("input",{className:"flex-1 border rounded text-xs p-2",value:m,onChange:_=>x(_.target.value),placeholder:"Add note..."}),s.jsx("button",{onClick:()=>ne(y.id),className:"px-3 py-1 text-xs bg-lpBlue text-white rounded",children:"Save"})]})]},y.id)})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Adjustments"}),s.jsxs("div",{className:"space-y-2",children:[v.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No adjustments yet."}),v.map(y=>s.jsx("div",{className:"border rounded-lg p-3 bg-gray-50",children:s.jsxs("div",{className:"flex justify-between",children:[s.jsx("p",{className:"font-semibold text-sm",children:y.label}),s.jsxs("p",{className:"font-bold text-red-600",children:["",y.amount.toLocaleString()]})]})},y.id))]})]})]}),s.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"General Note"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{className:"flex-1 border rounded text-xs p-2",value:m,onChange:y=>x(y.target.value),placeholder:"Add note for worksheet..."}),s.jsx("button",{onClick:()=>ne(void 0),className:"px-3 py-1 text-xs bg-lpBlue text-white rounded",children:"Save"})]})]})]}),d==="history"&&s.jsxs("div",{className:"space-y-2",children:[h.history.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No history recorded yet."}),h.history.map(y=>s.jsxs("div",{className:"border rounded-lg p-3 bg-white flex justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",children:y.action}),y.details&&s.jsx("p",{className:"text-xs text-gray-500",children:y.details})]}),s.jsxs("div",{className:"text-right text-[10px] text-gray-400",children:[s.jsx("p",{children:y.userName}),s.jsx("p",{children:new Date(y.timestamp).toLocaleString()})]})]},y.id))]}),d==="notes"&&s.jsxs("div",{className:"space-y-2",children:[h.notes.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No notes yet."}),h.notes.map(y=>s.jsx("div",{className:`border rounded-lg p-3 ${y.resolved?"bg-green-50":"bg-white"}`,children:s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",children:y.authorName}),s.jsx("p",{className:"text-xs text-gray-500",children:y.message})]}),s.jsxs("div",{className:"text-right text-[10px] text-gray-400",children:[s.jsx("p",{children:new Date(y.createdAt).toLocaleString()}),!y.resolved&&s.jsx("button",{onClick:()=>a(e.id,y.id),className:"text-xs text-green-600 hover:underline",children:"Resolve"})]})]})},y.id))]}),d==="compare"&&s.jsx("div",{children:c!=null&&c.expenseWorksheet?s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Previous Report"}),s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:new Date(c.reportDate).toLocaleDateString()}),s.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["",c.expenseWorksheet.totals.totalBalance.toLocaleString()]})]}),s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Current Report"}),s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:new Date(e.reportDate).toLocaleDateString()}),s.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["",D.totalBalance.toLocaleString()]})]})]}):s.jsx("p",{className:"text-xs text-gray-400",children:"No previous worksheet available for comparison."})})]})]})})},sN=()=>s.jsx(Cg,{children:s.jsx(nN,{})}),Fp=document.getElementById("root");if(!Fp)throw new Error("Could not find root element to mount to");const lN=Ba.createRoot(Fp);lN.render(s.jsx(Vo.StrictMode,{children:s.jsx(sN,{})}));
