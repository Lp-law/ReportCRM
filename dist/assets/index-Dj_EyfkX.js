(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))r(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(l){if(l.ep)return;l.ep=!0;const a=n(l);fetch(l.href,a)}})();function wh(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Em={exports:{}},vi={},Im={exports:{}},_e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ql=Symbol.for("react.element"),Sh=Symbol.for("react.portal"),jh=Symbol.for("react.fragment"),Eh=Symbol.for("react.strict_mode"),Ih=Symbol.for("react.profiler"),Th=Symbol.for("react.provider"),Ah=Symbol.for("react.context"),kh=Symbol.for("react.forward_ref"),Rh=Symbol.for("react.suspense"),Ch=Symbol.for("react.memo"),Dh=Symbol.for("react.lazy"),$d=Symbol.iterator;function Lh(e){return e===null||typeof e!="object"?null:(e=$d&&e[$d]||e["@@iterator"],typeof e=="function"?e:null)}var Tm={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Am=Object.assign,km={};function $r(e,t,n){this.props=e,this.context=t,this.refs=km,this.updater=n||Tm}$r.prototype.isReactComponent={};$r.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};$r.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function Rm(){}Rm.prototype=$r.prototype;function Ec(e,t,n){this.props=e,this.context=t,this.refs=km,this.updater=n||Tm}var Ic=Ec.prototype=new Rm;Ic.constructor=Ec;Am(Ic,$r.prototype);Ic.isPureReactComponent=!0;var Ud=Array.isArray,Cm=Object.prototype.hasOwnProperty,Tc={current:null},Dm={key:!0,ref:!0,__self:!0,__source:!0};function Lm(e,t,n){var r,l={},a=null,i=null;if(t!=null)for(r in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(a=""+t.key),t)Cm.call(t,r)&&!Dm.hasOwnProperty(r)&&(l[r]=t[r]);var o=arguments.length-2;if(o===1)l.children=n;else if(1<o){for(var c=Array(o),u=0;u<o;u++)c[u]=arguments[u+2];l.children=c}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)l[r]===void 0&&(l[r]=o[r]);return{$$typeof:Ql,type:e,key:a,ref:i,props:l,_owner:Tc.current}}function _h(e,t){return{$$typeof:Ql,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Ac(e){return typeof e=="object"&&e!==null&&e.$$typeof===Ql}function Oh(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hd=/\/+/g;function $i(e,t){return typeof e=="object"&&e!==null&&e.key!=null?Oh(""+e.key):t.toString(36)}function Ta(e,t,n,r,l){var a=typeof e;(a==="undefined"||a==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(a){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case Ql:case Sh:i=!0}}if(i)return i=e,l=l(i),e=r===""?"."+$i(i,0):r,Ud(l)?(n="",e!=null&&(n=e.replace(Hd,"$&/")+"/"),Ta(l,t,n,"",function(u){return u})):l!=null&&(Ac(l)&&(l=_h(l,n+(!l.key||i&&i.key===l.key?"":(""+l.key).replace(Hd,"$&/")+"/")+e)),t.push(l)),1;if(i=0,r=r===""?".":r+":",Ud(e))for(var o=0;o<e.length;o++){a=e[o];var c=r+$i(a,o);i+=Ta(a,t,n,c,l)}else if(c=Lh(e),typeof c=="function")for(e=c.call(e),o=0;!(a=e.next()).done;)a=a.value,c=r+$i(a,o++),i+=Ta(a,t,n,c,l);else if(a==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function la(e,t,n){if(e==null)return e;var r=[],l=0;return Ta(e,r,"","",function(a){return t.call(n,a,l++)}),r}function Ph(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Mt={current:null},Aa={transition:null},Mh={ReactCurrentDispatcher:Mt,ReactCurrentBatchConfig:Aa,ReactCurrentOwner:Tc};function _m(){throw Error("act(...) is not supported in production builds of React.")}_e.Children={map:la,forEach:function(e,t,n){la(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return la(e,function(){t++}),t},toArray:function(e){return la(e,function(t){return t})||[]},only:function(e){if(!Ac(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};_e.Component=$r;_e.Fragment=jh;_e.Profiler=Ih;_e.PureComponent=Ec;_e.StrictMode=Eh;_e.Suspense=Rh;_e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Mh;_e.act=_m;_e.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=Am({},e.props),l=e.key,a=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(a=t.ref,i=Tc.current),t.key!==void 0&&(l=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)Cm.call(t,c)&&!Dm.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&o!==void 0?o[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){o=Array(c);for(var u=0;u<c;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:Ql,type:e.type,key:l,ref:a,props:r,_owner:i}};_e.createContext=function(e){return e={$$typeof:Ah,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:Th,_context:e},e.Consumer=e};_e.createElement=Lm;_e.createFactory=function(e){var t=Lm.bind(null,e);return t.type=e,t};_e.createRef=function(){return{current:null}};_e.forwardRef=function(e){return{$$typeof:kh,render:e}};_e.isValidElement=Ac;_e.lazy=function(e){return{$$typeof:Dh,_payload:{_status:-1,_result:e},_init:Ph}};_e.memo=function(e,t){return{$$typeof:Ch,type:e,compare:t===void 0?null:t}};_e.startTransition=function(e){var t=Aa.transition;Aa.transition={};try{e()}finally{Aa.transition=t}};_e.unstable_act=_m;_e.useCallback=function(e,t){return Mt.current.useCallback(e,t)};_e.useContext=function(e){return Mt.current.useContext(e)};_e.useDebugValue=function(){};_e.useDeferredValue=function(e){return Mt.current.useDeferredValue(e)};_e.useEffect=function(e,t){return Mt.current.useEffect(e,t)};_e.useId=function(){return Mt.current.useId()};_e.useImperativeHandle=function(e,t,n){return Mt.current.useImperativeHandle(e,t,n)};_e.useInsertionEffect=function(e,t){return Mt.current.useInsertionEffect(e,t)};_e.useLayoutEffect=function(e,t){return Mt.current.useLayoutEffect(e,t)};_e.useMemo=function(e,t){return Mt.current.useMemo(e,t)};_e.useReducer=function(e,t,n){return Mt.current.useReducer(e,t,n)};_e.useRef=function(e){return Mt.current.useRef(e)};_e.useState=function(e){return Mt.current.useState(e)};_e.useSyncExternalStore=function(e,t,n){return Mt.current.useSyncExternalStore(e,t,n)};_e.useTransition=function(){return Mt.current.useTransition()};_e.version="18.3.1";Im.exports=_e;var y=Im.exports;const bi=wh(y);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fh=y,Bh=Symbol.for("react.element"),$h=Symbol.for("react.fragment"),Uh=Object.prototype.hasOwnProperty,Hh=Fh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,zh={key:!0,ref:!0,__self:!0,__source:!0};function Om(e,t,n){var r,l={},a=null,i=null;n!==void 0&&(a=""+n),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(i=t.ref);for(r in t)Uh.call(t,r)&&!zh.hasOwnProperty(r)&&(l[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)l[r]===void 0&&(l[r]=t[r]);return{$$typeof:Bh,type:e,key:a,ref:i,props:l,_owner:Hh.current}}vi.Fragment=$h;vi.jsx=Om;vi.jsxs=Om;Em.exports=vi;var s=Em.exports,Io={},Pm={exports:{}},Zt={},Mm={exports:{}},Fm={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(R,te){var se=R.length;R.push(te);e:for(;0<se;){var ye=se-1>>>1,L=R[ye];if(0<l(L,te))R[ye]=te,R[se]=L,se=ye;else break e}}function n(R){return R.length===0?null:R[0]}function r(R){if(R.length===0)return null;var te=R[0],se=R.pop();if(se!==te){R[0]=se;e:for(var ye=0,L=R.length,le=L>>>1;ye<le;){var Ie=2*(ye+1)-1,Ae=R[Ie],Le=Ie+1,Te=R[Le];if(0>l(Ae,se))Le<L&&0>l(Te,Ae)?(R[ye]=Te,R[Le]=se,ye=Le):(R[ye]=Ae,R[Ie]=se,ye=Ie);else if(Le<L&&0>l(Te,se))R[ye]=Te,R[Le]=se,ye=Le;else break e}}return te}function l(R,te){var se=R.sortIndex-te.sortIndex;return se!==0?se:R.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var c=[],u=[],f=1,p=null,g=3,S=!1,A=!1,E=!1,P=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(R){for(var te=n(u);te!==null;){if(te.callback===null)r(u);else if(te.startTime<=R)r(u),te.sortIndex=te.expirationTime,t(c,te);else break;te=n(u)}}function M(R){if(E=!1,b(R),!A)if(n(c)!==null)A=!0,V(U);else{var te=n(u);te!==null&&K(M,te.startTime-R)}}function U(R,te){A=!1,E&&(E=!1,x(O),O=-1),S=!0;var se=g;try{for(b(te),p=n(c);p!==null&&(!(p.expirationTime>te)||R&&!I());){var ye=p.callback;if(typeof ye=="function"){p.callback=null,g=p.priorityLevel;var L=ye(p.expirationTime<=te);te=e.unstable_now(),typeof L=="function"?p.callback=L:p===n(c)&&r(c),b(te)}else r(c);p=n(c)}if(p!==null)var le=!0;else{var Ie=n(u);Ie!==null&&K(M,Ie.startTime-te),le=!1}return le}finally{p=null,g=se,S=!1}}var H=!1,W=null,O=-1,D=5,$=-1;function I(){return!(e.unstable_now()-$<D)}function k(){if(W!==null){var R=e.unstable_now();$=R;var te=!0;try{te=W(!0,R)}finally{te?G():(H=!1,W=null)}}else H=!1}var G;if(typeof h=="function")G=function(){h(k)};else if(typeof MessageChannel<"u"){var de=new MessageChannel,ne=de.port2;de.port1.onmessage=k,G=function(){ne.postMessage(null)}}else G=function(){P(k,0)};function V(R){W=R,H||(H=!0,G())}function K(R,te){O=P(function(){R(e.unstable_now())},te)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(R){R.callback=null},e.unstable_continueExecution=function(){A||S||(A=!0,V(U))},e.unstable_forceFrameRate=function(R){0>R||125<R?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<R?Math.floor(1e3/R):5},e.unstable_getCurrentPriorityLevel=function(){return g},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(R){switch(g){case 1:case 2:case 3:var te=3;break;default:te=g}var se=g;g=te;try{return R()}finally{g=se}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(R,te){switch(R){case 1:case 2:case 3:case 4:case 5:break;default:R=3}var se=g;g=R;try{return te()}finally{g=se}},e.unstable_scheduleCallback=function(R,te,se){var ye=e.unstable_now();switch(typeof se=="object"&&se!==null?(se=se.delay,se=typeof se=="number"&&0<se?ye+se:ye):se=ye,R){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=se+L,R={id:f++,callback:te,priorityLevel:R,startTime:se,expirationTime:L,sortIndex:-1},se>ye?(R.sortIndex=se,t(u,R),n(c)===null&&R===n(u)&&(E?(x(O),O=-1):E=!0,K(M,se-ye))):(R.sortIndex=L,t(c,R),A||S||(A=!0,V(U))),R},e.unstable_shouldYield=I,e.unstable_wrapCallback=function(R){var te=g;return function(){var se=g;g=te;try{return R.apply(this,arguments)}finally{g=se}}}})(Fm);Mm.exports=Fm;var Wh=Mm.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vh=y,Jt=Wh;function J(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Bm=new Set,El={};function Qs(e,t){Cr(e,t),Cr(e+"Capture",t)}function Cr(e,t){for(El[e]=t,e=0;e<t.length;e++)Bm.add(t[e])}var Gn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),To=Object.prototype.hasOwnProperty,Yh=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zd={},Wd={};function Gh(e){return To.call(Wd,e)?!0:To.call(zd,e)?!1:Yh.test(e)?Wd[e]=!0:(zd[e]=!0,!1)}function Kh(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function qh(e,t,n,r){if(t===null||typeof t>"u"||Kh(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Ft(e,t,n,r,l,a,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=l,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=a,this.removeEmptyString=i}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Tt[e]=new Ft(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Tt[t]=new Ft(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Tt[e]=new Ft(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Tt[e]=new Ft(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Tt[e]=new Ft(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Tt[e]=new Ft(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Tt[e]=new Ft(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Tt[e]=new Ft(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Tt[e]=new Ft(e,5,!1,e.toLowerCase(),null,!1,!1)});var kc=/[\-:]([a-z])/g;function Rc(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(kc,Rc);Tt[t]=new Ft(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(kc,Rc);Tt[t]=new Ft(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(kc,Rc);Tt[t]=new Ft(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Tt[e]=new Ft(e,1,!1,e.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Tt[e]=new Ft(e,1,!1,e.toLowerCase(),null,!0,!0)});function Cc(e,t,n,r){var l=Tt.hasOwnProperty(t)?Tt[t]:null;(l!==null?l.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(qh(t,n,l,r)&&(n=null),r||l===null?Gh(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):l.mustUseProperty?e[l.propertyName]=n===null?l.type===3?!1:"":n:(t=l.attributeName,r=l.attributeNamespace,n===null?e.removeAttribute(t):(l=l.type,n=l===3||l===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Jn=Vh.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,aa=Symbol.for("react.element"),fr=Symbol.for("react.portal"),pr=Symbol.for("react.fragment"),Dc=Symbol.for("react.strict_mode"),Ao=Symbol.for("react.profiler"),$m=Symbol.for("react.provider"),Um=Symbol.for("react.context"),Lc=Symbol.for("react.forward_ref"),ko=Symbol.for("react.suspense"),Ro=Symbol.for("react.suspense_list"),_c=Symbol.for("react.memo"),is=Symbol.for("react.lazy"),Hm=Symbol.for("react.offscreen"),Vd=Symbol.iterator;function el(e){return e===null||typeof e!="object"?null:(e=Vd&&e[Vd]||e["@@iterator"],typeof e=="function"?e:null)}var ot=Object.assign,Ui;function ul(e){if(Ui===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Ui=t&&t[1]||""}return`
`+Ui+e}var Hi=!1;function zi(e,t){if(!e||Hi)return"";Hi=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var l=u.stack.split(`
`),a=r.stack.split(`
`),i=l.length-1,o=a.length-1;1<=i&&0<=o&&l[i]!==a[o];)o--;for(;1<=i&&0<=o;i--,o--)if(l[i]!==a[o]){if(i!==1||o!==1)do if(i--,o--,0>o||l[i]!==a[o]){var c=`
`+l[i].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=i&&0<=o);break}}}finally{Hi=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?ul(e):""}function Xh(e){switch(e.tag){case 5:return ul(e.type);case 16:return ul("Lazy");case 13:return ul("Suspense");case 19:return ul("SuspenseList");case 0:case 2:case 15:return e=zi(e.type,!1),e;case 11:return e=zi(e.type.render,!1),e;case 1:return e=zi(e.type,!0),e;default:return""}}function Co(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case pr:return"Fragment";case fr:return"Portal";case Ao:return"Profiler";case Dc:return"StrictMode";case ko:return"Suspense";case Ro:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case Um:return(e.displayName||"Context")+".Consumer";case $m:return(e._context.displayName||"Context")+".Provider";case Lc:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case _c:return t=e.displayName||null,t!==null?t:Co(e.type)||"Memo";case is:t=e._payload,e=e._init;try{return Co(e(t))}catch{}}return null}function Qh(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Co(t);case 8:return t===Dc?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Is(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function zm(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function Jh(e){var t=zm(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var l=n.get,a=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return l.call(this)},set:function(i){r=""+i,a.call(this,i)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(i){r=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function ia(e){e._valueTracker||(e._valueTracker=Jh(e))}function Wm(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=zm(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Ua(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Do(e,t){var n=t.checked;return ot({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Yd(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Is(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function Vm(e,t){t=t.checked,t!=null&&Cc(e,"checked",t,!1)}function Lo(e,t){Vm(e,t);var n=Is(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?_o(e,t.type,n):t.hasOwnProperty("defaultValue")&&_o(e,t.type,Is(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Gd(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function _o(e,t,n){(t!=="number"||Ua(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var ml=Array.isArray;function Er(e,t,n,r){if(e=e.options,t){t={};for(var l=0;l<n.length;l++)t["$"+n[l]]=!0;for(n=0;n<e.length;n++)l=t.hasOwnProperty("$"+e[n].value),e[n].selected!==l&&(e[n].selected=l),l&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Is(n),t=null,l=0;l<e.length;l++){if(e[l].value===n){e[l].selected=!0,r&&(e[l].defaultSelected=!0);return}t!==null||e[l].disabled||(t=e[l])}t!==null&&(t.selected=!0)}}function Oo(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(J(91));return ot({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Kd(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(J(92));if(ml(n)){if(1<n.length)throw Error(J(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Is(n)}}function Ym(e,t){var n=Is(t.value),r=Is(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function qd(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function Gm(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Po(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?Gm(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var oa,Km=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,l){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,l)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(oa=oa||document.createElement("div"),oa.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=oa.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Il(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var xl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Zh=["Webkit","ms","Moz","O"];Object.keys(xl).forEach(function(e){Zh.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),xl[t]=xl[e]})});function qm(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||xl.hasOwnProperty(e)&&xl[e]?(""+t).trim():t+"px"}function Xm(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,l=qm(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,l):e[n]=l}}var ex=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Mo(e,t){if(t){if(ex[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(J(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(J(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(J(61))}if(t.style!=null&&typeof t.style!="object")throw Error(J(62))}}function Fo(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Bo=null;function Oc(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $o=null,Ir=null,Tr=null;function Xd(e){if(e=ea(e)){if(typeof $o!="function")throw Error(J(280));var t=e.stateNode;t&&(t=Ii(t),$o(e.stateNode,e.type,t))}}function Qm(e){Ir?Tr?Tr.push(e):Tr=[e]:Ir=e}function Jm(){if(Ir){var e=Ir,t=Tr;if(Tr=Ir=null,Xd(e),t)for(e=0;e<t.length;e++)Xd(t[e])}}function Zm(e,t){return e(t)}function ef(){}var Wi=!1;function tf(e,t,n){if(Wi)return e(t,n);Wi=!0;try{return Zm(e,t,n)}finally{Wi=!1,(Ir!==null||Tr!==null)&&(ef(),Jm())}}function Tl(e,t){var n=e.stateNode;if(n===null)return null;var r=Ii(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(J(231,t,typeof n));return n}var Uo=!1;if(Gn)try{var tl={};Object.defineProperty(tl,"passive",{get:function(){Uo=!0}}),window.addEventListener("test",tl,tl),window.removeEventListener("test",tl,tl)}catch{Uo=!1}function tx(e,t,n,r,l,a,i,o,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(f){this.onError(f)}}var gl=!1,Ha=null,za=!1,Ho=null,nx={onError:function(e){gl=!0,Ha=e}};function sx(e,t,n,r,l,a,i,o,c){gl=!1,Ha=null,tx.apply(nx,arguments)}function rx(e,t,n,r,l,a,i,o,c){if(sx.apply(this,arguments),gl){if(gl){var u=Ha;gl=!1,Ha=null}else throw Error(J(198));za||(za=!0,Ho=u)}}function Js(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function nf(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Qd(e){if(Js(e)!==e)throw Error(J(188))}function lx(e){var t=e.alternate;if(!t){if(t=Js(e),t===null)throw Error(J(188));return t!==e?null:e}for(var n=e,r=t;;){var l=n.return;if(l===null)break;var a=l.alternate;if(a===null){if(r=l.return,r!==null){n=r;continue}break}if(l.child===a.child){for(a=l.child;a;){if(a===n)return Qd(l),e;if(a===r)return Qd(l),t;a=a.sibling}throw Error(J(188))}if(n.return!==r.return)n=l,r=a;else{for(var i=!1,o=l.child;o;){if(o===n){i=!0,n=l,r=a;break}if(o===r){i=!0,r=l,n=a;break}o=o.sibling}if(!i){for(o=a.child;o;){if(o===n){i=!0,n=a,r=l;break}if(o===r){i=!0,r=a,n=l;break}o=o.sibling}if(!i)throw Error(J(189))}}if(n.alternate!==r)throw Error(J(190))}if(n.tag!==3)throw Error(J(188));return n.stateNode.current===n?e:t}function sf(e){return e=lx(e),e!==null?rf(e):null}function rf(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=rf(e);if(t!==null)return t;e=e.sibling}return null}var lf=Jt.unstable_scheduleCallback,Jd=Jt.unstable_cancelCallback,ax=Jt.unstable_shouldYield,ix=Jt.unstable_requestPaint,ut=Jt.unstable_now,ox=Jt.unstable_getCurrentPriorityLevel,Pc=Jt.unstable_ImmediatePriority,af=Jt.unstable_UserBlockingPriority,Wa=Jt.unstable_NormalPriority,cx=Jt.unstable_LowPriority,of=Jt.unstable_IdlePriority,wi=null,Ln=null;function dx(e){if(Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(wi,e,void 0,(e.current.flags&128)===128)}catch{}}var vn=Math.clz32?Math.clz32:fx,ux=Math.log,mx=Math.LN2;function fx(e){return e>>>=0,e===0?32:31-(ux(e)/mx|0)|0}var ca=64,da=4194304;function fl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Va(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,l=e.suspendedLanes,a=e.pingedLanes,i=n&268435455;if(i!==0){var o=i&~l;o!==0?r=fl(o):(a&=i,a!==0&&(r=fl(a)))}else i=n&~l,i!==0?r=fl(i):a!==0&&(r=fl(a));if(r===0)return 0;if(t!==0&&t!==r&&!(t&l)&&(l=r&-r,a=t&-t,l>=a||l===16&&(a&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-vn(t),l=1<<n,r|=e[n],t&=~l;return r}function px(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function hx(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,l=e.expirationTimes,a=e.pendingLanes;0<a;){var i=31-vn(a),o=1<<i,c=l[i];c===-1?(!(o&n)||o&r)&&(l[i]=px(o,t)):c<=t&&(e.expiredLanes|=o),a&=~o}}function zo(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function cf(){var e=ca;return ca<<=1,!(ca&4194240)&&(ca=64),e}function Vi(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Jl(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-vn(t),e[t]=n}function xx(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var l=31-vn(n),a=1<<l;t[l]=0,r[l]=-1,e[l]=-1,n&=~a}}function Mc(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-vn(n),l=1<<r;l&t|e[r]&t&&(e[r]|=t),n&=~l}}var Ve=0;function df(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var uf,Fc,mf,ff,pf,Wo=!1,ua=[],gs=null,ys=null,Ns=null,Al=new Map,kl=new Map,us=[],gx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zd(e,t){switch(e){case"focusin":case"focusout":gs=null;break;case"dragenter":case"dragleave":ys=null;break;case"mouseover":case"mouseout":Ns=null;break;case"pointerover":case"pointerout":Al.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":kl.delete(t.pointerId)}}function nl(e,t,n,r,l,a){return e===null||e.nativeEvent!==a?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:a,targetContainers:[l]},t!==null&&(t=ea(t),t!==null&&Fc(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,l!==null&&t.indexOf(l)===-1&&t.push(l),e)}function yx(e,t,n,r,l){switch(t){case"focusin":return gs=nl(gs,e,t,n,r,l),!0;case"dragenter":return ys=nl(ys,e,t,n,r,l),!0;case"mouseover":return Ns=nl(Ns,e,t,n,r,l),!0;case"pointerover":var a=l.pointerId;return Al.set(a,nl(Al.get(a)||null,e,t,n,r,l)),!0;case"gotpointercapture":return a=l.pointerId,kl.set(a,nl(kl.get(a)||null,e,t,n,r,l)),!0}return!1}function hf(e){var t=Bs(e.target);if(t!==null){var n=Js(t);if(n!==null){if(t=n.tag,t===13){if(t=nf(n),t!==null){e.blockedOn=t,pf(e.priority,function(){mf(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function ka(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Vo(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Bo=r,n.target.dispatchEvent(r),Bo=null}else return t=ea(n),t!==null&&Fc(t),e.blockedOn=n,!1;t.shift()}return!0}function eu(e,t,n){ka(e)&&n.delete(t)}function Nx(){Wo=!1,gs!==null&&ka(gs)&&(gs=null),ys!==null&&ka(ys)&&(ys=null),Ns!==null&&ka(Ns)&&(Ns=null),Al.forEach(eu),kl.forEach(eu)}function sl(e,t){e.blockedOn===t&&(e.blockedOn=null,Wo||(Wo=!0,Jt.unstable_scheduleCallback(Jt.unstable_NormalPriority,Nx)))}function Rl(e){function t(l){return sl(l,e)}if(0<ua.length){sl(ua[0],e);for(var n=1;n<ua.length;n++){var r=ua[n];r.blockedOn===e&&(r.blockedOn=null)}}for(gs!==null&&sl(gs,e),ys!==null&&sl(ys,e),Ns!==null&&sl(Ns,e),Al.forEach(t),kl.forEach(t),n=0;n<us.length;n++)r=us[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<us.length&&(n=us[0],n.blockedOn===null);)hf(n),n.blockedOn===null&&us.shift()}var Ar=Jn.ReactCurrentBatchConfig,Ya=!0;function vx(e,t,n,r){var l=Ve,a=Ar.transition;Ar.transition=null;try{Ve=1,Bc(e,t,n,r)}finally{Ve=l,Ar.transition=a}}function bx(e,t,n,r){var l=Ve,a=Ar.transition;Ar.transition=null;try{Ve=4,Bc(e,t,n,r)}finally{Ve=l,Ar.transition=a}}function Bc(e,t,n,r){if(Ya){var l=Vo(e,t,n,r);if(l===null)to(e,t,r,Ga,n),Zd(e,r);else if(yx(l,e,t,n,r))r.stopPropagation();else if(Zd(e,r),t&4&&-1<gx.indexOf(e)){for(;l!==null;){var a=ea(l);if(a!==null&&uf(a),a=Vo(e,t,n,r),a===null&&to(e,t,r,Ga,n),a===l)break;l=a}l!==null&&r.stopPropagation()}else to(e,t,r,null,n)}}var Ga=null;function Vo(e,t,n,r){if(Ga=null,e=Oc(r),e=Bs(e),e!==null)if(t=Js(e),t===null)e=null;else if(n=t.tag,n===13){if(e=nf(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Ga=e,null}function xf(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ox()){case Pc:return 1;case af:return 4;case Wa:case cx:return 16;case of:return 536870912;default:return 16}default:return 16}}var ps=null,$c=null,Ra=null;function gf(){if(Ra)return Ra;var e,t=$c,n=t.length,r,l="value"in ps?ps.value:ps.textContent,a=l.length;for(e=0;e<n&&t[e]===l[e];e++);var i=n-e;for(r=1;r<=i&&t[n-r]===l[a-r];r++);return Ra=l.slice(e,1<r?1-r:void 0)}function Ca(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function ma(){return!0}function tu(){return!1}function en(e){function t(n,r,l,a,i){this._reactName=n,this._targetInst=l,this.type=r,this.nativeEvent=a,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(a):a[o]);return this.isDefaultPrevented=(a.defaultPrevented!=null?a.defaultPrevented:a.returnValue===!1)?ma:tu,this.isPropagationStopped=tu,this}return ot(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ma)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ma)},persist:function(){},isPersistent:ma}),t}var Ur={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uc=en(Ur),Zl=ot({},Ur,{view:0,detail:0}),wx=en(Zl),Yi,Gi,rl,Si=ot({},Zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hc,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==rl&&(rl&&e.type==="mousemove"?(Yi=e.screenX-rl.screenX,Gi=e.screenY-rl.screenY):Gi=Yi=0,rl=e),Yi)},movementY:function(e){return"movementY"in e?e.movementY:Gi}}),nu=en(Si),Sx=ot({},Si,{dataTransfer:0}),jx=en(Sx),Ex=ot({},Zl,{relatedTarget:0}),Ki=en(Ex),Ix=ot({},Ur,{animationName:0,elapsedTime:0,pseudoElement:0}),Tx=en(Ix),Ax=ot({},Ur,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),kx=en(Ax),Rx=ot({},Ur,{data:0}),su=en(Rx),Cx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Dx={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Lx={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _x(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Lx[e])?!!t[e]:!1}function Hc(){return _x}var Ox=ot({},Zl,{key:function(e){if(e.key){var t=Cx[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Ca(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Dx[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hc,charCode:function(e){return e.type==="keypress"?Ca(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Ca(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),Px=en(Ox),Mx=ot({},Si,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ru=en(Mx),Fx=ot({},Zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hc}),Bx=en(Fx),$x=ot({},Ur,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ux=en($x),Hx=ot({},Si,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),zx=en(Hx),Wx=[9,13,27,32],zc=Gn&&"CompositionEvent"in window,yl=null;Gn&&"documentMode"in document&&(yl=document.documentMode);var Vx=Gn&&"TextEvent"in window&&!yl,yf=Gn&&(!zc||yl&&8<yl&&11>=yl),lu=" ",au=!1;function Nf(e,t){switch(e){case"keyup":return Wx.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vf(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var hr=!1;function Yx(e,t){switch(e){case"compositionend":return vf(t);case"keypress":return t.which!==32?null:(au=!0,lu);case"textInput":return e=t.data,e===lu&&au?null:e;default:return null}}function Gx(e,t){if(hr)return e==="compositionend"||!zc&&Nf(e,t)?(e=gf(),Ra=$c=ps=null,hr=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return yf&&t.locale!=="ko"?null:t.data;default:return null}}var Kx={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function iu(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Kx[e.type]:t==="textarea"}function bf(e,t,n,r){Qm(r),t=Ka(t,"onChange"),0<t.length&&(n=new Uc("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Nl=null,Cl=null;function qx(e){Df(e,0)}function ji(e){var t=yr(e);if(Wm(t))return e}function Xx(e,t){if(e==="change")return t}var wf=!1;if(Gn){var qi;if(Gn){var Xi="oninput"in document;if(!Xi){var ou=document.createElement("div");ou.setAttribute("oninput","return;"),Xi=typeof ou.oninput=="function"}qi=Xi}else qi=!1;wf=qi&&(!document.documentMode||9<document.documentMode)}function cu(){Nl&&(Nl.detachEvent("onpropertychange",Sf),Cl=Nl=null)}function Sf(e){if(e.propertyName==="value"&&ji(Cl)){var t=[];bf(t,Cl,e,Oc(e)),tf(qx,t)}}function Qx(e,t,n){e==="focusin"?(cu(),Nl=t,Cl=n,Nl.attachEvent("onpropertychange",Sf)):e==="focusout"&&cu()}function Jx(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ji(Cl)}function Zx(e,t){if(e==="click")return ji(t)}function e0(e,t){if(e==="input"||e==="change")return ji(t)}function t0(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Sn=typeof Object.is=="function"?Object.is:t0;function Dl(e,t){if(Sn(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var l=n[r];if(!To.call(t,l)||!Sn(e[l],t[l]))return!1}return!0}function du(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function uu(e,t){var n=du(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=du(n)}}function jf(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?jf(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function Ef(){for(var e=window,t=Ua();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Ua(e.document)}return t}function Wc(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function n0(e){var t=Ef(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&jf(n.ownerDocument.documentElement,n)){if(r!==null&&Wc(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var l=n.textContent.length,a=Math.min(r.start,l);r=r.end===void 0?a:Math.min(r.end,l),!e.extend&&a>r&&(l=r,r=a,a=l),l=uu(n,a);var i=uu(n,r);l&&i&&(e.rangeCount!==1||e.anchorNode!==l.node||e.anchorOffset!==l.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(l.node,l.offset),e.removeAllRanges(),a>r?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var s0=Gn&&"documentMode"in document&&11>=document.documentMode,xr=null,Yo=null,vl=null,Go=!1;function mu(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Go||xr==null||xr!==Ua(r)||(r=xr,"selectionStart"in r&&Wc(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vl&&Dl(vl,r)||(vl=r,r=Ka(Yo,"onSelect"),0<r.length&&(t=new Uc("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=xr)))}function fa(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var gr={animationend:fa("Animation","AnimationEnd"),animationiteration:fa("Animation","AnimationIteration"),animationstart:fa("Animation","AnimationStart"),transitionend:fa("Transition","TransitionEnd")},Qi={},If={};Gn&&(If=document.createElement("div").style,"AnimationEvent"in window||(delete gr.animationend.animation,delete gr.animationiteration.animation,delete gr.animationstart.animation),"TransitionEvent"in window||delete gr.transitionend.transition);function Ei(e){if(Qi[e])return Qi[e];if(!gr[e])return e;var t=gr[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in If)return Qi[e]=t[n];return e}var Tf=Ei("animationend"),Af=Ei("animationiteration"),kf=Ei("animationstart"),Rf=Ei("transitionend"),Cf=new Map,fu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function As(e,t){Cf.set(e,t),Qs(t,[e])}for(var Ji=0;Ji<fu.length;Ji++){var Zi=fu[Ji],r0=Zi.toLowerCase(),l0=Zi[0].toUpperCase()+Zi.slice(1);As(r0,"on"+l0)}As(Tf,"onAnimationEnd");As(Af,"onAnimationIteration");As(kf,"onAnimationStart");As("dblclick","onDoubleClick");As("focusin","onFocus");As("focusout","onBlur");As(Rf,"onTransitionEnd");Cr("onMouseEnter",["mouseout","mouseover"]);Cr("onMouseLeave",["mouseout","mouseover"]);Cr("onPointerEnter",["pointerout","pointerover"]);Cr("onPointerLeave",["pointerout","pointerover"]);Qs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Qs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Qs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Qs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Qs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),a0=new Set("cancel close invalid load scroll toggle".split(" ").concat(pl));function pu(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,rx(r,t,void 0,e),e.currentTarget=null}function Df(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],l=r.event;r=r.listeners;e:{var a=void 0;if(t)for(var i=r.length-1;0<=i;i--){var o=r[i],c=o.instance,u=o.currentTarget;if(o=o.listener,c!==a&&l.isPropagationStopped())break e;pu(l,o,u),a=c}else for(i=0;i<r.length;i++){if(o=r[i],c=o.instance,u=o.currentTarget,o=o.listener,c!==a&&l.isPropagationStopped())break e;pu(l,o,u),a=c}}}if(za)throw e=Ho,za=!1,Ho=null,e}function Qe(e,t){var n=t[Jo];n===void 0&&(n=t[Jo]=new Set);var r=e+"__bubble";n.has(r)||(Lf(t,e,2,!1),n.add(r))}function eo(e,t,n){var r=0;t&&(r|=4),Lf(n,e,r,t)}var pa="_reactListening"+Math.random().toString(36).slice(2);function Ll(e){if(!e[pa]){e[pa]=!0,Bm.forEach(function(n){n!=="selectionchange"&&(a0.has(n)||eo(n,!1,e),eo(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[pa]||(t[pa]=!0,eo("selectionchange",!1,t))}}function Lf(e,t,n,r){switch(xf(t)){case 1:var l=vx;break;case 4:l=bx;break;default:l=Bc}n=l.bind(null,t,n,e),l=void 0,!Uo||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(l=!0),r?l!==void 0?e.addEventListener(t,n,{capture:!0,passive:l}):e.addEventListener(t,n,!0):l!==void 0?e.addEventListener(t,n,{passive:l}):e.addEventListener(t,n,!1)}function to(e,t,n,r,l){var a=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var i=r.tag;if(i===3||i===4){var o=r.stateNode.containerInfo;if(o===l||o.nodeType===8&&o.parentNode===l)break;if(i===4)for(i=r.return;i!==null;){var c=i.tag;if((c===3||c===4)&&(c=i.stateNode.containerInfo,c===l||c.nodeType===8&&c.parentNode===l))return;i=i.return}for(;o!==null;){if(i=Bs(o),i===null)return;if(c=i.tag,c===5||c===6){r=a=i;continue e}o=o.parentNode}}r=r.return}tf(function(){var u=a,f=Oc(n),p=[];e:{var g=Cf.get(e);if(g!==void 0){var S=Uc,A=e;switch(e){case"keypress":if(Ca(n)===0)break e;case"keydown":case"keyup":S=Px;break;case"focusin":A="focus",S=Ki;break;case"focusout":A="blur",S=Ki;break;case"beforeblur":case"afterblur":S=Ki;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":S=nu;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":S=jx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":S=Bx;break;case Tf:case Af:case kf:S=Tx;break;case Rf:S=Ux;break;case"scroll":S=wx;break;case"wheel":S=zx;break;case"copy":case"cut":case"paste":S=kx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":S=ru}var E=(t&4)!==0,P=!E&&e==="scroll",x=E?g!==null?g+"Capture":null:g;E=[];for(var h=u,b;h!==null;){b=h;var M=b.stateNode;if(b.tag===5&&M!==null&&(b=M,x!==null&&(M=Tl(h,x),M!=null&&E.push(_l(h,M,b)))),P)break;h=h.return}0<E.length&&(g=new S(g,A,null,n,f),p.push({event:g,listeners:E}))}}if(!(t&7)){e:{if(g=e==="mouseover"||e==="pointerover",S=e==="mouseout"||e==="pointerout",g&&n!==Bo&&(A=n.relatedTarget||n.fromElement)&&(Bs(A)||A[Kn]))break e;if((S||g)&&(g=f.window===f?f:(g=f.ownerDocument)?g.defaultView||g.parentWindow:window,S?(A=n.relatedTarget||n.toElement,S=u,A=A?Bs(A):null,A!==null&&(P=Js(A),A!==P||A.tag!==5&&A.tag!==6)&&(A=null)):(S=null,A=u),S!==A)){if(E=nu,M="onMouseLeave",x="onMouseEnter",h="mouse",(e==="pointerout"||e==="pointerover")&&(E=ru,M="onPointerLeave",x="onPointerEnter",h="pointer"),P=S==null?g:yr(S),b=A==null?g:yr(A),g=new E(M,h+"leave",S,n,f),g.target=P,g.relatedTarget=b,M=null,Bs(f)===u&&(E=new E(x,h+"enter",A,n,f),E.target=b,E.relatedTarget=P,M=E),P=M,S&&A)t:{for(E=S,x=A,h=0,b=E;b;b=ur(b))h++;for(b=0,M=x;M;M=ur(M))b++;for(;0<h-b;)E=ur(E),h--;for(;0<b-h;)x=ur(x),b--;for(;h--;){if(E===x||x!==null&&E===x.alternate)break t;E=ur(E),x=ur(x)}E=null}else E=null;S!==null&&hu(p,g,S,E,!1),A!==null&&P!==null&&hu(p,P,A,E,!0)}}e:{if(g=u?yr(u):window,S=g.nodeName&&g.nodeName.toLowerCase(),S==="select"||S==="input"&&g.type==="file")var U=Xx;else if(iu(g))if(wf)U=e0;else{U=Jx;var H=Qx}else(S=g.nodeName)&&S.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(U=Zx);if(U&&(U=U(e,u))){bf(p,U,n,f);break e}H&&H(e,g,u),e==="focusout"&&(H=g._wrapperState)&&H.controlled&&g.type==="number"&&_o(g,"number",g.value)}switch(H=u?yr(u):window,e){case"focusin":(iu(H)||H.contentEditable==="true")&&(xr=H,Yo=u,vl=null);break;case"focusout":vl=Yo=xr=null;break;case"mousedown":Go=!0;break;case"contextmenu":case"mouseup":case"dragend":Go=!1,mu(p,n,f);break;case"selectionchange":if(s0)break;case"keydown":case"keyup":mu(p,n,f)}var W;if(zc)e:{switch(e){case"compositionstart":var O="onCompositionStart";break e;case"compositionend":O="onCompositionEnd";break e;case"compositionupdate":O="onCompositionUpdate";break e}O=void 0}else hr?Nf(e,n)&&(O="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(O="onCompositionStart");O&&(yf&&n.locale!=="ko"&&(hr||O!=="onCompositionStart"?O==="onCompositionEnd"&&hr&&(W=gf()):(ps=f,$c="value"in ps?ps.value:ps.textContent,hr=!0)),H=Ka(u,O),0<H.length&&(O=new su(O,e,null,n,f),p.push({event:O,listeners:H}),W?O.data=W:(W=vf(n),W!==null&&(O.data=W)))),(W=Vx?Yx(e,n):Gx(e,n))&&(u=Ka(u,"onBeforeInput"),0<u.length&&(f=new su("onBeforeInput","beforeinput",null,n,f),p.push({event:f,listeners:u}),f.data=W))}Df(p,t)})}function _l(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Ka(e,t){for(var n=t+"Capture",r=[];e!==null;){var l=e,a=l.stateNode;l.tag===5&&a!==null&&(l=a,a=Tl(e,n),a!=null&&r.unshift(_l(e,a,l)),a=Tl(e,t),a!=null&&r.push(_l(e,a,l))),e=e.return}return r}function ur(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function hu(e,t,n,r,l){for(var a=t._reactName,i=[];n!==null&&n!==r;){var o=n,c=o.alternate,u=o.stateNode;if(c!==null&&c===r)break;o.tag===5&&u!==null&&(o=u,l?(c=Tl(n,a),c!=null&&i.unshift(_l(n,c,o))):l||(c=Tl(n,a),c!=null&&i.push(_l(n,c,o)))),n=n.return}i.length!==0&&e.push({event:t,listeners:i})}var i0=/\r\n?/g,o0=/\u0000|\uFFFD/g;function xu(e){return(typeof e=="string"?e:""+e).replace(i0,`
`).replace(o0,"")}function ha(e,t,n){if(t=xu(t),xu(e)!==t&&n)throw Error(J(425))}function qa(){}var Ko=null,qo=null;function Xo(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qo=typeof setTimeout=="function"?setTimeout:void 0,c0=typeof clearTimeout=="function"?clearTimeout:void 0,gu=typeof Promise=="function"?Promise:void 0,d0=typeof queueMicrotask=="function"?queueMicrotask:typeof gu<"u"?function(e){return gu.resolve(null).then(e).catch(u0)}:Qo;function u0(e){setTimeout(function(){throw e})}function no(e,t){var n=t,r=0;do{var l=n.nextSibling;if(e.removeChild(n),l&&l.nodeType===8)if(n=l.data,n==="/$"){if(r===0){e.removeChild(l),Rl(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=l}while(n);Rl(t)}function vs(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function yu(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Hr=Math.random().toString(36).slice(2),kn="__reactFiber$"+Hr,Ol="__reactProps$"+Hr,Kn="__reactContainer$"+Hr,Jo="__reactEvents$"+Hr,m0="__reactListeners$"+Hr,f0="__reactHandles$"+Hr;function Bs(e){var t=e[kn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Kn]||n[kn]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=yu(e);e!==null;){if(n=e[kn])return n;e=yu(e)}return t}e=n,n=e.parentNode}return null}function ea(e){return e=e[kn]||e[Kn],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function yr(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(J(33))}function Ii(e){return e[Ol]||null}var Zo=[],Nr=-1;function ks(e){return{current:e}}function Ze(e){0>Nr||(e.current=Zo[Nr],Zo[Nr]=null,Nr--)}function qe(e,t){Nr++,Zo[Nr]=e.current,e.current=t}var Ts={},Lt=ks(Ts),Wt=ks(!1),Vs=Ts;function Dr(e,t){var n=e.type.contextTypes;if(!n)return Ts;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var l={},a;for(a in n)l[a]=t[a];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=l),l}function Vt(e){return e=e.childContextTypes,e!=null}function Xa(){Ze(Wt),Ze(Lt)}function Nu(e,t,n){if(Lt.current!==Ts)throw Error(J(168));qe(Lt,t),qe(Wt,n)}function _f(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var l in r)if(!(l in t))throw Error(J(108,Qh(e)||"Unknown",l));return ot({},n,r)}function Qa(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ts,Vs=Lt.current,qe(Lt,e),qe(Wt,Wt.current),!0}function vu(e,t,n){var r=e.stateNode;if(!r)throw Error(J(169));n?(e=_f(e,t,Vs),r.__reactInternalMemoizedMergedChildContext=e,Ze(Wt),Ze(Lt),qe(Lt,e)):Ze(Wt),qe(Wt,n)}var $n=null,Ti=!1,so=!1;function Of(e){$n===null?$n=[e]:$n.push(e)}function p0(e){Ti=!0,Of(e)}function Rs(){if(!so&&$n!==null){so=!0;var e=0,t=Ve;try{var n=$n;for(Ve=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}$n=null,Ti=!1}catch(l){throw $n!==null&&($n=$n.slice(e+1)),lf(Pc,Rs),l}finally{Ve=t,so=!1}}return null}var vr=[],br=0,Ja=null,Za=0,ln=[],an=0,Ys=null,zn=1,Wn="";function Os(e,t){vr[br++]=Za,vr[br++]=Ja,Ja=e,Za=t}function Pf(e,t,n){ln[an++]=zn,ln[an++]=Wn,ln[an++]=Ys,Ys=e;var r=zn;e=Wn;var l=32-vn(r)-1;r&=~(1<<l),n+=1;var a=32-vn(t)+l;if(30<a){var i=l-l%5;a=(r&(1<<i)-1).toString(32),r>>=i,l-=i,zn=1<<32-vn(t)+l|n<<l|r,Wn=a+e}else zn=1<<a|n<<l|r,Wn=e}function Vc(e){e.return!==null&&(Os(e,1),Pf(e,1,0))}function Yc(e){for(;e===Ja;)Ja=vr[--br],vr[br]=null,Za=vr[--br],vr[br]=null;for(;e===Ys;)Ys=ln[--an],ln[an]=null,Wn=ln[--an],ln[an]=null,zn=ln[--an],ln[an]=null}var Qt=null,Xt=null,st=!1,Nn=null;function Mf(e,t){var n=on(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function bu(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Qt=e,Xt=vs(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Qt=e,Xt=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ys!==null?{id:zn,overflow:Wn}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=on(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Qt=e,Xt=null,!0):!1;default:return!1}}function ec(e){return(e.mode&1)!==0&&(e.flags&128)===0}function tc(e){if(st){var t=Xt;if(t){var n=t;if(!bu(e,t)){if(ec(e))throw Error(J(418));t=vs(n.nextSibling);var r=Qt;t&&bu(e,t)?Mf(r,n):(e.flags=e.flags&-4097|2,st=!1,Qt=e)}}else{if(ec(e))throw Error(J(418));e.flags=e.flags&-4097|2,st=!1,Qt=e}}}function wu(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Qt=e}function xa(e){if(e!==Qt)return!1;if(!st)return wu(e),st=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Xo(e.type,e.memoizedProps)),t&&(t=Xt)){if(ec(e))throw Ff(),Error(J(418));for(;t;)Mf(e,t),t=vs(t.nextSibling)}if(wu(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(J(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Xt=vs(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Xt=null}}else Xt=Qt?vs(e.stateNode.nextSibling):null;return!0}function Ff(){for(var e=Xt;e;)e=vs(e.nextSibling)}function Lr(){Xt=Qt=null,st=!1}function Gc(e){Nn===null?Nn=[e]:Nn.push(e)}var h0=Jn.ReactCurrentBatchConfig;function ll(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(J(309));var r=n.stateNode}if(!r)throw Error(J(147,e));var l=r,a=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===a?t.ref:(t=function(i){var o=l.refs;i===null?delete o[a]:o[a]=i},t._stringRef=a,t)}if(typeof e!="string")throw Error(J(284));if(!n._owner)throw Error(J(290,e))}return e}function ga(e,t){throw e=Object.prototype.toString.call(t),Error(J(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Su(e){var t=e._init;return t(e._payload)}function Bf(e){function t(x,h){if(e){var b=x.deletions;b===null?(x.deletions=[h],x.flags|=16):b.push(h)}}function n(x,h){if(!e)return null;for(;h!==null;)t(x,h),h=h.sibling;return null}function r(x,h){for(x=new Map;h!==null;)h.key!==null?x.set(h.key,h):x.set(h.index,h),h=h.sibling;return x}function l(x,h){return x=js(x,h),x.index=0,x.sibling=null,x}function a(x,h,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<h?(x.flags|=2,h):b):(x.flags|=2,h)):(x.flags|=1048576,h)}function i(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,h,b,M){return h===null||h.tag!==6?(h=uo(b,x.mode,M),h.return=x,h):(h=l(h,b),h.return=x,h)}function c(x,h,b,M){var U=b.type;return U===pr?f(x,h,b.props.children,M,b.key):h!==null&&(h.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===is&&Su(U)===h.type)?(M=l(h,b.props),M.ref=ll(x,h,b),M.return=x,M):(M=Fa(b.type,b.key,b.props,null,x.mode,M),M.ref=ll(x,h,b),M.return=x,M)}function u(x,h,b,M){return h===null||h.tag!==4||h.stateNode.containerInfo!==b.containerInfo||h.stateNode.implementation!==b.implementation?(h=mo(b,x.mode,M),h.return=x,h):(h=l(h,b.children||[]),h.return=x,h)}function f(x,h,b,M,U){return h===null||h.tag!==7?(h=zs(b,x.mode,M,U),h.return=x,h):(h=l(h,b),h.return=x,h)}function p(x,h,b){if(typeof h=="string"&&h!==""||typeof h=="number")return h=uo(""+h,x.mode,b),h.return=x,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case aa:return b=Fa(h.type,h.key,h.props,null,x.mode,b),b.ref=ll(x,null,h),b.return=x,b;case fr:return h=mo(h,x.mode,b),h.return=x,h;case is:var M=h._init;return p(x,M(h._payload),b)}if(ml(h)||el(h))return h=zs(h,x.mode,b,null),h.return=x,h;ga(x,h)}return null}function g(x,h,b,M){var U=h!==null?h.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return U!==null?null:o(x,h,""+b,M);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case aa:return b.key===U?c(x,h,b,M):null;case fr:return b.key===U?u(x,h,b,M):null;case is:return U=b._init,g(x,h,U(b._payload),M)}if(ml(b)||el(b))return U!==null?null:f(x,h,b,M,null);ga(x,b)}return null}function S(x,h,b,M,U){if(typeof M=="string"&&M!==""||typeof M=="number")return x=x.get(b)||null,o(h,x,""+M,U);if(typeof M=="object"&&M!==null){switch(M.$$typeof){case aa:return x=x.get(M.key===null?b:M.key)||null,c(h,x,M,U);case fr:return x=x.get(M.key===null?b:M.key)||null,u(h,x,M,U);case is:var H=M._init;return S(x,h,b,H(M._payload),U)}if(ml(M)||el(M))return x=x.get(b)||null,f(h,x,M,U,null);ga(h,M)}return null}function A(x,h,b,M){for(var U=null,H=null,W=h,O=h=0,D=null;W!==null&&O<b.length;O++){W.index>O?(D=W,W=null):D=W.sibling;var $=g(x,W,b[O],M);if($===null){W===null&&(W=D);break}e&&W&&$.alternate===null&&t(x,W),h=a($,h,O),H===null?U=$:H.sibling=$,H=$,W=D}if(O===b.length)return n(x,W),st&&Os(x,O),U;if(W===null){for(;O<b.length;O++)W=p(x,b[O],M),W!==null&&(h=a(W,h,O),H===null?U=W:H.sibling=W,H=W);return st&&Os(x,O),U}for(W=r(x,W);O<b.length;O++)D=S(W,x,O,b[O],M),D!==null&&(e&&D.alternate!==null&&W.delete(D.key===null?O:D.key),h=a(D,h,O),H===null?U=D:H.sibling=D,H=D);return e&&W.forEach(function(I){return t(x,I)}),st&&Os(x,O),U}function E(x,h,b,M){var U=el(b);if(typeof U!="function")throw Error(J(150));if(b=U.call(b),b==null)throw Error(J(151));for(var H=U=null,W=h,O=h=0,D=null,$=b.next();W!==null&&!$.done;O++,$=b.next()){W.index>O?(D=W,W=null):D=W.sibling;var I=g(x,W,$.value,M);if(I===null){W===null&&(W=D);break}e&&W&&I.alternate===null&&t(x,W),h=a(I,h,O),H===null?U=I:H.sibling=I,H=I,W=D}if($.done)return n(x,W),st&&Os(x,O),U;if(W===null){for(;!$.done;O++,$=b.next())$=p(x,$.value,M),$!==null&&(h=a($,h,O),H===null?U=$:H.sibling=$,H=$);return st&&Os(x,O),U}for(W=r(x,W);!$.done;O++,$=b.next())$=S(W,x,O,$.value,M),$!==null&&(e&&$.alternate!==null&&W.delete($.key===null?O:$.key),h=a($,h,O),H===null?U=$:H.sibling=$,H=$);return e&&W.forEach(function(k){return t(x,k)}),st&&Os(x,O),U}function P(x,h,b,M){if(typeof b=="object"&&b!==null&&b.type===pr&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case aa:e:{for(var U=b.key,H=h;H!==null;){if(H.key===U){if(U=b.type,U===pr){if(H.tag===7){n(x,H.sibling),h=l(H,b.props.children),h.return=x,x=h;break e}}else if(H.elementType===U||typeof U=="object"&&U!==null&&U.$$typeof===is&&Su(U)===H.type){n(x,H.sibling),h=l(H,b.props),h.ref=ll(x,H,b),h.return=x,x=h;break e}n(x,H);break}else t(x,H);H=H.sibling}b.type===pr?(h=zs(b.props.children,x.mode,M,b.key),h.return=x,x=h):(M=Fa(b.type,b.key,b.props,null,x.mode,M),M.ref=ll(x,h,b),M.return=x,x=M)}return i(x);case fr:e:{for(H=b.key;h!==null;){if(h.key===H)if(h.tag===4&&h.stateNode.containerInfo===b.containerInfo&&h.stateNode.implementation===b.implementation){n(x,h.sibling),h=l(h,b.children||[]),h.return=x,x=h;break e}else{n(x,h);break}else t(x,h);h=h.sibling}h=mo(b,x.mode,M),h.return=x,x=h}return i(x);case is:return H=b._init,P(x,h,H(b._payload),M)}if(ml(b))return A(x,h,b,M);if(el(b))return E(x,h,b,M);ga(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,h!==null&&h.tag===6?(n(x,h.sibling),h=l(h,b),h.return=x,x=h):(n(x,h),h=uo(b,x.mode,M),h.return=x,x=h),i(x)):n(x,h)}return P}var _r=Bf(!0),$f=Bf(!1),ei=ks(null),ti=null,wr=null,Kc=null;function qc(){Kc=wr=ti=null}function Xc(e){var t=ei.current;Ze(ei),e._currentValue=t}function nc(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function kr(e,t){ti=e,Kc=wr=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(zt=!0),e.firstContext=null)}function dn(e){var t=e._currentValue;if(Kc!==e)if(e={context:e,memoizedValue:t,next:null},wr===null){if(ti===null)throw Error(J(308));wr=e,ti.dependencies={lanes:0,firstContext:e}}else wr=wr.next=e;return t}var $s=null;function Qc(e){$s===null?$s=[e]:$s.push(e)}function Uf(e,t,n,r){var l=t.interleaved;return l===null?(n.next=n,Qc(t)):(n.next=l.next,l.next=n),t.interleaved=n,qn(e,r)}function qn(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var os=!1;function Jc(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Hf(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Vn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function bs(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,$e&2){var l=r.pending;return l===null?t.next=t:(t.next=l.next,l.next=t),r.pending=t,qn(e,n)}return l=r.interleaved,l===null?(t.next=t,Qc(r)):(t.next=l.next,l.next=t),r.interleaved=t,qn(e,n)}function Da(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Mc(e,n)}}function ju(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var l=null,a=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};a===null?l=a=i:a=a.next=i,n=n.next}while(n!==null);a===null?l=a=t:a=a.next=t}else l=a=t;n={baseState:r.baseState,firstBaseUpdate:l,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ni(e,t,n,r){var l=e.updateQueue;os=!1;var a=l.firstBaseUpdate,i=l.lastBaseUpdate,o=l.shared.pending;if(o!==null){l.shared.pending=null;var c=o,u=c.next;c.next=null,i===null?a=u:i.next=u,i=c;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=c))}if(a!==null){var p=l.baseState;i=0,f=u=c=null,o=a;do{var g=o.lane,S=o.eventTime;if((r&g)===g){f!==null&&(f=f.next={eventTime:S,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var A=e,E=o;switch(g=t,S=n,E.tag){case 1:if(A=E.payload,typeof A=="function"){p=A.call(S,p,g);break e}p=A;break e;case 3:A.flags=A.flags&-65537|128;case 0:if(A=E.payload,g=typeof A=="function"?A.call(S,p,g):A,g==null)break e;p=ot({},p,g);break e;case 2:os=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,g=l.effects,g===null?l.effects=[o]:g.push(o))}else S={eventTime:S,lane:g,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(u=f=S,c=p):f=f.next=S,i|=g;if(o=o.next,o===null){if(o=l.shared.pending,o===null)break;g=o,o=g.next,g.next=null,l.lastBaseUpdate=g,l.shared.pending=null}}while(!0);if(f===null&&(c=p),l.baseState=c,l.firstBaseUpdate=u,l.lastBaseUpdate=f,t=l.shared.interleaved,t!==null){l=t;do i|=l.lane,l=l.next;while(l!==t)}else a===null&&(l.shared.lanes=0);Ks|=i,e.lanes=i,e.memoizedState=p}}function Eu(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],l=r.callback;if(l!==null){if(r.callback=null,r=n,typeof l!="function")throw Error(J(191,l));l.call(r)}}}var ta={},_n=ks(ta),Pl=ks(ta),Ml=ks(ta);function Us(e){if(e===ta)throw Error(J(174));return e}function Zc(e,t){switch(qe(Ml,t),qe(Pl,e),qe(_n,ta),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Po(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Po(t,e)}Ze(_n),qe(_n,t)}function Or(){Ze(_n),Ze(Pl),Ze(Ml)}function zf(e){Us(Ml.current);var t=Us(_n.current),n=Po(t,e.type);t!==n&&(qe(Pl,e),qe(_n,n))}function ed(e){Pl.current===e&&(Ze(_n),Ze(Pl))}var at=ks(0);function si(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var ro=[];function td(){for(var e=0;e<ro.length;e++)ro[e]._workInProgressVersionPrimary=null;ro.length=0}var La=Jn.ReactCurrentDispatcher,lo=Jn.ReactCurrentBatchConfig,Gs=0,it=null,ht=null,vt=null,ri=!1,bl=!1,Fl=0,x0=0;function kt(){throw Error(J(321))}function nd(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Sn(e[n],t[n]))return!1;return!0}function sd(e,t,n,r,l,a){if(Gs=a,it=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,La.current=e===null||e.memoizedState===null?v0:b0,e=n(r,l),bl){a=0;do{if(bl=!1,Fl=0,25<=a)throw Error(J(301));a+=1,vt=ht=null,t.updateQueue=null,La.current=w0,e=n(r,l)}while(bl)}if(La.current=li,t=ht!==null&&ht.next!==null,Gs=0,vt=ht=it=null,ri=!1,t)throw Error(J(300));return e}function rd(){var e=Fl!==0;return Fl=0,e}function Tn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?it.memoizedState=vt=e:vt=vt.next=e,vt}function un(){if(ht===null){var e=it.alternate;e=e!==null?e.memoizedState:null}else e=ht.next;var t=vt===null?it.memoizedState:vt.next;if(t!==null)vt=t,ht=e;else{if(e===null)throw Error(J(310));ht=e,e={memoizedState:ht.memoizedState,baseState:ht.baseState,baseQueue:ht.baseQueue,queue:ht.queue,next:null},vt===null?it.memoizedState=vt=e:vt=vt.next=e}return vt}function Bl(e,t){return typeof t=="function"?t(e):t}function ao(e){var t=un(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=ht,l=r.baseQueue,a=n.pending;if(a!==null){if(l!==null){var i=l.next;l.next=a.next,a.next=i}r.baseQueue=l=a,n.pending=null}if(l!==null){a=l.next,r=r.baseState;var o=i=null,c=null,u=a;do{var f=u.lane;if((Gs&f)===f)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var p={lane:f,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(o=c=p,i=r):c=c.next=p,it.lanes|=f,Ks|=f}u=u.next}while(u!==null&&u!==a);c===null?i=r:c.next=o,Sn(r,t.memoizedState)||(zt=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){l=e;do a=l.lane,it.lanes|=a,Ks|=a,l=l.next;while(l!==e)}else l===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function io(e){var t=un(),n=t.queue;if(n===null)throw Error(J(311));n.lastRenderedReducer=e;var r=n.dispatch,l=n.pending,a=t.memoizedState;if(l!==null){n.pending=null;var i=l=l.next;do a=e(a,i.action),i=i.next;while(i!==l);Sn(a,t.memoizedState)||(zt=!0),t.memoizedState=a,t.baseQueue===null&&(t.baseState=a),n.lastRenderedState=a}return[a,r]}function Wf(){}function Vf(e,t){var n=it,r=un(),l=t(),a=!Sn(r.memoizedState,l);if(a&&(r.memoizedState=l,zt=!0),r=r.queue,ld(Kf.bind(null,n,r,e),[e]),r.getSnapshot!==t||a||vt!==null&&vt.memoizedState.tag&1){if(n.flags|=2048,$l(9,Gf.bind(null,n,r,l,t),void 0,null),bt===null)throw Error(J(349));Gs&30||Yf(n,t,l)}return l}function Yf(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Gf(e,t,n,r){t.value=n,t.getSnapshot=r,qf(t)&&Xf(e)}function Kf(e,t,n){return n(function(){qf(t)&&Xf(e)})}function qf(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Sn(e,n)}catch{return!0}}function Xf(e){var t=qn(e,1);t!==null&&bn(t,e,1,-1)}function Iu(e){var t=Tn();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Bl,lastRenderedState:e},t.queue=e,e=e.dispatch=N0.bind(null,it,e),[t.memoizedState,e]}function $l(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=it.updateQueue,t===null?(t={lastEffect:null,stores:null},it.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function Qf(){return un().memoizedState}function _a(e,t,n,r){var l=Tn();it.flags|=e,l.memoizedState=$l(1|t,n,void 0,r===void 0?null:r)}function Ai(e,t,n,r){var l=un();r=r===void 0?null:r;var a=void 0;if(ht!==null){var i=ht.memoizedState;if(a=i.destroy,r!==null&&nd(r,i.deps)){l.memoizedState=$l(t,n,a,r);return}}it.flags|=e,l.memoizedState=$l(1|t,n,a,r)}function Tu(e,t){return _a(8390656,8,e,t)}function ld(e,t){return Ai(2048,8,e,t)}function Jf(e,t){return Ai(4,2,e,t)}function Zf(e,t){return Ai(4,4,e,t)}function ep(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function tp(e,t,n){return n=n!=null?n.concat([e]):null,Ai(4,4,ep.bind(null,t,e),n)}function ad(){}function np(e,t){var n=un();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&nd(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function sp(e,t){var n=un();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&nd(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function rp(e,t,n){return Gs&21?(Sn(n,t)||(n=cf(),it.lanes|=n,Ks|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,zt=!0),e.memoizedState=n)}function g0(e,t){var n=Ve;Ve=n!==0&&4>n?n:4,e(!0);var r=lo.transition;lo.transition={};try{e(!1),t()}finally{Ve=n,lo.transition=r}}function lp(){return un().memoizedState}function y0(e,t,n){var r=Ss(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},ap(e))ip(t,n);else if(n=Uf(e,t,n,r),n!==null){var l=Pt();bn(n,e,r,l),op(n,t,r)}}function N0(e,t,n){var r=Ss(e),l={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(ap(e))ip(t,l);else{var a=e.alternate;if(e.lanes===0&&(a===null||a.lanes===0)&&(a=t.lastRenderedReducer,a!==null))try{var i=t.lastRenderedState,o=a(i,n);if(l.hasEagerState=!0,l.eagerState=o,Sn(o,i)){var c=t.interleaved;c===null?(l.next=l,Qc(t)):(l.next=c.next,c.next=l),t.interleaved=l;return}}catch{}finally{}n=Uf(e,t,l,r),n!==null&&(l=Pt(),bn(n,e,r,l),op(n,t,r))}}function ap(e){var t=e.alternate;return e===it||t!==null&&t===it}function ip(e,t){bl=ri=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function op(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Mc(e,n)}}var li={readContext:dn,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},v0={readContext:dn,useCallback:function(e,t){return Tn().memoizedState=[e,t===void 0?null:t],e},useContext:dn,useEffect:Tu,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,_a(4194308,4,ep.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _a(4194308,4,e,t)},useInsertionEffect:function(e,t){return _a(4,2,e,t)},useMemo:function(e,t){var n=Tn();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Tn();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=y0.bind(null,it,e),[r.memoizedState,e]},useRef:function(e){var t=Tn();return e={current:e},t.memoizedState=e},useState:Iu,useDebugValue:ad,useDeferredValue:function(e){return Tn().memoizedState=e},useTransition:function(){var e=Iu(!1),t=e[0];return e=g0.bind(null,e[1]),Tn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=it,l=Tn();if(st){if(n===void 0)throw Error(J(407));n=n()}else{if(n=t(),bt===null)throw Error(J(349));Gs&30||Yf(r,t,n)}l.memoizedState=n;var a={value:n,getSnapshot:t};return l.queue=a,Tu(Kf.bind(null,r,a,e),[e]),r.flags|=2048,$l(9,Gf.bind(null,r,a,n,t),void 0,null),n},useId:function(){var e=Tn(),t=bt.identifierPrefix;if(st){var n=Wn,r=zn;n=(r&~(1<<32-vn(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Fl++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=x0++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},b0={readContext:dn,useCallback:np,useContext:dn,useEffect:ld,useImperativeHandle:tp,useInsertionEffect:Jf,useLayoutEffect:Zf,useMemo:sp,useReducer:ao,useRef:Qf,useState:function(){return ao(Bl)},useDebugValue:ad,useDeferredValue:function(e){var t=un();return rp(t,ht.memoizedState,e)},useTransition:function(){var e=ao(Bl)[0],t=un().memoizedState;return[e,t]},useMutableSource:Wf,useSyncExternalStore:Vf,useId:lp,unstable_isNewReconciler:!1},w0={readContext:dn,useCallback:np,useContext:dn,useEffect:ld,useImperativeHandle:tp,useInsertionEffect:Jf,useLayoutEffect:Zf,useMemo:sp,useReducer:io,useRef:Qf,useState:function(){return io(Bl)},useDebugValue:ad,useDeferredValue:function(e){var t=un();return ht===null?t.memoizedState=e:rp(t,ht.memoizedState,e)},useTransition:function(){var e=io(Bl)[0],t=un().memoizedState;return[e,t]},useMutableSource:Wf,useSyncExternalStore:Vf,useId:lp,unstable_isNewReconciler:!1};function gn(e,t){if(e&&e.defaultProps){t=ot({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function sc(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:ot({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var ki={isMounted:function(e){return(e=e._reactInternals)?Js(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Pt(),l=Ss(e),a=Vn(r,l);a.payload=t,n!=null&&(a.callback=n),t=bs(e,a,l),t!==null&&(bn(t,e,l,r),Da(t,e,l))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Pt(),l=Ss(e),a=Vn(r,l);a.tag=1,a.payload=t,n!=null&&(a.callback=n),t=bs(e,a,l),t!==null&&(bn(t,e,l,r),Da(t,e,l))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Pt(),r=Ss(e),l=Vn(n,r);l.tag=2,t!=null&&(l.callback=t),t=bs(e,l,r),t!==null&&(bn(t,e,r,n),Da(t,e,r))}};function Au(e,t,n,r,l,a,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,a,i):t.prototype&&t.prototype.isPureReactComponent?!Dl(n,r)||!Dl(l,a):!0}function cp(e,t,n){var r=!1,l=Ts,a=t.contextType;return typeof a=="object"&&a!==null?a=dn(a):(l=Vt(t)?Vs:Lt.current,r=t.contextTypes,a=(r=r!=null)?Dr(e,l):Ts),t=new t(n,a),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ki,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=l,e.__reactInternalMemoizedMaskedChildContext=a),t}function ku(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&ki.enqueueReplaceState(t,t.state,null)}function rc(e,t,n,r){var l=e.stateNode;l.props=n,l.state=e.memoizedState,l.refs={},Jc(e);var a=t.contextType;typeof a=="object"&&a!==null?l.context=dn(a):(a=Vt(t)?Vs:Lt.current,l.context=Dr(e,a)),l.state=e.memoizedState,a=t.getDerivedStateFromProps,typeof a=="function"&&(sc(e,t,a,n),l.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof l.getSnapshotBeforeUpdate=="function"||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(t=l.state,typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount(),t!==l.state&&ki.enqueueReplaceState(l,l.state,null),ni(e,n,l,r),l.state=e.memoizedState),typeof l.componentDidMount=="function"&&(e.flags|=4194308)}function Pr(e,t){try{var n="",r=t;do n+=Xh(r),r=r.return;while(r);var l=n}catch(a){l=`
Error generating stack: `+a.message+`
`+a.stack}return{value:e,source:t,stack:l,digest:null}}function oo(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function lc(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var S0=typeof WeakMap=="function"?WeakMap:Map;function dp(e,t,n){n=Vn(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){ii||(ii=!0,hc=r),lc(e,t)},n}function up(e,t,n){n=Vn(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var l=t.value;n.payload=function(){return r(l)},n.callback=function(){lc(e,t)}}var a=e.stateNode;return a!==null&&typeof a.componentDidCatch=="function"&&(n.callback=function(){lc(e,t),typeof r!="function"&&(ws===null?ws=new Set([this]):ws.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),n}function Ru(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new S0;var l=new Set;r.set(t,l)}else l=r.get(t),l===void 0&&(l=new Set,r.set(t,l));l.has(n)||(l.add(n),e=M0.bind(null,e,t,n),t.then(e,e))}function Cu(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Du(e,t,n,r,l){return e.mode&1?(e.flags|=65536,e.lanes=l,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Vn(-1,1),t.tag=2,bs(n,t,1))),n.lanes|=1),e)}var j0=Jn.ReactCurrentOwner,zt=!1;function Ot(e,t,n,r){t.child=e===null?$f(t,null,n,r):_r(t,e.child,n,r)}function Lu(e,t,n,r,l){n=n.render;var a=t.ref;return kr(t,l),r=sd(e,t,n,r,a,l),n=rd(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Xn(e,t,l)):(st&&n&&Vc(t),t.flags|=1,Ot(e,t,r,l),t.child)}function _u(e,t,n,r,l){if(e===null){var a=n.type;return typeof a=="function"&&!pd(a)&&a.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=a,mp(e,t,a,r,l)):(e=Fa(n.type,null,r,t,t.mode,l),e.ref=t.ref,e.return=t,t.child=e)}if(a=e.child,!(e.lanes&l)){var i=a.memoizedProps;if(n=n.compare,n=n!==null?n:Dl,n(i,r)&&e.ref===t.ref)return Xn(e,t,l)}return t.flags|=1,e=js(a,r),e.ref=t.ref,e.return=t,t.child=e}function mp(e,t,n,r,l){if(e!==null){var a=e.memoizedProps;if(Dl(a,r)&&e.ref===t.ref)if(zt=!1,t.pendingProps=r=a,(e.lanes&l)!==0)e.flags&131072&&(zt=!0);else return t.lanes=e.lanes,Xn(e,t,l)}return ac(e,t,n,r,l)}function fp(e,t,n){var r=t.pendingProps,l=r.children,a=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},qe(jr,Kt),Kt|=n;else{if(!(n&1073741824))return e=a!==null?a.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,qe(jr,Kt),Kt|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=a!==null?a.baseLanes:n,qe(jr,Kt),Kt|=r}else a!==null?(r=a.baseLanes|n,t.memoizedState=null):r=n,qe(jr,Kt),Kt|=r;return Ot(e,t,l,n),t.child}function pp(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ac(e,t,n,r,l){var a=Vt(n)?Vs:Lt.current;return a=Dr(t,a),kr(t,l),n=sd(e,t,n,r,a,l),r=rd(),e!==null&&!zt?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~l,Xn(e,t,l)):(st&&r&&Vc(t),t.flags|=1,Ot(e,t,n,l),t.child)}function Ou(e,t,n,r,l){if(Vt(n)){var a=!0;Qa(t)}else a=!1;if(kr(t,l),t.stateNode===null)Oa(e,t),cp(t,n,r),rc(t,n,r,l),r=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var c=i.context,u=n.contextType;typeof u=="object"&&u!==null?u=dn(u):(u=Vt(n)?Vs:Lt.current,u=Dr(t,u));var f=n.getDerivedStateFromProps,p=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";p||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==r||c!==u)&&ku(t,i,r,u),os=!1;var g=t.memoizedState;i.state=g,ni(t,r,i,l),c=t.memoizedState,o!==r||g!==c||Wt.current||os?(typeof f=="function"&&(sc(t,n,f,r),c=t.memoizedState),(o=os||Au(t,n,o,r,g,c,u))?(p||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),i.props=r,i.state=c,i.context=u,r=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{i=t.stateNode,Hf(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:gn(t.type,o),i.props=u,p=t.pendingProps,g=i.context,c=n.contextType,typeof c=="object"&&c!==null?c=dn(c):(c=Vt(n)?Vs:Lt.current,c=Dr(t,c));var S=n.getDerivedStateFromProps;(f=typeof S=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==p||g!==c)&&ku(t,i,r,c),os=!1,g=t.memoizedState,i.state=g,ni(t,r,i,l);var A=t.memoizedState;o!==p||g!==A||Wt.current||os?(typeof S=="function"&&(sc(t,n,S,r),A=t.memoizedState),(u=os||Au(t,n,u,r,g,A,c)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(r,A,c),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(r,A,c)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=A),i.props=r,i.state=A,i.context=c,r=u):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&g===e.memoizedState||(t.flags|=1024),r=!1)}return ic(e,t,n,r,a,l)}function ic(e,t,n,r,l,a){pp(e,t);var i=(t.flags&128)!==0;if(!r&&!i)return l&&vu(t,n,!1),Xn(e,t,a);r=t.stateNode,j0.current=t;var o=i&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&i?(t.child=_r(t,e.child,null,a),t.child=_r(t,null,o,a)):Ot(e,t,o,a),t.memoizedState=r.state,l&&vu(t,n,!0),t.child}function hp(e){var t=e.stateNode;t.pendingContext?Nu(e,t.pendingContext,t.pendingContext!==t.context):t.context&&Nu(e,t.context,!1),Zc(e,t.containerInfo)}function Pu(e,t,n,r,l){return Lr(),Gc(l),t.flags|=256,Ot(e,t,n,r),t.child}var oc={dehydrated:null,treeContext:null,retryLane:0};function cc(e){return{baseLanes:e,cachePool:null,transitions:null}}function xp(e,t,n){var r=t.pendingProps,l=at.current,a=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(l&2)!==0),o?(a=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(l|=1),qe(at,l&1),e===null)return tc(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=r.children,e=r.fallback,a?(r=t.mode,a=t.child,i={mode:"hidden",children:i},!(r&1)&&a!==null?(a.childLanes=0,a.pendingProps=i):a=Di(i,r,0,null),e=zs(e,r,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=cc(n),t.memoizedState=oc,e):id(t,i));if(l=e.memoizedState,l!==null&&(o=l.dehydrated,o!==null))return E0(e,t,i,r,o,l,n);if(a){a=r.fallback,i=t.mode,l=e.child,o=l.sibling;var c={mode:"hidden",children:r.children};return!(i&1)&&t.child!==l?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=js(l,c),r.subtreeFlags=l.subtreeFlags&14680064),o!==null?a=js(o,a):(a=zs(a,i,n,null),a.flags|=2),a.return=t,r.return=t,r.sibling=a,t.child=r,r=a,a=t.child,i=e.child.memoizedState,i=i===null?cc(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},a.memoizedState=i,a.childLanes=e.childLanes&~n,t.memoizedState=oc,r}return a=e.child,e=a.sibling,r=js(a,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function id(e,t){return t=Di({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function ya(e,t,n,r){return r!==null&&Gc(r),_r(t,e.child,null,n),e=id(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function E0(e,t,n,r,l,a,i){if(n)return t.flags&256?(t.flags&=-257,r=oo(Error(J(422))),ya(e,t,i,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(a=r.fallback,l=t.mode,r=Di({mode:"visible",children:r.children},l,0,null),a=zs(a,l,i,null),a.flags|=2,r.return=t,a.return=t,r.sibling=a,t.child=r,t.mode&1&&_r(t,e.child,null,i),t.child.memoizedState=cc(i),t.memoizedState=oc,a);if(!(t.mode&1))return ya(e,t,i,null);if(l.data==="$!"){if(r=l.nextSibling&&l.nextSibling.dataset,r)var o=r.dgst;return r=o,a=Error(J(419)),r=oo(a,r,void 0),ya(e,t,i,r)}if(o=(i&e.childLanes)!==0,zt||o){if(r=bt,r!==null){switch(i&-i){case 4:l=2;break;case 16:l=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:l=32;break;case 536870912:l=268435456;break;default:l=0}l=l&(r.suspendedLanes|i)?0:l,l!==0&&l!==a.retryLane&&(a.retryLane=l,qn(e,l),bn(r,e,l,-1))}return fd(),r=oo(Error(J(421))),ya(e,t,i,r)}return l.data==="$?"?(t.flags|=128,t.child=e.child,t=F0.bind(null,e),l._reactRetry=t,null):(e=a.treeContext,Xt=vs(l.nextSibling),Qt=t,st=!0,Nn=null,e!==null&&(ln[an++]=zn,ln[an++]=Wn,ln[an++]=Ys,zn=e.id,Wn=e.overflow,Ys=t),t=id(t,r.children),t.flags|=4096,t)}function Mu(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),nc(e.return,t,n)}function co(e,t,n,r,l){var a=e.memoizedState;a===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:l}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=l)}function gp(e,t,n){var r=t.pendingProps,l=r.revealOrder,a=r.tail;if(Ot(e,t,r.children,n),r=at.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Mu(e,n,t);else if(e.tag===19)Mu(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(qe(at,r),!(t.mode&1))t.memoizedState=null;else switch(l){case"forwards":for(n=t.child,l=null;n!==null;)e=n.alternate,e!==null&&si(e)===null&&(l=n),n=n.sibling;n=l,n===null?(l=t.child,t.child=null):(l=n.sibling,n.sibling=null),co(t,!1,l,n,a);break;case"backwards":for(n=null,l=t.child,t.child=null;l!==null;){if(e=l.alternate,e!==null&&si(e)===null){t.child=l;break}e=l.sibling,l.sibling=n,n=l,l=e}co(t,!0,n,null,a);break;case"together":co(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Oa(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Xn(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Ks|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(J(153));if(t.child!==null){for(e=t.child,n=js(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=js(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function I0(e,t,n){switch(t.tag){case 3:hp(t),Lr();break;case 5:zf(t);break;case 1:Vt(t.type)&&Qa(t);break;case 4:Zc(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,l=t.memoizedProps.value;qe(ei,r._currentValue),r._currentValue=l;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(qe(at,at.current&1),t.flags|=128,null):n&t.child.childLanes?xp(e,t,n):(qe(at,at.current&1),e=Xn(e,t,n),e!==null?e.sibling:null);qe(at,at.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return gp(e,t,n);t.flags|=128}if(l=t.memoizedState,l!==null&&(l.rendering=null,l.tail=null,l.lastEffect=null),qe(at,at.current),r)break;return null;case 22:case 23:return t.lanes=0,fp(e,t,n)}return Xn(e,t,n)}var yp,dc,Np,vp;yp=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};dc=function(){};Np=function(e,t,n,r){var l=e.memoizedProps;if(l!==r){e=t.stateNode,Us(_n.current);var a=null;switch(n){case"input":l=Do(e,l),r=Do(e,r),a=[];break;case"select":l=ot({},l,{value:void 0}),r=ot({},r,{value:void 0}),a=[];break;case"textarea":l=Oo(e,l),r=Oo(e,r),a=[];break;default:typeof l.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=qa)}Mo(n,r);var i;n=null;for(u in l)if(!r.hasOwnProperty(u)&&l.hasOwnProperty(u)&&l[u]!=null)if(u==="style"){var o=l[u];for(i in o)o.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(El.hasOwnProperty(u)?a||(a=[]):(a=a||[]).push(u,null));for(u in r){var c=r[u];if(o=l!=null?l[u]:void 0,r.hasOwnProperty(u)&&c!==o&&(c!=null||o!=null))if(u==="style")if(o){for(i in o)!o.hasOwnProperty(i)||c&&c.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in c)c.hasOwnProperty(i)&&o[i]!==c[i]&&(n||(n={}),n[i]=c[i])}else n||(a||(a=[]),a.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,o=o?o.__html:void 0,c!=null&&o!==c&&(a=a||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(a=a||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(El.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Qe("scroll",e),a||o===c||(a=[])):(a=a||[]).push(u,c))}n&&(a=a||[]).push("style",n);var u=a;(t.updateQueue=u)&&(t.flags|=4)}};vp=function(e,t,n,r){n!==r&&(t.flags|=4)};function al(e,t){if(!st)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Rt(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags&14680064,r|=l.flags&14680064,l.return=e,l=l.sibling;else for(l=e.child;l!==null;)n|=l.lanes|l.childLanes,r|=l.subtreeFlags,r|=l.flags,l.return=e,l=l.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function T0(e,t,n){var r=t.pendingProps;switch(Yc(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rt(t),null;case 1:return Vt(t.type)&&Xa(),Rt(t),null;case 3:return r=t.stateNode,Or(),Ze(Wt),Ze(Lt),td(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(xa(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Nn!==null&&(yc(Nn),Nn=null))),dc(e,t),Rt(t),null;case 5:ed(t);var l=Us(Ml.current);if(n=t.type,e!==null&&t.stateNode!=null)Np(e,t,n,r,l),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(J(166));return Rt(t),null}if(e=Us(_n.current),xa(t)){r=t.stateNode,n=t.type;var a=t.memoizedProps;switch(r[kn]=t,r[Ol]=a,e=(t.mode&1)!==0,n){case"dialog":Qe("cancel",r),Qe("close",r);break;case"iframe":case"object":case"embed":Qe("load",r);break;case"video":case"audio":for(l=0;l<pl.length;l++)Qe(pl[l],r);break;case"source":Qe("error",r);break;case"img":case"image":case"link":Qe("error",r),Qe("load",r);break;case"details":Qe("toggle",r);break;case"input":Yd(r,a),Qe("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!a.multiple},Qe("invalid",r);break;case"textarea":Kd(r,a),Qe("invalid",r)}Mo(n,a),l=null;for(var i in a)if(a.hasOwnProperty(i)){var o=a[i];i==="children"?typeof o=="string"?r.textContent!==o&&(a.suppressHydrationWarning!==!0&&ha(r.textContent,o,e),l=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(a.suppressHydrationWarning!==!0&&ha(r.textContent,o,e),l=["children",""+o]):El.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&Qe("scroll",r)}switch(n){case"input":ia(r),Gd(r,a,!0);break;case"textarea":ia(r),qd(r);break;case"select":case"option":break;default:typeof a.onClick=="function"&&(r.onclick=qa)}r=l,t.updateQueue=r,r!==null&&(t.flags|=4)}else{i=l.nodeType===9?l:l.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=Gm(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=i.createElement(n,{is:r.is}):(e=i.createElement(n),n==="select"&&(i=e,r.multiple?i.multiple=!0:r.size&&(i.size=r.size))):e=i.createElementNS(e,n),e[kn]=t,e[Ol]=r,yp(e,t,!1,!1),t.stateNode=e;e:{switch(i=Fo(n,r),n){case"dialog":Qe("cancel",e),Qe("close",e),l=r;break;case"iframe":case"object":case"embed":Qe("load",e),l=r;break;case"video":case"audio":for(l=0;l<pl.length;l++)Qe(pl[l],e);l=r;break;case"source":Qe("error",e),l=r;break;case"img":case"image":case"link":Qe("error",e),Qe("load",e),l=r;break;case"details":Qe("toggle",e),l=r;break;case"input":Yd(e,r),l=Do(e,r),Qe("invalid",e);break;case"option":l=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},l=ot({},r,{value:void 0}),Qe("invalid",e);break;case"textarea":Kd(e,r),l=Oo(e,r),Qe("invalid",e);break;default:l=r}Mo(n,l),o=l;for(a in o)if(o.hasOwnProperty(a)){var c=o[a];a==="style"?Xm(e,c):a==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&Km(e,c)):a==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Il(e,c):typeof c=="number"&&Il(e,""+c):a!=="suppressContentEditableWarning"&&a!=="suppressHydrationWarning"&&a!=="autoFocus"&&(El.hasOwnProperty(a)?c!=null&&a==="onScroll"&&Qe("scroll",e):c!=null&&Cc(e,a,c,i))}switch(n){case"input":ia(e),Gd(e,r,!1);break;case"textarea":ia(e),qd(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Is(r.value));break;case"select":e.multiple=!!r.multiple,a=r.value,a!=null?Er(e,!!r.multiple,a,!1):r.defaultValue!=null&&Er(e,!!r.multiple,r.defaultValue,!0);break;default:typeof l.onClick=="function"&&(e.onclick=qa)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return Rt(t),null;case 6:if(e&&t.stateNode!=null)vp(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(J(166));if(n=Us(Ml.current),Us(_n.current),xa(t)){if(r=t.stateNode,n=t.memoizedProps,r[kn]=t,(a=r.nodeValue!==n)&&(e=Qt,e!==null))switch(e.tag){case 3:ha(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ha(r.nodeValue,n,(e.mode&1)!==0)}a&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[kn]=t,t.stateNode=r}return Rt(t),null;case 13:if(Ze(at),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(st&&Xt!==null&&t.mode&1&&!(t.flags&128))Ff(),Lr(),t.flags|=98560,a=!1;else if(a=xa(t),r!==null&&r.dehydrated!==null){if(e===null){if(!a)throw Error(J(318));if(a=t.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(J(317));a[kn]=t}else Lr(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;Rt(t),a=!1}else Nn!==null&&(yc(Nn),Nn=null),a=!0;if(!a)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||at.current&1?xt===0&&(xt=3):fd())),t.updateQueue!==null&&(t.flags|=4),Rt(t),null);case 4:return Or(),dc(e,t),e===null&&Ll(t.stateNode.containerInfo),Rt(t),null;case 10:return Xc(t.type._context),Rt(t),null;case 17:return Vt(t.type)&&Xa(),Rt(t),null;case 19:if(Ze(at),a=t.memoizedState,a===null)return Rt(t),null;if(r=(t.flags&128)!==0,i=a.rendering,i===null)if(r)al(a,!1);else{if(xt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=si(e),i!==null){for(t.flags|=128,al(a,!1),r=i.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)a=n,e=r,a.flags&=14680066,i=a.alternate,i===null?(a.childLanes=0,a.lanes=e,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,e=i.dependencies,a.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return qe(at,at.current&1|2),t.child}e=e.sibling}a.tail!==null&&ut()>Mr&&(t.flags|=128,r=!0,al(a,!1),t.lanes=4194304)}else{if(!r)if(e=si(i),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),al(a,!0),a.tail===null&&a.tailMode==="hidden"&&!i.alternate&&!st)return Rt(t),null}else 2*ut()-a.renderingStartTime>Mr&&n!==1073741824&&(t.flags|=128,r=!0,al(a,!1),t.lanes=4194304);a.isBackwards?(i.sibling=t.child,t.child=i):(n=a.last,n!==null?n.sibling=i:t.child=i,a.last=i)}return a.tail!==null?(t=a.tail,a.rendering=t,a.tail=t.sibling,a.renderingStartTime=ut(),t.sibling=null,n=at.current,qe(at,r?n&1|2:n&1),t):(Rt(t),null);case 22:case 23:return md(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Kt&1073741824&&(Rt(t),t.subtreeFlags&6&&(t.flags|=8192)):Rt(t),null;case 24:return null;case 25:return null}throw Error(J(156,t.tag))}function A0(e,t){switch(Yc(t),t.tag){case 1:return Vt(t.type)&&Xa(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Or(),Ze(Wt),Ze(Lt),td(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return ed(t),null;case 13:if(Ze(at),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(J(340));Lr()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Ze(at),null;case 4:return Or(),null;case 10:return Xc(t.type._context),null;case 22:case 23:return md(),null;case 24:return null;default:return null}}var Na=!1,Ct=!1,k0=typeof WeakSet=="function"?WeakSet:Set,oe=null;function Sr(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){dt(e,t,r)}else n.current=null}function uc(e,t,n){try{n()}catch(r){dt(e,t,r)}}var Fu=!1;function R0(e,t){if(Ko=Ya,e=Ef(),Wc(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var l=r.anchorOffset,a=r.focusNode;r=r.focusOffset;try{n.nodeType,a.nodeType}catch{n=null;break e}var i=0,o=-1,c=-1,u=0,f=0,p=e,g=null;t:for(;;){for(var S;p!==n||l!==0&&p.nodeType!==3||(o=i+l),p!==a||r!==0&&p.nodeType!==3||(c=i+r),p.nodeType===3&&(i+=p.nodeValue.length),(S=p.firstChild)!==null;)g=p,p=S;for(;;){if(p===e)break t;if(g===n&&++u===l&&(o=i),g===a&&++f===r&&(c=i),(S=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=S}n=o===-1||c===-1?null:{start:o,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(qo={focusedElem:e,selectionRange:n},Ya=!1,oe=t;oe!==null;)if(t=oe,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,oe=e;else for(;oe!==null;){t=oe;try{var A=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(A!==null){var E=A.memoizedProps,P=A.memoizedState,x=t.stateNode,h=x.getSnapshotBeforeUpdate(t.elementType===t.type?E:gn(t.type,E),P);x.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(J(163))}}catch(M){dt(t,t.return,M)}if(e=t.sibling,e!==null){e.return=t.return,oe=e;break}oe=t.return}return A=Fu,Fu=!1,A}function wl(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var l=r=r.next;do{if((l.tag&e)===e){var a=l.destroy;l.destroy=void 0,a!==void 0&&uc(t,n,a)}l=l.next}while(l!==r)}}function Ri(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function mc(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function bp(e){var t=e.alternate;t!==null&&(e.alternate=null,bp(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[kn],delete t[Ol],delete t[Jo],delete t[m0],delete t[f0])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function wp(e){return e.tag===5||e.tag===3||e.tag===4}function Bu(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||wp(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function fc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=qa));else if(r!==4&&(e=e.child,e!==null))for(fc(e,t,n),e=e.sibling;e!==null;)fc(e,t,n),e=e.sibling}function pc(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(pc(e,t,n),e=e.sibling;e!==null;)pc(e,t,n),e=e.sibling}var St=null,yn=!1;function as(e,t,n){for(n=n.child;n!==null;)Sp(e,t,n),n=n.sibling}function Sp(e,t,n){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(wi,n)}catch{}switch(n.tag){case 5:Ct||Sr(n,t);case 6:var r=St,l=yn;St=null,as(e,t,n),St=r,yn=l,St!==null&&(yn?(e=St,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):St.removeChild(n.stateNode));break;case 18:St!==null&&(yn?(e=St,n=n.stateNode,e.nodeType===8?no(e.parentNode,n):e.nodeType===1&&no(e,n),Rl(e)):no(St,n.stateNode));break;case 4:r=St,l=yn,St=n.stateNode.containerInfo,yn=!0,as(e,t,n),St=r,yn=l;break;case 0:case 11:case 14:case 15:if(!Ct&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){l=r=r.next;do{var a=l,i=a.destroy;a=a.tag,i!==void 0&&(a&2||a&4)&&uc(n,t,i),l=l.next}while(l!==r)}as(e,t,n);break;case 1:if(!Ct&&(Sr(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){dt(n,t,o)}as(e,t,n);break;case 21:as(e,t,n);break;case 22:n.mode&1?(Ct=(r=Ct)||n.memoizedState!==null,as(e,t,n),Ct=r):as(e,t,n);break;default:as(e,t,n)}}function $u(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new k0),t.forEach(function(r){var l=B0.bind(null,e,r);n.has(r)||(n.add(r),r.then(l,l))})}}function xn(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var l=n[r];try{var a=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:St=o.stateNode,yn=!1;break e;case 3:St=o.stateNode.containerInfo,yn=!0;break e;case 4:St=o.stateNode.containerInfo,yn=!0;break e}o=o.return}if(St===null)throw Error(J(160));Sp(a,i,l),St=null,yn=!1;var c=l.alternate;c!==null&&(c.return=null),l.return=null}catch(u){dt(l,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)jp(t,e),t=t.sibling}function jp(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(xn(t,e),In(e),r&4){try{wl(3,e,e.return),Ri(3,e)}catch(E){dt(e,e.return,E)}try{wl(5,e,e.return)}catch(E){dt(e,e.return,E)}}break;case 1:xn(t,e),In(e),r&512&&n!==null&&Sr(n,n.return);break;case 5:if(xn(t,e),In(e),r&512&&n!==null&&Sr(n,n.return),e.flags&32){var l=e.stateNode;try{Il(l,"")}catch(E){dt(e,e.return,E)}}if(r&4&&(l=e.stateNode,l!=null)){var a=e.memoizedProps,i=n!==null?n.memoizedProps:a,o=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{o==="input"&&a.type==="radio"&&a.name!=null&&Vm(l,a),Fo(o,i);var u=Fo(o,a);for(i=0;i<c.length;i+=2){var f=c[i],p=c[i+1];f==="style"?Xm(l,p):f==="dangerouslySetInnerHTML"?Km(l,p):f==="children"?Il(l,p):Cc(l,f,p,u)}switch(o){case"input":Lo(l,a);break;case"textarea":Ym(l,a);break;case"select":var g=l._wrapperState.wasMultiple;l._wrapperState.wasMultiple=!!a.multiple;var S=a.value;S!=null?Er(l,!!a.multiple,S,!1):g!==!!a.multiple&&(a.defaultValue!=null?Er(l,!!a.multiple,a.defaultValue,!0):Er(l,!!a.multiple,a.multiple?[]:"",!1))}l[Ol]=a}catch(E){dt(e,e.return,E)}}break;case 6:if(xn(t,e),In(e),r&4){if(e.stateNode===null)throw Error(J(162));l=e.stateNode,a=e.memoizedProps;try{l.nodeValue=a}catch(E){dt(e,e.return,E)}}break;case 3:if(xn(t,e),In(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Rl(t.containerInfo)}catch(E){dt(e,e.return,E)}break;case 4:xn(t,e),In(e);break;case 13:xn(t,e),In(e),l=e.child,l.flags&8192&&(a=l.memoizedState!==null,l.stateNode.isHidden=a,!a||l.alternate!==null&&l.alternate.memoizedState!==null||(dd=ut())),r&4&&$u(e);break;case 22:if(f=n!==null&&n.memoizedState!==null,e.mode&1?(Ct=(u=Ct)||f,xn(t,e),Ct=u):xn(t,e),In(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!f&&e.mode&1)for(oe=e,f=e.child;f!==null;){for(p=oe=f;oe!==null;){switch(g=oe,S=g.child,g.tag){case 0:case 11:case 14:case 15:wl(4,g,g.return);break;case 1:Sr(g,g.return);var A=g.stateNode;if(typeof A.componentWillUnmount=="function"){r=g,n=g.return;try{t=r,A.props=t.memoizedProps,A.state=t.memoizedState,A.componentWillUnmount()}catch(E){dt(r,n,E)}}break;case 5:Sr(g,g.return);break;case 22:if(g.memoizedState!==null){Hu(p);continue}}S!==null?(S.return=g,oe=S):Hu(p)}f=f.sibling}e:for(f=null,p=e;;){if(p.tag===5){if(f===null){f=p;try{l=p.stateNode,u?(a=l.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"):(o=p.stateNode,c=p.memoizedProps.style,i=c!=null&&c.hasOwnProperty("display")?c.display:null,o.style.display=qm("display",i))}catch(E){dt(e,e.return,E)}}}else if(p.tag===6){if(f===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(E){dt(e,e.return,E)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;f===p&&(f=null),p=p.return}f===p&&(f=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:xn(t,e),In(e),r&4&&$u(e);break;case 21:break;default:xn(t,e),In(e)}}function In(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(wp(n)){var r=n;break e}n=n.return}throw Error(J(160))}switch(r.tag){case 5:var l=r.stateNode;r.flags&32&&(Il(l,""),r.flags&=-33);var a=Bu(e);pc(e,a,l);break;case 3:case 4:var i=r.stateNode.containerInfo,o=Bu(e);fc(e,o,i);break;default:throw Error(J(161))}}catch(c){dt(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function C0(e,t,n){oe=e,Ep(e)}function Ep(e,t,n){for(var r=(e.mode&1)!==0;oe!==null;){var l=oe,a=l.child;if(l.tag===22&&r){var i=l.memoizedState!==null||Na;if(!i){var o=l.alternate,c=o!==null&&o.memoizedState!==null||Ct;o=Na;var u=Ct;if(Na=i,(Ct=c)&&!u)for(oe=l;oe!==null;)i=oe,c=i.child,i.tag===22&&i.memoizedState!==null?zu(l):c!==null?(c.return=i,oe=c):zu(l);for(;a!==null;)oe=a,Ep(a),a=a.sibling;oe=l,Na=o,Ct=u}Uu(e)}else l.subtreeFlags&8772&&a!==null?(a.return=l,oe=a):Uu(e)}}function Uu(e){for(;oe!==null;){var t=oe;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:Ct||Ri(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!Ct)if(n===null)r.componentDidMount();else{var l=t.elementType===t.type?n.memoizedProps:gn(t.type,n.memoizedProps);r.componentDidUpdate(l,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var a=t.updateQueue;a!==null&&Eu(t,a,r);break;case 3:var i=t.updateQueue;if(i!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}Eu(t,i,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var f=u.memoizedState;if(f!==null){var p=f.dehydrated;p!==null&&Rl(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(J(163))}Ct||t.flags&512&&mc(t)}catch(g){dt(t,t.return,g)}}if(t===e){oe=null;break}if(n=t.sibling,n!==null){n.return=t.return,oe=n;break}oe=t.return}}function Hu(e){for(;oe!==null;){var t=oe;if(t===e){oe=null;break}var n=t.sibling;if(n!==null){n.return=t.return,oe=n;break}oe=t.return}}function zu(e){for(;oe!==null;){var t=oe;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ri(4,t)}catch(c){dt(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var l=t.return;try{r.componentDidMount()}catch(c){dt(t,l,c)}}var a=t.return;try{mc(t)}catch(c){dt(t,a,c)}break;case 5:var i=t.return;try{mc(t)}catch(c){dt(t,i,c)}}}catch(c){dt(t,t.return,c)}if(t===e){oe=null;break}var o=t.sibling;if(o!==null){o.return=t.return,oe=o;break}oe=t.return}}var D0=Math.ceil,ai=Jn.ReactCurrentDispatcher,od=Jn.ReactCurrentOwner,cn=Jn.ReactCurrentBatchConfig,$e=0,bt=null,ft=null,It=0,Kt=0,jr=ks(0),xt=0,Ul=null,Ks=0,Ci=0,cd=0,Sl=null,Ht=null,dd=0,Mr=1/0,Fn=null,ii=!1,hc=null,ws=null,va=!1,hs=null,oi=0,jl=0,xc=null,Pa=-1,Ma=0;function Pt(){return $e&6?ut():Pa!==-1?Pa:Pa=ut()}function Ss(e){return e.mode&1?$e&2&&It!==0?It&-It:h0.transition!==null?(Ma===0&&(Ma=cf()),Ma):(e=Ve,e!==0||(e=window.event,e=e===void 0?16:xf(e.type)),e):1}function bn(e,t,n,r){if(50<jl)throw jl=0,xc=null,Error(J(185));Jl(e,n,r),(!($e&2)||e!==bt)&&(e===bt&&(!($e&2)&&(Ci|=n),xt===4&&ms(e,It)),Yt(e,r),n===1&&$e===0&&!(t.mode&1)&&(Mr=ut()+500,Ti&&Rs()))}function Yt(e,t){var n=e.callbackNode;hx(e,t);var r=Va(e,e===bt?It:0);if(r===0)n!==null&&Jd(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Jd(n),t===1)e.tag===0?p0(Wu.bind(null,e)):Of(Wu.bind(null,e)),d0(function(){!($e&6)&&Rs()}),n=null;else{switch(df(r)){case 1:n=Pc;break;case 4:n=af;break;case 16:n=Wa;break;case 536870912:n=of;break;default:n=Wa}n=Lp(n,Ip.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function Ip(e,t){if(Pa=-1,Ma=0,$e&6)throw Error(J(327));var n=e.callbackNode;if(Rr()&&e.callbackNode!==n)return null;var r=Va(e,e===bt?It:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=ci(e,r);else{t=r;var l=$e;$e|=2;var a=Ap();(bt!==e||It!==t)&&(Fn=null,Mr=ut()+500,Hs(e,t));do try{O0();break}catch(o){Tp(e,o)}while(!0);qc(),ai.current=a,$e=l,ft!==null?t=0:(bt=null,It=0,t=xt)}if(t!==0){if(t===2&&(l=zo(e),l!==0&&(r=l,t=gc(e,l))),t===1)throw n=Ul,Hs(e,0),ms(e,r),Yt(e,ut()),n;if(t===6)ms(e,r);else{if(l=e.current.alternate,!(r&30)&&!L0(l)&&(t=ci(e,r),t===2&&(a=zo(e),a!==0&&(r=a,t=gc(e,a))),t===1))throw n=Ul,Hs(e,0),ms(e,r),Yt(e,ut()),n;switch(e.finishedWork=l,e.finishedLanes=r,t){case 0:case 1:throw Error(J(345));case 2:Ps(e,Ht,Fn);break;case 3:if(ms(e,r),(r&130023424)===r&&(t=dd+500-ut(),10<t)){if(Va(e,0)!==0)break;if(l=e.suspendedLanes,(l&r)!==r){Pt(),e.pingedLanes|=e.suspendedLanes&l;break}e.timeoutHandle=Qo(Ps.bind(null,e,Ht,Fn),t);break}Ps(e,Ht,Fn);break;case 4:if(ms(e,r),(r&4194240)===r)break;for(t=e.eventTimes,l=-1;0<r;){var i=31-vn(r);a=1<<i,i=t[i],i>l&&(l=i),r&=~a}if(r=l,r=ut()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*D0(r/1960))-r,10<r){e.timeoutHandle=Qo(Ps.bind(null,e,Ht,Fn),r);break}Ps(e,Ht,Fn);break;case 5:Ps(e,Ht,Fn);break;default:throw Error(J(329))}}}return Yt(e,ut()),e.callbackNode===n?Ip.bind(null,e):null}function gc(e,t){var n=Sl;return e.current.memoizedState.isDehydrated&&(Hs(e,t).flags|=256),e=ci(e,t),e!==2&&(t=Ht,Ht=n,t!==null&&yc(t)),e}function yc(e){Ht===null?Ht=e:Ht.push.apply(Ht,e)}function L0(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var l=n[r],a=l.getSnapshot;l=l.value;try{if(!Sn(a(),l))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ms(e,t){for(t&=~cd,t&=~Ci,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-vn(t),r=1<<n;e[n]=-1,t&=~r}}function Wu(e){if($e&6)throw Error(J(327));Rr();var t=Va(e,0);if(!(t&1))return Yt(e,ut()),null;var n=ci(e,t);if(e.tag!==0&&n===2){var r=zo(e);r!==0&&(t=r,n=gc(e,r))}if(n===1)throw n=Ul,Hs(e,0),ms(e,t),Yt(e,ut()),n;if(n===6)throw Error(J(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ps(e,Ht,Fn),Yt(e,ut()),null}function ud(e,t){var n=$e;$e|=1;try{return e(t)}finally{$e=n,$e===0&&(Mr=ut()+500,Ti&&Rs())}}function qs(e){hs!==null&&hs.tag===0&&!($e&6)&&Rr();var t=$e;$e|=1;var n=cn.transition,r=Ve;try{if(cn.transition=null,Ve=1,e)return e()}finally{Ve=r,cn.transition=n,$e=t,!($e&6)&&Rs()}}function md(){Kt=jr.current,Ze(jr)}function Hs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,c0(n)),ft!==null)for(n=ft.return;n!==null;){var r=n;switch(Yc(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Xa();break;case 3:Or(),Ze(Wt),Ze(Lt),td();break;case 5:ed(r);break;case 4:Or();break;case 13:Ze(at);break;case 19:Ze(at);break;case 10:Xc(r.type._context);break;case 22:case 23:md()}n=n.return}if(bt=e,ft=e=js(e.current,null),It=Kt=t,xt=0,Ul=null,cd=Ci=Ks=0,Ht=Sl=null,$s!==null){for(t=0;t<$s.length;t++)if(n=$s[t],r=n.interleaved,r!==null){n.interleaved=null;var l=r.next,a=n.pending;if(a!==null){var i=a.next;a.next=l,r.next=i}n.pending=r}$s=null}return e}function Tp(e,t){do{var n=ft;try{if(qc(),La.current=li,ri){for(var r=it.memoizedState;r!==null;){var l=r.queue;l!==null&&(l.pending=null),r=r.next}ri=!1}if(Gs=0,vt=ht=it=null,bl=!1,Fl=0,od.current=null,n===null||n.return===null){xt=1,Ul=t,ft=null;break}e:{var a=e,i=n.return,o=n,c=t;if(t=It,o.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,f=o,p=f.tag;if(!(f.mode&1)&&(p===0||p===11||p===15)){var g=f.alternate;g?(f.updateQueue=g.updateQueue,f.memoizedState=g.memoizedState,f.lanes=g.lanes):(f.updateQueue=null,f.memoizedState=null)}var S=Cu(i);if(S!==null){S.flags&=-257,Du(S,i,o,a,t),S.mode&1&&Ru(a,u,t),t=S,c=u;var A=t.updateQueue;if(A===null){var E=new Set;E.add(c),t.updateQueue=E}else A.add(c);break e}else{if(!(t&1)){Ru(a,u,t),fd();break e}c=Error(J(426))}}else if(st&&o.mode&1){var P=Cu(i);if(P!==null){!(P.flags&65536)&&(P.flags|=256),Du(P,i,o,a,t),Gc(Pr(c,o));break e}}a=c=Pr(c,o),xt!==4&&(xt=2),Sl===null?Sl=[a]:Sl.push(a),a=i;do{switch(a.tag){case 3:a.flags|=65536,t&=-t,a.lanes|=t;var x=dp(a,c,t);ju(a,x);break e;case 1:o=c;var h=a.type,b=a.stateNode;if(!(a.flags&128)&&(typeof h.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ws===null||!ws.has(b)))){a.flags|=65536,t&=-t,a.lanes|=t;var M=up(a,o,t);ju(a,M);break e}}a=a.return}while(a!==null)}Rp(n)}catch(U){t=U,ft===n&&n!==null&&(ft=n=n.return);continue}break}while(!0)}function Ap(){var e=ai.current;return ai.current=li,e===null?li:e}function fd(){(xt===0||xt===3||xt===2)&&(xt=4),bt===null||!(Ks&268435455)&&!(Ci&268435455)||ms(bt,It)}function ci(e,t){var n=$e;$e|=2;var r=Ap();(bt!==e||It!==t)&&(Fn=null,Hs(e,t));do try{_0();break}catch(l){Tp(e,l)}while(!0);if(qc(),$e=n,ai.current=r,ft!==null)throw Error(J(261));return bt=null,It=0,xt}function _0(){for(;ft!==null;)kp(ft)}function O0(){for(;ft!==null&&!ax();)kp(ft)}function kp(e){var t=Dp(e.alternate,e,Kt);e.memoizedProps=e.pendingProps,t===null?Rp(e):ft=t,od.current=null}function Rp(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=A0(n,t),n!==null){n.flags&=32767,ft=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{xt=6,ft=null;return}}else if(n=T0(n,t,Kt),n!==null){ft=n;return}if(t=t.sibling,t!==null){ft=t;return}ft=t=e}while(t!==null);xt===0&&(xt=5)}function Ps(e,t,n){var r=Ve,l=cn.transition;try{cn.transition=null,Ve=1,P0(e,t,n,r)}finally{cn.transition=l,Ve=r}return null}function P0(e,t,n,r){do Rr();while(hs!==null);if($e&6)throw Error(J(327));n=e.finishedWork;var l=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(J(177));e.callbackNode=null,e.callbackPriority=0;var a=n.lanes|n.childLanes;if(xx(e,a),e===bt&&(ft=bt=null,It=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||va||(va=!0,Lp(Wa,function(){return Rr(),null})),a=(n.flags&15990)!==0,n.subtreeFlags&15990||a){a=cn.transition,cn.transition=null;var i=Ve;Ve=1;var o=$e;$e|=4,od.current=null,R0(e,n),jp(n,e),n0(qo),Ya=!!Ko,qo=Ko=null,e.current=n,C0(n),ix(),$e=o,Ve=i,cn.transition=a}else e.current=n;if(va&&(va=!1,hs=e,oi=l),a=e.pendingLanes,a===0&&(ws=null),dx(n.stateNode),Yt(e,ut()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)l=t[n],r(l.value,{componentStack:l.stack,digest:l.digest});if(ii)throw ii=!1,e=hc,hc=null,e;return oi&1&&e.tag!==0&&Rr(),a=e.pendingLanes,a&1?e===xc?jl++:(jl=0,xc=e):jl=0,Rs(),null}function Rr(){if(hs!==null){var e=df(oi),t=cn.transition,n=Ve;try{if(cn.transition=null,Ve=16>e?16:e,hs===null)var r=!1;else{if(e=hs,hs=null,oi=0,$e&6)throw Error(J(331));var l=$e;for($e|=4,oe=e.current;oe!==null;){var a=oe,i=a.child;if(oe.flags&16){var o=a.deletions;if(o!==null){for(var c=0;c<o.length;c++){var u=o[c];for(oe=u;oe!==null;){var f=oe;switch(f.tag){case 0:case 11:case 15:wl(8,f,a)}var p=f.child;if(p!==null)p.return=f,oe=p;else for(;oe!==null;){f=oe;var g=f.sibling,S=f.return;if(bp(f),f===u){oe=null;break}if(g!==null){g.return=S,oe=g;break}oe=S}}}var A=a.alternate;if(A!==null){var E=A.child;if(E!==null){A.child=null;do{var P=E.sibling;E.sibling=null,E=P}while(E!==null)}}oe=a}}if(a.subtreeFlags&2064&&i!==null)i.return=a,oe=i;else e:for(;oe!==null;){if(a=oe,a.flags&2048)switch(a.tag){case 0:case 11:case 15:wl(9,a,a.return)}var x=a.sibling;if(x!==null){x.return=a.return,oe=x;break e}oe=a.return}}var h=e.current;for(oe=h;oe!==null;){i=oe;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,oe=b;else e:for(i=h;oe!==null;){if(o=oe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Ri(9,o)}}catch(U){dt(o,o.return,U)}if(o===i){oe=null;break e}var M=o.sibling;if(M!==null){M.return=o.return,oe=M;break e}oe=o.return}}if($e=l,Rs(),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(wi,e)}catch{}r=!0}return r}finally{Ve=n,cn.transition=t}}return!1}function Vu(e,t,n){t=Pr(n,t),t=dp(e,t,1),e=bs(e,t,1),t=Pt(),e!==null&&(Jl(e,1,t),Yt(e,t))}function dt(e,t,n){if(e.tag===3)Vu(e,e,n);else for(;t!==null;){if(t.tag===3){Vu(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ws===null||!ws.has(r))){e=Pr(n,e),e=up(t,e,1),t=bs(t,e,1),e=Pt(),t!==null&&(Jl(t,1,e),Yt(t,e));break}}t=t.return}}function M0(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Pt(),e.pingedLanes|=e.suspendedLanes&n,bt===e&&(It&n)===n&&(xt===4||xt===3&&(It&130023424)===It&&500>ut()-dd?Hs(e,0):cd|=n),Yt(e,t)}function Cp(e,t){t===0&&(e.mode&1?(t=da,da<<=1,!(da&130023424)&&(da=4194304)):t=1);var n=Pt();e=qn(e,t),e!==null&&(Jl(e,t,n),Yt(e,n))}function F0(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),Cp(e,n)}function B0(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,l=e.memoizedState;l!==null&&(n=l.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(J(314))}r!==null&&r.delete(t),Cp(e,n)}var Dp;Dp=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Wt.current)zt=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return zt=!1,I0(e,t,n);zt=!!(e.flags&131072)}else zt=!1,st&&t.flags&1048576&&Pf(t,Za,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Oa(e,t),e=t.pendingProps;var l=Dr(t,Lt.current);kr(t,n),l=sd(null,t,r,e,l,n);var a=rd();return t.flags|=1,typeof l=="object"&&l!==null&&typeof l.render=="function"&&l.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Vt(r)?(a=!0,Qa(t)):a=!1,t.memoizedState=l.state!==null&&l.state!==void 0?l.state:null,Jc(t),l.updater=ki,t.stateNode=l,l._reactInternals=t,rc(t,r,e,n),t=ic(null,t,r,!0,a,n)):(t.tag=0,st&&a&&Vc(t),Ot(null,t,l,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Oa(e,t),e=t.pendingProps,l=r._init,r=l(r._payload),t.type=r,l=t.tag=U0(r),e=gn(r,e),l){case 0:t=ac(null,t,r,e,n);break e;case 1:t=Ou(null,t,r,e,n);break e;case 11:t=Lu(null,t,r,e,n);break e;case 14:t=_u(null,t,r,gn(r.type,e),n);break e}throw Error(J(306,r,""))}return t;case 0:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:gn(r,l),ac(e,t,r,l,n);case 1:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:gn(r,l),Ou(e,t,r,l,n);case 3:e:{if(hp(t),e===null)throw Error(J(387));r=t.pendingProps,a=t.memoizedState,l=a.element,Hf(e,t),ni(t,r,null,n);var i=t.memoizedState;if(r=i.element,a.isDehydrated)if(a={element:r,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=a,t.memoizedState=a,t.flags&256){l=Pr(Error(J(423)),t),t=Pu(e,t,r,n,l);break e}else if(r!==l){l=Pr(Error(J(424)),t),t=Pu(e,t,r,n,l);break e}else for(Xt=vs(t.stateNode.containerInfo.firstChild),Qt=t,st=!0,Nn=null,n=$f(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Lr(),r===l){t=Xn(e,t,n);break e}Ot(e,t,r,n)}t=t.child}return t;case 5:return zf(t),e===null&&tc(t),r=t.type,l=t.pendingProps,a=e!==null?e.memoizedProps:null,i=l.children,Xo(r,l)?i=null:a!==null&&Xo(r,a)&&(t.flags|=32),pp(e,t),Ot(e,t,i,n),t.child;case 6:return e===null&&tc(t),null;case 13:return xp(e,t,n);case 4:return Zc(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=_r(t,null,r,n):Ot(e,t,r,n),t.child;case 11:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:gn(r,l),Lu(e,t,r,l,n);case 7:return Ot(e,t,t.pendingProps,n),t.child;case 8:return Ot(e,t,t.pendingProps.children,n),t.child;case 12:return Ot(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,l=t.pendingProps,a=t.memoizedProps,i=l.value,qe(ei,r._currentValue),r._currentValue=i,a!==null)if(Sn(a.value,i)){if(a.children===l.children&&!Wt.current){t=Xn(e,t,n);break e}}else for(a=t.child,a!==null&&(a.return=t);a!==null;){var o=a.dependencies;if(o!==null){i=a.child;for(var c=o.firstContext;c!==null;){if(c.context===r){if(a.tag===1){c=Vn(-1,n&-n),c.tag=2;var u=a.updateQueue;if(u!==null){u=u.shared;var f=u.pending;f===null?c.next=c:(c.next=f.next,f.next=c),u.pending=c}}a.lanes|=n,c=a.alternate,c!==null&&(c.lanes|=n),nc(a.return,n,t),o.lanes|=n;break}c=c.next}}else if(a.tag===10)i=a.type===t.type?null:a.child;else if(a.tag===18){if(i=a.return,i===null)throw Error(J(341));i.lanes|=n,o=i.alternate,o!==null&&(o.lanes|=n),nc(i,n,t),i=a.sibling}else i=a.child;if(i!==null)i.return=a;else for(i=a;i!==null;){if(i===t){i=null;break}if(a=i.sibling,a!==null){a.return=i.return,i=a;break}i=i.return}a=i}Ot(e,t,l.children,n),t=t.child}return t;case 9:return l=t.type,r=t.pendingProps.children,kr(t,n),l=dn(l),r=r(l),t.flags|=1,Ot(e,t,r,n),t.child;case 14:return r=t.type,l=gn(r,t.pendingProps),l=gn(r.type,l),_u(e,t,r,l,n);case 15:return mp(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,l=t.pendingProps,l=t.elementType===r?l:gn(r,l),Oa(e,t),t.tag=1,Vt(r)?(e=!0,Qa(t)):e=!1,kr(t,n),cp(t,r,l),rc(t,r,l,n),ic(null,t,r,!0,e,n);case 19:return gp(e,t,n);case 22:return fp(e,t,n)}throw Error(J(156,t.tag))};function Lp(e,t){return lf(e,t)}function $0(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function on(e,t,n,r){return new $0(e,t,n,r)}function pd(e){return e=e.prototype,!(!e||!e.isReactComponent)}function U0(e){if(typeof e=="function")return pd(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Lc)return 11;if(e===_c)return 14}return 2}function js(e,t){var n=e.alternate;return n===null?(n=on(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fa(e,t,n,r,l,a){var i=2;if(r=e,typeof e=="function")pd(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case pr:return zs(n.children,l,a,t);case Dc:i=8,l|=8;break;case Ao:return e=on(12,n,t,l|2),e.elementType=Ao,e.lanes=a,e;case ko:return e=on(13,n,t,l),e.elementType=ko,e.lanes=a,e;case Ro:return e=on(19,n,t,l),e.elementType=Ro,e.lanes=a,e;case Hm:return Di(n,l,a,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case $m:i=10;break e;case Um:i=9;break e;case Lc:i=11;break e;case _c:i=14;break e;case is:i=16,r=null;break e}throw Error(J(130,e==null?e:typeof e,""))}return t=on(i,n,t,l),t.elementType=e,t.type=r,t.lanes=a,t}function zs(e,t,n,r){return e=on(7,e,r,t),e.lanes=n,e}function Di(e,t,n,r){return e=on(22,e,r,t),e.elementType=Hm,e.lanes=n,e.stateNode={isHidden:!1},e}function uo(e,t,n){return e=on(6,e,null,t),e.lanes=n,e}function mo(e,t,n){return t=on(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function H0(e,t,n,r,l){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vi(0),this.expirationTimes=Vi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vi(0),this.identifierPrefix=r,this.onRecoverableError=l,this.mutableSourceEagerHydrationData=null}function hd(e,t,n,r,l,a,i,o,c){return e=new H0(e,t,n,o,c),t===1?(t=1,a===!0&&(t|=8)):t=0,a=on(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Jc(a),e}function z0(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:fr,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function _p(e){if(!e)return Ts;e=e._reactInternals;e:{if(Js(e)!==e||e.tag!==1)throw Error(J(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Vt(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(J(171))}if(e.tag===1){var n=e.type;if(Vt(n))return _f(e,n,t)}return t}function Op(e,t,n,r,l,a,i,o,c){return e=hd(n,r,!0,e,l,a,i,o,c),e.context=_p(null),n=e.current,r=Pt(),l=Ss(n),a=Vn(r,l),a.callback=t??null,bs(n,a,l),e.current.lanes=l,Jl(e,l,r),Yt(e,r),e}function Li(e,t,n,r){var l=t.current,a=Pt(),i=Ss(l);return n=_p(n),t.context===null?t.context=n:t.pendingContext=n,t=Vn(a,i),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=bs(l,t,i),e!==null&&(bn(e,l,i,a),Da(e,l,i)),i}function di(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Yu(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function xd(e,t){Yu(e,t),(e=e.alternate)&&Yu(e,t)}function W0(){return null}var Pp=typeof reportError=="function"?reportError:function(e){console.error(e)};function gd(e){this._internalRoot=e}_i.prototype.render=gd.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(J(409));Li(e,t,null,null)};_i.prototype.unmount=gd.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qs(function(){Li(null,e,null,null)}),t[Kn]=null}};function _i(e){this._internalRoot=e}_i.prototype.unstable_scheduleHydration=function(e){if(e){var t=ff();e={blockedOn:null,target:e,priority:t};for(var n=0;n<us.length&&t!==0&&t<us[n].priority;n++);us.splice(n,0,e),n===0&&hf(e)}};function yd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Oi(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Gu(){}function V0(e,t,n,r,l){if(l){if(typeof r=="function"){var a=r;r=function(){var u=di(i);a.call(u)}}var i=Op(t,r,e,0,null,!1,!1,"",Gu);return e._reactRootContainer=i,e[Kn]=i.current,Ll(e.nodeType===8?e.parentNode:e),qs(),i}for(;l=e.lastChild;)e.removeChild(l);if(typeof r=="function"){var o=r;r=function(){var u=di(c);o.call(u)}}var c=hd(e,0,!1,null,null,!1,!1,"",Gu);return e._reactRootContainer=c,e[Kn]=c.current,Ll(e.nodeType===8?e.parentNode:e),qs(function(){Li(t,c,n,r)}),c}function Pi(e,t,n,r,l){var a=n._reactRootContainer;if(a){var i=a;if(typeof l=="function"){var o=l;l=function(){var c=di(i);o.call(c)}}Li(t,i,e,l)}else i=V0(n,t,e,l,r);return di(i)}uf=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=fl(t.pendingLanes);n!==0&&(Mc(t,n|1),Yt(t,ut()),!($e&6)&&(Mr=ut()+500,Rs()))}break;case 13:qs(function(){var r=qn(e,1);if(r!==null){var l=Pt();bn(r,e,1,l)}}),xd(e,1)}};Fc=function(e){if(e.tag===13){var t=qn(e,134217728);if(t!==null){var n=Pt();bn(t,e,134217728,n)}xd(e,134217728)}};mf=function(e){if(e.tag===13){var t=Ss(e),n=qn(e,t);if(n!==null){var r=Pt();bn(n,e,t,r)}xd(e,t)}};ff=function(){return Ve};pf=function(e,t){var n=Ve;try{return Ve=e,t()}finally{Ve=n}};$o=function(e,t,n){switch(t){case"input":if(Lo(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var l=Ii(r);if(!l)throw Error(J(90));Wm(r),Lo(r,l)}}}break;case"textarea":Ym(e,n);break;case"select":t=n.value,t!=null&&Er(e,!!n.multiple,t,!1)}};Zm=ud;ef=qs;var Y0={usingClientEntryPoint:!1,Events:[ea,yr,Ii,Qm,Jm,ud]},il={findFiberByHostInstance:Bs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},G0={bundleType:il.bundleType,version:il.version,rendererPackageName:il.rendererPackageName,rendererConfig:il.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Jn.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=sf(e),e===null?null:e.stateNode},findFiberByHostInstance:il.findFiberByHostInstance||W0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ba=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ba.isDisabled&&ba.supportsFiber)try{wi=ba.inject(G0),Ln=ba}catch{}}Zt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Y0;Zt.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!yd(t))throw Error(J(200));return z0(e,t,null,n)};Zt.createRoot=function(e,t){if(!yd(e))throw Error(J(299));var n=!1,r="",l=Pp;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(l=t.onRecoverableError)),t=hd(e,1,!1,null,null,n,!1,r,l),e[Kn]=t.current,Ll(e.nodeType===8?e.parentNode:e),new gd(t)};Zt.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(J(188)):(e=Object.keys(e).join(","),Error(J(268,e)));return e=sf(t),e=e===null?null:e.stateNode,e};Zt.flushSync=function(e){return qs(e)};Zt.hydrate=function(e,t,n){if(!Oi(t))throw Error(J(200));return Pi(null,e,t,!0,n)};Zt.hydrateRoot=function(e,t,n){if(!yd(e))throw Error(J(405));var r=n!=null&&n.hydratedSources||null,l=!1,a="",i=Pp;if(n!=null&&(n.unstable_strictMode===!0&&(l=!0),n.identifierPrefix!==void 0&&(a=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),t=Op(t,null,e,1,n??null,l,!1,a,i),e[Kn]=t.current,Ll(e),r)for(e=0;e<r.length;e++)n=r[e],l=n._getVersion,l=l(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,l]:t.mutableSourceEagerHydrationData.push(n,l);return new _i(t)};Zt.render=function(e,t,n){if(!Oi(t))throw Error(J(200));return Pi(null,e,t,!1,n)};Zt.unmountComponentAtNode=function(e){if(!Oi(e))throw Error(J(40));return e._reactRootContainer?(qs(function(){Pi(null,null,e,!1,function(){e._reactRootContainer=null,e[Kn]=null})}),!0):!1};Zt.unstable_batchedUpdates=ud;Zt.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Oi(n))throw Error(J(200));if(e==null||e._reactInternals===void 0)throw Error(J(38));return Pi(e,t,n,!1,r)};Zt.version="18.3.1-next-f1338f8080-20240426";function Mp(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Mp)}catch(e){console.error(e)}}Mp(),Pm.exports=Zt;var K0=Pm.exports,Ku=K0;Io.createRoot=Ku.createRoot,Io.hydrateRoot=Ku.hydrateRoot;/**
 * @license
 * (c) Copyright 2023 Grammarly, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wa(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var qu=new Map;class Hl extends Error{constructor(t,n){super(),wa(this,"args",void 0),wa(this,"code",void 0),wa(this,"url",void 0),wa(this,"_c",void 0);var r=new URL("https://developer.grammarly.com/docs/error-explainer");r.searchParams.set("code",t.toString()),n.forEach(l=>r.searchParams.append("args",function(a){if(a instanceof Error)return a.message+`
`+String(a.stack);if(a==null)return"null";if(typeof a=="object")try{return Object.prototype.toString.call(a)}catch{}return String(a)}(l))),this.stack!=null&&r.searchParams.set("trace",this.stack),this.message="Minified error #".concat(t,": See ").concat(r.toString()," for details."),this.args=n,this.code=t,this.url=r.toString()}toUserMessage(){var t=qu.get("".concat(this.code));if(t==null)return[this];var n=new Map(this.args.map((l,a)=>["${".concat(a,"}"),l])),r=t.split(/(\${\d+})/).filter(l=>l!=="");return r.map(l=>{var a;return(a=n.get(l))!==null&&a!==void 0?a:l})}toJSON(){return{name:"InvariantError",message:this.message,description:this._m,code:this.code,args:this.args,stack:this.stack}}static setMessages(t){qu=t}static create(t,n,r,l){l!=null&&n.push(l);var a=new Hl(t,n,r);return a.stack=l==null?void 0:l.stack,a._m=r,a}}const Xu=new WeakMap;async function q0(e,t){const n=Xu.get(e);if(n!=null)return await n;(function(l){l.Grammarly==null&&(l.Grammarly={})})(e);const r=new Promise((l,a)=>{try{let o=function(c,u){return c.document.querySelectorAll(`script[src^="${u.replace(/\?.*$/,"")}"]`)[0]}(e,t);o!=null?i():(o=function(c,u){const f=c.document.createElement("script");return f.src=u,c.document.head.appendChild(f),f}(e,t),o.addEventListener("load",i),o.addEventListener("error",function(){try{throw new Hl(23,[])}catch(c){a(c)}}))}catch(o){return a(o)}function i(){try{if(e.Grammarly==null||typeof e.Grammarly.EditorSDK!="function")throw new Hl(22,[]);l(e.Grammarly)}catch(o){a(o)}}});return Xu.set(e,r),await r}async function Qu(e,t,n,r){if(typeof window>"u"&&r===void 0)throw new Hl(21,[]);const l=function(o){return o.location.origin!=="null"?o.location.origin:o.origin!=="null"?o.origin:"null"}(r??window);l==="null"&&(r??window).top!==(r??window)&&console.warn("Grammarly is not supported in IFrames with `null` origin. Consider adding `sandbox='allow-same-origin allow-scripts'` to <iframe> element.");const a=new URL("https://js.grammarly.com/grammarly-editor-sdk@2.5",l);t!=null&&a.searchParams.set("clientId",t),a.searchParams.set("packageName",e);const i=await q0(r??window,a.toString());if(t!=null)return new i.EditorSDK(t,n)}const fo={onBeforeSuggestionCardOpen:"before-suggestion-card-open",onSuggestionCardOpen:"suggestion-card-open",onSuggestionCardClose:"suggestion-card-close",onSuggestionCardAction:"suggestion-card-action",onPluginTurnedOff:"plugin-turned-off",onPluginError:"plugin-error",onDocumentStats:"document-stats",onSessionStats:"session-stats"};/**
 * @license
 * (c) Copyright 2023 Grammarly, Inc.
 * 
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * 
 *     http://www.apache.org/licenses/LICENSE-2.0
 * 
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X0=bi.createContext({});function Q0(e,t,n){const r=y.useCallback(l=>e==null?void 0:e(new CustomEvent("plugin-error",{detail:l})),[e]);y.useEffect(()=>{var l;typeof navigator<"u"&&(t!=null&&((l=n==null?void 0:n.current)===null||l===void 0?void 0:l.ownerDocument.defaultView)!=null&&window!==n.current.ownerDocument.defaultView?Qu("@grammarly/editor-sdk-react",t,void 0,n.current.ownerDocument.defaultView).catch(r):Qu("@grammarly/editor-sdk-react").catch(r))},n!=null&&t!=null?[n,t]:[])}function Ju(e){return typeof e=="function"}const zl=e=>{const[t,{clientId:n,config:r,children:l,className:a,...i}]=function(E){const P={},x={...E};return Object.keys(fo).forEach(h=>{P[h]=E[h],h in x&&delete x[h]}),[P,x]}(e),o=y.useContext(X0),c=y.useRef(),u=y.useRef(),f=y.useRef(),p=y.useCallback(E=>{c.current=E,S()},[]),g=function(E){const[P,x]=y.useState({}),h=y.useCallback(()=>{customElements.whenDefined(E).then(()=>x(b=>({...b,[E]:!0}))).catch(()=>{})},[E]);return y.useEffect(h,[h]),!!P[E]}("grammarly-editor-plugin"),S=y.useCallback(()=>{var E;c.current!=null&&u.current!=null&&g&&c.current.connect(u.current,(E=f.current)!==null&&E!==void 0?E:void 0)},[g]),A=y.useMemo(()=>({...o.config,...r}),[o.config,r]);return y.useEffect(()=>{c.current&&(c.current.config=A)},[c,A]),y.useEffect(()=>{if(c.current==null)return;const{current:E}=c,P=[];return Object.keys(fo).forEach(x=>{const h=t[x],b=fo[x];h!=null&&(E.addEventListener(b,h),P.push(()=>E.removeEventListener(b,h)))}),()=>P.forEach(x=>x())},[...Object.values(t),g,c.current]),Q0(e.onPluginError,n??o.clientId,c),bi.createElement("grammarly-editor-plugin",{...i,ref:p,clientId:n??o.clientId,autodetect:Ju(l)?"off":"on",class:a},Ju(l)?l({setEditor:E=>{u.current=E,S()},setViewport:E=>{f.current=E,S()}}):l)};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var J0={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z0=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),De=(e,t)=>{const n=y.forwardRef(({color:r="currentColor",size:l=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:o="",children:c,...u},f)=>y.createElement("svg",{ref:f,...J0,width:l,height:l,stroke:r,strokeWidth:i?Number(a)*24/Number(l):a,className:["lucide",`lucide-${Z0(e)}`,o].join(" "),...u},[...t.map(([p,g])=>y.createElement(p,g)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ui=De("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fp=De("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=De("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eg=De("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tg=De("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bp=De("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=De("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fi=De("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rn=De("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=De("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=De("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=De("FilePlus2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=De("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wl=De("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $p=De("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=De("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=De("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nc=De("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vd=De("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=De("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cg=De("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dg=De("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=De("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Up=De("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=De("NotebookPen",[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M18.4 2.6a2.17 2.17 0 0 1 3 3L16 11l-4 1 1-4Z",key:"1dba1m"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ug=De("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wd=De("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hp=De("Receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mg=De("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pi=De("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fg=De("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pg=De("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hg=De("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zp=De("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fs=De("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=De("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xg=De("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gg=De("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yg=De("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jt=De("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Wp=["The facts outlined in the statement of claim","Statement of Claim  Factual Summary"],xs="Factual background  Statement of Claim",Vp=["Factual Summary from the Letter of Demand"],na="Factual background  Letter of Demand",Sd="The plaintiff's expert opinion",jd="The claimant's expert opinion",Es=[{id:"u1",username:"lior",password:"lior123",name:"Lior Perry",email:"lior@lp-law.co.il",role:"ADMIN"},{id:"u2",username:"lidor",password:"lidor123",name:"Lidor Kabilo",email:"Lidor@lp-law.co.il",role:"SUB_ADMIN"},{id:"u3",username:"iris",password:"iris123",name:"Iris Alfman",email:"Iris@lp-law.co.il",role:"FINANCE"},{id:"u4",username:"hava",password:"hava123",name:"Hava Kabilo",email:"Hava@lp-law.co.il",role:"LAWYER"},{id:"u5",username:"may",password:"may123",name:"May Harari",email:"May@lp-law.co.il",role:"LAWYER"},{id:"u6",username:"vlada",password:"vlada123",name:"Vlada Boltach",email:"Vlada@lp-law.co.il",role:"LAWYER"},{id:"u7",username:"orly",password:"orly123",name:"Orly Day",email:"Orly@lp-law.co.il",role:"LAWYER"}],Zu=["W/R/B Underwriting","QBE Insurance Group","Market Form Underwriting","Dale Underwriting Partners","MedPro & CNA Syndicate","Hardy (Underwriting Agencies) Limited"],hl=[xs,na,Sd,jd,"The insured's expert opinion","Insurance Coverage","Risk Assessment","MPL","Strategy","Expenses breakdown","Expenses & Compensation breakdown","Recommendations","Strategy & Recommendations","Request for Approval of a Settlement Agreement"],Yp=["New lawsuit","Letter of demand","New third-party notice","Caution Notice"],Yl="/api/templates",Gl=async e=>{if(!e.ok){const n=await e.text().catch(()=>"");throw new Error(n||`Request failed with status ${e.status}`)}const t=await e.json();return Array.isArray(t)?t:[]},em=async()=>{const e=await fetch(Yl);return Gl(e)},tm=async(e,t)=>{const n={"Content-Type":"application/json","x-user-role":t};if(!e.id){const l=await fetch(Yl,{method:"POST",headers:n,body:JSON.stringify(e)});return Gl(l)}const r=await fetch(`${Yl}/${encodeURIComponent(e.id)}`,{method:"PUT",headers:n,body:JSON.stringify(e)});return Gl(r)},Ng=async(e,t)=>{const n=await fetch(`${Yl}/${encodeURIComponent(e)}`,{method:"DELETE",headers:{"x-user-role":t}});return Gl(n)},vg=async(e,t,n)=>{const r=await fetch(`${Yl}/${encodeURIComponent(e)}/reorder`,{method:"POST",headers:{"Content-Type":"application/json","x-user-role":n},body:JSON.stringify({direction:t})});return Gl(r)},bg=async e=>{if(!e||!e.trim())return"";try{const t=await fetch("/api/translate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!t.ok)throw new Error(`Server error: ${t.statusText}`);return(await t.json()).translation||""}catch(t){return console.error("Translation error:",t),"Error translation."}},wg=async(e,t)=>{try{const n=await fetch("/api/extract-policy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({image:e,mimeType:t})});if(!n.ok)throw new Error("Server error");return await n.json()}catch(n){return console.error(n),{}}},Sg=async e=>{try{const t=await fetch("/api/refine-text",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!t.ok)throw new Error("Refinement failed");return(await t.json()).refined||e}catch(t){return console.error(t),e}},jg=async(e,t,n="CLAIM",r)=>{try{const l=await fetch("/api/analyze-medical-complaint",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileBase64:e,mimeType:t,analysisType:n,expertCountMode:r==null?void 0:r.expertCountMode,partyRole:r==null?void 0:r.partyRole,sectionKey:r==null?void 0:r.sectionKey,plaintiffName:r==null?void 0:r.plaintiffName,insuredName:r==null?void 0:r.insuredName,insurerName:r==null?void 0:r.insurerName,reportSubject:r==null?void 0:r.reportSubject})});if(!l.ok)throw new Error("Medical analysis failed");return await l.json()}catch(l){throw console.error("Medical complaint analysis error:",l),l}},Eg=async(e,t)=>{try{const n=await fetch("/api/extract-expenses",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fileBase64:e,mimeType:t})});if(!n.ok)throw new Error("Expenses extraction failed");return await n.json()}catch(n){return console.error(n),{items:[]}}},Ig=async e=>{try{const t=await fetch("/api/help-chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question:e})});if(!t.ok)throw new Error("Chat failed");return(await t.json()).answer||"Sorry, I could not answer that."}catch(t){return console.error(t),"System error. Please try again."}},nm=async e=>{try{if(!(await fetch("/api/send-email",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).ok)throw new Error("Email failed");return!0}catch(t){return console.error(t),!1}},po=async e=>{try{const t=await fetch("/api/render-report-pdf",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report:e})});if(!t.ok)throw new Error("PDF rendering failed");return await t.blob()}catch(t){throw console.error("PDF render error:",t),t}};async function Tg(e){try{const t=await fetch("/api/analyze-tone-risk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e})});if(!t.ok)throw new Error("Tone & Risk analysis failed");const n=await t.json(),r=Array.isArray(n.issues)?n.issues:[];return{runAt:typeof n.runAt=="string"?n.runAt:new Date().toISOString(),issues:r}}catch(t){return console.error("Tone & Risk analysis error:",t),{runAt:new Date().toISOString(),issues:[]}}}async function Ag(e,t){try{const n=await fetch("/api/review-hebrew-style",{method:"POST",headers:{"Content-Type":"application/json",...t?{"x-user-role":t}:{}},body:JSON.stringify({content:e})});if(!n.ok)throw new Error("Hebrew style review failed");const r=await n.json(),l=Array.isArray(r.issues)?r.issues:[];return{runAt:typeof r.runAt=="string"?r.runAt:new Date().toISOString(),issues:l}}catch(n){return console.error("Hebrew style review error:",n),{runAt:new Date().toISOString(),issues:[]}}}const Fr="/api/best-practices",Br=async e=>{if(!e.ok){const n=await e.text().catch(()=>"");throw new Error(n||`Request failed with status ${e.status}`)}const t=await e.json();return Array.isArray(t)?t:[]},kg=async()=>{const e=await fetch(Fr);return Br(e)},sm=async(e,t)=>{const n={"Content-Type":"application/json","x-user-role":t};if(!e.id){const l=await fetch(Fr,{method:"POST",headers:n,body:JSON.stringify(e)});return Br(l)}const r=await fetch(`${Fr}/${encodeURIComponent(e.id)}`,{method:"PUT",headers:n,body:JSON.stringify(e)});return Br(r)},Rg=async(e,t)=>{const n=await fetch(`${Fr}/${encodeURIComponent(e)}`,{method:"DELETE",headers:{"x-user-role":t}});return Br(n)},Cg=async(e,t,n)=>{const r=await fetch(`${Fr}/${encodeURIComponent(e)}`,{method:"PUT",headers:{"Content-Type":"application/json","x-user-role":n},body:JSON.stringify({isEnabled:t})});return Br(r)},rm=async(e,t,n)=>{const r=await fetch(`${Fr}/${encodeURIComponent(e)}/usage`,{method:"POST",headers:{"Content-Type":"application/json","x-user-role":n},body:JSON.stringify({mode:t})});return Br(r)},Ed=e=>e===Sd,Id=e=>e===jd,lm=e=>Ed(e)||Id(e),Dg=e=>Ed(e)||e===xs?"PLAINTIFF":Id(e)||e===na?"CLAIMANT":null,am=(e,t="SINGLE")=>`${t==="MULTIPLE"?"Expert opinions":"Expert opinion"}  ${e==="PLAINTIFF"?"Statement of Claim":"Letter of Demand"}`,Lg=(e,t)=>Ed(e)?am("PLAINTIFF",t):Id(e)?am("CLAIMANT",t):e,_g=({data:e})=>{const[t,n]=y.useState(""),[r,l]=y.useState(!1),[a,i]=y.useState(null);if(y.useEffect(()=>{let c=!1;return(async()=>{l(!0),i(null);try{const f=await fetch("/api/render-report-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({report:e})});if(!f.ok)throw new Error("Failed to load report HTML");const p=await f.text();c||n(p)}catch(f){console.error(f),c||i("   ")}finally{c||l(!1)}})(),()=>{c=!0}},[e]),a)return s.jsx("div",{className:"w-[210mm] min-h-[297mm] bg-white shadow-2xl mx-auto flex items-center justify-center text-sm text-red-600",children:a});if(r&&!t)return s.jsx("div",{className:"w-[210mm] min-h-[297mm] bg-white shadow-2xl mx-auto flex flex-col items-center justify-center text-sm text-gray-500",children:s.jsx("span",{children:"  ..."})});const o=!!e.policyFile&&(e.attachPolicyAsAppendix??!0);return s.jsxs("div",{className:"space-y-2",children:[s.jsx("iframe",{title:"Report Preview",className:"w-[210mm] min-h-[297mm] bg-white shadow-2xl mx-auto border-none print:shadow-none print:w-full",srcDoc:t}),o&&s.jsx("p",{className:"w-[210mm] mx-auto text-[11px] text-gray-500 text-right",children:"The policy file will be attached as Appendix A in the final PDF (not shown in this preview)."})]})},Og=e=>{switch(e){case"HEBREW_SUBMITTED":return" ";case"HEBREW_CHANGES_REQUESTED":return" ";case"HEBREW_APPROVED":return" ";case"HEBREW_REOPENED_EXTERNAL":return"  ()";case"HEBREW_DRAFT":default:return" "}},Pg=e=>{switch(e){case"SUBMITTED":return"  ";case"CHANGES_REQUESTED":return"  ";case"APPROVED":return"  ";case"DRAFT":default:return"  (  )"}},Ba="report-review-panel",vc="external-feedback-panel",Mg=({report:e,currentUser:t,onSubmitToAdmin:n,onApproveHebrew:r,onRequestChanges:l,onMarkIssueDone:a,onAddExternalFeedbackIssues:i,onReopenHebrewDueToExternalFeedback:o})=>{const[c,u]=y.useState(!1),[f,p]=y.useState(""),[g,S]=y.useState(""),[A,E]=y.useState("NORMAL"),[P,x]=y.useState(""),[h,b]=y.useState("INTERNAL"),[M,U]=y.useState("ENGLISH_ONLY"),H=y.useMemo(()=>{const V=e.reportReview;return V||{status:"DRAFT",issues:[]}},[e.reportReview]),W=y.useMemo(()=>{const V={};return H.issues.filter(K=>(K.origin??"INTERNAL")==="INTERNAL").forEach(K=>{const R=K.sectionKey||"GENERAL";V[R]||(V[R]=[]),V[R]=[...V[R],K]}),V},[H.issues]),O=y.useMemo(()=>{const V={};return H.issues.filter(K=>K.origin==="EXTERNAL").forEach(K=>{const R=K.sectionKey||"GENERAL";V[R]||(V[R]=[]),V[R]=[...V[R],K]}),V},[H.issues]),D=(t==null?void 0:t.role)==="LAWYER",$=(t==null?void 0:t.role)==="ADMIN",I=H.issues.some(V=>(V.origin??"INTERNAL")==="EXTERNAL"&&V.status!=="DONE"&&V.externalAction==="REQUIRES_HEBREW"),k=V=>{b(V),p(""),S(""),E("NORMAL"),x(""),U("ENGLISH_ONLY"),u(!0)},G=()=>{const V=f.trim(),K=g.trim();if(!V||!K)return;const R={title:V,instruction:K,severity:A,type:"OTHER",sectionKey:void 0,externalAction:h==="EXTERNAL"?M:void 0};h==="EXTERNAL"&&i?i([R],P.trim()||void 0):l([R]),u(!1)},de=Pg(H.status),ne=Og(e.hebrewWorkflowStatus);return s.jsxs("section",{id:Ba,className:"mt-4 rounded-xl border border-slate-200 bg-slate-50 px-4 py-3",dir:"rtl",lang:"he",children:[s.jsxs("div",{className:"mb-2 flex items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-xs font-semibold text-slate-500",children:" "}),s.jsx("div",{className:"text-sm font-medium text-slate-900",children:de})]}),s.jsx("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-3 py-1 text-xs font-medium text-slate-700",children:ne})]}),D&&s.jsx("div",{className:"mb-3 text-xs text-amber-700",children:e.hebrewWorkflowStatus==="HEBREW_REOPENED_EXTERNAL"?"            .":H.status==="SUBMITTED"?"   .       .":H.status==="CHANGES_REQUESTED"?"   .      .":null}),$&&I&&s.jsx("div",{className:"mb-3 text-xs font-semibold text-red-700",children:"      .    ."}),H.issues.length>0&&s.jsxs("div",{className:"mb-3 space-y-3",children:[Object.keys(W).length>0&&s.jsxs("div",{children:[s.jsx("div",{className:"mb-1 text-xs font-semibold text-slate-600",children:"  ()"}),Object.entries(W).map(([V,K])=>s.jsxs("div",{className:"rounded-lg bg-white p-2 mb-1",children:[V!=="GENERAL"&&s.jsxs("div",{className:"mb-1 text-[11px] font-semibold text-slate-500",children:[": ",V]}),s.jsx("ul",{className:"space-y-1",children:K.map(R=>s.jsxs("li",{className:"flex items-start justify-between gap-2 rounded-md border border-slate-100 bg-slate-50 px-2 py-1.5",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ${R.severity==="CRITICAL"?"bg-red-100 text-red-700":R.severity==="NORMAL"?"bg-amber-50 text-amber-700":"bg-slate-100 text-slate-600"}`,children:R.severity==="CRITICAL"?"":R.severity==="NORMAL"?"":""}),s.jsx("span",{className:"text-xs font-medium text-slate-900",children:R.title})]}),s.jsx("div",{className:"mt-1 text-[11px] text-slate-700",children:R.instruction})]}),(D||$)&&s.jsx("button",{type:"button",className:"mt-1 inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 hover:bg-emerald-100 disabled:opacity-50",disabled:R.status==="DONE",onClick:()=>a(R.id),children:R.status==="DONE"?"":" "})]},R.id))})]},V))]}),Object.keys(O).length>0&&s.jsxs("div",{id:vc,children:[s.jsx("div",{className:"mb-1 text-xs font-semibold text-slate-600",children:"  "}),Object.entries(O).map(([V,K])=>s.jsxs("div",{className:"rounded-lg bg-white p-2 mb-1",children:[V!=="GENERAL"&&s.jsxs("div",{className:"mb-1 text-[11px] font-semibold text-slate-500",children:[": ",V]}),s.jsx("ul",{className:"space-y-1",children:K.map(R=>s.jsxs("li",{className:"flex items-start justify-between gap-2 rounded-md border border-slate-100 bg-slate-50 px-2 py-1.5",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ${R.severity==="CRITICAL"?"bg-red-100 text-red-700":R.severity==="NORMAL"?"bg-amber-50 text-amber-700":"bg-slate-100 text-slate-600"}`,children:R.severity==="CRITICAL"?"":R.severity==="NORMAL"?"":""}),s.jsx("span",{className:"text-xs font-medium text-slate-900",children:R.title})]}),s.jsx("div",{className:"mt-1 text-[11px] text-slate-700",children:R.instruction})]}),(D||$)&&s.jsx("button",{type:"button",className:"mt-1 inline-flex items-center rounded-full border border-emerald-200 bg-emerald-50 px-2 py-0.5 text-[10px] font-medium text-emerald-700 hover:bg-emerald-100 disabled:opacity-50",disabled:R.status==="DONE",onClick:()=>a(R.id),children:R.status==="DONE"?"":" "})]},R.id))})]},V))]})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap items-center gap-2",children:[D&&s.jsx("button",{type:"button",className:"rounded-md bg-sky-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-sky-800 disabled:opacity-50",onClick:n,disabled:H.status==="SUBMITTED"||H.status==="APPROVED",children:"  "}),$&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",className:"rounded-md bg-emerald-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-emerald-800 disabled:opacity-50",onClick:r,children:"  "}),s.jsx("button",{type:"button",className:"rounded-md bg-amber-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-amber-800",onClick:()=>k("INTERNAL"),children:" "}),i&&s.jsx("button",{type:"button",className:"rounded-md bg-slate-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-slate-800",onClick:()=>k("EXTERNAL"),children:"   "}),o&&e.status==="SENT"&&s.jsx("button",{type:"button",className:"rounded-md bg-red-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-red-800",onClick:o,children:"   ( )"}),o&&e.status!=="SENT"&&s.jsx("span",{className:"text-[11px] text-slate-500",children:"       (SENT)."})]})]}),c&&s.jsx("div",{className:"fixed inset-0 z-[180] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"w-full max-w-md rounded-xl bg-white p-4 shadow-2xl",dir:"rtl",lang:"he",children:[s.jsx("h3",{className:"mb-3 text-sm font-bold text-slate-900",children:"   "}),s.jsxs("div",{className:"mb-3 space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:"  ()"}),s.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-sm",value:f,onChange:V=>p(V.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:"  ()"}),s.jsx("textarea",{className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-sm",rows:3,value:g,onChange:V=>S(V.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:" "}),s.jsxs("select",{className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs",value:A,onChange:V=>E(V.target.value),children:[s.jsx("option",{value:"NORMAL",children:""}),s.jsx("option",{value:"CRITICAL",children:""}),s.jsx("option",{value:"STYLE",children:""})]})]}),h==="EXTERNAL"&&s.jsxs("div",{children:[s.jsx("label",{className:"mb-1 block text-xs font-semibold text-slate-700",children:"    ()"}),s.jsx("input",{type:"text",className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-sm",value:P,onChange:V=>x(V.target.value)}),s.jsx("label",{className:"mb-1 mt-3 block text-xs font-semibold text-slate-700",children:" "}),s.jsxs("select",{className:"w-full rounded-md border border-slate-300 px-2 py-1.5 text-xs",value:M,onChange:V=>U(V.target.value),children:[s.jsx("option",{value:"ENGLISH_ONLY",children:"  "}),s.jsx("option",{value:"REQUIRES_HEBREW",children:"  "})]})]})]}),s.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[s.jsx("button",{type:"button",className:"rounded-md border border-slate-300 px-3 py-1.5 text-xs font-medium text-slate-700 hover:bg-slate-100",onClick:()=>u(!1),children:""}),s.jsx("button",{type:"button",className:"rounded-md bg-amber-700 px-3 py-1.5 text-xs font-semibold text-white hover:bg-amber-800 disabled:opacity-50",onClick:G,disabled:!f.trim()||!g.trim(),children:" "})]})]})})]})},Kl="REPLACE_WITH_GRAMMARLY_CLIENT_ID",Td={[xs]:"Statement of Claim",[na]:"Letter of Demand",[Sd]:"Statement of Claim Expert Opinion",[jd]:"Letter of Demand Expert Opinion","The plaintiff's expert opinion":"Plaintiff Expert Opinion","The claimant's expert opinion":"Claimant Expert Opinion","The insured's expert opinion":"Insured Expert Opinion","Insurance Coverage":"Insurance Coverage","Risk Assessment":"Risk Assessment",MPL:"MPL",Strategy:"Strategy","Expenses breakdown":"Expenses Breakdown","Expenses & Compensation breakdown":"Expenses & Compensation",Recommendations:"Recommendations","Strategy & Recommendations":"Strategy & Recommendations","Request for Approval of a Settlement Agreement":"Settlement Approval",Update:"Update"};Wp.forEach(e=>{Td[e]="Statement of Claim"});Vp.forEach(e=>{Td[e]="Letter of Demand"});const Fg=e=>(Td[e]||e||"").trim(),Gp=e=>e.map(Fg).filter(Boolean),bc=e=>{const t=new Set;return e.map(n=>n.trim()).filter(n=>{if(!n)return!1;const r=n.toLowerCase();return t.has(r)?!1:(t.add(r),!0)})},Ad=/[\\/:*?"<>|]/g,ho=e=>(e||"").trim(),Bg=e=>{const t=(e.filenameTag||"").toLowerCase(),n=(e.plaintiffTitle||"").toLowerCase();return t.includes("demand")||n==="claimant"},$g=e=>{var t;return(((t=e.reportHistory)==null?void 0:t.length)||0)+1},Ug=120,Hg=e=>{if(!e.length)return"";if(e.length===1)return e[0];if(e.length===2)return`${e[0]} & ${e[1]}`;const t=e.slice(0,-1),n=e[e.length-1];return`${t.join(", ")} & ${n}`},Fs=e=>{const t=ho(e.insurerName),n=ho(e.insuredName),r=ho(e.plaintiffName),l=$g(e);let a=[];const i=Array.isArray(e.fileNameTitles)?Dt(e.fileNameTitles.map(A=>Et(A))):[];i.length>0?a=bc(i):l===1?a=[Bg(e)?"New Letter of demand":"New Lawsuit"]:(a=bc(Gp(e.selectedSections||[])),a.length||(a=["Update"]));const o=Hg(a),c=`Report ${l}`;let f=[t||void 0,n||void 0,r||void 0,o||void 0].filter(Boolean).join(" - ");if(f=f.replace(Ad," ").replace(/\s+/g," ").replace(/-+/g,"-").trim(),!f){const A=c;return A.toLowerCase().endsWith(".pdf")?A:`${A}.pdf`}const p=` - ${c}`,g=Math.max(0,Ug-p.length);if(f.length>g){const A=f.slice(0,g),E=A.lastIndexOf(" ");f=(E>0?A.slice(0,E):A).trim()}let S=`${f}${p}`;return S=S.replace(/\s+/g," ").replace(/-+/g,"-").trim(),S||(S=`Report-${Date.now()}`),S.toLowerCase().endsWith(".pdf")?S:`${S}.pdf`},hi=e=>Fs(e).replace(/\.pdf$/i,""),Kp=e=>`fileNameTopics:${e||"default"}`,zg=["Update","Expenses","New Lawsuit","New Third Party Notice","New Letter of Demand","Risk Assessment","Strategy","Recommendation","Request for Settlement Approval","Judgment","Request to Reopen a Claim","Dismissal for Inaction"],Et=e=>{const t=(e||"").trim();return t?t.replace(Ad," ").replace(/\s+/g," ").trim():""},xi=e=>Et(e).trim().toLowerCase(),Dt=e=>{const t=new Set,n=[];for(const r of e){const l=Et(r),a=xi(l);a&&(t.has(a)||(t.add(a),n.push(l)))}return n},Wg=e=>{if(typeof window>"u")return[];try{const t=window.localStorage.getItem(Kp(e));if(!t)return[];const n=JSON.parse(t);return Array.isArray(n)?Dt(n.map(r=>typeof r=="string"?r:"").map(Et)):[]}catch{return[]}},Vg=(e,t)=>{if(!(typeof window>"u"))try{const n=Dt(t.map(Et)).filter(Boolean);window.localStorage.setItem(Kp(e),JSON.stringify(n))}catch{}},Yg=(e,t,n=15)=>{const r=Et(t),l=xi(r);if(!l)return Dt(e).slice(0,n);const a=(e||[]).filter(o=>xi(o)!==l),i=[r,...a];return Dt(i).slice(0,n)},qp=e=>`topicCombos:${e||"default"}`,Xp=e=>`insurerDefaultTopics:${e||"default"}`,Qp=e=>{if(!e)return null;try{return JSON.parse(e)}catch{return null}},wc=e=>{if(typeof window>"u")return[];const t=window.localStorage.getItem(qp(e)),n=Qp(t);return Array.isArray(n)?n.filter(l=>Array.isArray(l)).map(l=>l.map(a=>Et(a)).filter(Boolean)).filter(l=>l.length>0):[]},im=(e,t)=>{if(typeof window>"u")return;const n=t.map(r=>Dt(r.map(l=>Et(l))).filter(Boolean)).filter(r=>r.length>0);try{window.localStorage.setItem(qp(e),JSON.stringify(n))}catch{}},om=e=>e.map(n=>xi(n)).filter(Boolean).sort().join("|"),cm=(e,t,n=6)=>{const r=Dt(t.map(o=>Et(o))).filter(Boolean);if(!r.length)return e;const l=om(r),a=[],i=new Set;a.push(r),i.add(l);for(const o of e){const c=om(o);if(!i.has(c)&&(a.push(Dt(o.map(u=>Et(u))).filter(Boolean)),i.add(c),a.length>=n))break}return a.slice(0,n)},kd=e=>(e||"").trim().toLowerCase(),Rd=e=>{if(typeof window>"u")return{};const t=window.localStorage.getItem(Xp(e)),n=Qp(t);if(!n||typeof n!="object")return{};const r={};for(const[l,a]of Object.entries(n)){if(!Array.isArray(a))continue;const i=Dt(a.map(o=>Et(o))).filter(Boolean).slice(0,8);i.length&&(r[l]=i)}return r},Jp=(e,t)=>{if(typeof window>"u")return;const n={};for(const[r,l]of Object.entries(t)){const a=Dt((l||[]).map(i=>Et(i))).filter(Boolean).slice(0,8);a.length&&(n[r]=a)}try{window.localStorage.setItem(Xp(e),JSON.stringify(n))}catch{}},Gg=(e,t)=>{const n=Rd(e),r=kd(t);return n[r]||[]},Kg=(e,t,n)=>{if(!t)return;const r=kd(t),l=Rd(e),a=Dt(n.map(i=>Et(i))).filter(Boolean).slice(0,8);a.length?l[r]=a:delete l[r],Jp(e,l)},qg=(e,t)=>{if(!t)return;const n=kd(t),r=Rd(e);r[n]&&(delete r[n],Jp(e,r))},dm=[{id:"general_update",label:"General Update",body:`Dear Sir/Madam,

Please find below our general update regarding the above-captioned matter.

Best regards,
Lior Perry, Adv.`},{id:"risk_assessment",label:"Risk Assessment",body:`Dear Sir/Madam,

Kindly review the following risk assessment prepared for the insurer.

Best regards,
Lior Perry, Adv.`},{id:"expert_opinion",label:"Expert Opinion",body:`Dear Sir/Madam,

Please find our expert opinion summary for your review and records.

Best regards,
Lior Perry, Adv.`},{id:"full_report",label:"Full Report Delivery",body:`Dear Sir/Madam,

Attached is the full report for the current update, including all relevant sections.

Best regards,
Lior Perry, Adv.`},{id:"zeev_new_demand",label:"Zeev  New demand letter",body:`Dear Zeev,

I've attached a report regarding a new demand letter.

Sincerely,
Lior`},{id:"zeev_claim_update",label:"Zeev  Claim update",body:`Dear Zeev,

I've attached a report on the claim in question.

Sincerely,
Lior`},{id:"zeev_new_lawsuit",label:"Zeev  New lawsuit",body:`Dear Zeev,

I've attached a report regarding a new lawsuit.

Sincerely,
Lior`},{id:"zeev_lawsuit_update",label:"Zeev  Lawsuit update",body:`Dear Zeev,

I've attached a report on the lawsuit in question.

Sincerely,
Lior`}],um=e=>`emailTemplates:${e||"default"}`,Xg=({isOpen:e,report:t,userId:n,isSending:r=!1,recipientsPreview:l,defaultSubject:a,subjectDraft:i,onSubjectDraftChange:o,selectedTopics:c,onSelectedTopicsChange:u,onClose:f,onSend:p})=>{const g=dm[0],[S,A]=y.useState(g.id),[E,P]=y.useState(g.body),[x,h]=y.useState([]),[b,M]=y.useState([]),[U,H]=y.useState(i),[W,O]=y.useState(""),[D,$]=y.useState(""),[I,k]=y.useState([]),[G,de]=y.useState([]),ne=q=>{if(typeof window>"u")return[];try{const F=localStorage.getItem(um(q));if(!F)return[];const Ne=JSON.parse(F);return Array.isArray(Ne)?Ne.filter(xe=>typeof(xe==null?void 0:xe.id)=="string"&&typeof(xe==null?void 0:xe.label)=="string"&&typeof(xe==null?void 0:xe.body)=="string"):[]}catch{return[]}},V=q=>{typeof window>"u"||localStorage.setItem(um(n),JSON.stringify(q))},K=y.useMemo(()=>[...dm,...x],[x]),R=y.useMemo(()=>K.reduce((q,F)=>(q[F.id]=F,q),{}),[K]);y.useEffect(()=>{if(!e)return;const q=ne(n);h(q);const F=Wg(n);M(F),k(wc(n)),de(Gg(n,t.insurerName)),H(i),$(""),O("")},[e,n,i,t.insurerName]),y.useEffect(()=>{if(!e)return;const q=t.selectedEmailTemplate&&R[t.selectedEmailTemplate]?t.selectedEmailTemplate:g.id;A(q),P(t.emailBodyDraft||R[q].body)},[e,g.id,t.emailBodyDraft,t.selectedEmailTemplate,R]);const te=q=>{A(q);const F=R[q];F&&P(F.body)},se=()=>{const q=window.prompt("  ?");if(!q)return;const F=q.trim();if(!F)return;const Ne={id:`custom_${Date.now()}`,label:F,body:E},xe=[...x,Ne];h(xe),V(xe),A(Ne.id)},ye=y.useMemo(()=>Dt([...b,...zg]),[b]),L=y.useMemo(()=>{const q=D.trim().toLowerCase();return q?ye.filter(F=>F.toLowerCase().includes(q)):ye},[ye,D]),le=q=>{const F=Et(q);if(!F)return;const Ne=F.toLowerCase(),xe=c.some(ze=>ze.trim().toLowerCase()===Ne)?c.filter(ze=>ze.trim().toLowerCase()!==Ne):[...c,F];u(Dt(xe))},Ie=()=>{const q=Et(W);if(!q)return;const F=Yg(b,q,15);M(F),Vg(n,F);const Ne=Dt([...c,q]);u(Ne),O("")},Ae=y.useMemo(()=>Fs({...t,fileNameTitles:c}),[t,c]),Te=!l.cc.some(q=>q.toLowerCase()!=="reports@lp-law.co.il"),he=l.to[0]||"",et=l.to.length===1&&he.toLowerCase()==="lidor@lp-law.co.il";return e?s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[999] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between border-b px-6 py-4",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Compose Email"}),et&&s.jsx("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2.5 py-0.5 text-[11px] font-semibold text-blue-800 border border-blue-200",children:"SANDBOX"})]}),s.jsx("button",{onClick:f,className:"text-gray-500 hover:text-gray-700",children:s.jsx(jt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-4 space-y-4",children:[Te&&s.jsxs("div",{className:"flex items-start gap-2 text-xs text-amber-800 bg-amber-50 border border-amber-200 rounded-md px-3 py-2",children:[s.jsx(ui,{className:"w-3.5 h-3.5 mt-[1px]"}),s.jsx("p",{children:"         .       (To)   CC."})]}),et&&s.jsxs("div",{className:"flex items-start gap-2 text-xs text-blue-800 bg-blue-50 border border-blue-200 rounded-md px-3 py-2",children:[s.jsx(ui,{className:"w-3.5 h-3.5 mt-[1px]"}),s.jsx("p",{children:" :         ,    ."})]}),s.jsxs("div",{className:"text-xs text-gray-600 space-y-1 border rounded-md border-gray-200 bg-gray-50 px-3 py-2",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-semibold",children:"To:"})," ",s.jsx("span",{children:l.to.join("; ")||""})]}),l.cc.length>0&&s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-semibold",children:"CC:"})," ",s.jsx("span",{children:l.cc.join("; ")})]}),s.jsxs("p",{className:"text-[11px] text-gray-500 mt-1",children:["To: ",he||""," (primary), CC: Office + report owner ( )."]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Subject:"})," ",U||"(will be generated from case data)"]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:"Attachment:"})," ",Ae]}),s.jsx("p",{className:"text-[11px] text-amber-700 mt-1",children:" :       ,        -PDF ."})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Subject"}),s.jsx("button",{type:"button",onClick:()=>{H(a),o(void 0)},className:"text-[11px] text-blue-700 hover:underline disabled:opacity-50",disabled:r,children:"Reset"})]}),s.jsx("input",{type:"text",value:U,onChange:q=>{const F=q.target.value;H(F),o(F)},className:"w-full border rounded-md p-2 text-sm",disabled:r})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template"}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("select",{value:S,onChange:q=>te(q.target.value),className:"flex-1 border rounded-md p-2",children:K.map(q=>s.jsx("option",{value:q.id,children:q.label},q.id))}),s.jsx("button",{type:"button",onClick:se,className:"px-3 py-2 bg-white border rounded-md text-sm font-medium text-gray-700 hover:bg-gray-100",disabled:r,children:"Save Template"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PDF Filename Topics"}),I.length>0&&s.jsxs("div",{className:"mb-2",children:[s.jsx("p",{className:"text-[11px] font-semibold text-gray-700 mb-1",children:"Recent combinations"}),s.jsx("div",{className:"flex flex-wrap gap-2",children:I.map((q,F)=>s.jsx("button",{type:"button",onClick:()=>u(q),className:"inline-flex items-center gap-1 rounded-full bg-gray-100 px-3 py-1 text-[11px] text-gray-800 border border-gray-300 hover:bg-gray-200",children:q.join(" + ")},F))})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:c.length===0?s.jsx("span",{className:"text-xs text-gray-400",children:"No topics selected yet. You can choose from the list below or add your own."}):c.map(q=>s.jsxs("button",{type:"button",onClick:()=>le(q),className:"inline-flex items-center gap-1 rounded-full bg-blue-50 px-3 py-1 text-xs text-blue-800 border border-blue-200 hover:bg-blue-100",children:[s.jsx("span",{children:q}),s.jsx("span",{className:"text-[10px]",children:""})]},q))}),s.jsx("button",{type:"button",onClick:()=>{u([]),$("")},className:"mb-2 text-[11px] text-blue-700 hover:underline",disabled:r,children:"  "}),s.jsx("div",{className:"flex items-center gap-2 mb-2",children:s.jsx("input",{type:"text",value:D,onChange:q=>$(q.target.value),placeholder:"  ...",className:"flex-1 border rounded-md p-1.5 text-[11px]",disabled:r})}),s.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-1 mb-2 max-h-32 overflow-y-auto border rounded-md p-2 bg-white",children:L.map(q=>{const F=`topic-${q}`,Ne=q.toLowerCase(),xe=c.some(ze=>ze.trim().toLowerCase()===Ne);return s.jsxs("label",{htmlFor:F,className:"flex items-center gap-1 text-xs text-gray-700 cursor-pointer",children:[s.jsx("input",{id:F,type:"checkbox",className:"h-3 w-3",checked:xe,onChange:()=>le(q),disabled:r}),s.jsx("span",{className:"whitespace-normal break-words",children:q})]},q)})}),s.jsxs("div",{className:"flex gap-2 mt-1",children:[s.jsx("input",{type:"text",value:W,onChange:q=>O(q.target.value),placeholder:"Add custom topic",className:"flex-1 border rounded-md p-2 text-xs",disabled:r}),s.jsx("button",{type:"button",onClick:Ie,className:"px-3 py-1.5 bg-white border rounded-md text-xs font-medium text-gray-700 hover:bg-gray-100 disabled:opacity-50",disabled:r,children:"Add"})]}),s.jsxs("div",{className:"mt-3 space-y-1 text-[11px] text-gray-700",children:[s.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[s.jsx("button",{type:"button",onClick:()=>{const q=Dt(c.map(F=>Et(F)));q.length&&(Kg(n,t.insurerName,q),de(q))},className:"px-2 py-1 rounded-full border border-gray-300 bg-white hover:bg-gray-100",disabled:r||c.length===0,children:"     "}),G.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:()=>u(G),className:"px-2 py-1 rounded-full border border-blue-300 bg-blue-50 text-blue-800 hover:bg-blue-100 disabled:opacity-50",disabled:r,children:"     "}),s.jsx("button",{type:"button",onClick:()=>{qg(n,t.insurerName),de([])},className:"text-[11px] text-red-600 hover:underline",disabled:r,children:"    "})]})]}),G.length>0&&c.length===0&&s.jsx("p",{className:"text-[11px] text-gray-500",children:"     .       ."})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Body"}),s.jsx(zl,{clientId:Kl,children:s.jsx("textarea",{value:E,onChange:q=>P(q.target.value),rows:12,dir:"ltr",className:"w-full border rounded-md p-3 text-sm",style:{direction:"ltr",textAlign:"left",unicodeBidi:"plaintext"}})})]}),s.jsxs("div",{className:"border-t pt-4 text-right",children:[s.jsx("p",{className:"text-sm font-semibold text-gray-600 mb-2",children:"Signature"}),s.jsxs("div",{className:"inline-flex flex-col items-end",children:[s.jsx("img",{src:"/assets/branding/signature.png",alt:"Signature placeholder",className:"h-16 object-contain mb-2 opacity-80",onError:q=>{q.currentTarget.style.display="none"}}),s.jsx("span",{className:"text-sm text-gray-700 font-semibold",children:"Adv. Lior Perry"})]})]})]}),s.jsxs("div",{className:"flex justify-end gap-3 border-t px-6 py-4 bg-gray-50",children:[s.jsx("button",{onClick:f,className:"px-4 py-2 rounded-md text-gray-600 hover:bg-gray-200",disabled:r,children:"Cancel"}),s.jsx("button",{onClick:()=>p({body:E,templateId:S,subjectBase:U.trim(),topics:Dt(c.map(q=>Et(q)))}),className:"px-5 py-2 rounded-md bg-lpBlue text-white font-semibold hover:bg-blue-900 disabled:opacity-60 disabled:cursor-not-allowed",disabled:r,children:r?"Sending":"Send Email"})]})]})}):null},Qg=({isOpen:e,availableTitles:t,selectedTitles:n,onClose:r,onSave:l})=>{const a=y.useMemo(()=>g=>{const S=new Set,A=[];return g.forEach(E=>{const P=t.find(x=>x.label===E&&!S.has(x.id));P&&(A.push(P.id),S.add(P.id))}),A},[t]),i=y.useCallback(()=>{const g=a(n);return g.length?g:t.map(S=>S.id)},[a,n,t]),[o,c]=y.useState(i);if(y.useEffect(()=>{e&&c(i())},[e,i]),!e)return null;const u=g=>{c(S=>S.includes(g)?S.filter(A=>A!==g):[...S,g])},f=()=>{c(t.map(g=>g.id))},p=()=>{const g=o.map(S=>{var A;return(A=t.find(E=>E.id===S))==null?void 0:A.label}).filter(Boolean);l(g)};return s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[900] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between px-5 py-3 border-b bg-gray-50",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Select File Name Titles"}),s.jsx("button",{onClick:r,className:"text-gray-500 hover:text-gray-800",children:s.jsx(jt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-5 space-y-3",children:[t.length===0&&s.jsx("p",{className:"text-sm text-gray-500",children:"No sections available to include."}),t.map(g=>s.jsxs("label",{className:"flex items-center gap-3 border rounded-lg px-3 py-2 text-sm",children:[s.jsx("input",{type:"checkbox",className:"h-4 w-4 text-lpBlue",checked:o.includes(g.id),onChange:()=>u(g.id)}),s.jsx("span",{className:"text-gray-800",children:g.label||"[Untitled Section]"})]},g.id)),t.length>0&&s.jsx("button",{type:"button",className:"text-xs text-lpBlue hover:underline",onClick:f,children:"Select All"})]}),s.jsxs("div",{className:"flex justify-end gap-3 border-t px-5 py-4 bg-gray-50",children:[s.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 hover:bg-gray-200 rounded-md",children:"Cancel"}),s.jsx("button",{onClick:p,className:"px-5 py-2 bg-lpBlue text-white rounded-md font-semibold hover:bg-blue-900",children:"Save"})]})]})})};var zr=1e9,Jg={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Dd,rt=!0,mn="[DecimalError] ",Ws=mn+"Invalid argument: ",Cd=mn+"Exponent out of range: ",Wr=Math.floor,Ms=Math.pow,Zg=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qt,Nt=1e7,Je=7,Zp=9007199254740991,gi=Wr(Zp/Je),ce={};ce.absoluteValue=ce.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ce.comparedTo=ce.cmp=function(e){var t,n,r,l,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(r=a.d.length,l=e.d.length,t=0,n=r<l?r:l;t<n;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return r===l?0:r>l^a.s<0?1:-1};ce.decimalPlaces=ce.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Je;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};ce.dividedBy=ce.div=function(e){return Yn(this,new this.constructor(e))};ce.dividedToIntegerBy=ce.idiv=function(e){var t=this,n=t.constructor;return Ge(Yn(t,new n(e),0,1),n.precision)};ce.equals=ce.eq=function(e){return!this.cmp(e)};ce.exponent=function(){return pt(this)};ce.greaterThan=ce.gt=function(e){return this.cmp(e)>0};ce.greaterThanOrEqualTo=ce.gte=function(e){return this.cmp(e)>=0};ce.isInteger=ce.isint=function(){return this.e>this.d.length-2};ce.isNegative=ce.isneg=function(){return this.s<0};ce.isPositive=ce.ispos=function(){return this.s>0};ce.isZero=function(){return this.s===0};ce.lessThan=ce.lt=function(e){return this.cmp(e)<0};ce.lessThanOrEqualTo=ce.lte=function(e){return this.cmp(e)<1};ce.logarithm=ce.log=function(e){var t,n=this,r=n.constructor,l=r.precision,a=l+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(qt))throw Error(mn+"NaN");if(n.s<1)throw Error(mn+(n.s?"NaN":"-Infinity"));return n.eq(qt)?new r(0):(rt=!1,t=Yn(ql(n,a),ql(e,a),a),rt=!0,Ge(t,l))};ce.minus=ce.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?nh(t,e):eh(t,(e.s=-e.s,e))};ce.modulo=ce.mod=function(e){var t,n=this,r=n.constructor,l=r.precision;if(e=new r(e),!e.s)throw Error(mn+"NaN");return n.s?(rt=!1,t=Yn(n,e,0,1).times(e),rt=!0,n.minus(t)):Ge(new r(n),l)};ce.naturalExponential=ce.exp=function(){return th(this)};ce.naturalLogarithm=ce.ln=function(){return ql(this)};ce.negated=ce.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ce.plus=ce.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?eh(t,e):nh(t,(e.s=-e.s,e))};ce.precision=ce.sd=function(e){var t,n,r,l=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ws+e);if(t=pt(l)+1,r=l.d.length-1,n=r*Je+1,r=l.d[r],r){for(;r%10==0;r/=10)n--;for(r=l.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};ce.squareRoot=ce.sqrt=function(){var e,t,n,r,l,a,i,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(mn+"NaN")}for(e=pt(o),rt=!1,l=Math.sqrt(+o),l==0||l==1/0?(t=Cn(o.d),(t.length+e)%2==0&&(t+="0"),l=Math.sqrt(t),e=Wr((e+1)/2)-(e<0||e%2),l==1/0?t="5e"+e:(t=l.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(l.toString()),n=c.precision,l=i=n+3;;)if(a=r,r=a.plus(Yn(o,a,i+2)).times(.5),Cn(a.d).slice(0,i)===(t=Cn(r.d)).slice(0,i)){if(t=t.slice(i-3,i+1),l==i&&t=="4999"){if(Ge(a,n+1,0),a.times(a).eq(o)){r=a;break}}else if(t!="9999")break;i+=4}return rt=!0,Ge(r,n)};ce.times=ce.mul=function(e){var t,n,r,l,a,i,o,c,u,f=this,p=f.constructor,g=f.d,S=(e=new p(e)).d;if(!f.s||!e.s)return new p(0);for(e.s*=f.s,n=f.e+e.e,c=g.length,u=S.length,c<u&&(a=g,g=S,S=a,i=c,c=u,u=i),a=[],i=c+u,r=i;r--;)a.push(0);for(r=u;--r>=0;){for(t=0,l=c+r;l>r;)o=a[l]+S[r]*g[l-r-1]+t,a[l--]=o%Nt|0,t=o/Nt|0;a[l]=(a[l]+t)%Nt|0}for(;!a[--i];)a.pop();return t?++n:a.shift(),e.d=a,e.e=n,rt?Ge(e,p.precision):e};ce.toDecimalPlaces=ce.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(On(e,0,zr),t===void 0?t=r.rounding:On(t,0,8),Ge(n,e+pt(n)+1,t))};ce.toExponential=function(e,t){var n,r=this,l=r.constructor;return e===void 0?n=Xs(r,!0):(On(e,0,zr),t===void 0?t=l.rounding:On(t,0,8),r=Ge(new l(r),e+1,t),n=Xs(r,!0,e+1)),n};ce.toFixed=function(e,t){var n,r,l=this,a=l.constructor;return e===void 0?Xs(l):(On(e,0,zr),t===void 0?t=a.rounding:On(t,0,8),r=Ge(new a(l),e+pt(l)+1,t),n=Xs(r.abs(),!1,e+pt(r)+1),l.isneg()&&!l.isZero()?"-"+n:n)};ce.toInteger=ce.toint=function(){var e=this,t=e.constructor;return Ge(new t(e),pt(e)+1,t.rounding)};ce.toNumber=function(){return+this};ce.toPower=ce.pow=function(e){var t,n,r,l,a,i,o=this,c=o.constructor,u=12,f=+(e=new c(e));if(!e.s)return new c(qt);if(o=new c(o),!o.s){if(e.s<1)throw Error(mn+"Infinity");return o}if(o.eq(qt))return o;if(r=c.precision,e.eq(qt))return Ge(o,r);if(t=e.e,n=e.d.length-1,i=t>=n,a=o.s,i){if((n=f<0?-f:f)<=Zp){for(l=new c(qt),t=Math.ceil(r/Je+4),rt=!1;n%2&&(l=l.times(o),fm(l.d,t)),n=Wr(n/2),n!==0;)o=o.times(o),fm(o.d,t);return rt=!0,e.s<0?new c(qt).div(l):Ge(l,r)}}else if(a<0)throw Error(mn+"NaN");return a=a<0&&e.d[Math.max(t,n)]&1?-1:1,o.s=1,rt=!1,l=e.times(ql(o,r+u)),rt=!0,l=th(l),l.s=a,l};ce.toPrecision=function(e,t){var n,r,l=this,a=l.constructor;return e===void 0?(n=pt(l),r=Xs(l,n<=a.toExpNeg||n>=a.toExpPos)):(On(e,1,zr),t===void 0?t=a.rounding:On(t,0,8),l=Ge(new a(l),e,t),n=pt(l),r=Xs(l,e<=n||n<=a.toExpNeg,e)),r};ce.toSignificantDigits=ce.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(On(e,1,zr),t===void 0?t=r.rounding:On(t,0,8)),Ge(new r(n),e,t)};ce.toString=ce.valueOf=ce.val=ce.toJSON=ce[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=pt(e),n=e.constructor;return Xs(e,t<=n.toExpNeg||t>=n.toExpPos)};function eh(e,t){var n,r,l,a,i,o,c,u,f=e.constructor,p=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),rt?Ge(t,p):t;if(c=e.d,u=t.d,i=e.e,l=t.e,c=c.slice(),a=i-l,a){for(a<0?(r=c,a=-a,o=u.length):(r=u,l=i,o=c.length),i=Math.ceil(p/Je),o=i>o?i+1:o+1,a>o&&(a=o,r.length=1),r.reverse();a--;)r.push(0);r.reverse()}for(o=c.length,a=u.length,o-a<0&&(a=o,r=u,u=c,c=r),n=0;a;)n=(c[--a]=c[a]+u[a]+n)/Nt|0,c[a]%=Nt;for(n&&(c.unshift(n),++l),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=l,rt?Ge(t,p):t}function On(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ws+e)}function Cn(e){var t,n,r,l=e.length-1,a="",i=e[0];if(l>0){for(a+=i,t=1;t<l;t++)r=e[t]+"",n=Je-r.length,n&&(a+=cs(n)),a+=r;i=e[t],r=i+"",n=Je-r.length,n&&(a+=cs(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var Yn=function(){function e(r,l){var a,i=0,o=r.length;for(r=r.slice();o--;)a=r[o]*l+i,r[o]=a%Nt|0,i=a/Nt|0;return i&&r.unshift(i),r}function t(r,l,a,i){var o,c;if(a!=i)c=a>i?1:-1;else for(o=c=0;o<a;o++)if(r[o]!=l[o]){c=r[o]>l[o]?1:-1;break}return c}function n(r,l,a){for(var i=0;a--;)r[a]-=i,i=r[a]<l[a]?1:0,r[a]=i*Nt+r[a]-l[a];for(;!r[0]&&r.length>1;)r.shift()}return function(r,l,a,i){var o,c,u,f,p,g,S,A,E,P,x,h,b,M,U,H,W,O,D=r.constructor,$=r.s==l.s?1:-1,I=r.d,k=l.d;if(!r.s)return new D(r);if(!l.s)throw Error(mn+"Division by zero");for(c=r.e-l.e,W=k.length,U=I.length,S=new D($),A=S.d=[],u=0;k[u]==(I[u]||0);)++u;if(k[u]>(I[u]||0)&&--c,a==null?h=a=D.precision:i?h=a+(pt(r)-pt(l))+1:h=a,h<0)return new D(0);if(h=h/Je+2|0,u=0,W==1)for(f=0,k=k[0],h++;(u<U||f)&&h--;u++)b=f*Nt+(I[u]||0),A[u]=b/k|0,f=b%k|0;else{for(f=Nt/(k[0]+1)|0,f>1&&(k=e(k,f),I=e(I,f),W=k.length,U=I.length),M=W,E=I.slice(0,W),P=E.length;P<W;)E[P++]=0;O=k.slice(),O.unshift(0),H=k[0],k[1]>=Nt/2&&++H;do f=0,o=t(k,E,W,P),o<0?(x=E[0],W!=P&&(x=x*Nt+(E[1]||0)),f=x/H|0,f>1?(f>=Nt&&(f=Nt-1),p=e(k,f),g=p.length,P=E.length,o=t(p,E,g,P),o==1&&(f--,n(p,W<g?O:k,g))):(f==0&&(o=f=1),p=k.slice()),g=p.length,g<P&&p.unshift(0),n(E,p,P),o==-1&&(P=E.length,o=t(k,E,W,P),o<1&&(f++,n(E,W<P?O:k,P))),P=E.length):o===0&&(f++,E=[0]),A[u++]=f,o&&E[0]?E[P++]=I[M]||0:(E=[I[M]],P=1);while((M++<U||E[0]!==void 0)&&h--)}return A[0]||A.shift(),S.e=c,Ge(S,i?a+pt(S)+1:a)}}();function th(e,t){var n,r,l,a,i,o,c=0,u=0,f=e.constructor,p=f.precision;if(pt(e)>16)throw Error(Cd+pt(e));if(!e.s)return new f(qt);for(rt=!1,o=p,i=new f(.03125);e.abs().gte(.1);)e=e.times(i),u+=5;for(r=Math.log(Ms(2,u))/Math.LN10*2+5|0,o+=r,n=l=a=new f(qt),f.precision=o;;){if(l=Ge(l.times(e),o),n=n.times(++c),i=a.plus(Yn(l,n,o)),Cn(i.d).slice(0,o)===Cn(a.d).slice(0,o)){for(;u--;)a=Ge(a.times(a),o);return f.precision=p,t==null?(rt=!0,Ge(a,p)):a}a=i}}function pt(e){for(var t=e.e*Je,n=e.d[0];n>=10;n/=10)t++;return t}function xo(e,t,n){if(t>e.LN10.sd())throw rt=!0,n&&(e.precision=n),Error(mn+"LN10 precision limit exceeded");return Ge(new e(e.LN10),t)}function cs(e){for(var t="";e--;)t+="0";return t}function ql(e,t){var n,r,l,a,i,o,c,u,f,p=1,g=10,S=e,A=S.d,E=S.constructor,P=E.precision;if(S.s<1)throw Error(mn+(S.s?"NaN":"-Infinity"));if(S.eq(qt))return new E(0);if(t==null?(rt=!1,u=P):u=t,S.eq(10))return t==null&&(rt=!0),xo(E,u);if(u+=g,E.precision=u,n=Cn(A),r=n.charAt(0),a=pt(S),Math.abs(a)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)S=S.times(e),n=Cn(S.d),r=n.charAt(0),p++;a=pt(S),r>1?(S=new E("0."+n),a++):S=new E(r+"."+n.slice(1))}else return c=xo(E,u+2,P).times(a+""),S=ql(new E(r+"."+n.slice(1)),u-g).plus(c),E.precision=P,t==null?(rt=!0,Ge(S,P)):S;for(o=i=S=Yn(S.minus(qt),S.plus(qt),u),f=Ge(S.times(S),u),l=3;;){if(i=Ge(i.times(f),u),c=o.plus(Yn(i,new E(l),u)),Cn(c.d).slice(0,u)===Cn(o.d).slice(0,u))return o=o.times(2),a!==0&&(o=o.plus(xo(E,u+2,P).times(a+""))),o=Yn(o,new E(p),u),E.precision=P,t==null?(rt=!0,Ge(o,P)):o;o=c,l+=2}}function mm(e,t){var n,r,l;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(l=t.length;t.charCodeAt(l-1)===48;)--l;if(t=t.slice(r,l),t){if(l-=r,n=n-r-1,e.e=Wr(n/Je),e.d=[],r=(n+1)%Je,n<0&&(r+=Je),r<l){for(r&&e.d.push(+t.slice(0,r)),l-=Je;r<l;)e.d.push(+t.slice(r,r+=Je));t=t.slice(r),r=Je-t.length}else r-=l;for(;r--;)t+="0";if(e.d.push(+t),rt&&(e.e>gi||e.e<-gi))throw Error(Cd+n)}else e.s=0,e.e=0,e.d=[0];return e}function Ge(e,t,n){var r,l,a,i,o,c,u,f,p=e.d;for(i=1,a=p[0];a>=10;a/=10)i++;if(r=t-i,r<0)r+=Je,l=t,u=p[f=0];else{if(f=Math.ceil((r+1)/Je),a=p.length,f>=a)return e;for(u=a=p[f],i=1;a>=10;a/=10)i++;r%=Je,l=r-Je+i}if(n!==void 0&&(a=Ms(10,i-l-1),o=u/a%10|0,c=t<0||p[f+1]!==void 0||u%a,c=n<4?(o||c)&&(n==0||n==(e.s<0?3:2)):o>5||o==5&&(n==4||c||n==6&&(r>0?l>0?u/Ms(10,i-l):0:p[f-1])%10&1||n==(e.s<0?8:7))),t<1||!p[0])return c?(a=pt(e),p.length=1,t=t-a-1,p[0]=Ms(10,(Je-t%Je)%Je),e.e=Wr(-t/Je)||0):(p.length=1,p[0]=e.e=e.s=0),e;if(r==0?(p.length=f,a=1,f--):(p.length=f+1,a=Ms(10,Je-r),p[f]=l>0?(u/Ms(10,i-l)%Ms(10,l)|0)*a:0),c)for(;;)if(f==0){(p[0]+=a)==Nt&&(p[0]=1,++e.e);break}else{if(p[f]+=a,p[f]!=Nt)break;p[f--]=0,a=1}for(r=p.length;p[--r]===0;)p.pop();if(rt&&(e.e>gi||e.e<-gi))throw Error(Cd+pt(e));return e}function nh(e,t){var n,r,l,a,i,o,c,u,f,p,g=e.constructor,S=g.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new g(e),rt?Ge(t,S):t;if(c=e.d,p=t.d,r=t.e,u=e.e,c=c.slice(),i=u-r,i){for(f=i<0,f?(n=c,i=-i,o=p.length):(n=p,r=u,o=c.length),l=Math.max(Math.ceil(S/Je),o)+2,i>l&&(i=l,n.length=1),n.reverse(),l=i;l--;)n.push(0);n.reverse()}else{for(l=c.length,o=p.length,f=l<o,f&&(o=l),l=0;l<o;l++)if(c[l]!=p[l]){f=c[l]<p[l];break}i=0}for(f&&(n=c,c=p,p=n,t.s=-t.s),o=c.length,l=p.length-o;l>0;--l)c[o++]=0;for(l=p.length;l>i;){if(c[--l]<p[l]){for(a=l;a&&c[--a]===0;)c[a]=Nt-1;--c[a],c[l]+=Nt}c[l]-=p[l]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,rt?Ge(t,S):t):new g(0)}function Xs(e,t,n){var r,l=pt(e),a=Cn(e.d),i=a.length;return t?(n&&(r=n-i)>0?a=a.charAt(0)+"."+a.slice(1)+cs(r):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(l<0?"e":"e+")+l):l<0?(a="0."+cs(-l-1)+a,n&&(r=n-i)>0&&(a+=cs(r))):l>=i?(a+=cs(l+1-i),n&&(r=n-l-1)>0&&(a=a+"."+cs(r))):((r=l+1)<i&&(a=a.slice(0,r)+"."+a.slice(r)),n&&(r=n-i)>0&&(l+1===i&&(a+="."),a+=cs(r))),e.s<0?"-"+a:a}function fm(e,t){if(e.length>t)return e.length=t,!0}function sh(e){var t,n,r;function l(a){var i=this;if(!(i instanceof l))return new l(a);if(i.constructor=l,a instanceof l){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(Ws+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return mm(i,a.toString())}else if(typeof a!="string")throw Error(Ws+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,Zg.test(a))mm(i,a);else throw Error(Ws+a)}if(l.prototype=ce,l.ROUND_UP=0,l.ROUND_DOWN=1,l.ROUND_CEIL=2,l.ROUND_FLOOR=3,l.ROUND_HALF_UP=4,l.ROUND_HALF_DOWN=5,l.ROUND_HALF_EVEN=6,l.ROUND_HALF_CEIL=7,l.ROUND_HALF_FLOOR=8,l.clone=sh,l.config=l.set=ey,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return l.config(e),l}function ey(e){if(!e||typeof e!="object")throw Error(mn+"Object expected");var t,n,r,l=["precision",1,zr,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<l.length;t+=3)if((r=e[n=l[t]])!==void 0)if(Wr(r)===r&&r>=l[t+1]&&r<=l[t+2])this[n]=r;else throw Error(Ws+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ws+n+": "+r);return this}var Dd=sh(Jg);qt=new Dd(1);const Un=Dd;Un.set({precision:20,rounding:Un.ROUND_HALF_UP});const wn=e=>new Un(e??0),Hn=e=>e.toDecimalPlaces(2).toNumber(),rh=(e,t)=>{const n=wn(e),r=wn(t);return Hn(n.mul(r))},lh=(e,t)=>{const n=wn(e),r=wn(t).div(100);return Hn(n.mul(r))},ah=(e,t)=>{const n=wn(e),r=wn(t);return Hn(n.add(r))},go=e=>{if(e.lineTotalAmount!=null)return wn(e.lineTotalAmount);const t=e.lineNetAmount!=null?e.lineNetAmount:rh(e.quantity??0,e.unitPrice??0),n=e.lineVatAmount!=null?e.lineVatAmount:lh(t,e.vatRate??0);return wn(ah(t,n))},Qn=(e,t)=>{const n=t.reduce((S,A)=>S.add(go(A)),new Un(0)),r=t.reduce((S,A)=>A.isIncludedInRequestedAmount===!1?S:S.add(go(A)),new Un(0)),l=t.reduce((S,A)=>A.lineVatAmount==null?S:S.add(wn(A.lineVatAmount)),new Un(0)),i=t.filter(S=>(S.kind==="ADJUSTMENT"||S.kind==="COMPENSATION")&&S.isIncludedInRequestedAmount===!1).reduce((S,A)=>S.add(go(A)),new Un(0)),o=wn(e.deductibleAmount??0),c=wn(e.alreadyPaidAmount??0),u=o.add(c).add(i),f=r.sub(u),p=!!e.infoOnly,g=p?new Un(0):f.greaterThan(0)?f:new Un(0);return{grossExpensesTotal:Hn(n),includedExpensesTotal:Hn(r),vatTotal:Hn(l),adjustmentsTotal:Hn(u),amountBeforeInfoOnly:Hn(f),amountToRequest:Hn(g),infoOnlyApplied:p}},ih="financial_expenses_store_v1",Sa=()=>({sheets:{},lineItems:{},attachments:{},auditEvents:{},insurerRulesets:{},exceptionAnnotations:{}}),wt=()=>{if(typeof window>"u")return Sa();try{const e=window.localStorage.getItem(ih);if(!e)return Sa();const t=JSON.parse(e);return!t||typeof t!="object"?Sa():{sheets:t.sheets||{},lineItems:t.lineItems||{},attachments:t.attachments||{},auditEvents:t.auditEvents||{},insurerRulesets:t.insurerRulesets||{},exceptionAnnotations:t.exceptionAnnotations||{}}}catch(e){return console.error("Failed to load financial expenses store",e),Sa()}},Pn=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(ih,JSON.stringify(e))}catch(t){console.error("Failed to persist financial expenses store",t)}},ty=e=>{let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return Math.abs(t).toString(16)},ny=(e,t,n)=>{const r={sheet:e,lineItems:t.map(l=>({id:l.id,sheetId:l.sheetId,kind:l.kind,expenseType:l.expenseType,providerName:l.providerName,description:l.description,date:l.date,quantity:l.quantity,unitPrice:l.unitPrice,vatRate:l.vatRate,isIncludedInRequestedAmount:l.isIncludedInRequestedAmount,lineNetAmount:l.lineNetAmount,lineVatAmount:l.lineVatAmount,lineTotalAmount:l.lineTotalAmount,attachmentId:l.attachmentId})),attachments:n.map(l=>({id:l.id,sheetId:l.sheetId,fileKey:l.fileKey,originalFileName:l.originalFileName,mimeType:l.mimeType,sizeBytes:l.sizeBytes,linkedLineItemId:l.linkedLineItemId}))};return ty(JSON.stringify(r))},fn=()=>new Date().toISOString(),sa=e=>`${e}_${Math.random().toString(36).slice(2,10)}_${Date.now().toString(36)}`,Xl=(e,t)=>{const n=Object.values(e.lineItems).filter(l=>l.sheetId===t),r=Object.values(e.attachments).filter(l=>l.sheetId===t);return{lineItems:n,attachments:r}},sy=e=>wt().insurerRulesets[e]||null,yo=()=>{const e=wt();return Object.values(e.sheets).sort((t,n)=>{const r=new Date(t.updatedAt||t.createdAt).getTime();return new Date(n.updatedAt||n.createdAt).getTime()-r})},pm=e=>{const t=wt(),n=t.sheets[e];if(!n)return null;const{lineItems:r,attachments:l}=Xl(t,e);return{sheet:n,lineItems:r,attachments:l}},Zn=(e,t)=>{const n=e.sheets[t];if(!n)return e;const{lineItems:r,attachments:l}=Xl(e,t),a={...n,sheetVersionNumber:n.sheetVersionNumber+1,sheetVersionHash:ny(n,r,l),updatedAt:fn()};return{...e,sheets:{...e.sheets,[t]:a}}},es=(e,t,n,r,l,a,i,o)=>{const c=e.sheets[t];if(!c)return e;const u=sa("fae"),f={id:u,sheetId:t,actorUserId:n,actorRole:r,eventType:l,eventAt:fn(),entityType:a,entityId:i??null,diffJson:o,sheetVersionNumberAtEvent:c.sheetVersionNumber,sheetVersionHashAtEvent:c.sheetVersionHash};return{...e,auditEvents:{...e.auditEvents,[u]:f}}},ry=e=>{const t=wt(),n=sa("fes"),r=fn(),l={id:n,caseId:e.caseId,insurerId:e.insurerId??null,insurerName:e.insurerName??null,periodStart:e.periodStart??null,periodEnd:e.periodEnd??null,periodLabel:e.periodLabel??null,versionIndex:e.versionIndex,status:"DRAFT",archivedReason:null,currency:e.currency||"ILS",deductibleAmount:e.deductibleAmount??null,alreadyPaidAmount:e.alreadyPaidAmount??null,infoOnly:!!e.infoOnly,attachedToReportId:null,attachedAt:null,createdByUserId:e.createdByUserId,createdAt:r,updatedAt:r,readyAt:null,sheetVersionNumber:1,sheetVersionHash:"",insurerRulesetId:e.insurerRulesetId??null,insurerRulesetVersion:e.insurerRulesetVersion??null};let a={...t,sheets:{...t.sheets,[n]:l}};return a=Zn(a,n),a=es(a,n,e.createdByUserId,"FINANCE","SHEET_CREATED","SHEET",n,{caseId:e.caseId,insurerId:e.insurerId??null,insurerName:e.insurerName??null}),Pn(a),a.sheets[n]},ly=e=>{let t=wt();const n=t.sheets[e.sheetId];if(!n)return console.warn("updateFinancialExpenseSheetMeta: sheet not found",e.sheetId),null;const r={...n,...e.patch,updatedAt:fn()};t={...t,sheets:{...t.sheets,[e.sheetId]:r}};const l={};return Object.keys(e.patch).forEach(a=>{const i=n[a],o=r[a];i!==o&&(l[a]={before:i,after:o})}),t=Zn(t,e.sheetId),t=es(t,e.sheetId,e.actorUserId,e.actorRole,"SHEET_META_UPDATED","SHEET",e.sheetId,Object.keys(l).length?l:void 0),Pn(t),t.sheets[e.sheetId]},ay=e=>{let t=wt();if(!t.sheets[e.sheetId])return console.warn("addFinancialExpenseLineItem: sheet not found",e.sheetId),null;const n=sa("fli"),r=fn(),l={id:n,sheetId:e.sheetId,kind:e.kind,expenseType:e.expenseType??null,providerName:e.providerName??null,providerId:e.providerId??null,description:e.description,date:e.date??null,quantity:e.quantity??null,unitPrice:e.unitPrice??null,vatRate:e.vatRate??null,isIncludedInRequestedAmount:e.isIncludedInRequestedAmount??!0,lineNetAmount:e.lineNetAmount??null,lineVatAmount:e.lineVatAmount??null,lineTotalAmount:e.lineTotalAmount??null,attachmentId:e.attachmentId??null,createdAt:r,updatedAt:r};return t={...t,lineItems:{...t.lineItems,[n]:l}},t=Zn(t,e.sheetId),t=es(t,e.sheetId,e.actorUserId,e.actorRole,"LINE_ITEM_CREATED","LINE_ITEM",n,{kind:e.kind,description:e.description,amount:e.lineTotalAmount??null}),Pn(t),l},iy=e=>{let t=wt();const n=t.lineItems[e.lineItemId];if(!n||n.sheetId!==e.sheetId)return console.warn("updateFinancialExpenseLineItem: line item not found",e.lineItemId),null;const r={...n,...e.patch,updatedAt:fn()};t={...t,lineItems:{...t.lineItems,[e.lineItemId]:r}};const l={};return Object.keys(e.patch).forEach(a=>{const i=n[a],o=r[a];i!==o&&(l[a]={before:i,after:o})}),t=Zn(t,e.sheetId),t=es(t,e.sheetId,e.actorUserId,e.actorRole,"LINE_ITEM_UPDATED","LINE_ITEM",e.lineItemId,Object.keys(l).length?l:void 0),Pn(t),t.lineItems[e.lineItemId]},oy=e=>{let t=wt();const n=t.lineItems[e.lineItemId];if(!n||n.sheetId!==e.sheetId)return console.warn("deleteFinancialExpenseLineItem: line item not found",e.lineItemId),!1;const{[e.lineItemId]:r,...l}=t.lineItems;return t={...t,lineItems:l},t=Zn(t,e.sheetId),t=es(t,e.sheetId,e.actorUserId,e.actorRole,"LINE_ITEM_DELETED","LINE_ITEM",e.lineItemId,{deleted:r}),Pn(t),!0},cy=e=>{let t=wt();if(!t.sheets[e.sheetId])return console.warn("addFinancialExpenseAttachment: sheet not found",e.sheetId),null;const n=sa("fat"),r=fn(),l={id:n,sheetId:e.sheetId,fileKey:e.fileKey,originalFileName:e.originalFileName,mimeType:e.mimeType??null,sizeBytes:e.sizeBytes??null,uploadedByUserId:e.uploadedByUserId,uploadedAt:r,linkedLineItemId:e.linkedLineItemId??null};return t={...t,attachments:{...t.attachments,[n]:l}},t=Zn(t,e.sheetId),t=es(t,e.sheetId,e.uploadedByUserId,"FINANCE","ATTACHMENT_ADDED","ATTACHMENT",n,{fileKey:e.fileKey,originalFileName:e.originalFileName}),Pn(t),l},dy=e=>{let t=wt();const n=t.attachments[e.attachmentId];if(!n||n.sheetId!==e.sheetId)return console.warn("linkAttachmentToLineItem: attachment not found",e.attachmentId),null;const r=n.linkedLineItemId??null,l={...n,linkedLineItemId:e.lineItemId};if(t={...t,attachments:{...t.attachments,[e.attachmentId]:l}},e.lineItemId){const a=t.lineItems[e.lineItemId];a&&(t={...t,lineItems:{...t.lineItems,[e.lineItemId]:{...a,attachmentId:e.attachmentId,updatedAt:fn()}}})}else if(r){const a=t.lineItems[r];a&&a.attachmentId===e.attachmentId&&(t={...t,lineItems:{...t.lineItems,[r]:{...a,attachmentId:null,updatedAt:fn()}}})}return t=Zn(t,e.sheetId),t=es(t,e.sheetId,e.actorUserId,e.actorRole,"ATTACHMENT_LINKED","ATTACHMENT",e.attachmentId,{before:r,after:e.lineItemId}),Pn(t),t.attachments[e.attachmentId]},uy=e=>{let t=wt();const n=t.sheets[e.sheetId];if(!n)return console.warn("recordSheetReadyAttempt: sheet not found",e.sheetId),null;let r=n;if(e.success){const l=fn();r={...n,status:"READY_FOR_REPORT",readyAt:l,updatedAt:l,insurerRulesetId:e.decisionLog.rulesetId??n.insurerRulesetId??null,insurerRulesetVersion:e.decisionLog.rulesetVersion??n.insurerRulesetVersion??null},t={...t,sheets:{...t.sheets,[e.sheetId]:r}},t=Zn(t,e.sheetId)}return t=es(t,e.sheetId,e.actorUserId,e.actorRole,"SHEET_READY_ATTEMPT","SHEET",e.sheetId,{success:e.success,decisionLog:e.decisionLog}),Pn(t),t.sheets[e.sheetId]},my=e=>{let t=wt();const n=t.sheets[e.sheetId];if(!n||n.status!=="READY_FOR_REPORT")return n||null;const r=fn(),l={...n,status:"DRAFT",readyAt:null,updatedAt:r};return t={...t,sheets:{...t.sheets,[e.sheetId]:l}},t=Zn(t,e.sheetId),t=es(t,e.sheetId,e.actorUserId,e.actorRole,"SHEET_REVERTED_TO_DRAFT","SHEET",e.sheetId,{from:"READY_FOR_REPORT",to:"DRAFT"}),Pn(t),t.sheets[e.sheetId]},fy=(e,t)=>{const n=wt(),r=Object.values(n.sheets),l=new Map;t.forEach(o=>{l.set(o.id,o)});const a=r.map(o=>{var E,P;const{lineItems:c}=Xl(n,o.id),u=Qn(o,c),f=o.attachedToReportId?l.get(o.attachedToReportId):void 0,p=Object.values(n.auditEvents).filter(x=>x.sheetId===o.id&&x.diffJson&&x.diffJson.decisionLog);p.sort((x,h)=>new Date(h.eventAt).getTime()-new Date(x.eventAt).getTime());const g=((P=(E=p[0])==null?void 0:E.diffJson)==null?void 0:P.decisionLog)||null,S=g!=null&&g.blockingIssueCodes&&Array.isArray(g.blockingIssueCodes)?g.blockingIssueCodes:void 0,A=(f==null?void 0:f.expensesSheetId)===o.id?!!f.expensesOutOfSync:!1;return{sheetId:o.id,caseId:o.caseId,insurerName:o.insurerName??null,status:o.status,versionIndex:o.versionIndex,updatedAt:o.updatedAt,readyAt:o.readyAt??null,attachedAt:o.attachedAt??null,sentAt:(f==null?void 0:f.sentAt)||null,amountToRequest:u.amountToRequest,infoOnly:o.infoOnly,expensesOutOfSync:A,blockingIssueCodesLatest:S}}),i=o=>{if(!o)return!1;const c=new Date(o).getTime();return!(Number.isNaN(c)||e.dateFrom&&c<new Date(e.dateFrom).getTime()||e.dateTo&&c>new Date(e.dateTo).getTime())};return a.filter(o=>{var c,u;if(e.status&&o.status!==e.status||e.insurerId&&((c=n.sheets[o.sheetId])==null?void 0:c.insurerId)!==e.insurerId||e.insurerName&&!(o.insurerName||"").toLowerCase().includes(e.insurerName.toLowerCase()))return!1;if(e.caseIdOrSearch){const f=e.caseIdOrSearch.toLowerCase();if(!`${o.caseId} ${o.insurerName||""}`.toLowerCase().includes(f))return!1}return!(e.isInfoOnly!=null&&o.infoOnly!==e.isInfoOnly||e.minAmountToRequest!=null&&o.amountToRequest<e.minAmountToRequest||e.maxAmountToRequest!=null&&o.amountToRequest>e.maxAmountToRequest||(e.dateFrom||e.dateTo)&&!i(o.updatedAt)||e.hasMissingAttachments&&!((u=o.blockingIssueCodesLatest)!=null&&u.includes("MISSING_ATTACHMENT_REQUIRED")))}).sort((o,c)=>new Date(c.updatedAt).getTime()-new Date(o.updatedAt).getTime())},py=e=>{const t=wt(),n=Object.values(t.sheets),r=new Map;e.forEach(c=>{r.set(c.id,c)});let l=0,a=0,i=0,o=0;return n.forEach(c=>{c.status==="READY_FOR_REPORT"&&(l+=1),c.status==="ATTACHED_TO_REPORT"&&(a+=1);const u=c.attachedToReportId?r.get(c.attachedToReportId):void 0;(u==null?void 0:u.status)==="SENT"&&(i+=1);const f=(u==null?void 0:u.expensesSheetId)===c.id&&u.expensesOutOfSync===!0,p=Object.values(t.auditEvents).some(g=>{var S;return g.sheetId===c.id&&g.eventType==="SHEET_READY_ATTEMPT"&&((S=g.diffJson)==null?void 0:S.success)===!1});(f||p)&&(o+=1)}),{readyCount:l,attachedCount:a,sentCount:i,exceptionsCount:o}},No=(e,t)=>{if(!e||!t)return null;const n=new Date(e).getTime(),r=new Date(t).getTime();return Number.isNaN(n)||Number.isNaN(r)?null:(r-n)/(1e3*60*60)},vo=e=>e.length?e.reduce((n,r)=>n+r,0)/e.length:null,bo=e=>{if(!e.length)return null;const t=[...e].sort((r,l)=>r-l),n=Math.floor(t.length/2);return t.length%2===0?(t[n-1]+t[n])/2:t[n]},ja=(e,t=5)=>({count:e.length,samples:e.slice(0,t)}),hy=e=>{let t=wt();const n=sa("fexa"),r=fn(),l={id:n,sheetId:e.sheetId,noteType:"EXCEPTION_STATUS",value:e.value,actorUserId:e.actorUserId,createdAt:r};return t={...t,exceptionAnnotations:{...t.exceptionAnnotations,[n]:l}},Pn(t),l},xy=e=>{const t=wt(),n=Object.values(t.exceptionAnnotations).filter(r=>r.sheetId===e&&r.noteType==="EXCEPTION_STATUS");return n.length?(n.sort((r,l)=>new Date(l.createdAt).getTime()-new Date(r.createdAt).getTime()),n[0].value):null},gy=e=>{const t=wt(),n=Object.values(t.sheets),r=new Map;e.forEach(D=>{r.set(D.id,D)});const l=[],a=[],i=[];let o=0,c=0;const u=[],f=[],p=[],g=[],S=3,A=3,E=Date.now(),P=new Map;Object.values(t.auditEvents).forEach(D=>{const $=P.get(D.sheetId)||[];$.push(D),P.set(D.sheetId,$)});const x=[];n.forEach(D=>{const{lineItems:$}=Xl(t,D.id),I=Qn(D,$);if(o+=I.amountToRequest,D.infoOnly&&(c+=1),D.createdAt&&D.readyAt){const G=No(D.createdAt,D.readyAt);G!=null&&l.push(G)}if(D.readyAt&&D.attachedAt){const G=No(D.readyAt,D.attachedAt);G!=null&&a.push(G)}const k=D.attachedToReportId?r.get(D.attachedToReportId):void 0;if(D.attachedAt&&(k!=null&&k.sentAt)){const G=No(D.attachedAt,k.sentAt);G!=null&&i.push(G)}I.amountToRequest>0&&x.push(I.amountToRequest)});let h=0;if(x.length>=5){const D=[...x].sort((I,k)=>I-k),$=Math.floor(D.length*.95)-1;h=D[Math.max(0,$)]}else x.length>0&&(h=Math.max(...x));n.forEach(D=>{var se,ye;const{lineItems:$}=Xl(t,D.id),I=Qn(D,$),k=D.attachedToReportId?r.get(D.attachedToReportId):void 0,G=P.get(D.id)||[],de=G.filter(L=>L.diffJson&&L.diffJson.decisionLog);de.sort((L,le)=>new Date(le.eventAt).getTime()-new Date(L.eventAt).getTime());const ne=((ye=(se=de[0])==null?void 0:se.diffJson)==null?void 0:ye.decisionLog)||null,V=ne!=null&&ne.blockingIssueCodes&&Array.isArray(ne.blockingIssueCodes)?ne.blockingIssueCodes:[];if((k==null?void 0:k.expensesSheetId)===D.id&&k.expensesOutOfSync===!0){const L=new Date(D.updatedAt||D.createdAt).getTime();Number.isNaN(L)||(E-L)/864e5>=S&&u.push({sheetId:D.id,caseId:D.caseId,reason:"DIVERGENCE_OLD",updatedAt:D.updatedAt})}(D.status==="READY_FOR_REPORT"||D.status==="ATTACHED_TO_REPORT")&&V.includes("MISSING_ATTACHMENT_REQUIRED")&&I.amountToRequest>0&&f.push({sheetId:D.id,caseId:D.caseId,reason:"MISSING_ATTACHMENTS",updatedAt:D.updatedAt}),h>0&&I.amountToRequest>=h&&p.push({sheetId:D.id,caseId:D.caseId,reason:"HIGH_AMOUNT",updatedAt:D.updatedAt,amountToRequest:I.amountToRequest});const te=G.filter(L=>{var le;return L.eventType==="SHEET_READY_ATTEMPT"&&((le=L.diffJson)==null?void 0:le.success)===!1}).length;te>=A&&g.push({sheetId:D.id,caseId:D.caseId,reason:"REPEATED_BLOCKS",failedAttempts:te,updatedAt:D.updatedAt})});const b=n.length,M=n.filter(D=>{const $=D.attachedToReportId?r.get(D.attachedToReportId):void 0;return($==null?void 0:$.status)==="SENT"}).length,U=b>0?Number((c/b).toFixed(3)):null,H={draftToReadyAvgHours:vo(l),draftToReadyMedianHours:bo(l),readyToAttachedAvgHours:vo(a),readyToAttachedMedianHours:bo(a),attachedToSentAvgHours:vo(i),attachedToSentMedianHours:bo(i)},W={totalSheets:b,totalSentReports:M,totalAmountRequested:o,infoOnlyRatio:U},O={divergenceOld:ja(u),missingAttachments:ja(f),highAmounts:{threshold:h,...ja(p)},repeatedBlocks:{threshold:A,...ja(g)}};return{sla:H,volumes:W,exceptions:O}},yy=(e,t=10)=>{const n=wt();return Object.values(n.auditEvents).filter(r=>r.sheetId===e).sort((r,l)=>new Date(l.eventAt).getTime()-new Date(r.eventAt).getTime()).slice(0,t)},ol=e=>({actorUserId:e.id,actorRole:e.role}),nt={async listSheets(){return yo()},async getLatestSheetForCase(e){const n=yo().find(r=>r.caseId===e);return n?pm(n.id):null},async isNewFinancialModel(e){return e?(await yo()).some(n=>n.caseId===e):!1},logIfMixedModel(e){if(!!!e.expensesSheetId)return;(e.expensesItems&&e.expensesItems.length>0||!!e.expenseWorksheet||!!e.expensesSum)&&console.error("[FinancialExpenses] Mixed model detected for report",e.id," expensesSheetId is set but legacy expenses fields are also populated.")},async getSheet(e){return pm(e)},async getRulesetForSheet(e){const t=e.insurerRulesetId||e.insurerId||"default",n=sy(t);if(n)return n;const r=new Date().toISOString();return{insurerId:t,policyFamily:"FLEXIBLE",requiredAttachmentTypes:[],requireAttachmentPerLine:!1,requireAttachmentForExpenseTypes:[],amountThresholdRequiringAttachment:null,infoOnlyTextVariant:null,notesInternal:null,rulesetVersion:"default",updatedAt:r}},async createSheet(e,t){const n={...t,createdByUserId:e.id};return ry(n)},async updateSheetMeta(e,t,n){const r={sheetId:t,...ol(e),patch:n};return ly(r)},async addLineItem(e,t,n){const r={...n,sheetId:t,...ol(e)};return ay(r)},async updateLineItem(e,t,n,r){const l={sheetId:t,lineItemId:n,...ol(e),patch:r};return iy(l)},async deleteLineItem(e,t,n){const r={sheetId:t,lineItemId:n,...ol(e)};return oy(r)},async addAttachment(e,t,n){const r={...n,sheetId:t,uploadedByUserId:e.id};return cy(r)},async linkAttachmentToLineItem(e,t,n,r){const l={sheetId:t,attachmentId:n,lineItemId:r,...ol(e)};return dy(l)},async recordReadyAttempt(e,t){const n={...t,actorUserId:e.id,actorRole:e.role};return uy(n)},async revertSheetToDraft(e,t){return my({sheetId:t,actorUserId:e.id,actorRole:e.role})},async listSheetsForLidor(e,t,n){if(e.role!=="ADMIN"&&e.role!=="SUB_ADMIN")throw new Error("Access denied: only ADMIN or SUB_ADMIN can view financial control data.");return fy(t,n)},async getLidorCounts(e,t){if(e.role!=="ADMIN"&&e.role!=="SUB_ADMIN")throw new Error("Access denied: only ADMIN or SUB_ADMIN can view financial control data.");return py(t)},async getLidorKpis(e,t){if(e.role!=="ADMIN"&&e.role!=="SUB_ADMIN")throw new Error("Access denied: only ADMIN or SUB_ADMIN can view financial control data.");return gy(t)},async getExceptionStatusForSheet(e,t){if(e.role!=="ADMIN"&&e.role!=="SUB_ADMIN")throw new Error("Access denied: only ADMIN or SUB_ADMIN can view financial control data.");return xy(t)},async setExceptionStatusForSheet(e,t,n){if(e.role!=="ADMIN"&&e.role!=="SUB_ADMIN")throw new Error("Access denied: only ADMIN or SUB_ADMIN can view financial control data.");return hy({sheetId:t,value:n,actorUserId:e.id})},async getSheetAuditForLidor(e,t,n=10){if(e.role!=="ADMIN"&&e.role!=="SUB_ADMIN")throw new Error("Access denied: only ADMIN or SUB_ADMIN can view financial control data.");return yy(t,n)}},Ny={dashboardTitle:" ",brandName:"Lior Perry",brandSubtitle:"  ",welcomeBack:" ",roleLawyer:"",gettingStartedTitle:" ",gettingStartedBodyLine1:"  .",gettingStartedBodyLine2:"   .          .",gettingStartedStep1:"  ",gettingStartedStep2:" ",gettingStartedStep3:"  ",gettingStartedCta:"  ",searchSectionLabel:" ",searchLabel:" ",searchPlaceholder:"  , ,     ...",statusLabel:"",sortByLabel:" ",sortByUpdated:" ",sortByReportDate:" ",sortByInsured:"",onlyMyCases:"  ",clearFilters:" ",searchByOdakanit:"    ",searchOdakanitPlaceholder:"    ...",noCaseFolderFound:"       .",statsSectionLabel:"  ",statsActiveCases:" ",statsActionRequired:"  ",statsWaitingOnOthers:" ",statsFinanceTasks:"  ",statsDraftsReady:" /  ",caseListTitle:"   ",caseListHeaderTitle:" ",caseListHeaderReportNo:"REPORT NO",caseListHeaderPlaintiff:"PLAINTIFF / CLAIMANT",caseListHeaderInsured:"INSURED",caseListHeaderInsurer:"INSURER",caseListHeaderOdakanit:"  ",caseListStatusAttention:"  ",caseListStatusOpen:"  ",caseListStatusNone:"  ",caseListEmpty:"   .",caseListHintActiveOnly:"(     )",financeBannerTitle:"    ",financeBannerBody:"      .         .",bucketActionRequiredTitle:"  ",bucketActionRequiredDescription:"    .",bucketWaitingTitle:" ",bucketWaitingDescription:"   ,     .",bucketInProgressTitle:"",bucketInProgressDescription:"   .",bucketSentTitle:" / ",bucketSentDescription:"     .",emptyActionRequiredTitle:"    ",emptyActionRequiredDesc:"    ,   .",emptyWaitingTitle:"   ",emptyWaitingDesc:"      .",emptyInProgressTitle:"  ",emptyInProgressDesc:"    .",emptySentTitle:"   ",emptySentDesc:"  ,     .",emptyInProgressCta:"  ",defaultEmptyTitle:"  ",defaultEmptyDescription:"     .",untitledCase:"  ",labelInsured:"",labelPlaintiff:"",labelInsurer:" ",labelFile:" ",labelUpdated:":",labelNextStep:" :",nextStepReview:"  ",nextStepWaitingInvoices:" ",nextStepReadyToSend:" ",nextStepDraft:"  ",nextStepSent:"",nextStepContinue:" ",openContinue:" / ",preview:" ",viewSections:"  ",deleteDraftConfirm:"   ?     .",deleteDraftAria:" ",deleteTitle:"",pin:" ",unpin:" ",alertTimeBreach:" ",alertResponseDelay:" ",openNotificationsAria:" ",openNotificationsTitle:"",openNewCaseFolderAria:"  ",openNewCaseFolderTitle:"  ",openHelpCenterAria:"  ",openHelpCenterTitle:" ",logoutAria:"",logoutTitle:"",workQueuesAria:"  ",expand:"",collapse:"",statusDraft:"",statusActionRequired:" ",statusWaitingInvoices:" ",statusPendingReview:" ",statusApproved:"",statusReadyToSend:" ",statusSent:"",densityLabel:" :",densityComfortable:"",densityCompact:"",resumeLastCase:"   ",resumeLabel:"",internalFile:" ",workloadTitle:"  ",workloadActionLabel:"  ",workloadWaitingLabel:"   ",workloadDraftLabel:" ",financeReportsTitle:" /    ",financeReportsHint:"           .",financeReportsHeaderOdakanit:" ",financeReportsHeaderInsured:"",financeReportsHeaderPlaintiff:"",financeReportsHeaderStatus:" ",financeReportsHeaderUpdated:" ",financeReportsEmpty:"     .",focusModeLabel:"    ",tagNewCase:" ",tagOngoingCase:" ",notificationTitle:" ",dailySummary:" ",noNotifications:"  .",clearAll:" ",footerArchiveNote:"      "},me=e=>Ny[e],wo=({label:e,value:t,icon:n,accentClass:r,selected:l,onClick:a})=>{const i=s.jsxs("div",{className:["flex items-center justify-between rounded-2xl border px-4 py-3 shadow-sm transition","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",l?"border-lpBlue bg-blue-50/80":"border-gray-200 bg-white hover:bg-gray-50"].join(" "),children:[s.jsxs("div",{children:[s.jsx("p",{className:["text-[11px] uppercase tracking-wide",l?"font-bold text-gray-800":"font-semibold text-gray-500"].join(" "),children:e}),s.jsx("p",{className:"mt-1 text-xl font-bold text-gray-900",children:t})]}),s.jsx("div",{className:["inline-flex h-9 w-9 items-center justify-center rounded-full",r].join(" "),"aria-hidden":"true",children:n})]});return a?s.jsx("button",{type:"button",onClick:a,className:"w-full text-left",children:i}):i},vy=({activeCases:e,actionRequired:t,waitingOnOthers:n,draftsAndReady:r,financeTasks:l,selectedFilter:a,onChangeFilter:i})=>{const o=c=>{i&&i(a===c?null:c)};return s.jsxs("section",{"aria-label":me("statsSectionLabel"),className:"mb-6 grid gap-4 sm:grid-cols-3 lg:grid-cols-3",children:[s.jsx(wo,{label:me("statsFinanceTasks"),value:l,icon:s.jsx(ag,{className:"h-4 w-4 text-emerald-700"}),accentClass:"bg-emerald-50",selected:a==="FINANCE",onClick:()=>o("FINANCE")}),s.jsx(wo,{label:me("statsWaitingOnOthers"),value:n,icon:s.jsx(rg,{className:"h-4 w-4 text-yellow-600"}),accentClass:"bg-yellow-50",selected:a==="WAITING",onClick:()=>o("WAITING")}),s.jsx(wo,{label:me("statsDraftsReady"),value:r,icon:s.jsx(pi,{className:"h-4 w-4 text-emerald-600"}),accentClass:"bg-emerald-50",selected:a==="DRAFTS",onClick:()=>o("DRAFTS")})]})};me("statusDraft"),me("statusActionRequired"),me("statusWaitingInvoices"),me("statusPendingReview"),me("statusApproved"),me("statusReadyToSend"),me("statusSent");const cl=e=>(e||"").trim().toLowerCase(),So=e=>{const t=(e.odakanitNo||"").trim();if(t)return`odakanit:${t}`;const n=[`umr:${cl(e.marketRef)}`,`line:${cl(e.lineSlipNo)}`,`cert:${cl(e.certificateRef)}`,`insured:${cl(e.insuredName)}`,`plaintiff:${cl(e.plaintiffName)}`].filter(r=>!r.endsWith(":"));return n.length?n.join("|"):`id:${e.id}`},by=24*60*60*1e3,wy=e=>{const t=e.updatedAt||e.reportDate;if(!t)return null;const n=new Date(t).getTime();return Number.isFinite(n)?n:null},Sy=e=>{const t=wy(e);return!t||(Date.now()-t)/by<=3?null:e.status==="DRAFT"?me("alertResponseDelay"):e.status==="WAITING_FOR_INVOICES"||e.status==="READY_TO_SEND"?me("alertTimeBreach"):null},jy=e=>e.status==="TASK_ASSIGNED"||e.status==="PENDING_REVIEW"||e.status==="READY_TO_SEND",Ey=me("brandName"),Iy=me("brandSubtitle"),Ty={DRAFT:me("statusDraft"),TASK_ASSIGNED:me("statusActionRequired"),WAITING_FOR_INVOICES:me("statusWaitingInvoices"),PENDING_REVIEW:me("statusPendingReview"),APPROVED:me("statusApproved"),READY_TO_SEND:me("statusReadyToSend"),SENT:me("statusSent")},hm=e=>e==="TASK_ASSIGNED"||e==="PENDING_REVIEW"?"ACTION_REQUIRED":e==="WAITING_FOR_INVOICES"?"WAITING_ON_OTHERS":e==="READY_TO_SEND"?"IN_PROGRESS":e==="SENT"?"SENT_COMPLETED":"IN_PROGRESS",jo=e=>`lp_pins:${e}`,Ay=e=>`lp_dashboard_density:${e}`,ky="lp_current_report",xm=e=>`lp_pins_migrated:${e}`,Ry=({user:e,reports:t,caseFolders:n,notifications:r,showNotifications:l,setShowNotifications:a,onClearNotifications:i,dailySummaryOptIn:o,setDailySummaryOptIn:c,archiveAfterMs:u,onSelectReport:f,onNewReport:p,onOpenCaseFolder:g,onLogout:S,deleteReportById:A})=>{const[E,P]=y.useState(""),[x,h]=y.useState("ALL"),[b,M]=y.useState(!0),[U,H]=y.useState(null),[W,O]=y.useState("UPDATED"),[D,$]=y.useState(()=>{if(typeof window>"u")return[];try{const z=window.localStorage.getItem(jo(e.id)),we=z?JSON.parse(z):[];return Array.isArray(we)?we.filter(ve=>typeof ve=="string"):[]}catch{return[]}}),[I,k]=y.useState(()=>{if(typeof window>"u")return"COMFORTABLE";try{return window.localStorage.getItem(Ay(e.id))==="COMPACT"?"COMPACT":"COMFORTABLE"}catch{return"COMFORTABLE"}}),G=Date.now(),de=u??Number.MAX_SAFE_INTEGER,[ne,V]=y.useState(!1),[K,R]=y.useState({}),te=y.useMemo(()=>r.filter(z=>!z.targetUserId||z.targetUserId===e.id),[r,e.id]),{mine:se,buckets:ye,filteredReports:L}=y.useMemo(()=>{const z=t.filter(Fe=>!Fe.deletedAt),we=z.filter(Fe=>Fe.createdBy===e.id),ve=b?we:z,ue=x==="ALL"?ve:ve.filter(Fe=>Fe.status===x),je=U==="FINANCE"?ue.filter(Fe=>!!Fe.expensesSheetId):ue,be=(()=>{const Fe=E.trim().toLowerCase();return Fe?je.filter(Ye=>[Ye.odakanitNo,Ye.insuredName,Ye.plaintiffName,Ye.insurerName,Ye.marketRef].filter(Boolean).join(" ").toLowerCase().includes(Fe)):je})(),Oe=ne?be.filter(Fe=>jy(Fe)||!!Sy(Fe)):be,Xe={ACTION_REQUIRED:[],WAITING_ON_OTHERS:[],IN_PROGRESS:[],SENT_COMPLETED:[]};return Oe.forEach(Fe=>{const Ye=hm(Fe.status);Xe[Ye].push(Fe)}),{mine:we,buckets:Xe,filteredReports:Oe}},[t,e.id,E,x,b,ne,G,de,U]),le=y.useMemo(()=>{const z=new Set;let we=0,ve=0,ue=0,je=0;return se.forEach(be=>{be.status!=="SENT"&&(ve+=1,z.add(So(be))),hm(be.status)==="ACTION_REQUIRED"&&(we+=1),be.status==="READY_TO_SEND"&&(ue+=1),be.expensesSheetId&&be.status!=="SENT"&&(je+=1)}),{activeCasesCount:z.size,actionRequiredCount:we,draftsInWorkCount:ve,readyToSendCount:ue,financeTasksCount:je}},[se]),{activeCasesCount:Ie,actionRequiredCount:Ae,draftsInWorkCount:Le,readyToSendCount:Te,financeTasksCount:he}=le,et=y.useMemo(()=>se.filter(z=>z.status==="WAITING_FOR_INVOICES").length,[se]),q=se.filter(z=>!!z.expensesSheetId&&z.status!=="SENT");y.useEffect(()=>{const we=Array.from(new Set(q.map(ve=>ve.expensesSheetId).filter(ve=>!!ve))).filter(ve=>!K[ve]);we.length&&we.forEach(ve=>{(async()=>{try{const ue=await nt.getSheet(ve);if(!ue)return;const je=Qn(ue.sheet,ue.lineItems);R(be=>({...be,[ve]:je}))}catch{}})()})},[q,K]);const F=y.useMemo(()=>{const z=new Map,we=ue=>{const je=hi(ue);if(!je)return"";const be=je.split(" - ");return be.length<=2?je:be[be.length-2]||je};return se.forEach(ue=>{var We;if(!ue.odakanitNo)return;const je=ue.odakanitNo.trim();if(!je)return;const be=z.get(je)||{odakanitNo:je,insuredName:ue.insuredName||void 0,plaintiffName:ue.plaintiffName||void 0,insurerName:ue.insurerName||void 0,latestUpdatedAt:null,latestReportTitle:void 0,latestReportNumber:void 0,hasOpenWork:!1,hasUrgentWork:!1},Oe=ue.updatedAt||ue.reportDate,Xe=Oe&&new Date(Oe).getTime()||0,Fe=be.latestUpdatedAt&&new Date(be.latestUpdatedAt).getTime()||0;Xe>=Fe&&(be.latestUpdatedAt=Oe||be.latestUpdatedAt||null,be.insuredName=ue.insuredName||be.insuredName,be.plaintiffName=ue.plaintiffName||be.plaintiffName,be.insurerName=ue.insurerName||be.insurerName,be.latestReportTitle=we(ue),be.latestReportNumber=(((We=ue.reportHistory)==null?void 0:We.length)||0)+1),ue.status!=="SENT"&&!ue.deletedAt&&(be.hasOpenWork=!0),(ue.status==="TASK_ASSIGNED"||ue.status==="WAITING_FOR_INVOICES"||ue.status==="PENDING_REVIEW"||ue.status==="READY_TO_SEND")&&(be.hasUrgentWork=!0),z.set(je,be)}),Array.from(z.values()).filter(ue=>ue.hasOpenWork).sort((ue,je)=>{const be=ue.latestUpdatedAt&&new Date(ue.latestUpdatedAt).getTime()||0;return(je.latestUpdatedAt&&new Date(je.latestUpdatedAt).getTime()||0)-be})},[se]);y.useMemo(()=>new Set(D),[D]);const Ne=z=>{f(z.id)},xe=z=>{const we=U===z?null:z;switch(H(we),we){case"ACTION":h("TASK_ASSIGNED");break;case"WAITING":h("WAITING_FOR_INVOICES");break;case"DRAFTS":h("READY_TO_SEND");break;case"FINANCE":h("ALL");break;case"ACTIVE":h("ALL");break;default:h("ALL");break}};x!=="ALL"||E.trim(),y.useEffect(()=>{if(!l)return;const z=we=>{we.key==="Escape"&&a(!1)};return window.addEventListener("keydown",z),()=>window.removeEventListener("keydown",z)},[l,a]),y.useEffect(()=>{if(typeof window>"u"||!t.length)return;const z=xm(e.id);if(window.localStorage.getItem(z)!=="1")try{const ve=window.localStorage.getItem(jo(e.id));if(!ve){window.localStorage.setItem(z,"1");return}const ue=JSON.parse(ve);if(!Array.isArray(ue)){window.localStorage.setItem(z,"1");return}const je=[],be=Oe=>{Oe&&(je.includes(Oe)||je.push(Oe))};ue.forEach(Oe=>{if(typeof Oe!="string")return;const Xe=Oe.trim();if(!Xe)return;const Fe=Xe.toLowerCase();if(Fe.startsWith("odakanit:")||Fe.startsWith("umr:")||Fe.startsWith("line:")||Fe.startsWith("cert:")||Fe.startsWith("insured:")||Fe.startsWith("plaintiff:")||Fe.startsWith("id:")){be(Xe);return}const We=t.find(mt=>So(mt)===Xe?!0:mt.id===Xe||mt.odakanitNo&&mt.odakanitNo===Xe||mt.marketRef&&mt.marketRef===Xe);be(We?So(We):`odakanit:${Xe}`)}),$(je),window.localStorage.setItem(jo(e.id),JSON.stringify(je)),window.localStorage.setItem(z,"1")}catch{window.localStorage.setItem(xm(e.id),"1")}},[t,e.id]),y.useMemo(()=>{if(!se.length)return null;if(typeof window<"u")try{const we=window.localStorage.getItem(ky),ve=we?se.find(ue=>ue.id===we&&!ue.deletedAt):null;if(ve)return ve}catch{}return[...se].sort((we,ve)=>{const ue=Oe=>{const Xe=Oe.updatedAt||Oe.reportDate;return Xe&&new Date(Xe).getTime()||0},je=ue(we);return ue(ve)-je})[0]||null},[se]);const ze=()=>s.jsxs("div",{className:"relative",children:[s.jsxs("button",{type:"button",onClick:()=>a(!l),className:"relative inline-flex h-9 w-9 items-center justify-center rounded-full bg-blue-50 text-xs font-medium text-blue-700 hover:bg-blue-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":me("openNotificationsAria"),title:me("openNotificationsTitle"),children:[s.jsx(mi,{className:"h-4 w-4","aria-hidden":"true"}),te.length>0&&s.jsx("span",{className:"absolute -top-1.5 -right-1.5 inline-flex h-4 min-w-[16px] items-center justify-center rounded-full bg-red-500 px-1 text-[10px] font-bold text-white",children:te.length})]}),l&&s.jsxs("div",{className:"absolute right-0 mt-2 w-80 rounded-lg border border-gray-200 bg-white text-xs shadow-xl z-50",children:[s.jsxs("div",{className:"flex items-center justify-between border-b px-3 py-2",children:[s.jsx("span",{className:"font-semibold text-gray-800",children:me("notificationTitle")}),s.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-gray-500",children:[s.jsx("input",{type:"checkbox",checked:o,onChange:z=>c(z.target.checked),className:"h-3 w-3 rounded border-gray-300 text-lpBlue focus:ring-lpBlue"}),me("dailySummary")]})]}),s.jsxs("div",{className:"max-h-64 overflow-auto divide-y",children:[te.length===0&&s.jsx("div",{className:"p-4 text-center text-gray-400",children:me("noNotifications")}),te.map(z=>s.jsxs("div",{className:"p-3 space-y-1",children:[s.jsx("p",{className:"font-medium text-gray-800",children:z.message}),s.jsx("p",{className:"text-[10px] text-gray-400",children:new Date(z.createdAt).toLocaleString()}),z.reportId&&s.jsx("button",{type:"button",className:"mt-1 text-[11px] text-blue-700 hover:underline",onClick:()=>{f(z.reportId),a(!1)},children:"  "})]},z.id))]}),s.jsx("div",{className:"px-3 py-2 text-right",children:s.jsx("button",{type:"button",onClick:i,className:"text-[11px] font-medium text-red-500 hover:underline",children:me("clearAll")})})]})]}),[_,X]=y.useState(""),[fe,ge]=y.useState(!1),[Z,re]=y.useState(-1),pe=y.useMemo(()=>{const z=_.trim();if(!z)return[];const we=z.toLowerCase(),ve=Object.values(n),ue=ve.filter(Oe=>Oe.odakanitNo.toLowerCase().startsWith(we)),je=ve.filter(Oe=>!Oe.odakanitNo.toLowerCase().startsWith(we)&&Oe.odakanitNo.toLowerCase().includes(we));return[...ue,...je].slice(0,8).map(Oe=>({odakanitNo:Oe.odakanitNo,insuredName:Oe.insuredName,plaintiffName:Oe.plaintiffName}))},[_,n]);return y.useEffect(()=>{if(!_.trim()){ge(!1),re(-1);return}pe.length>0?(ge(!0),re(0)):(ge(!1),re(-1))},[_,pe.length]),s.jsx("div",{className:"min-h-screen bg-gray-100 px-0 pb-6 text-[15px]",dir:"rtl",lang:"he",children:s.jsxs("div",{className:"mx-auto max-w-6xl px-4",children:[s.jsxs("header",{className:"sticky top-0 z-20 mb-4 flex flex-col gap-3 border-b border-gray-200 bg-white/80 pb-3 pt-2 backdrop-blur-sm md:flex-row md:items-center md:justify-between",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-lpBlue font-heebo",children:me("dashboardTitle")}),s.jsxs("p",{className:"text-base text-gray-600 text-right",children:[s.jsx("span",{className:"font-semibold",children:Ey})," ",s.jsx("span",{className:"text-gray-500",children:Iy}),s.jsx("span",{className:"text-gray-400",children:"  "}),me("welcomeBack"),","," ",s.jsx("span",{className:"font-semibold",children:e.name})," ",s.jsxs("span",{className:"text-gray-500",children:["(",me("roleLawyer"),")"]})]})]}),s.jsxs("div",{className:"flex flex-wrap items-center justify-start gap-2 md:justify-end",children:[s.jsx("button",{type:"button",onClick:p,className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-lpBlue text-sm font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":me("openNewCaseFolderAria"),title:me("openNewCaseFolderTitle"),children:s.jsx(wd,{className:"h-4 w-4","aria-hidden":"true"})}),ze(),s.jsx("button",{type:"button",className:"inline-flex h-9 w-9 items-center justify-center rounded-full bg-blue-50 text-sm font-medium text-blue-700 hover:bg-blue-100 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",onClick:()=>{const z=new CustomEvent("openUserGuide");window.dispatchEvent(z)},"aria-label":me("openHelpCenterAria"),title:me("openHelpCenterTitle"),children:s.jsx(Nd,{className:"h-4 w-4","aria-hidden":"true"})}),s.jsx("button",{type:"button",onClick:S,className:"inline-flex h-9 w-9 items-center justify-center rounded-full text-sm font-semibold text-red-600 hover:bg-red-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-red-500 focus-visible:ring-offset-2","aria-label":me("logoutAria"),title:me("logoutTitle"),children:s.jsx(Up,{className:"h-4 w-4","aria-hidden":"true"})})]})]}),!1,s.jsxs("section",{className:"mb-3 rounded-2xl border border-gray-200 bg-white px-4 py-3 text-xs text-gray-700 shadow-sm",children:[s.jsx("h2",{className:"mb-1 text-sm font-semibold text-gray-900",children:me("workloadTitle")}),s.jsxs("div",{className:"flex flex-wrap gap-3 text-[11px] text-gray-700 mb-2",children:[s.jsxs("span",{children:[he," ",me("statsFinanceTasks")]}),s.jsxs("span",{children:[et," ",me("statsWaitingOnOthers")]}),s.jsxs("span",{children:[Te," ",me("statsDraftsReady")]})]}),s.jsx("div",{className:"max-h-40 overflow-y-auto rounded-xl border border-dashed border-gray-200 bg-gray-50 px-3 py-2",children:se.filter(z=>z.status!=="SENT").length===0?s.jsx("p",{className:"text-[11px] text-gray-500",children:me("emptyInProgressTitle")}):s.jsx("ul",{className:"space-y-1 text-[11px]",children:se.filter(z=>z.status!=="SENT").sort((z,we)=>{const ve=ue=>{const je=ue.updatedAt||ue.reportDate;return je&&new Date(je).getTime()||0};return ve(we)-ve(z)}).map(z=>s.jsxs("li",{className:"flex items-center justify-between gap-2 border-b border-gray-200/70 pb-1 last:border-b-0",children:[s.jsxs("button",{type:"button",onClick:()=>Ne(z),className:"flex-1 text-right hover:text-lpBlue",children:[s.jsx("span",{className:"font-semibold",children:z.insuredName||z.plaintiffName||me("untitledCase")}),z.odakanitNo&&s.jsxs("span",{className:"text-gray-500",children:["  ",z.odakanitNo]})]}),s.jsx("span",{className:"whitespace-nowrap text-[10px] text-gray-500",children:Ty[z.status]})]},z.id))})})]}),!1,s.jsxs("section",{className:"mb-3 rounded-2xl border border-gray-200 bg-white px-4 py-3 text-xs text-gray-800 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:me("caseListTitle")}),s.jsxs("span",{className:"text-[11px] text-gray-500",children:[F.length," ",me("statsActiveCases")]})]}),s.jsx("p",{className:"mb-2 text-[11px] text-gray-500",children:me("caseListHintActiveOnly")}),F.length===0?s.jsx("p",{className:"text-[11px] text-gray-500",children:me("caseListEmpty")}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full table-fixed text-[11px]",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-48",children:me("caseListHeaderTitle")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-24",children:me("caseListHeaderReportNo")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:me("caseListHeaderPlaintiff")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:me("caseListHeaderInsured")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:me("caseListHeaderInsurer")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-32",children:me("caseListHeaderOdakanit")})]})}),s.jsx("tbody",{children:F.map((z,we)=>{const ve=z.hasUrgentWork,ue=z.hasOpenWork,je=we%2===0?"bg-white":"bg-gray-50",be=ve?"border-l-4 border-red-400 bg-red-50/80":ue?"border-l-4 border-amber-300 bg-amber-50/70":"border-l border-transparent";return s.jsxs("tr",{className:`cursor-pointer border-b border-gray-100 ${je} ${be}`,onClick:()=>g(z.odakanitNo),children:[s.jsxs("td",{className:"px-2 py-1 text-right",children:[s.jsx("div",{className:"font-semibold text-gray-900",children:z.latestReportTitle||""}),z.latestUpdatedAt&&s.jsx("div",{className:"text-[10px] text-gray-500",children:new Date(z.latestUpdatedAt).toLocaleString("he-IL")})]}),s.jsx("td",{className:"px-2 py-1 text-right font-mono text-[11px]",children:z.latestReportNumber??""}),s.jsx("td",{className:"px-2 py-1 text-right",children:z.plaintiffName||""}),s.jsx("td",{className:"px-2 py-1 text-right",children:z.insuredName||""}),s.jsx("td",{className:"px-2 py-1 text-right",children:z.insurerName||""}),s.jsx("td",{className:"px-2 py-1 text-right font-mono text-[11px]",children:z.odakanitNo})]},z.odakanitNo)})})]})})]}),!1,!1,s.jsx(vy,{activeCases:Ie,actionRequired:Ae,waitingOnOthers:et,draftsAndReady:Te,financeTasks:he,selectedFilter:U,onChangeFilter:xe}),s.jsxs("section",{className:"mb-3 rounded-2xl border border-emerald-100 bg-white px-4 py-3 text-xs text-gray-800 shadow-sm",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:me("financeReportsTitle")}),s.jsx("span",{className:"text-[11px] text-gray-500",children:he})]}),s.jsx("p",{className:"mb-2 text-[11px] text-gray-500",children:me("financeReportsHint")}),q.length===0?s.jsx("p",{className:"text-[11px] text-gray-500",children:me("financeReportsEmpty")}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full table-fixed text-[11px]",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-200 bg-gray-50",children:[s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-48",children:me("caseListHeaderTitle")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-20",children:me("caseListHeaderReportNo")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:me("caseListHeaderPlaintiff")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:me("caseListHeaderInsured")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:me("caseListHeaderInsurer")}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-32",children:me("caseListHeaderOdakanit")})]})}),s.jsx("tbody",{children:q.slice().sort((z,we)=>{const ve=ue=>{const je=ue.updatedAt||ue.reportDate;return je&&new Date(je).getTime()||0};return ve(we)-ve(z)}).map(z=>{var be;const we=hi(z),ve=we.split(" - "),ue=ve.length>2&&ve[ve.length-2]||we,je=(((be=z.reportHistory)==null?void 0:be.length)||0)+1;return s.jsxs("tr",{className:"cursor-pointer border-b border-gray-100 hover:bg-emerald-50/60",onClick:()=>{z.odakanitNo?g(z.odakanitNo):Ne(z)},children:[s.jsxs("td",{className:"px-2 py-1 text-right",children:[s.jsx("div",{className:"font-semibold text-gray-900",children:ue||""}),z.updatedAt&&s.jsx("div",{className:"text-[10px] text-gray-500",children:new Date(z.updatedAt).toLocaleString("he-IL")})]}),s.jsx("td",{className:"px-2 py-1 text-right font-mono text-[11px]",children:je}),s.jsx("td",{className:"px-2 py-1 text-right",children:z.plaintiffName||""}),s.jsx("td",{className:"px-2 py-1 text-right",children:z.insuredName||""}),s.jsx("td",{className:"px-2 py-1 text-right",children:z.insurerName||""}),s.jsx("td",{className:"px-2 py-1 text-right font-mono text-[11px]",children:z.odakanitNo||""})]},z.id)})})]})})]}),!1]})})},Ea={title:"    ",subtitle:"     ,    ",actions:{openNewReport:"  "},queueItem:{noDate:" "}},Ld=(e,t)=>{console.error(`[LP-CRM] ${e}`,t)},Cy=e=>{if(!e)return!1;const t=new Date(e);return Number.isNaN(t.getTime())?!1:t.getTime()>Date.now()},An=e=>{const{messageHe:t,...n}=e;return t?{...n,messageHe:t}:{...n,messageHe:{MISSING_PROVIDER:"    .",MISSING_DESCRIPTION:"  .",INVALID_DATE_FUTURE:"     .",INVALID_QUANTITY:"     -0.",INVALID_UNIT_PRICE:"     .",INVALID_VAT_RATE:"     .",NEGATIVE_AMOUNT:"     .",MISSING_ATTACHMENT_REQUIRED:"      .",SHEET_STATUS_INVALID_FOR_READY:"     -READY_FOR_REPORT.",SHEET_STATUS_INVALID_FOR_ATTACH:"     .",SHEET_STATUS_INVALID_FOR_SEND:"    .",SUMS_INCONSISTENT:"     .",INFO_ONLY_INCONSISTENT:'  " "     0.',SNAPSHOT_HASH_MISMATCH:"-Hash        ."}[n.code]||"  ."}},Dy=(e,t,n)=>{const r=n.filter(u=>u.severity==="ERROR").map(u=>u.code),l=n.filter(u=>u.severity==="WARNING").map(u=>u.code),a=!n.some(u=>u.code==="SUMS_INCONSISTENT"),i=!n.some(u=>u.code==="MISSING_ATTACHMENT_REQUIRED"&&u.severity==="ERROR"),o=!n.some(u=>["MISSING_PROVIDER","MISSING_DESCRIPTION"].includes(u.code)),c=!n.some(u=>u.code==="INFO_ONLY_INCONSISTENT");return{evaluatedAt:new Date().toISOString(),insurerId:e.insurerId||void 0,rulesetId:t==null?void 0:t.insurerId,rulesetVersion:t==null?void 0:t.rulesetVersion,checks:{sumsValid:a,attachmentsOk:i,requiredFieldsOk:o,infoOnlyConsistent:c},blockingIssueCodes:r,warningIssueCodes:l}},Ly=e=>{const t=[];return e.kind==="EXPENSE"&&!e.providerName&&t.push(An({code:"MISSING_PROVIDER",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),e.description||t.push(An({code:"MISSING_DESCRIPTION",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),Cy(e.date)&&t.push(An({code:"INVALID_DATE_FUTURE",severity:"WARNING",scope:"LINE_ITEM",entityId:e.id})),e.quantity!=null&&e.quantity<=0&&t.push(An({code:"INVALID_QUANTITY",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),e.unitPrice!=null&&e.unitPrice<0&&t.push(An({code:"INVALID_UNIT_PRICE",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),e.vatRate!=null&&e.vatRate<0&&t.push(An({code:"INVALID_VAT_RATE",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),[e.lineNetAmount,e.lineVatAmount,e.lineTotalAmount].filter(r=>r!=null).some(r=>r<0)&&t.push(An({code:"NEGATIVE_AMOUNT",severity:"ERROR",scope:"LINE_ITEM",entityId:e.id})),t},_y=(e,t,n,r)=>{if(!r)return[];const l=[],a={};n.forEach(o=>{a[o.id]=o});const i=r.amountThresholdRequiringAttachment??null;return t.forEach(o=>{const c=o.isIncludedInRequestedAmount!==!1,u=!!(o.attachmentId&&a[o.attachmentId]),f=o.lineTotalAmount??0;let p=!1;if(r.policyFamily==="STRICT")c&&o.kind==="EXPENSE"&&(!i||f>=i)&&(p=!0);else if(r.policyFamily==="PARTIAL"){const g=!!o.expenseType&&r.requireAttachmentForExpenseTypes.includes(o.expenseType),S=!!i&&f>=i;c&&(g||S)&&(p=!0)}else r.policyFamily==="FLEXIBLE"&&c&&o.kind==="EXPENSE"&&(!i||f>=i)&&(p=!0);if(p&&!u){const g=r.policyFamily==="FLEXIBLE"?"WARNING":"ERROR";l.push(An({code:"MISSING_ATTACHMENT_REQUIRED",severity:g,scope:"LINE_ITEM",entityId:o.id,messageHe:g==="ERROR"?"      .":"       ."}))}}),r.requiredAttachmentTypes.length>0&&l.push(An({code:"ATTACHMENT_TYPES_NOT_ENFORCED",severity:"INFO",scope:"SHEET",messageHe:"     ,      ."})),e.infoOnly&&l.length&&r.policyFamily,l},Oy=e=>{const{sheet:t,lineItems:n,attachments:r,ruleset:l}=e,a=[];n.forEach(c=>{a.push(...Ly(c))});const i=Qn(t,n);t.infoOnly&&i.amountToRequest!==0&&a.push(An({code:"INFO_ONLY_INCONSISTENT",severity:"ERROR",scope:"SHEET"})),a.push(..._y(t,n,r,l));const o=Dy(t,l,a);return{issues:a,decisionLog:o}},gm=e=>Oy(e),Py=e=>{if(!e)return"";const t=new Date(e);if(Number.isNaN(t.getTime()))return"";const n=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),l=t.getFullYear();return`${n}/${r}/${l}`},Bn=e=>(e??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),$a=e=>{if(e.lineTotalAmount!=null)return e.lineTotalAmount;const t=e.lineNetAmount!=null?e.lineNetAmount:rh(e.quantity??0,e.unitPrice??0),n=e.lineVatAmount!=null?e.lineVatAmount:lh(t,e.vatRate??0);return ah(t,n)},oh=(e,t)=>{const n=Qn(e,t),r=[`Expenses Table  Case ${e.caseId}`,"",`Deductible: ${Bn(e.deductibleAmount??0)} NIS`,`Payments already made: ${Bn(e.alreadyPaidAmount??0)} NIS`,`Amount to request: ${Bn(n.amountToRequest)} NIS`,"","Expenses:"],l=[],a=[];return t.forEach(o=>{const c=Py(o.date||null),u=o.providerName||"",f=o.description||"",p=o.kind==="EXPENSE"?"Expense":o.kind==="COMPENSATION"?o.compensationSource==="COURT"?"Compensation pursuant to a judgment":"Compensation pursuant to a settlement":"Adjustment",g=Bn($a(o)),S=o.vatRate!=null?`, VAT ${o.vatRate}%`:"",A=o.isIncludedInRequestedAmount===!1?" (not included in request)":"",E=` ${c||"-"}  ${f}${u?` (${u})`:""}  ${g} NIS (${p}${S})${A}`;o.kind==="EXPENSE"?l.push(E):a.push(E)}),l.length||l.push(" No expense items."),{text:[...r,...l,"","Adjustments and compensations:",...a.length?a:[" No adjustments or compensations."],"",`Total gross expenses: ${Bn(n.grossExpensesTotal)} NIS`,`Total deductions (Deductible + Payments already made + adjustments): ${Bn(n.adjustmentsTotal)} NIS`,`Amount to request: ${Bn(n.amountToRequest)} NIS`].join(`
`),totals:n}},My=(e,t)=>{const n=Qn(e,t),r=n.amountToRequest<=0,l=[],a=(P,x,h)=>{const b=h!=null&&h.isTotal?"total-balance-row":h!=null&&h.isSummary?"summary-row":"";l.push(`<tr class="${b}"><td>${Fy(P)}</td><td class="amount-cell">${Bn(x??0)}</td></tr>`)},i=t.filter(P=>P.kind==="EXPENSE"),o=i.reduce((P,x)=>P+$a(x),0),c=e.deductibleAmount??0;i.forEach(P=>{const x=P.providerName?` (${P.providerName})`:"",h=P.description?`${P.description}${x}`:x||"Expense";a(h,$a(P))}),t.filter(P=>P.kind==="COMPENSATION").forEach(P=>{const x=P.compensationSource==="COURT"?"Court-awarded compensation":"Settlement compensation";a(x,$a(P))}),a("Total expenses so far",o,{isSummary:!0}),a("Deductible",c,{isSummary:!0}),a("Payments already made",e.alreadyPaidAmount??0,{isSummary:!0}),a(r?"Total Balance Due (no payment requested)":"Total Balance Due",n.amountToRequest,{isTotal:!0});const f=['<div class="expenses-table-wrapper">','<table class="expenses-table">',"<thead>",'<tr><th>Expenses</th><th class="amount-cell">Amount ()</th></tr>',"</thead>","<tbody>",...l,"</tbody>","</table>","</div>"].join(""),p=t.some(P=>P.kind==="COMPENSATION"&&P.compensationSource!=="COURT"),g=t.some(P=>P.kind==="COMPENSATION"&&P.compensationSource==="COURT"),S=`${Bn(n.amountToRequest)}`;let A;return g?A='<p class="expenses-payment-note">Pursuant to the judgment rendered in this matter, we kindly request that the Insurer arrange payment of the total amount set out in the attached Expenses Table, in order to bring this claim to a conclusion.<br/><br/><strong>Payment is required within 30 days of receipt of this report.</strong></p>':p?r?A='<p class="expenses-payment-note">Although a settlement has been agreed in principle, the total expenses and compensation fall within the applicable deductible. Accordingly, no payment is required from the Insurer in respect of this claim.</p>':A=`<p class="expenses-payment-note">Should the Insurer approve the settlement, we would be obliged if the Insurer could arrange payment of ${S} to the Brokers bank account in order to bring this claim to a conclusion. This amount represents an all-inclusive settlement, covering both the agreed compensation and the associated expenses. In the event that the settlement is not approved, no payment is required at this stage.</p>`:A=r?'<p class="expenses-payment-note">Given that the deductible exceeds the total expenses incurred in this matter, the Insurer is not required to make any payment in respect of this claim.</p>':`<p class="expenses-payment-note">Accordingly, we would appreciate it if the Insurer could transfer the amount of ${S} to the Brokers bank account.</p>`,{html:f+A+'<p class="expenses-payment-note">All amounts are stated in New Israeli Shekels ().</p>',totals:n}},Fy=e=>e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"),By=({open:e,title:t,message:n,confirmText:r,cancelText:l,destructive:a=!1,onConfirm:i,onCancel:o})=>{const c=y.useRef(null);if(y.useEffect(()=>{if(!e)return;const p=g=>{g.key==="Escape"&&(g.stopPropagation(),o())};if(typeof window<"u"&&window.addEventListener("keydown",p),c.current)try{c.current.focus()}catch{}return()=>{typeof window<"u"&&window.removeEventListener("keydown",p)}},[e,o]),!e)return null;const u=p=>{p.target===p.currentTarget&&o()},f=a?"bg-red-600 text-white hover:bg-red-700":"bg-lpBlue text-white hover:bg-blue-800";return s.jsx("div",{className:"fixed inset-0 z-[300] flex items-center justify-center bg-black/30",onClick:u,children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full mx-4 p-5 space-y-3",dir:"rtl",children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900 text-right",children:t}),n&&s.jsx("p",{className:"text-xs text-slate-600 text-right whitespace-pre-line",children:n}),s.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[s.jsx("button",{type:"button",onClick:o,className:"px-3 py-1.5 rounded-md border border-slate-300 text-xs text-slate-700 bg-white hover:bg-slate-50",children:l}),s.jsx("button",{type:"button",ref:c,onClick:i,className:`px-3 py-1.5 rounded-md text-xs font-semibold ${f}`,children:r})]})]})})},$y={DRAFT:"",READY_FOR_REPORT:" ",ATTACHED_TO_REPORT:" ",ARCHIVED:""},ch=({user:e,sheetWithRelations:t,onSheetUpdated:n,onBack:r,onNotifyLawyer:l,linkedReportForLawyer:a})=>{const[i,o]=y.useState(t.sheet),[c,u]=y.useState(t.lineItems),[f,p]=y.useState(!1),[g,S]=y.useState(null),[A,E]=y.useState(null),[P,x]=y.useState([]),[h,b]=y.useState(t.attachments),[M,U]=y.useState(!1),[H,W]=y.useState(""),[O,D]=y.useState([]),[$,I]=y.useState([]),[k,G]=y.useState("AUTO");y.useEffect(()=>{o(t.sheet),u(t.lineItems),b(t.attachments)},[t]);const de=y.useMemo(()=>Qn(i,c),[i,c]),ne=y.useMemo(()=>{const _=new Set;return P.forEach(X=>{X.scope==="LINE_ITEM"&&X.entityId&&_.add(X.entityId)}),_},[P]),V=()=>{const _=gm({sheet:i,lineItems:c,attachments:h,ruleset:void 0});x(_.issues)};y.useEffect(()=>{V()},[i,c]),y.useEffect(()=>{if(!(typeof window>"u"))try{const _=window.localStorage.getItem("financeProviderSuggestions"),X=window.localStorage.getItem("financeDescriptionSuggestions");if(_){const fe=JSON.parse(_);Array.isArray(fe)&&D(fe.filter(ge=>typeof ge=="string"))}if(X){const fe=JSON.parse(X);Array.isArray(fe)&&I(fe.filter(ge=>typeof ge=="string"))}}catch{}},[]),y.useEffect(()=>{if(typeof window>"u")return;const _=new Set(O);let X=!1;if(c.forEach(Z=>{const re=(Z.providerName||"").trim();re&&!_.has(re)&&(_.add(re),X=!0)}),X){const Z=Array.from(_).sort((re,pe)=>re.localeCompare(pe,"he-IL"));D(Z);try{window.localStorage.setItem("financeProviderSuggestions",JSON.stringify(Z))}catch{}}const fe=new Set($);let ge=!1;if(c.forEach(Z=>{const re=(Z.description||"").trim();re&&!fe.has(re)&&(fe.add(re),ge=!0)}),ge){const Z=Array.from(fe).sort((re,pe)=>re.localeCompare(pe,"he-IL"));I(Z);try{window.localStorage.setItem("financeDescriptionSuggestions",JSON.stringify(Z))}catch{}}},[c]);const K=_=>{o(X=>({...X,..._}))},R=(_,X)=>{u(fe=>{const ge=[...fe];return ge[_]={...ge[_],...X,sheetId:i.id},ge})},te=()=>{const _={id:`tmp-${Date.now()}`,sheetId:i.id,kind:"EXPENSE",expenseType:null,providerName:"",providerId:null,description:"",date:new Date().toISOString().slice(0,10),quantity:1,unitPrice:0,vatRate:18,isIncludedInRequestedAmount:!0,lineNetAmount:null,lineVatAmount:null,lineTotalAmount:null,attachmentId:null,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};u(X=>[...X,_])},se=_=>{const X=c[_];X&&(u(fe=>fe.filter((ge,Z)=>Z!==_)),X.id.startsWith("tmp-")||nt.deleteLineItem(e,i.id,X.id))},ye=async _=>{const X=Array.from(_);if(X.length)for(let fe=0;fe<X.length;fe++){const ge=X[fe],Z=new FileReader,re=await new Promise((z,we)=>{Z.onload=()=>z(String(Z.result)),Z.onerror=()=>we(Z.error),Z.readAsDataURL(ge)}),pe=await nt.addAttachment(e,i.id,{fileKey:re,originalFileName:ge.name,mimeType:ge.type||"application/octet-stream",sizeBytes:ge.size});pe&&b(z=>[...z,pe])}},L=async _=>{const{files:X}=_.target;!X||!X.length||(await ye(X),_.target.value="")},le=async _=>{_.preventDefault(),_.stopPropagation();const{files:X}=_.dataTransfer;!X||!X.length||await ye(X)},Ie=async(_,X)=>{const fe=await nt.linkAttachmentToLineItem(e,i.id,X||"",X?_.id:null);fe&&(b(ge=>ge.map(Z=>Z.id===fe.id?fe:Z)),u(ge=>ge.map(Z=>Z.id===_.id?{...Z,attachmentId:X||null}:Z.id===_.attachmentId&&!X?{...Z,attachmentId:null}:Z)),S(X?" /     .":"    ."))},Ae=async()=>{if(!((e.role==="SUB_ADMIN"||e.role==="ADMIN")&&(i.status==="READY_FOR_REPORT"||i.status==="ATTACHED_TO_REPORT"||i.status==="ARCHIVED")&&!window.confirm(`     (  /   / ).
         .

  ?`))){p(!0);try{const X=await nt.updateSheetMeta(e,i.id,{insurerName:i.insurerName,periodLabel:i.periodLabel,deductibleAmount:i.deductibleAmount??0,alreadyPaidAmount:i.alreadyPaidAmount??0,infoOnly:i.infoOnly}),fe=[];for(const Z of c)if(Z.id.startsWith("tmp-")){const re=await nt.addLineItem(e,i.id,{kind:Z.kind,expenseType:Z.expenseType,providerName:Z.providerName,providerId:Z.providerId,description:Z.description,date:Z.date,quantity:Z.quantity,unitPrice:Z.unitPrice,vatRate:Z.vatRate,isIncludedInRequestedAmount:Z.isIncludedInRequestedAmount,lineNetAmount:Z.lineNetAmount,lineVatAmount:Z.lineVatAmount,lineTotalAmount:Z.lineTotalAmount,attachmentId:Z.attachmentId});re&&fe.push(re)}else{const re=await nt.updateLineItem(e,i.id,Z.id,{kind:Z.kind,expenseType:Z.expenseType,providerName:Z.providerName,providerId:Z.providerId,description:Z.description,date:Z.date,quantity:Z.quantity,unitPrice:Z.unitPrice,vatRate:Z.vatRate,isIncludedInRequestedAmount:Z.isIncludedInRequestedAmount,lineNetAmount:Z.lineNetAmount,lineVatAmount:Z.lineVatAmount,lineTotalAmount:Z.lineTotalAmount,attachmentId:Z.attachmentId});re&&fe.push(re)}const ge=await nt.getSheet(i.id)||{sheet:X||i,lineItems:fe,attachments:[]};n(ge),S("  .")}finally{p(!1)}}},Le=async()=>{p(!0);try{const _=await nt.getRulesetForSheet(i),X=gm({sheet:i,lineItems:c,attachments:h,ruleset:_}),fe=X.issues.map(re=>re.code==="MISSING_ATTACHMENT_REQUIRED"&&re.severity==="ERROR"?{...re,severity:"WARNING"}:re);x(fe);const ge=fe.filter(re=>re.severity==="ERROR"&&re.code!=="MISSING_ATTACHMENT_REQUIRED");if(ge.length){const re=ge.map(pe=>` ${pe.messageHe}`).join(`
`);W(re),U(!0),S("          .");return}const Z=await nt.recordReadyAttempt(e,{sheetId:i.id,success:!0,decisionLog:X.decisionLog});if(Z){o(Z);const re=await nt.getSheet(Z.id)||{sheet:Z,lineItems:c,attachments:h};n(re),l&&l({caseId:Z.caseId,sheetId:Z.id,lawyerId:k==="AUTO"?void 0:k});const pe=k==="AUTO"?(a==null?void 0:a.ownerName)||"  ":(a==null?void 0:a.ownerName)||" ";S(`       ${pe}   ${Z.caseId}.`)}}finally{p(!1)}},Te=()=>{const{html:_}=My(i,c);E(_)},he=_=>ne.has(_),et=y.useMemo(()=>{const _=new Set(O);return c.forEach(X=>{X.providerName&&_.add(X.providerName)}),Array.from(_).sort((X,fe)=>X.localeCompare(fe,"he-IL"))},[c,O]),q=y.useMemo(()=>{const _=new Set($);return c.forEach(X=>{X.description&&_.add(X.description)}),Array.from(_).sort((X,fe)=>X.localeCompare(fe,"he-IL"))},[c,$]),F=()=>{const _={sheet:i,lineItems:c,attachments:h,totals:de},X=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),fe=URL.createObjectURL(X),ge=document.createElement("a");ge.href=fe,ge.download=`expenses-${i.caseId||i.id}.json`,ge.click(),URL.revokeObjectURL(fe)},Ne=()=>{const _=["LineId","Date","Provider","Description","Quantity","UnitPrice","VatRate","IncludedInRequest","LineTotal"],X=c.map(pe=>[pe.id,pe.date||"",(pe.providerName||"").replace(/"/g,'""'),(pe.description||"").replace(/"/g,'""'),pe.quantity??"",pe.unitPrice??"",pe.vatRate??"",pe.isIncludedInRequestedAmount!==!1?"YES":"NO",pe.lineTotalAmount??""]),fe=[_.join(","),...X.map(pe=>pe.map(z=>{const we=String(z??"");return/[",\n]/.test(we)?`"${we}"`:we}).join(","))].join(`
`),ge=new Blob(["\uFEFF"+fe],{type:"text/csv;charset=utf-8;"}),Z=URL.createObjectURL(ge),re=document.createElement("a");re.href=Z,re.download=`expenses-${i.caseId||i.id}.csv`,re.click(),URL.revokeObjectURL(Z)},xe=y.useMemo(()=>{if(!a)return i.status==="READY_FOR_REPORT"?"   (  ).":i.status==="ATTACHED_TO_REPORT"||i.status==="ARCHIVED"?"     .":"  .";switch(a.status){case"TASK_ASSIGNED":return"      .";case"WAITING_FOR_INVOICES":return"   /  .";case"PENDING_REVIEW":return"   / .";case"READY_TO_SEND":return"    .";case"SENT":return"   .";default:return"    ."}},[a,i.status]),ze=y.useMemo(()=>a?[{id:a.createdBy,name:a.ownerName||" "}]:[],[a]);return s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:["  : ",s.jsx("span",{className:"font-mono",children:i.caseId})]}),s.jsxs("p",{className:"text-sm text-gray-600",children:[": ",s.jsx("span",{children:$y[i.status]})]}),s.jsxs("p",{className:"mt-1 text-xs text-gray-600",children:["  :"," ",s.jsx("span",{className:"font-medium text-gray-800",children:xe})]})]}),s.jsxs("div",{className:"flex gap-3 flex-wrap justify-end items-center",children:[ze.length>0&&s.jsxs("div",{className:"text-xs text-gray-700",children:[s.jsx("label",{className:"block mb-1 font-medium",children:"     "}),s.jsxs("select",{className:"border rounded px-2 py-1 text-xs bg-white",value:k,onChange:_=>G(_.target.value||"AUTO"),children:[s.jsx("option",{value:"AUTO",children:"     "}),ze.map(_=>s.jsx("option",{value:_.id,children:_.name},_.id))]})]}),s.jsx("button",{type:"button",className:"px-3 py-1 text-sm rounded border border-gray-300 text-gray-700 hover:bg-gray-50",onClick:r,children:" "}),s.jsx("button",{type:"button",className:"px-3 py-1.5 text-sm rounded border border-blue-300 text-blue-700 hover:bg-blue-50",onClick:Te,children:" "}),s.jsx("button",{type:"button",className:"px-4 py-1.5 text-sm rounded bg-emerald-600 text-white hover:bg-emerald-700 disabled:opacity-50",onClick:Le,disabled:f,children:"   "}),s.jsx("button",{type:"button",className:"px-4 py-1.5 text-sm rounded bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",onClick:Ae,disabled:f,children:f?"":" "}),s.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs rounded border border-gray-300 text-gray-700 hover:bg-gray-50",onClick:F,children:" JSON"}),s.jsx("button",{type:"button",className:"px-3 py-1.5 text-xs rounded border border-gray-300 text-gray-700 hover:bg-gray-50",onClick:Ne,children:" Excel (CSV)"})]})]}),g&&s.jsx("div",{className:"mt-2 rounded border border-green-200 bg-green-50 px-3 py-2 text-sm text-green-800",children:g}),A&&s.jsxs("div",{className:"mt-2 rounded border border-gray-300 bg-white px-3 py-3 text-sm text-left",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("span",{className:"font-semibold text-gray-800",children:"Expenses Table  Preview"}),s.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:underline",onClick:()=>E(null),children:""})]}),s.jsx("div",{className:"overflow-x-auto text-base",dangerouslySetInnerHTML:{__html:A}})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-white border rounded-lg p-4 shadow-sm",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:i.insurerName||"",onChange:_=>K({insurerName:_.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" / "}),s.jsx("input",{className:"w-full border rounded px-2 py-1 text-sm",value:i.periodLabel||"",onChange:_=>K({periodLabel:_.target.value})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:" "}),s.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1 text-sm",value:i.deductibleAmount??0,onChange:_=>{const X=Number(_.target.value),fe=Number.isFinite(X)?Math.max(0,X):0;K({deductibleAmount:fe})}})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsx("input",{type:"number",className:"w-full border rounded px-2 py-1 text-sm",value:i.alreadyPaidAmount??0,onChange:_=>{const X=Number(_.target.value),fe=Number.isFinite(X)?Math.max(0,X):0;K({alreadyPaidAmount:fe})}})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("input",{id:"infoOnly",type:"checkbox",checked:i.infoOnly,onChange:_=>K({infoOnly:_.target.checked})}),s.jsx("label",{htmlFor:"infoOnly",className:"text-sm text-gray-800",children:"   (  )"})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 items-center bg-blue-50 border border-blue-100 rounded-lg p-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:" "}),s.jsxs("div",{className:"font-semibold",children:[de.grossExpensesTotal.toLocaleString("he-IL")," "]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:" (  +  + )"}),s.jsxs("div",{className:"font-semibold",children:[de.adjustmentsTotal.toLocaleString("he-IL")," "]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:"   INFO_ONLY"}),s.jsxs("div",{className:"font-semibold",children:[de.amountBeforeInfoOnly.toLocaleString("he-IL")," "]})]}),s.jsxs("div",{children:[s.jsx("div",{className:"text-gray-600",children:" "}),s.jsxs("div",{className:"font-semibold text-blue-700",children:[de.amountToRequest.toLocaleString("he-IL")," "]})]}),de.infoOnlyApplied&&s.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"INFO_ONLY    (  )"})]}),s.jsxs("div",{className:"mt-2 text-xs text-gray-500 bg-white border border-dashed border-gray-300 rounded-md p-2",children:[s.jsx("span",{className:"font-semibold mr-1",children:" :"}),"    (, , , ,  ).      ,     ,         ."]}),s.jsxs("div",{className:"bg-white border rounded-lg p-4 shadow-sm flex flex-col gap-2 text-sm",onDragOver:_=>{_.preventDefault(),_.stopPropagation()},onDrop:le,children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("div",{className:"font-medium text-gray-900",children:""}),s.jsxs("label",{className:"inline-flex items-center gap-2 cursor-pointer text-xs text-blue-700 hover:text-blue-800",children:[s.jsx("span",{className:"px-2 py-1 border border-blue-400 rounded bg-blue-50",children:" "}),s.jsx("input",{type:"file",className:"hidden",multiple:!0,onChange:L})]})]}),s.jsx("p",{className:"text-xs text-gray-500",children:"         ."}),h.length===0?s.jsx("div",{className:"text-gray-500 text-xs",children:"    ."}):s.jsx("ul",{className:"divide-y divide-gray-100",children:h.map(_=>s.jsxs("li",{className:"py-1 flex items-center justify-between gap-4",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("span",{className:"text-gray-900 text-xs",children:_.originalFileName}),s.jsxs("span",{className:"text-gray-500 text-[11px]",children:[": ",_.sizeBytes!=null?`${(_.sizeBytes/1024).toFixed(1)} KB`:" ","  "," ",_.uploadedAt?new Date(_.uploadedAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"}):""]})]}),s.jsx("button",{type:"button",className:"text-xs text-blue-700 hover:underline",onClick:()=>{_.fileKey.startsWith("data:")&&window.open(_.fileKey,"_blank")},children:" / "})]},_.id))})]}),P.length>0&&s.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 text-sm",children:[s.jsx("div",{className:"font-semibold text-red-800 mb-1",children:"  :"}),s.jsx("ul",{className:"list-disc pr-5 space-y-0.5",children:P.map(_=>s.jsxs("li",{children:[s.jsxs("span",{className:"font-mono text-xs text-gray-500 ml-1",children:["[",_.severity,"]"]}),s.jsxs("span",{className:"text-red-900",children:[" ",_.messageHe]})]},`${_.code}-${_.scope}-${_.entityId||"sheet"}`))})]}),s.jsxs("div",{className:"bg-white border rounded-lg shadow-sm overflow-x-auto",children:[s.jsxs("table",{className:"min-w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" "}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" %"}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" "}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:" "}),s.jsx("th",{className:"px-2 py-1 border-b text-right",children:""}),s.jsx("th",{className:"px-2 py-1 border-b"})]})}),s.jsx("tbody",{children:c.map((_,X)=>{const fe=he(_.id),ge=h.find(re=>re.id===_.attachmentId),Z=_.kind==="COMPENSATION"?_.compensationSource==="COURT"?"COMPENSATION_COURT":"COMPENSATION_SETTLEMENT":_.kind;return s.jsxs("tr",{className:fe?"bg-red-50":X%2===0?"bg-white":"bg-gray-50",children:[s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsxs("select",{className:"border rounded px-1 py-0.5 text-xs",value:Z,onChange:re=>{const pe=re.target.value;pe==="EXPENSE"?R(X,{kind:"EXPENSE",compensationSource:null}):pe==="ADJUSTMENT"?R(X,{kind:"ADJUSTMENT",compensationSource:null}):pe==="COMPENSATION_SETTLEMENT"?R(X,{kind:"COMPENSATION",compensationSource:"SETTLEMENT"}):pe==="COMPENSATION_COURT"&&R(X,{kind:"COMPENSATION",compensationSource:"COURT"})},children:[s.jsx("option",{value:"EXPENSE",children:"Expense"}),s.jsx("option",{value:"COMPENSATION_SETTLEMENT",children:"Compensation pursuant to a settlement"}),s.jsx("option",{value:"COMPENSATION_COURT",children:"Compensation pursuant to a judgment"}),s.jsx("option",{value:"ADJUSTMENT",children:"Adjustment"})]})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{list:"provider-suggestions",className:"border rounded px-1 py-0.5 w-32 text-xs",placeholder:" ",value:_.providerName||"",onChange:re=>R(X,{providerName:re.target.value})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{className:"border rounded px-1 py-0.5 w-64 text-xs",list:"description-suggestions",value:_.description,onChange:re=>R(X,{description:re.target.value})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"date",className:"border rounded px-1 py-0.5 text-xs",value:_.date||"",onChange:re=>R(X,{date:re.target.value||null})})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"number",className:"border rounded px-1 py-0.5 w-20 text-xs",value:_.quantity??1,onChange:re=>{const pe=Number(re.target.value),z=Number.isFinite(pe)?Math.max(0,pe):0;R(X,{quantity:z})}})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"number",className:"border rounded px-1 py-0.5 w-24 text-xs",value:_.unitPrice??0,onChange:re=>{const pe=Number(re.target.value),z=Number.isFinite(pe)?Math.max(0,pe):0;R(X,{unitPrice:z})}})}),s.jsx("td",{className:"px-2 py-1 border-b",children:s.jsx("input",{type:"number",className:"border rounded px-1 py-0.5 w-16 text-xs",value:_.vatRate??0,onChange:re=>{const pe=Number(re.target.value),z=Number.isFinite(pe)?Math.max(0,pe):0;R(X,{vatRate:z})}})}),s.jsx("td",{className:"px-2 py-1 border-b text-center",children:s.jsx("input",{type:"checkbox",checked:_.isIncludedInRequestedAmount!==!1,onChange:re=>R(X,{isIncludedInRequestedAmount:re.target.checked})})}),s.jsx("td",{className:"px-2 py-1 border-b text-left font-mono text-xs",children:_.lineTotalAmount!=null?_.lineTotalAmount.toLocaleString("he-IL"):""}),s.jsxs("td",{className:"px-2 py-1 border-b text-right",children:[s.jsxs("div",{className:"flex items-center justify-end gap-2",children:[s.jsxs("select",{className:"border rounded px-1 py-0.5 text-xs max-w-[190px]",value:_.attachmentId||"",title:ge?` : ${ge.originalFileName}`:"   ",onChange:re=>void Ie(_,re.target.value?re.target.value:null),children:[s.jsx("option",{value:"",children:h.length?"   ":"  "}),h.map(re=>s.jsx("option",{value:re.id,children:re.originalFileName},re.id))]}),_.attachmentId?s.jsxs("span",{className:"inline-flex items-center gap-1 text-[11px] text-emerald-700 font-semibold whitespace-nowrap",children:[s.jsx("span",{className:"text-emerald-600",children:""}),s.jsx("span",{children:" "})]}):s.jsx("span",{className:"inline-flex items-center gap-1 text-[11px] text-gray-500 whitespace-nowrap",children:" "})]}),ge&&s.jsxs("div",{className:"mt-0.5 text-[11px] text-gray-700 text-left",children:[s.jsx("span",{className:"text-gray-500",children:":"})," ",s.jsx("span",{className:"font-mono break-all",children:ge.originalFileName})]})]}),s.jsx("td",{className:"px-2 py-1 border-b text-center",children:s.jsx("button",{type:"button",className:"text-xs text-red-600 hover:underline",onClick:()=>se(X),children:""})})]},_.id)})})]}),s.jsx("datalist",{id:"provider-suggestions",children:et.map(_=>s.jsx("option",{value:_},_))}),s.jsx("datalist",{id:"description-suggestions",children:q.map(_=>s.jsx("option",{value:_},_))}),s.jsx("div",{className:"p-2",children:s.jsx("button",{type:"button",className:"px-3 py-1 text-xs rounded border border-dashed border-gray-400 text-gray-700 hover:bg-gray-50",onClick:te,children:" "})})]}),s.jsx(By,{open:M,title:"    ",message:H?`      :

${H}`:"      .",confirmText:"",cancelText:"",onConfirm:()=>U(!1),onCancel:()=>U(!1)})]})},Uy=[{id:"READY",label:" "},{id:"ATTACHED",label:" "},{id:"SENT",label:""},{id:"EXCEPTIONS",label:""}],ym={DRAFT:"",READY_FOR_REPORT:" ",ATTACHED_TO_REPORT:" ",ARCHIVED:""},Hy=({user:e,reports:t,onOpenReport:n})=>{var q;const[r,l]=y.useState("READY"),[a,i]=y.useState(""),[o,c]=y.useState(""),[u,f]=y.useState(""),[p,g]=y.useState(""),[S,A]=y.useState(""),[E,P]=y.useState([]),[x,h]=y.useState(null),[b,M]=y.useState(null),[U,H]=y.useState(!1),[W,O]=y.useState(null),[D,$]=y.useState(null),[I,k]=y.useState(null),[G,de]=y.useState(!1),[ne,V]=y.useState(null),[K,R]=y.useState(null),[te,se]=y.useState(!1),[ye,L]=y.useState(!1),[le,Ie]=y.useState(0);y.useMemo(()=>{if(!x)return 0;switch(r){case"READY":return x.readyCount;case"ATTACHED":return x.attachedCount;case"SENT":return x.sentCount;case"EXCEPTIONS":return x.exceptionsCount;default:return 0}},[x,r]);const Ae=F=>{if(F==null)return"";if(F<24)return`${F.toFixed(1)} `;const Ne=Math.floor(F/24),xe=F%24;return xe<1?`${Ne} `:`${Ne}  ${xe.toFixed(1)} `};y.useEffect(()=>{let F=!1;return(async()=>{H(!0),O(null);try{const[xe,ze]=await Promise.all([nt.getLidorCounts(e,t),nt.getLidorKpis(e,t)]);F||(h(xe),M(ze));const _={};r==="READY"?_.status="READY_FOR_REPORT":r==="ATTACHED"&&(_.status="ATTACHED_TO_REPORT"),a.trim()&&(_.insurerName=a.trim()),u&&(_.dateFrom=u),p&&(_.dateTo=p),S.trim()&&(_.caseIdOrSearch=S.trim()),o&&(_.status=o);const X=await nt.listSheetsForLidor(e,_,t);let fe=X;r==="SENT"?fe=X.filter(ge=>ge.sentAt):r==="EXCEPTIONS"&&(fe=X.filter(ge=>ge.expensesOutOfSync||ge.blockingIssueCodesLatest&&ge.blockingIssueCodesLatest.length>0)),F||(P(fe),$(null),R(null))}catch(xe){console.error(xe),F||O("    . /   .")}finally{F||H(!1)}})(),()=>{F=!0}},[e,t,r,a,o,u,p,S,le]);const Le=async F=>{$(F),R(null),V(null),de(!0);try{const Ne=await nt.getSheet(F.sheetId),xe=await nt.getSheetAuditForLidor(e,F.sheetId,200),ze=await nt.getExceptionStatusForSheet(e,F.sheetId);R(Ne?{sheet:Ne.sheet,lineItems:Ne.lineItems,attachments:Ne.attachments,audit:xe,exceptionStatus:ze}:{sheet:null,lineItems:[],attachments:[],audit:xe,exceptionStatus:ze})}catch(Ne){console.error(Ne),V("     .")}finally{de(!1)}},Te=()=>{if(!K||!K.sheet)return;const F={sheet:K.sheet,lineItems:K.lineItems,attachments:K.attachments};k(F)},he=()=>{k(null),Ie(F=>F+1)};if(I)return s.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mt-4",dir:"rtl",children:[s.jsxs("header",{className:"flex items-center justify-between mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-900",children:"   ()"}),s.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"           ."})]}),s.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-slate-300 text-sm text-slate-700 hover:bg-slate-100",onClick:he,children:"  "})]}),s.jsx(ch,{user:e,sheetWithRelations:I,onSheetUpdated:F=>{k(F)},onBack:he})]});const et=async F=>{if(!(!D||!K))try{await nt.setExceptionStatusForSheet(e,D.sheetId,F),R({...K,exceptionStatus:F})}catch(Ne){Ld("Failed to update financial exception status",Ne),V("     .")}};return s.jsxs("div",{className:"bg-white rounded-xl border border-slate-200 shadow-sm p-4 mt-4",dir:"rtl",children:[s.jsx("header",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-slate-900",children:" "}),s.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"-    ,      ."}),b&&s.jsxs("p",{className:"mt-1 text-xs text-slate-500",children:["  :"," ",b.exceptions.divergenceOld.count+b.exceptions.missingAttachments.count+b.exceptions.repeatedBlocks.count]})]})}),b&&s.jsxs("section",{className:"mb-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-xs",children:[s.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5",children:[s.jsx("p",{className:"text-slate-500 mb-1",children:"   "}),s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:Ae(b.sla.draftToReadyAvgHours)})]}),s.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5",children:[s.jsx("p",{className:"text-slate-500 mb-1",children:"   "}),s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:Ae(b.sla.readyToAttachedAvgHours)})]}),s.jsxs("div",{className:"rounded-xl border border-slate-200 bg-slate-50 px-3 py-2.5",children:[s.jsx("p",{className:"text-slate-500 mb-1",children:"   "}),s.jsx("p",{className:"text-sm font-semibold text-slate-900",children:Ae(b.sla.attachedToSentAvgHours)})]}),s.jsxs("div",{className:"rounded-xl border border-blue-100 bg-blue-50 px-3 py-2.5",children:[s.jsx("p",{className:"text-slate-600 mb-1",children:"  "}),s.jsxs("p",{className:"text-sm font-semibold text-blue-800",children:[b.volumes.totalAmountRequested.toLocaleString("he-IL")," "]}),s.jsxs("p",{className:"text-[11px] text-slate-500 mt-0.5",children:[b.volumes.totalSheets||0,"  "," ",b.volumes.totalSentReports||0,"  "]})]})]}),b&&s.jsxs("section",{className:"mb-4",children:[s.jsx("h3",{className:"text-sm font-semibold text-slate-700 mb-1",children:"  "}),s.jsxs("div",{className:"flex flex-wrap gap-2 text-xs",children:[s.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full border border-amber-200 bg-amber-50 text-amber-800 hover:bg-amber-100 transition disabled:opacity-40 disabled:hover:bg-amber-50",disabled:b.exceptions.divergenceOld.count===0,onClick:()=>l("EXCEPTIONS"),children:[s.jsx("span",{children:"    "}),s.jsxs("span",{className:"font-semibold",children:["(",b.exceptions.divergenceOld.count,")"]})]}),s.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full border border-rose-200 bg-rose-50 text-rose-800 hover:bg-rose-100 transition disabled:opacity-40 disabled:hover:bg-rose-50",disabled:b.exceptions.missingAttachments.count===0,onClick:()=>l("EXCEPTIONS"),children:[s.jsx("span",{children:"  "}),s.jsxs("span",{className:"font-semibold",children:["(",b.exceptions.missingAttachments.count,")"]})]}),s.jsxs("button",{type:"button",className:"inline-flex items-center gap-1 px-3 py-1.5 rounded-full border border-purple-200 bg-purple-50 text-purple-800 hover:bg-purple-100 transition disabled:opacity-40 disabled:hover:bg-purple-50",disabled:b.exceptions.repeatedBlocks.count===0,onClick:()=>l("EXCEPTIONS"),children:[s.jsx("span",{children:"   "}),s.jsxs("span",{className:"font-semibold",children:["(",b.exceptions.repeatedBlocks.count,")"]})]})]})]}),s.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:Uy.map(F=>s.jsxs("button",{type:"button",onClick:()=>l(F.id),className:`px-3 py-1.5 text-xs font-semibold rounded-full border transition ${r===F.id?"bg-lpBlue text-white border-lpBlue":"bg-slate-50 text-slate-700 border-slate-200 hover:bg-slate-100"}`,children:[s.jsx("span",{children:F.label}),x&&s.jsxs("span",{className:"ml-2 inline-flex items-center justify-center px-2 py-0.5 rounded-full bg-white/20 text-[10px]",children:[F.id==="READY"&&x.readyCount,F.id==="ATTACHED"&&x.attachedCount,F.id==="SENT"&&x.sentCount,F.id==="EXCEPTIONS"&&x.exceptionsCount]})]},F.id))}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3 mb-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:""}),s.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2 py-1.5",placeholder:"   ",value:a,onChange:F=>i(F.target.value)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:""}),s.jsxs("select",{className:"w-full border border-slate-200 rounded-lg px-2 py-1.5",value:o,onChange:F=>c(F.target.value),children:[s.jsx("option",{value:"",children:""}),s.jsx("option",{value:"DRAFT",children:""}),s.jsx("option",{value:"READY_FOR_REPORT",children:" "}),s.jsx("option",{value:"ATTACHED_TO_REPORT",children:" "}),s.jsx("option",{value:"ARCHIVED",children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:" "}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"date",className:"w-1/2 border border-slate-200 rounded-lg px-2 py-1.5",value:u,onChange:F=>f(F.target.value)}),s.jsx("input",{type:"date",className:"w-1/2 border border-slate-200 rounded-lg px-2 py-1.5",value:p,onChange:F=>g(F.target.value)})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-slate-600 mb-1",children:"   / ID"}),s.jsx("input",{className:"w-full border border-slate-200 rounded-lg px-2 py-1.5",placeholder:'/  ,    "',value:S,onChange:F=>A(F.target.value)})]})]}),U&&s.jsx("div",{className:"mt-6 text-sm text-slate-500 text-center",children:" "}),W&&!U&&s.jsx("div",{className:"mt-6 text-sm text-red-600 text-center",children:W}),!U&&!W&&E.length===0&&s.jsxs("div",{className:"mt-6 border border-dashed border-slate-300 rounded-xl py-10 flex flex-col items-center justify-center text-center text-sm text-slate-500",children:[s.jsx("p",{className:"mb-1",children:"  "}),s.jsx("p",{className:"text-xs text-slate-400",children:"/       ."})]}),!U&&!W&&E.length>0&&s.jsx("div",{className:"mt-4 overflow-x-auto border border-slate-200 rounded-xl",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-slate-50 text-slate-700",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 text-right",children:""}),s.jsx("th",{className:"px-3 py-2 text-right",children:""}),s.jsx("th",{className:"px-3 py-2 text-right",children:""}),s.jsx("th",{className:"px-3 py-2 text-right",children:" #"}),s.jsx("th",{className:"px-3 py-2 text-right",children:" "}),s.jsx("th",{className:"px-3 py-2 text-right",children:" "}),s.jsx("th",{className:"px-3 py-2 text-right",title:"         ",children:"INFO_ONLY"}),s.jsx("th",{className:"px-3 py-2 text-right",title:"       ",children:""}),s.jsx("th",{className:"px-3 py-2 text-left",children:""})]})}),s.jsx("tbody",{children:E.map(F=>{var X;const Ne=(X=F.blockingIssueCodesLatest)==null?void 0:X.includes("MISSING_ATTACHMENT_REQUIRED"),xe=F.expensesOutOfSync,ze=(F.blockingIssueCodesLatest||[]).some(fe=>fe!=="MISSING_ATTACHMENT_REQUIRED");let _="";return xe?_=" ":Ne?_=" ":ze&&(_=""),s.jsxs("tr",{className:"border-t border-slate-100 hover:bg-slate-50",children:[s.jsx("td",{className:"px-3 py-2 text-right font-mono text-xs text-slate-800",children:F.caseId}),s.jsx("td",{className:"px-3 py-2 text-right text-slate-800",children:F.insurerName||""}),s.jsx("td",{className:"px-3 py-2 text-right text-slate-800 text-xs",children:ym[F.status]||F.status}),s.jsxs("td",{className:"px-3 py-2 text-right text-slate-800 text-xs",children:[" #",F.versionIndex]}),s.jsx("td",{className:"px-3 py-2 text-right text-slate-700 text-xs",children:new Date(F.updatedAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"})}),s.jsxs("td",{className:"px-3 py-2 text-right text-blue-700 font-semibold text-xs",children:[F.amountToRequest.toLocaleString("he-IL")," "]}),s.jsx("td",{className:"px-3 py-2 text-right text-xs text-slate-700",children:F.infoOnly?"":""}),s.jsx("td",{className:"px-3 py-2 text-right text-xs",children:_?s.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full bg-amber-100 text-amber-800 border border-amber-200",children:_}):s.jsx("span",{className:"text-slate-400",children:""})}),s.jsxs("td",{className:"px-3 py-2 text-left text-xs space-x-2 space-x-reverse",children:[s.jsx("button",{type:"button",className:"px-2 py-1 rounded border border-slate-300 text-slate-700 hover:bg-slate-100",onClick:()=>Le(F),children:""}),s.jsx("button",{type:"button",className:"px-2 py-1 rounded border border-slate-300 text-slate-600 hover:bg-slate-100",onClick:()=>{var fe;(fe=navigator.clipboard)!=null&&fe.writeText?navigator.clipboard.writeText(F.sheetId).catch(()=>{}):window.prompt(" :",F.sheetId)},children:" "})]})]},F.sheetId)})})]})}),D&&s.jsxs("div",{className:"mt-6 bg-slate-50 border border-slate-200 rounded-xl p-4",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2 mb-2",children:[s.jsxs("h3",{className:"text-sm font-bold text-slate-900",children:["   ",D.caseId," (",D.sheetId,")"]}),s.jsxs("div",{className:"flex flex-wrap gap-2 text-[11px]",children:[s.jsx("button",{type:"button",className:"px-2 py-1 rounded border border-slate-300 text-slate-700 hover:bg-slate-100",onClick:()=>{var F;(F=navigator.clipboard)!=null&&F.writeText?navigator.clipboard.writeText(D.sheetId).catch(()=>{}):window.prompt(" :",D.sheetId)},children:"  "}),((q=K==null?void 0:K.sheet)==null?void 0:q.attachedToReportId)&&s.jsx("button",{type:"button",className:"px-2 py-1 rounded border border-slate-300 text-slate-700 hover:bg-slate-100",onClick:()=>{var Ne;const F=K.sheet.attachedToReportId;(Ne=navigator.clipboard)!=null&&Ne.writeText?navigator.clipboard.writeText(F).catch(()=>{}):window.prompt(" :",F)},children:"  "}),s.jsx("button",{type:"button",className:"px-2 py-1 rounded border border-slate-300 text-slate-700 hover:bg-slate-100",onClick:()=>{var Ne;const F=`${window.location.origin}${window.location.pathname}?financialSheetId=${encodeURIComponent(D.sheetId)}`;(Ne=navigator.clipboard)!=null&&Ne.writeText?navigator.clipboard.writeText(F).catch(()=>{}):window.prompt("  :",F)},children:"  "})]})]}),G&&s.jsx("p",{className:"text-xs text-slate-500",children:" "}),ne&&s.jsx("p",{className:"text-xs text-red-600",children:ne}),!G&&K&&K.sheet&&s.jsxs("div",{className:"space-y-3 text-xs text-slate-800",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:":"})," ",s.jsx("span",{className:"font-mono",children:K.sheet.caseId})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:":"})," ",s.jsx("span",{children:K.sheet.insurerName||""})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:":"})," ",s.jsx("span",{children:ym[K.sheet.status]||K.sheet.status})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:" #:"})," ",s.jsx("span",{children:K.sheet.versionIndex})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:":"})," ",s.jsx("span",{children:new Date(K.sheet.updatedAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"})})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:" :"})," ",s.jsx("span",{children:K.sheet.readyAt||""})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:" :"})," ",s.jsx("span",{children:K.sheet.attachedAt||""})]})]}),s.jsxs("div",{className:"mt-3",children:[s.jsx("h4",{className:"font-semibold text-slate-900 mb-1 text-xs",children:"  (  )"}),s.jsx("p",{className:"text-[11px] text-slate-500 mb-1",children:"       ,      ."}),s.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-1 text-[11px] font-semibold text-slate-700",children:[s.jsx("button",{type:"button",className:`px-3 py-1 rounded-full transition ${K.exceptionStatus?"text-slate-600 hover:text-slate-900":"bg-white shadow-sm text-slate-900"}`,onClick:()=>et("IN_PROGRESS"),children:""}),s.jsx("button",{type:"button",className:`px-3 py-1 rounded-full transition ${K.exceptionStatus==="RESOLVED"?"bg-emerald-500 text-white shadow-sm":"text-slate-600 hover:text-slate-900"}`,onClick:()=>et("RESOLVED"),children:""})]})]}),K.audit&&K.audit.length>0&&s.jsxs("div",{className:"mt-2",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold text-slate-900",children:"Decision Logs"}),s.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-slate-600",children:[s.jsx("input",{type:"checkbox",className:"rounded border-slate-300",checked:ye,onChange:F=>L(F.target.checked)}),s.jsx("span",{children:" Decision Logs "})]})]}),(()=>{const F=K.audit.filter(xe=>xe.diffJson&&xe.diffJson.decisionLog).sort((xe,ze)=>new Date(ze.eventAt).getTime()-new Date(xe.eventAt).getTime());if(!F.length)return s.jsx("p",{className:"text-slate-500 text-[11px]",children:"   ."});const Ne=ye?F:[F[0]];return s.jsx("div",{className:"space-y-2 text-[11px]",children:Ne.map((xe,ze)=>{const _=xe.diffJson.decisionLog;return s.jsxs("div",{className:"border border-slate-200 rounded-lg px-2 py-1.5 bg-white/60",children:[ye&&s.jsxs("div",{className:"flex items-center justify-between mb-0.5 text-[10px] text-slate-500",children:[s.jsx("span",{children:new Date(xe.eventAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"})}),s.jsxs("span",{children:["#",ze+1]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",title:"      ",children:"Ruleset:"})," ",s.jsxs("span",{children:[_.rulesetId||""," ("," ",_.rulesetVersion||"-",")"]})]}),s.jsxs("div",{className:"space-y-0.5",children:[s.jsxs("div",{children:[s.jsx("span",{className:_.checks.requiredFieldsOk?"text-green-600":"text-red-600",children:_.checks.requiredFieldsOk?"":""})," ",s.jsx("span",{children:"   "})]}),s.jsxs("div",{children:[s.jsx("span",{className:_.checks.sumsValid?"text-green-600":"text-red-600",children:_.checks.sumsValid?"":""})," ",s.jsx("span",{children:" "})]}),s.jsxs("div",{children:[s.jsx("span",{className:_.checks.attachmentsOk?"text-green-600":"text-red-600",children:_.checks.attachmentsOk?"":""})," ",s.jsx("span",{children:"    "})]}),s.jsxs("div",{children:[s.jsx("span",{className:_.checks.infoOnlyConsistent?"text-green-600":"text-red-600",children:_.checks.infoOnlyConsistent?"":""})," ",s.jsx("span",{children:" INFO_ONLY"})]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"font-semibold",children:" :"})," ",s.jsx("span",{children:(_.blockingIssueCodes||_.blockingIssueCodesLatest||[]).join(", ")||""})]})]})]},xe.id)})})})()]}),K.audit&&K.audit.length>0&&s.jsxs("div",{className:"mt-3",children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("h4",{className:"font-semibold text-slate-900",children:"Audit Log"}),s.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-slate-600",children:[s.jsx("input",{type:"checkbox",className:"rounded border-slate-300",checked:te,onChange:F=>se(F.target.checked)}),s.jsx("span",{children:" Audit Log "})]})]}),s.jsx("ul",{className:"space-y-0.5 text-[11px] text-slate-700",children:(te?K.audit:K.audit.slice(0,10)).map(F=>s.jsxs("li",{children:[s.jsx("span",{className:"font-mono text-slate-500 mr-1",children:new Date(F.eventAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"})})," ",s.jsx("span",{className:"font-semibold",children:F.eventType})," "," ",s.jsx("span",{className:"text-slate-500",children:F.actorRole})]},F.id))})]}),K.sheet.attachedToReportId&&s.jsxs("div",{className:"mt-3",children:[s.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-slate-300 text-xs text-slate-700 hover:bg-slate-100",onClick:()=>n(K.sheet.attachedToReportId),children:"  "}),s.jsx("button",{type:"button",className:"ml-2 px-3 py-1.5 rounded border border-blue-500 text-xs text-blue-700 hover:bg-blue-50",onClick:Te,children:"  "})]}),!K.sheet.attachedToReportId&&s.jsx("div",{className:"mt-3",children:s.jsx("button",{type:"button",className:"px-3 py-1.5 rounded border border-blue-500 text-xs text-blue-700 hover:bg-blue-50",onClick:Te,children:"  "})})]})]})]})},yi=e=>{const t=e.updatedAt||e.sentAt||e.reportDate;return t?new Date(t).getTime():0},zy=e=>{var n;return(((n=e.reportReview)==null?void 0:n.issues)??[]).some(r=>(r.origin??"INTERNAL")==="EXTERNAL"&&r.status!=="DONE")},Wy=e=>{var n;return(((n=e.reportReview)==null?void 0:n.issues)??[]).some(r=>(r.origin??"INTERNAL")==="EXTERNAL"&&r.status!=="DONE"&&r.externalAction==="REQUIRES_HEBREW")},Vy=e=>e.filter(t=>t.deletedAt?!1:t.hebrewWorkflowStatus==="HEBREW_REOPENED_EXTERNAL"?!0:zy(t)).sort((t,n)=>yi(n)-yi(t)),Yy=(e,t)=>e.filter(n=>!(n.deletedAt||n.status!=="SENT"||!t(n)||Wy(n))).sort((n,r)=>yi(r)-yi(n)),Gy="adminDashboardUiState:v1",Ky=["u6","u5","u7","u4"],Ia=Ky.map(e=>Es.find(t=>t.id===e&&t.role==="LAWYER")).filter(e=>!!e);function qy(e){var l;if(e.status==="SENT")return"GREEN";const t=(l=e.reportReview)==null?void 0:l.status,n=e.hebrewWorkflowStatus;return(t==="SUBMITTED"||t==="APPROVED"||t==="CHANGES_REQUESTED"||n==="HEBREW_SUBMITTED"||n==="HEBREW_APPROVED"||n==="HEBREW_CHANGES_REQUESTED"||n==="HEBREW_REOPENED_EXTERNAL")&&e.status!=="SENT"?"RED":"YELLOW"}const Xy=({user:e,reports:t,onSelectReport:n,onSelectReportWithFocus:r,onMarkExternalIssuesDone:l,onReopenHebrewDueToExternalFeedback:a,onNewReport:i,canTranslate:o,onLogout:c})=>{var I;const u=y.useMemo(()=>t.filter(k=>!k.deletedAt),[t]),f=y.useMemo(()=>Vy(u),[u]),p=y.useMemo(()=>Yy(u,o),[u,o]),g=y.useMemo(()=>{const k=new Map;return u.forEach(G=>{if(!G.createdBy)return;const de=k.get(G.createdBy)||[];de.push(G),k.set(G.createdBy,de)}),k},[u]),S=y.useMemo(()=>Ia.map(k=>{const de=(g.get(k.id)||[]).filter(R=>R.status!=="SENT"),ne=de.filter(R=>R.status==="READY_TO_SEND").length,V=f.filter(R=>R.createdBy===k.id).length,K=p.filter(R=>R.createdBy===k.id).length;return{lawyer:k,totalOpen:de.length,readyToSendCount:ne,feedbackCount:V,resendCount:K}}),[f,p,g]),A=k=>{var G;return k.hebrewWorkflowStatus?k.hebrewWorkflowStatus:((G=k.reportReview)==null?void 0:G.status)??"-"},E=k=>{if(!k)return Ea.queueItem.noDate;try{const G=new Date(k);return`${G.toLocaleDateString("he-IL")} ${G.toLocaleTimeString("he-IL",{hour:"2-digit",minute:"2-digit"}).replace(":00","")}`}catch{return k}},[P,x]=y.useState("ADMIN"),[h,b]=y.useState(((I=Ia[0])==null?void 0:I.id)||""),[M,U]=y.useState("SUMMARY"),[H,W]=y.useState(null),O=y.useMemo(()=>Ia.find(k=>k.id===h)||Ia[0],[h]),D=y.useMemo(()=>{if(!O)return[];const k=g.get(O.id)||[],G=new Map;return k.filter(ne=>!ne.deletedAt).forEach(ne=>{const V=ne.odakanitNo&&ne.odakanitNo.trim().length>0?ne.odakanitNo.trim():"NO_ODAKANIT",K=G.get(V)||[];K.push(ne),G.set(V,K)}),Array.from(G.entries()).map(([ne,V])=>{let K=V[0];V.forEach(ye=>{const L=new Date(ye.updatedAt||ye.reportDate).getTime(),le=new Date(K.updatedAt||K.reportDate).getTime();L>le&&(K=ye)});const R=ne==="NO_ODAKANIT"?"":ne,te=R||"  ",se=K.updatedAt||K.reportDate;return{odakanitNo:R,displayOdakanit:te,representative:K,lastUpdatedIso:se,reportsCount:V.length}}).sort((ne,V)=>{const K=ne.lastUpdatedIso?new Date(ne.lastUpdatedIso).getTime():0;return(V.lastUpdatedIso?new Date(V.lastUpdatedIso).getTime():0)-K})},[g,O]),$=y.useMemo(()=>{if(!O||!H)return[];const k=g.get(O.id)||[],G=H.trim();return k.filter(de=>!de.deletedAt).filter(de=>(de.odakanitNo||"").trim()===G)},[g,O,H]);return s.jsx("div",{className:"min-h-screen bg-slate-50",dir:"rtl",children:s.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[s.jsxs("header",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4 mb-6",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:Ea.title}),s.jsx("p",{className:"text-sm text-slate-600 mt-1",children:Ea.subtitle}),s.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["/ ",s.jsx("span",{className:"font-semibold",children:e.name})," ",s.jsxs("span",{className:"ml-1 text-slate-400",children:["(",e.role==="SUB_ADMIN"?"SUB_ADMIN":"ADMIN",")"]})]})]}),s.jsxs("div",{className:"flex flex-col items-stretch md:flex-row md:items-center gap-3",children:[s.jsxs("div",{className:"inline-flex rounded-full bg-slate-100 p-1 text-xs font-semibold text-slate-600",children:[s.jsx("button",{type:"button",onClick:()=>x("ADMIN"),className:`px-3 py-1 rounded-full transition ${P==="ADMIN"?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:" "}),s.jsx("button",{type:"button",onClick:()=>x("FINANCIAL_CONTROL"),className:`px-3 py-1 rounded-full transition ${P==="FINANCIAL_CONTROL"?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:text-slate-900"}`,children:" "})]}),s.jsx("button",{type:"button",onClick:c,className:"inline-flex items-center justify-center px-3 py-2 rounded-lg border border-red-200 bg-white text-sm font-semibold text-red-700 hover:bg-red-50 transition",children:""}),s.jsx("button",{onClick:i,className:"inline-flex items-center justify-center px-4 py-2 rounded-lg bg-lpBlue text-white text-sm font-semibold shadow-sm hover:bg-blue-800 transition",children:Ea.actions.openNewReport})]})]}),P==="FINANCIAL_CONTROL"?s.jsx(Hy,{user:e,reports:t,onOpenReport:n}):s.jsxs(s.Fragment,{children:[s.jsxs("section",{className:"mb-6",children:[s.jsx("h2",{className:"text-sm font-semibold text-slate-800 mb-2",children:"   "}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-3 text-xs",children:S.map(k=>{const G=(O==null?void 0:O.id)===k.lawyer.id;return s.jsxs("button",{type:"button",onClick:()=>{b(k.lawyer.id),W(null),U("LAWYER_CASES")},className:`flex flex-col items-stretch rounded-2xl border px-3 py-3 text-right shadow-sm transition ${G?"border-lpBlue bg-blue-50/80":"border-slate-200 bg-white hover:bg-slate-50"}`,children:[s.jsxs("div",{className:"flex items-center justify-between mb-1",children:[s.jsx("span",{className:"text-[11px] font-semibold text-slate-700",children:k.lawyer.name}),s.jsxs("span",{className:"inline-flex items-center rounded-full bg-slate-100 px-2 py-0.5 text-[10px] text-slate-600",children:[k.totalOpen," "]})]}),s.jsxs("div",{className:"flex flex-col gap-0.5 text-[11px] text-slate-600",children:[s.jsxs("span",{children:[" :",s.jsx("span",{className:"font-semibold text-emerald-700",children:k.readyToSendCount})]}),s.jsxs("span",{children:["  :",s.jsx("span",{className:"font-semibold text-purple-700",children:k.feedbackCount})]}),s.jsxs("span",{children:["  :",s.jsx("span",{className:"font-semibold text-amber-700",children:k.resendCount})]})]})]},k.lawyer.id)})})]}),M==="LAWYER_CASES"&&O&&s.jsxs("section",{className:"mb-6 bg-white rounded-2xl border border-slate-200 shadow-sm p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-sm font-semibold text-slate-900",children:["     ",O.name]}),s.jsx("p",{className:"text-[11px] text-slate-500",children:"        ."})]}),s.jsx("button",{type:"button",onClick:()=>{U("SUMMARY"),W(null)},className:"text-[11px] px-3 py-1.5 rounded-full border border-slate-300 text-slate-700 hover:bg-slate-50",children:" "})]}),D.length===0?s.jsx("p",{className:"text-xs text-slate-400",children:"       ."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-[11px]",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-slate-200 bg-slate-50",children:[s.jsx("th",{className:"px-2 py-1 text-right font-semibold",children:" "}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-20",children:"REPORT NO."}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:"PLAINTIFF/CLAIMANT"}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:"INSURED"}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-40",children:"INSURER"}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-28",children:"'  "})]})}),s.jsx("tbody",{children:D.map(k=>{var L;const{representative:G}=k,de=!!k.odakanitNo,ne=hi(G),V=ne?ne.split(" - "):[],K=V.length<=2?ne:V[V.length-2]||ne,R=(((L=G.reportHistory)==null?void 0:L.length)||0)+1,te=G.plaintiffName||"",se=G.insuredName||"",ye=G.insurerName||"";return s.jsxs("tr",{className:`border-b border-slate-100 ${de?"hover:bg-slate-50 cursor-pointer":"bg-slate-50/40 text-slate-500"}`,onClick:()=>{de&&(W(k.odakanitNo),U("CASE_REPORTS"))},children:[s.jsxs("td",{className:"px-2 py-1 text-right",children:[s.jsx("div",{className:"text-slate-900",children:K||""}),s.jsx("div",{className:"text-[10px] text-slate-500",children:E(k.lastUpdatedIso)})]}),s.jsx("td",{className:"px-2 py-1 text-right text-slate-700 font-mono text-[11px]",children:R}),s.jsx("td",{className:"px-2 py-1 text-right text-slate-700",children:te}),s.jsx("td",{className:"px-2 py-1 text-right text-slate-700",children:se}),s.jsx("td",{className:"px-2 py-1 text-right text-slate-700",children:ye}),s.jsx("td",{className:"px-2 py-1 text-right font-mono text-[11px]",children:k.displayOdakanit})]},k.displayOdakanit)})})]})})]}),M==="CASE_REPORTS"&&O&&H&&s.jsxs("section",{className:"mb-6 bg-white rounded-2xl border border-slate-200 shadow-sm p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsxs("div",{children:[s.jsxs("h2",{className:"text-sm font-semibold text-slate-900",children:["  ",H,"  ",O.name]}),s.jsx("p",{className:"text-[11px] text-slate-500",children:"  ,     ."})]}),s.jsx("button",{type:"button",onClick:()=>U("LAWYER_CASES"),className:"text-[11px] px-3 py-1.5 rounded-full border border-slate-300 text-slate-700 hover:bg-slate-50",children:" "})]}),$.length===0?s.jsx("p",{className:"text-xs text-slate-400",children:"     ."}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-[11px]",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-slate-200 bg-slate-50",children:[s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-64",children:" /  / "}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-24",children:' \\"'}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-32",children:""}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-32",children:" "}),s.jsx("th",{className:"px-2 py-1 text-right font-semibold w-28"})]})}),s.jsx("tbody",{children:$.map(k=>{var R;const G=qy(k),de=G==="GREEN"?"bg-emerald-50":G==="RED"?"bg-red-50":"bg-yellow-50",ne=!!k.expensesSheetId,V=k.reportSubject||k.insuredName||k.plaintiffName||"",K=(((R=k.reportHistory)==null?void 0:R.length)||0)+1;return s.jsxs("tr",{className:`border-b border-slate-100 hover:bg-slate-100 cursor-pointer ${de}`,onClick:()=>n(k.id),children:[s.jsxs("td",{className:"px-2 py-1 text-right",children:[s.jsxs("div",{className:"text-slate-900 flex flex-wrap items-center gap-1 justify-end",children:[s.jsx("span",{children:V}),ne&&s.jsx("span",{className:"inline-flex items-center rounded-full bg-purple-100 px-2 py-0.5 text-[10px] font-medium text-purple-700",children:" /  "})]}),(k.insuredName||k.plaintiffName)&&s.jsx("div",{className:"text-[10px] text-slate-600",children:[k.insuredName,k.plaintiffName].filter(Boolean).join(" / ")})]}),s.jsx("td",{className:"px-2 py-1 text-right text-slate-700",children:K}),s.jsxs("td",{className:"px-2 py-1 text-right text-slate-700",children:[A(k)," (",k.status,")"]}),s.jsx("td",{className:"px-2 py-1 text-right text-slate-500 whitespace-nowrap",children:E(k.updatedAt||k.reportDate)}),s.jsx("td",{className:"px-2 py-1 text-left",children:s.jsx("button",{type:"button",onClick:te=>{te.stopPropagation(),n(k.id)},className:"inline-flex items-center rounded-full bg-lpBlue px-3 py-1 text-[11px] font-semibold text-white shadow-sm hover:bg-blue-900",children:' \\"'})})]},k.id)})})]})})]})]})]})})},Qy={DRAFT:"",READY_FOR_REPORT:" ",ATTACHED_TO_REPORT:" ",ARCHIVED:""},Jy=({user:e,reports:t,onLogout:n,onNotifyLawyer:r})=>{const[l,a]=y.useState([]),[i,o]=y.useState(!1),[c,u]=y.useState("ALL"),[f,p]=y.useState(""),[g,S]=y.useState(null),[A,E]=y.useState(null),[P,x]=y.useState({}),h=async()=>{o(!0);try{const D=await nt.listSheets();a(D)}finally{o(!1)}};y.useEffect(()=>{h()},[]);const b=y.useMemo(()=>{const D=new Map;return t.forEach($=>{if(!$.expensesSheetId)return;const I=D.get($.expensesSheetId);if(!I){D.set($.expensesSheetId,$);return}const k=I.updatedAt&&new Date(I.updatedAt).getTime()||0;($.updatedAt&&new Date($.updatedAt).getTime()||0)>k&&D.set($.expensesSheetId,$)}),D},[t]),M=y.useMemo(()=>l.filter(D=>{if(c!=="ALL"&&D.status!==c)return!1;const $=f.trim().toLowerCase();return!($&&!(D.insurerName||"").toLowerCase().includes($))}),[l,c,f]);y.useEffect(()=>{const D=M.map($=>$.id).filter($=>!P[$]);D.length&&D.forEach($=>{(async()=>{try{const I=await nt.getSheet($);if(!I)return;const k=Qn(I.sheet,I.lineItems);x(G=>({...G,[$]:k}))}catch{}})()})},[M,P]);const U=async D=>{const $=await nt.getSheet(D);$&&(S(D),E($))},H=async()=>{const D=window.prompt("  / :")||"";if(!D.trim())return;const $=window.prompt(" ():")||"",I=await nt.createSheet(e,{caseId:D.trim(),insurerId:null,insurerName:$||null,periodLabel:"",versionIndex:1,currency:"ILS",deductibleAmount:0,alreadyPaidAmount:0,infoOnly:!1});await h(),await U(I.id)},W=D=>{E(D),a($=>$.map(I=>I.id===D.sheet.id?D.sheet:I))},O=()=>{S(null),E(null)};if(g&&A){const D=b.get(A.sheet.id)||null;return s.jsx("div",{className:"max-w-6xl mx-auto px-4 py-6",children:s.jsx(ch,{user:e,sheetWithRelations:A,onSheetUpdated:W,onBack:O,onNotifyLawyer:r,linkedReportForLawyer:D})})}return s.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-5",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:" "}),s.jsx("p",{className:"text-base text-gray-600 mt-1",children:"        ()."})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{type:"button",className:"px-3 py-1.5 text-base rounded border border-gray-300 text-gray-700 hover:bg-gray-50",onClick:n,children:""}),s.jsx("button",{type:"button",className:"px-4 py-1.5 text-base rounded bg-blue-600 text-white hover:bg-blue-700",onClick:H,children:"   "})]})]}),s.jsxs("div",{className:"flex flex-wrap gap-4 mb-4 items-end",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"  "}),s.jsxs("select",{className:"border rounded px-2 py-1 text-base",value:c,onChange:D=>u(D.target.value==="ALL"?"ALL":D.target.value),children:[s.jsx("option",{value:"ALL",children:""}),s.jsx("option",{value:"DRAFT",children:""}),s.jsx("option",{value:"READY_FOR_REPORT",children:" "}),s.jsx("option",{value:"ATTACHED_TO_REPORT",children:" "}),s.jsx("option",{value:"ARCHIVED",children:""})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),s.jsx("input",{className:"border rounded px-2 py-1 text-base",placeholder:"   ",value:f,onChange:D=>p(D.target.value)})]})]}),s.jsx("div",{className:"bg-white border rounded-lg shadow-sm overflow-x-auto text-base",children:s.jsxs("table",{className:"min-w-full",children:[s.jsx("thead",{className:"bg-gray-50",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:""}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:"   "}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:" "}),s.jsx("th",{className:"px-3 py-2 border-b text-right",children:" "}),s.jsx("th",{className:"px-3 py-2 border-b"})]})}),s.jsxs("tbody",{children:[i&&s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-3 py-4 text-center text-gray-500",children:" "})}),!i&&M.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:8,className:"px-3 py-4 text-center text-gray-500",children:"    ."})}),!i&&M.map(D=>{const $=b.get(D.id),I=P[D.id],k=$?$.status==="TASK_ASSIGNED"?" ":$.status==="WAITING_FOR_INVOICES"?" ":$.status==="READY_TO_SEND"?"   ":$.status==="SENT"?"  ":"  ":"";return s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"px-3 py-2 border-b font-mono text-sm text-gray-800",children:D.caseId}),s.jsx("td",{className:"px-3 py-2 border-b text-gray-800",children:D.insurerName||""}),s.jsxs("td",{className:"px-3 py-2 border-b text-gray-800",children:[" #",D.versionIndex]}),s.jsx("td",{className:"px-3 py-2 border-b",children:s.jsx("span",{className:"inline-flex px-2 py-0.5 rounded-full text-sm bg-gray-100 text-gray-700 border border-gray-200",children:Qy[D.status]})}),s.jsx("td",{className:"px-3 py-2 border-b text-gray-800",children:$?k:""}),s.jsx("td",{className:"px-3 py-2 border-b text-gray-700",children:D.updatedAt?new Date(D.updatedAt).toLocaleString("he-IL",{dateStyle:"short",timeStyle:"short"}):""}),s.jsx("td",{className:"px-3 py-2 border-b text-blue-700 font-semibold",children:I?`${I.amountToRequest.toLocaleString("he-IL")} `:""}),s.jsx("td",{className:"px-3 py-2 border-b text-left",children:s.jsx("button",{type:"button",className:"px-3 py-1 text-sm rounded border border-blue-500 text-blue-700 hover:bg-blue-50",onClick:()=>void U(D.id),children:""})})]},D.id)})]})]})})]})},Zy=y.createContext(void 0);let eN=0;const tN=({children:e})=>{const[t,n]=y.useState([]),r=y.useCallback(i=>{n(o=>o.filter(c=>c.id!==i))},[]),l=y.useCallback(({message:i,type:o="info"})=>{const c=++eN;n(u=>[...u,{id:c,message:i,type:o}]),window.setTimeout(()=>{r(c)},3e3)},[r]),a=i=>i==="success"?"border-green-500 text-green-900":i==="error"?"border-red-500 text-red-900":"border-blue-500 text-blue-900";return s.jsxs(Zy.Provider,{value:{showToast:l},children:[e,s.jsx("div",{className:"fixed top-4 right-4 z-[260] flex flex-col gap-2 items-end pointer-events-none",dir:"rtl",children:t.map(i=>s.jsxs("div",{className:`pointer-events-auto max-w-xs bg-white rounded-lg shadow-lg px-3 py-2 border-l-4 text-xs flex items-center gap-2 ${a(i.type)}`,children:[s.jsx("span",{className:"whitespace-pre-line",children:i.message}),s.jsx("button",{type:"button",onClick:()=>r(i.id),className:"ml-1 p-1 rounded hover:bg-slate-100 text-slate-500",children:s.jsx(jt,{className:"w-3 h-3"})})]},i.id))})]})},nN=({folder:e,reports:t,onBack:n,onUpdateReTemplate:r,onCreateReportInCase:l,onOpenReport:a})=>{const[i,o]=y.useState(e.reTemplate||""),c=()=>{const p=i.trim();p!==e.reTemplate&&r(p)},u=t.filter(p=>p.odakanitNo&&p.odakanitNo.trim()===e.odakanitNo),f=y.useMemo(()=>{const p=[],g=(S,A,E)=>{if(!S)return;const P=new Date(S).getTime();if(!Number.isFinite(P))return;const x=new Date(S).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"});p.push({date:x,sortKey:P,icon:A,label:E})};return u.forEach(S=>{g(S.reportDate,""," ")}),e.sentReports.forEach(S=>{g(S.sentAt,""," ")}),p.sort((S,A)=>S.sortKey-A.sortKey)},[u,e.sentReports]);return s.jsx("div",{className:"min-h-screen bg-gray-100 px-0 pb-8",children:s.jsxs("div",{className:"mx-auto max-w-4xl px-4 pt-4",children:[s.jsx("button",{type:"button",onClick:n,className:"mb-4 inline-flex items-center rounded-full bg-white px-3 py-1.5 text-xs font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:" Back to dashboard"}),s.jsxs("header",{className:"mb-4 rounded-2xl bg-white px-5 py-4 shadow-sm border border-gray-200",children:[s.jsxs("h1",{className:"text-xl font-serif font-bold text-lpBlue",children:["Case Folder  ",e.odakanitNo]}),s.jsx("p",{className:"mt-1 text-xs text-gray-600",children:"Central view for all reports and metadata in this case."})]}),s.jsxs("section",{className:"mb-4 grid gap-4 md:grid-cols-2",children:[s.jsxs("div",{className:"rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Case Metadata"}),s.jsxs("dl",{className:"space-y-1 text-xs text-gray-700",children:[s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Insured"}),s.jsx("dd",{children:e.insuredName||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Plaintiff"}),s.jsx("dd",{children:e.plaintiffName||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Insurer"}),s.jsx("dd",{children:e.insurerName||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"UMR / Market Ref"}),s.jsx("dd",{children:e.marketRef||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Line Slip"}),s.jsx("dd",{children:e.lineSlipNo||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Certificate Ref"}),s.jsx("dd",{children:e.certificateRef||""})]}),s.jsxs("div",{children:[s.jsx("dt",{className:"font-semibold text-gray-600",children:"Reports in case"}),s.jsx("dd",{children:e.reportIds.length})]})]})]}),s.jsxs("div",{className:"rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"RE Template"}),s.jsx("textarea",{className:"w-full rounded-lg border border-gray-300 p-2 text-xs text-gray-900 placeholder:text-gray-400 focus:border-lpBlue focus:outline-none focus:ring-1 focus:ring-lpBlue",rows:4,value:i,onChange:p=>o(p.target.value),onBlur:c,placeholder:"e.g. John Doe v. XYZ Medical Center  Claim Update"}),s.jsx("p",{className:"mt-1 text-[11px] text-gray-500",children:"This subject line will be used as the default RE for new reports in this case."})]})]}),s.jsxs("section",{className:"mb-4 rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"Timeline"}),f.length===0?s.jsx("p",{className:"text-xs text-gray-400",children:"No activity recorded for this case yet."}):s.jsx("ol",{className:"border-r border-gray-200 pr-3 text-xs text-gray-700 space-y-2",children:f.map((p,g)=>s.jsxs("li",{className:"flex items-start gap-2",children:[s.jsx("span",{className:"ml-1",children:p.icon}),s.jsxs("span",{children:[p.date,"  ",p.label]})]},`${p.sortKey}-${g}`))})]}),s.jsxs("section",{className:"mb-4 rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsxs("div",{className:"mb-3 flex items-center justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-sm font-semibold text-gray-900",children:"Previously sent reports"}),s.jsx("p",{className:"text-xs text-gray-500",children:"History of reports that were marked as SENT in this case."})]}),s.jsx("button",{type:"button",onClick:l,className:"inline-flex items-center rounded-full bg-lpBlue px-4 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:"Create new report in this case"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"min-w-full text-xs text-left text-gray-700",children:[s.jsx("thead",{className:"bg-gray-50 text-[11px] uppercase tracking-wide text-gray-500",children:s.jsxs("tr",{children:[s.jsx("th",{className:"px-3 py-2",children:"Report #"}),s.jsx("th",{className:"px-3 py-2",children:"Sent at"}),s.jsx("th",{className:"px-3 py-2",children:"File name"}),s.jsx("th",{className:"px-3 py-2",children:"Actions"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-100",children:[e.sentReports.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"px-3 py-4 text-center text-gray-400",children:"No sent reports recorded for this case yet."})}),e.sentReports.map(p=>{const g=p.sentAt?new Date(p.sentAt).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}):"";return s.jsxs("tr",{children:[s.jsx("td",{className:"px-3 py-2",children:p.reportNo?`#${p.reportNo}`:""}),s.jsx("td",{className:"px-3 py-2",children:g}),s.jsx("td",{className:"px-3 py-2",children:p.fileName||""}),s.jsx("td",{className:"px-3 py-2",children:s.jsx("button",{type:"button",onClick:()=>a(p.reportId),className:"inline-flex items-center rounded-full bg-white px-3 py-1 text-[11px] font-semibold text-lpBlue ring-1 ring-lpBlue hover:bg-blue-50 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2","aria-label":`Open report ${p.reportId}`,children:"Open"})})]},`${p.reportId}-${p.sentAt}`)})]})]})})]}),s.jsxs("section",{className:"rounded-2xl bg-white p-4 shadow-sm border border-gray-200",children:[s.jsx("h2",{className:"mb-2 text-xs font-semibold uppercase tracking-wide text-gray-500",children:"All reports in this case"}),s.jsxs("ul",{className:"space-y-1 text-xs text-gray-700",children:[u.length===0&&s.jsx("li",{className:"text-gray-400",children:"No reports are currently linked to this case."}),u.map(p=>s.jsxs("li",{className:"flex items-center justify-between",children:[s.jsxs("span",{children:[p.reportDate?new Date(p.reportDate).toLocaleDateString("en-GB"):""," "," ",p.status," "," ",p.reportSubject||"No subject"]}),s.jsx("button",{type:"button",onClick:()=>a(p.id),className:"inline-flex items-center rounded-full bg-gray-100 px-3 py-0.5 text-[11px] font-semibold text-gray-700 hover:bg-gray-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:"Open"})]},p.id))]})]})]})})},dh="lp_case_folders",uh="lp_case_folders_migrated",sN=()=>{if(typeof window>"u")return{};try{const e=window.localStorage.getItem(dh),t=e?JSON.parse(e):{};return!t||typeof t!="object"?{}:t}catch(e){return console.error("Failed to load case folders",e),{}}},dl=e=>{if(!(typeof window>"u"))try{window.localStorage.setItem(dh,JSON.stringify(e))}catch(t){console.error("Failed to persist case folders",t)}},Sc=(e,t,n)=>{if(!t.odakanitNo)return e;const r=t.odakanitNo.trim();if(!r)return e;const l=n||new Date().toISOString(),a=e[r],i=a||{odakanitNo:r,reTemplate:"",insuredName:"",insurerName:"",plaintiffName:"",marketRef:"",lineSlipNo:"",certificateRef:"",createdAt:(a==null?void 0:a.createdAt)||l,updatedAt:(a==null?void 0:a.updatedAt)||l,reportIds:[],sentReports:(a==null?void 0:a.sentReports)||[]},o={...i,insuredName:t.insuredName||i.insuredName,insurerName:t.insurerName||i.insurerName,plaintiffName:t.plaintiffName||i.plaintiffName,marketRef:t.marketRef||i.marketRef,lineSlipNo:t.lineSlipNo||i.lineSlipNo,certificateRef:t.certificateRef||i.certificateRef,updatedAt:l,reportIds:i.reportIds.includes(t.id)?i.reportIds:[...i.reportIds,t.id],sentReports:i.sentReports},c=(t.reportSubject||"").trim();return c&&(!i.reTemplate||c!==i.reTemplate)&&(o.reTemplate=c),{...e,[r]:o}},mh=(e,t,n,r,l)=>{var g;if(!t.odakanitNo)return e;const a=t.odakanitNo.trim();if(!a)return e;const i=n||new Date().toISOString(),o=e[a];if(!o)return e;const c=(((g=t.reportHistory)==null?void 0:g.length)||0)+1,u={id:t.id,odakanitNo:t.odakanitNo,insuredName:t.insuredName,plaintiffName:t.plaintiffName,insurerName:t.insurerName,marketRef:t.marketRef,lineSlipNo:t.lineSlipNo,certificateRef:t.certificateRef,reportDate:t.reportDate,status:"SENT",reportSubject:t.reportSubject},f={reportId:t.id,sentAt:i,reportNo:c,fileName:r,snapshot:u,isResend:!!l,resendIndex:c},p={...o,updatedAt:i,sentReports:[...o.sentReports,f]};return{...e,[a]:p}},rN=(e,t)=>{let n={...e};return t.forEach(r=>{if(r.odakanitNo&&(n=Sc(n,r,r.updatedAt||r.reportDate),r.status==="SENT")){const l=r.sentAt||r.reportDate||new Date().toISOString();n=mh(n,r,l)}}),n},lN=()=>{if(!(typeof window>"u"))try{window.localStorage.setItem(uh,"1")}catch{}},aN=()=>{if(typeof window>"u")return!0;try{return window.localStorage.getItem(uh)==="1"}catch{return!0}},iN={title:"Final Preview",toggleHide:"Hide Preview",toggleShow:"Show Preview",downloadPdf:"Download PDF",editFileNames:"Edit file name titles",finalize:"Finalize & Close",backToEditing:"Back to Editing",backToStep2:"Back to Step 2",backToDashboard:"Back to dashboard",helperScroll:"Scroll to review entire document",collapsedHint:'Click "Show Preview" to review the document before sending.'},oN={title:" ",toggleHide:" ",toggleShow:" ",downloadPdf:" PDF",editFileNames:"  ",finalize:" ",backToEditing:" ",backToStep2:"  2",backToDashboard:"  ",helperScroll:"    ",collapsedHint:'  " "     .'},cN=e=>e==="LAWYER"?oN:iN,dN=({message:e,type:t,onClose:n})=>s.jsxs("div",{className:`fixed top-4 right-4 z-[100] p-4 rounded-lg shadow-xl border-l-4 flex items-center gap-3 animate-slide-in bg-white ${t==="success"?"border-green-500 text-green-800":t==="error"?"border-red-500 text-red-800":"border-blue-500 text-blue-800"}`,children:[s.jsx("span",{children:e}),s.jsx("button",{onClick:n,className:"hover:bg-gray-100 p-1 rounded",children:s.jsx(jt,{className:"w-4 h-4"})})]}),uN=({onSubmit:e,onCancel:t,initialTitle:n})=>{const[r,l]=y.useState(n||""),[a,i]=y.useState("BEST_PRACTICE"),[o,c]=y.useState(""),[u,f]=y.useState("INSERTABLE"),p=g=>{g.preventDefault();const S=r.trim();if(!S)return;const A=o.split(",").map(E=>E.trim()).filter(Boolean);e({title:S,label:a,tags:A,behavior:u})};return s.jsxs("form",{onSubmit:p,className:"px-4 py-3 space-y-3 text-xs",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block font-semibold text-slate-800",children:"Title"}),s.jsx("input",{type:"text",className:"w-full border border-slate-300 rounded px-2 py-1 text-xs",value:r,onChange:g=>l(g.target.value),required:!0})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block font-semibold text-slate-800",children:"Label / Type"}),s.jsxs("select",{className:"w-full border border-slate-300 rounded px-2 py-1 text-xs",value:a,onChange:g=>i(g.target.value==="LLOYDS_RECOMMENDED"?"LLOYDS_RECOMMENDED":"BEST_PRACTICE"),children:[s.jsx("option",{value:"BEST_PRACTICE",children:"Best practice"}),s.jsx("option",{value:"LLOYDS_RECOMMENDED",children:"Lloyds recommended"})]})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block font-semibold text-slate-800",children:"Tags (optional)"}),s.jsx("input",{type:"text",className:"w-full border border-slate-300 rounded px-2 py-1 text-xs",placeholder:"e.g. lloyds, settlement, high exposure",value:o,onChange:g=>c(g.target.value)})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block font-semibold text-slate-800",children:"Behavior"}),s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsxs("label",{className:"flex items-center gap-1",children:[s.jsx("input",{type:"radio",name:"bp-behavior",checked:u==="INSERTABLE",onChange:()=>f("INSERTABLE")}),s.jsx("span",{children:"Insertable (insert into body)"})]}),s.jsxs("label",{className:"flex items-center gap-1",children:[s.jsx("input",{type:"radio",name:"bp-behavior",checked:u==="COPY_ONLY",onChange:()=>f("COPY_ONLY")}),s.jsx("span",{children:"Copy only"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-slate-200 mt-2",children:[s.jsx("button",{type:"button",onClick:t,className:"px-3 py-1.5 rounded border border-slate-300 text-[11px] text-slate-700 hover:bg-slate-100",children:""}),s.jsx("button",{type:"submit",className:"px-3 py-1.5 rounded bg-emerald-600 text-white text-[11px] hover:bg-emerald-700",children:" Best Practice"})]})]})},Nm=({value:e,onChange:t,placeholder:n,disabled:r,dir:l="ltr",className:a,style:i={},textareaRef:o})=>{const c=y.useRef(null),u=o||c;return y.useEffect(()=>{const f=u&&"current"in u?u.current:c.current;f&&(f.style.height="auto",f.style.height=f.scrollHeight+"px")},[e,u]),s.jsx(zl,{clientId:Kl,children:s.jsx("textarea",{ref:u,className:a,dir:l,value:e,onChange:t,placeholder:n,disabled:r,rows:3,style:{...i,overflow:"hidden",resize:"none"}})})},mN=({onClose:e})=>{const[t,n]=y.useState("MANUAL"),[r,l]=y.useState(""),[a,i]=y.useState([]),[o,c]=y.useState(!1),u=async()=>{if(!r.trim())return;c(!0);const f=await Ig(r);i(p=>[...p,{q:r,a:f}]),l(""),c(!1)};return s.jsx("div",{className:"fixed inset-0 bg-black/50 z-[200] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white w-full max-w-3xl h-[600px] rounded-xl shadow-2xl flex flex-col overflow-hidden animate-scale-in",children:[s.jsxs("div",{className:"bg-lpBlue p-4 text-white flex justify-between items-center",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(Nd,{className:"w-6 h-6"}),s.jsx("h2",{className:"font-bold text-lg",children:"  "})]}),s.jsx("button",{onClick:e,className:"hover:bg-white/20 rounded p-1",children:s.jsx(jt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"flex border-b",children:[s.jsx("button",{onClick:()=>n("MANUAL"),className:`flex-1 p-3 font-bold ${t==="MANUAL"?"text-lpBlue border-b-2 border-lpBlue":"text-gray-500"}`,children:" "}),s.jsx("button",{onClick:()=>n("CHAT"),className:`flex-1 p-3 font-bold ${t==="CHAT"?"text-lpBlue border-b-2 border-lpBlue":"text-gray-500"}`,children:"   "})]}),s.jsx("div",{className:"flex-1 overflow-auto p-6 bg-gray-50",dir:"rtl",children:t==="MANUAL"?s.jsxs("div",{className:"space-y-4",children:[s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:["   ",s.jsx(Rn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:"1.       (CRM / Finance /    )."}),s.jsx("p",{children:"2.       +  Notifications   ."}),s.jsx("p",{children:`3.  ""     ' .`})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:['    " ',s.jsx(Rn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsxs("p",{children:["1.   ",s.jsx("strong",{children:"Open New Case Folder"}),",      ."]}),s.jsx("p",{children:"2.  ,   4  (Word/PDF)    ."}),s.jsx("p",{children:"3.   FINANCE FINALIZE     ."})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:["   ",s.jsx(Rn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:'   View Worksheet  , ,   " .'}),s.jsx("p",{children:" /     ( ADD),    ."}),s.jsx("p",{children:'  ,      "     Expenses.'})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:["    ",s.jsx(Rn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:"  Manage Favorite Providers     ."}),s.jsx("p",{children:"        ."}),s.jsx("p",{children:'    4   (PDF/Word)  "    .'})]})]}),s.jsxs("details",{className:"bg-white p-4 rounded shadow-sm group",children:[s.jsxs("summary",{className:"font-bold text-gray-800 cursor-pointer list-none flex justify-between",children:[' "     ',s.jsx(Rn,{className:"group-open:rotate-90 transition"})]}),s.jsxs("div",{className:"mt-2 text-gray-600 text-sm space-y-1",children:[s.jsx("p",{children:"       -FINANCE   FINALIZE."}),s.jsx("p",{children:' FINALIZE  "     (READY TO SEND)   .'}),s.jsx("p",{children:"     (48   , 30   )     ."})]})]})]}):s.jsxs("div",{className:"flex flex-col h-full",children:[s.jsxs("div",{className:"flex-1 space-y-4 mb-4 overflow-auto",children:[a.length===0&&s.jsx("div",{className:"text-center text-gray-400 mt-10",children:"     !"}),a.map((f,p)=>s.jsxs("div",{className:"space-y-1",children:[s.jsx("div",{className:"bg-blue-100 text-blue-900 p-2 rounded-lg rounded-tr-none self-end w-fit ml-auto max-w-[80%]",children:f.q}),s.jsx("div",{className:"bg-white border text-gray-800 p-2 rounded-lg rounded-tl-none self-start w-fit mr-auto max-w-[80%]",children:f.a})]},p))]}),s.jsxs("div",{className:"flex gap-2",dir:"ltr",children:[s.jsx("input",{className:"flex-1 border p-2 rounded",placeholder:"/   ...",value:r,onChange:f=>l(f.target.value),onKeyDown:f=>f.key==="Enter"&&u()}),s.jsx("button",{onClick:u,disabled:o,className:"bg-lpBlue text-white px-4 rounded hover:bg-blue-800",children:o?s.jsx(Ut,{className:"w-5 h-5 animate-spin"}):s.jsx(pi,{className:"w-5 h-5"})})]})]})})]})})},fN=({reports:e,currentUser:t,onMarkPaid:n})=>{const r=e.filter(i=>i.expensesSum&&!i.isPaid),l=r.reduce((i,o)=>{var u;const c=parseFloat(((u=o.expensesSum)==null?void 0:u.replace(/,/g,""))||"0");return i+(isNaN(c)?0:c)},0),a=t.role==="SUB_ADMIN";return r.length?s.jsxs("div",{className:"mb-8 bg-white rounded-xl shadow-sm border border-indigo-100 overflow-hidden",children:[s.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-800 p-4 text-white flex justify-between items-center",children:[s.jsxs("h3",{className:"font-bold text-lg flex items-center",children:[s.jsx(eg,{className:"w-6 h-6 mr-2"})," Financial Control - Outstanding Expenses"]}),s.jsxs("div",{className:"text-xl font-bold bg-white/20 px-4 py-1 rounded",children:["Total: ",l.toLocaleString()]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-left text-sm",children:[s.jsx("thead",{className:"bg-indigo-50 text-indigo-800",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3",children:"Report Date"}),s.jsx("th",{className:"p-3",children:"Insured / File"}),s.jsx("th",{className:"p-3",children:"Amount Requested"}),s.jsx("th",{className:"p-3",children:"Action"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:r.map(i=>s.jsxs("tr",{className:"hover:bg-gray-50",children:[s.jsx("td",{className:"p-3",children:new Date(i.reportDate).toLocaleDateString()}),s.jsxs("td",{className:"p-3 font-medium",children:[i.insuredName," (",i.marketRef,")"]}),s.jsxs("td",{className:"p-3 font-bold text-indigo-700",children:["",i.expensesSum]}),s.jsx("td",{className:"p-3",children:a?s.jsx("button",{onClick:()=>n(i.id),className:"text-red-400 hover:text-red-600 hover:bg-red-50 p-1.5 rounded transition",title:"Mark as Paid",children:s.jsx(fs,{className:"w-4 h-4"})}):s.jsx("span",{className:"text-gray-400 cursor-not-allowed",children:s.jsx(fs,{className:"w-4 h-4"})})})]},i.id))})]})})]}):null},pN=[{id:"statement_of_claim",name:"Statement of Claim",src:new URL("/assets/statement%20of%20claim-BbEIHM0L.jpg",import.meta.url).href},{id:"statement_of_defence",name:"Statement of Defence",src:new URL("/assets/statement%20of%20defence-BIigMwUC.jpg",import.meta.url).href},{id:"preliminary",name:"Preliminary Proceedings",src:new URL("/assets/preliminary%20proceedings-BoY9iCcP.jpg",import.meta.url).href},{id:"evidence_submission",name:"Evidence Submission",src:new URL("/assets/evidence%20submission-CZIKo1E1.jpg",import.meta.url).href},{id:"evidentiary",name:"Evidentiary Hearing",src:new URL("/assets/evidentiary%20hearing-BibkA_Ru.jpg",import.meta.url).href},{id:"summaries",name:"Summaries",src:new URL("/assets/summaries-BEUvavav.jpg",import.meta.url).href},{id:"judgment",name:"Judgment",src:new URL("/assets/judgment-cIMuyU1R.jpg",import.meta.url).href}],Dn=[{value:"EXPERT_OUR",label:"Expert fees on our behalf",type:"EXPENSE"},{value:"EXPERT_COURT",label:"Expert fees on behalf of the court",type:"EXPENSE"},{value:"INVESTIGATION",label:"Private Investigation fees",type:"EXPENSE"},{value:"SECONDARY_FEE",label:"Payment of secondary procedure fee",type:"EXPENSE"},{value:"COURT_FEES",label:"Court fees",type:"EXPENSE"},{value:"PHOTOCOPY",label:"Photocopying and binding of documents",type:"EXPENSE"},{value:"MEDICAL_RECORDS",label:"Medical Records Collection",type:"EXPENSE"},{value:"ATTORNEY_PHASE_1",label:"Attorney fees for phase 1",type:"EXPENSE"},{value:"ATTORNEY_PHASE_2",label:"Attorney fees for phase 2",type:"EXPENSE"},{value:"ATTORNEY_PHASE_3",label:"Attorney fees for phase 3",type:"EXPENSE"},{value:"ATTORNEY_PHASE_4",label:"Attorney fees for phase 4",type:"EXPENSE"},{value:"ATTORNEY_PHASE_5",label:"Attorney fees for phase 5",type:"EXPENSE"},{value:"ATTORNEY_EXTRA_HEARING",label:"Attorney fees for extra court hearing",type:"EXPENSE"},{value:"ATTORNEY_THIRD_PARTY",label:"Attorney fees for third party notice",type:"EXPENSE"},{value:"OTHER",label:"Other",type:"EXPENSE"},{value:"COMPENSATION_JUDGMENT",label:"Compensation by Judgment",type:"ADJUSTMENT"},{value:"COMPENSATION_SETTLEMENT",label:"Compensation under Settlement",type:"ADJUSTMENT"},{value:"DEDUCTIBLE",label:"Deductible paid by the insured",type:"ADJUSTMENT"},{value:"PAID_BY_INSURER",label:"Expenses already paid by the insurer",type:"ADJUSTMENT"}],ds=()=>({status:"DRAFT",rows:[],history:[],notes:[],favorites:[],totals:{totalExpenses:0,totalAdjustments:0,totalBalance:0}}),hN=1e3*60*60*48,fh=1e3*60*60*24*30,ph=7*24*60*60*1e3,vm={lineSlip:"UNIQUE MARKET REF",certificate:"CERTIFICATE REF"},Ke={REPORTS:"lp_reports",USER:"lp_current_user",VIEW:"lp_view",CURRENT_REPORT:"lp_current_report",CASE_FOLDERS:"lp_case_folders",NOTIFICATIONS:"lp_notifications"},hh=()=>{},bm=(e,t,n)=>{if(!e)return e;let r=!1;const l={...e};if(l.content&&t.forEach(a=>{var o;const i=(o=l.content)==null?void 0:o[a];i!==void 0&&(l.content={...l.content},!l.content[n]&&i&&(l.content[n]=i),delete l.content[a],r=!0)}),l.translatedContent&&t.forEach(a=>{var o;const i=(o=l.translatedContent)==null?void 0:o[a];i!==void 0&&(l.translatedContent={...l.translatedContent},!l.translatedContent[n]&&i&&(l.translatedContent[n]=i),delete l.translatedContent[a],r=!0)}),Array.isArray(l.selectedSections)&&l.selectedSections.some(i=>t.includes(i))){const i=l.selectedSections.map(o=>t.includes(o)?n:o);l.selectedSections=Array.from(new Set(i)),r=!0}return l.expertSummaryMode&&t.forEach(a=>{var o;const i=(o=l.expertSummaryMode)==null?void 0:o[a];i&&(l.expertSummaryMode={...l.expertSummaryMode,[n]:i},delete l.expertSummaryMode[a],r=!0)}),r?l:e},xN=e=>{let t=bm(e,Wp,xs);return t=bm(t,Vp,na),t},gN=e=>{const t={...e};return t.reportReview||(t.reportReview={status:"DRAFT",issues:[]}),t.hebrewWorkflowStatus||(t.hebrewWorkflowStatus="HEBREW_DRAFT"),Array.isArray(t.reportReview.issues)&&t.reportReview.issues.length>0&&(t.reportReview={...t.reportReview,issues:t.reportReview.issues.map(n=>{const r=n.origin??"INTERNAL";let l=n.externalAction;return r==="EXTERNAL"&&!l&&(l="ENGLISH_ONLY"),{...n,origin:r,externalAction:l}})}),t},yN=()=>{if(typeof window>"u")return[];try{hh();const e=localStorage.getItem(Ke.REPORTS);return(e?JSON.parse(e):[]).map(xN).map(gN)}catch(e){return console.error("Failed to load stored reports",e),[]}},NN=()=>{if(typeof window>"u")return null;try{hh();const e=localStorage.getItem(Ke.USER);return e&&Es.find(t=>t.username===e)||null}catch(e){return console.error("Failed to load stored user",e),null}},vN=()=>{if(typeof window>"u")return"DASHBOARD";const e=localStorage.getItem(Ke.VIEW);return e&&(e==="STEP1"||e==="STEP2"||e==="PREVIEW"||e==="DASHBOARD"||e==="CASE_FOLDER")?e:"DASHBOARD"},Ni=e=>{const t=e.filter(r=>r.type==="EXPENSE").reduce((r,l)=>r+(l.amount||0),0),n=e.filter(r=>r.type==="ADJUSTMENT").reduce((r,l)=>r+(l.amount||0),0);return{totalExpenses:t,totalAdjustments:n,totalBalance:t-n}},wm=e=>{var t,n;if((t=e.expenseWorksheet)!=null&&t.totals)return e.expenseWorksheet.totals.totalBalance;if(e.expensesSum){const r=parseFloat(e.expensesSum.replace(/,/g,""));if(!isNaN(r))return r}return(n=e.expensesItems)!=null&&n.length?e.expensesItems.reduce((r,l)=>r+(l.amount||0),0):0},Sm=e=>{var t,n,r;return(((n=(t=e.expenseWorksheet)==null?void 0:t.rows)==null?void 0:n.length)??0)>0||(((r=e.expensesItems)==null?void 0:r.length)??0)>0||!!(e.expensesSum&&e.expensesSum!=="0")},rn=()=>Math.random().toString(36).slice(2,10),mr=e=>e==null?e:JSON.parse(JSON.stringify(e)),jm=e=>new Promise((t,n)=>{const r=new FileReader;r.onloadend=()=>{const l=r.result,a=l.includes(",")?l.split(",")[1]:l;t(a)},r.onerror=()=>n(new Error("Failed to convert blob")),r.readAsDataURL(e)}),xh=e=>e?e.replace(/\r\n/g,`
`).replace(/\t/g," ").split(`
`).map(r=>r.replace(/\s+$/g,"").replace(/ {2,}/g," ")).join(`
`).trim().replace(/\n{3,}/g,`

`):"",Eo=e=>{const t=e||{};return Object.keys(t).reduce((n,r)=>(n[r]=xh(t[r]),n),{})},bN=`
               . ,   ,          .

          , ,  ,            .

      -  ,     .

   ,     ,                .

      .
`.trim(),wN=["The policy period is from [policyStartDate] to [policyEndDate].","","The retroactive date is [retroactiveDate].","","    _______________, ,   .","","      ,     ____________  ____________.","",",         ."].join(`
`),gh=(e,t,n,r,l)=>{const a=wN,i=M=>`${M}`,o=t||"",c=n||"",u=r||l||"",f=i(`The policy period is from ${o} to ${c}.`),p=i(`The retroactive date is ${u}.`),g=["    _______________, ,   .","","      ,     ____________  ____________.","",",         ."].join(`
`),S=M=>M.replace(/\[policyStartDate\]/gi,o).replace(/\[policyEndDate\]/gi,c).replace(/\[retroactiveDate\]/gi,u),A=`${f}

${p}

${g}`,E=a?S(a):"";if(!E&&!e)return A;let x=e&&e.trim().length?e:E||A;(/\[policyStartDate\]/i.test(x)||/\[policyEndDate\]/i.test(x)||/\[retroactiveDate\]/i.test(x))&&(x=S(x));const h=/The policy period is[^\n]*/i;h.test(x)?x=x.replace(h,f):(!e||!e.trim())&&(x=`${f}

${x}`);const b=/The retroactive date is[^\n]*/i;return b.test(x)?x=x.replace(b,p):(!e||!e.trim())&&(x=x.includes(f)?x.replace(f,`${f}

${p}`):`${p}

${x}`),x.includes("   ")||(x=`${x.trim()}

${g}`),x},jc=(e,t)=>e.map(n=>{var i;const r=Dn.find(o=>o.value===n.category),l=(r==null?void 0:r.type)||"EXPENSE",a=n.category==="OTHER"?((i=n.customLabel)==null?void 0:i.trim())||"Other expense":(r==null?void 0:r.label)||"Expense";return{id:n.id||rn(),type:l,category:n.category,label:a,serviceProvider:l==="EXPENSE"?n.serviceProvider:void 0,amount:Number(n.amount)||0,locked:!1,createdBy:t==null?void 0:t.id,createdAt:new Date().toISOString(),updatedBy:t==null?void 0:t.id,updatedAt:new Date().toISOString()}}),SN=e=>e.filter(t=>t.type==="EXPENSE").map(t=>({id:t.id,date:new Date().toISOString().split("T")[0],description:`${t.label}${t.serviceProvider?` (${t.serviceProvider})`:""}`,amount:t.amount,currency:"NIS"})),jN=({data:e,updateData:t,onNext:n,currentUser:r,timelineGallery:l,onAddTimelineImages:a,onRemoveTimelineImage:i,onSaveAndExit:o})=>{var te,se,ye;const[c,u]=y.useState(""),[f,p]=y.useState(!1),g=e.insurerName===""||Zu.includes(e.insurerName),[S,A]=y.useState(!g),[E,P]=y.useState(!1),[x,h]=y.useState(!1);y.useRef(null);const b=L=>L?new Date(L).toISOString().split("T")[0]:new Date().toISOString().split("T")[0],M=L=>L.trim().replace(/\s+/g," "),U=L=>{const le=e,Ie="plaintiffName"in L?L.plaintiffName??le.plaintiffName:le.plaintiffName,Ae="insuredName"in L?L.insuredName??le.insuredName:le.insuredName;if(!(!!Ie&&!!Ae))return L;const Te=M(Ie),he=M(Ae),et=`${Te} v. ${he}`,q="reportSubject"in L?L.reportSubject??le.reportSubject:le.reportSubject,F="isSubjectAuto"in L?L.isSubjectAuto??le.isSubjectAuto:le.isSubjectAuto;return!q||!q.trim()||F?{...L,reportSubject:et,isSubjectAuto:!0}:L},H=L=>{L==="OTHER"?(A(!0),t(U({insurerName:""}))):(A(!1),t(U({insurerName:L})))},W=()=>{if(!e.odakanitNo||!e.odakanitNo.trim()){alert("     (Odakanit)    .");return}n()},O=L=>{e.selectedSections.includes(L)||t({selectedSections:[...e.selectedSections,L]}),p(!1)},D=L=>{L!=="Update"&&t({selectedSections:e.selectedSections.filter(le=>le!==L)})},$=()=>{c.trim()&&!e.selectedSections.includes(c)&&(t({selectedSections:[...e.selectedSections,c]}),u(""))},I=(L,le)=>{const Ie=le==="UP"?L-1:L+1;if(Ie<0||Ie>=e.selectedSections.length)return;const Ae=[...e.selectedSections];[Ae[L],Ae[Ie]]=[Ae[Ie],Ae[L]],t({selectedSections:Ae})},k=L=>{t({selectedTimeline:L.id,selectedTimelineImage:L.src}),l.some(le=>le.name===L.name)||a([{name:L.name,src:L.src}])},G=async L=>{var Ie;const le=(Ie=L.target.files)==null?void 0:Ie[0];if(le){P(!0);try{const Ae=new FileReader;Ae.onload=async()=>{var q;const Le=Ae.result.split(",")[1],Te=await wg(Le,le.type);let he={};Te.insuredName&&(he=U({...he,insuredName:Te.insuredName})),Te.marketRef?(he.marketRef=Te.marketRef,he.lineSlipNo=Te.marketRef):Te.lineSlipNo&&!he.lineSlipNo&&(he.lineSlipNo=Te.lineSlipNo),Te.certificateRef&&(he.certificateRef=Te.certificateRef),typeof Te.policyPeriodStart=="string"&&(he.policyPeriodStart=Te.policyPeriodStart),typeof Te.policyPeriodEnd=="string"&&(he.policyPeriodEnd=Te.policyPeriodEnd),typeof Te.retroStart=="string"&&(he.retroStart=Te.retroStart),typeof Te.retroEnd=="string"&&(he.retroEnd=Te.retroEnd),he.policyFile={id:"policy-doc",name:le.name,data:Le,type:le.type};const et=gh((q=e.content)==null?void 0:q["Insurance Coverage"],he.policyPeriodStart||e.policyPeriodStart,he.policyPeriodEnd||e.policyPeriodEnd,he.retroStart||e.retroStart,he.retroEnd||e.retroEnd);et&&(he.content={...e.content,"Insurance Coverage":et}),t(he),P(!1)},Ae.readAsDataURL(le)}catch(Ae){console.error("Error reading file",Ae),P(!1)}}},de=10,ne=10,V=async L=>{const le=L.target.files;if(!le||!le.length)return;const Ie=e.lawyerAppendixFiles??[];if(Ie.length>=de){alert(`You can attach up to ${de} appendices.`),L.target.value="";return}const Ae=de-Ie.length,Le=Array.from(le).slice(0,Ae),Te=[];for(const he of Le){if(he.size/1048576>ne){alert(`${he.name} is larger than ${ne}MB and will not be attached.`);continue}let q=he.type;q||(/\.(tif|tiff)$/i.test(he.name)?q="image/tiff":q="application/octet-stream");const F=new FileReader,Ne=await new Promise((xe,ze)=>{F.onload=()=>{const X=String(F.result||"").split(",");xe(X[1]||"")},F.onerror=()=>ze(F.error),F.readAsDataURL(he)});Te.push({id:`lawyer-appx-${Date.now()}-${Math.random().toString(36).slice(2,8)}`,name:he.name,data:Ne,type:q})}Te.length&&t({lawyerAppendixFiles:[...Ie,...Te]}),L.target.value=""},K=L=>{const Ie=(e.lawyerAppendixFiles??[]).filter(Ae=>Ae.id!==L);t({lawyerAppendixFiles:Ie})},R=(L,le,Ie)=>s.jsxs("div",{className:"relative group",children:[s.jsx("input",{className:"w-full border border-gray-300 p-2 rounded focus:ring-2 focus:ring-lpBlue outline-none pr-8",placeholder:Ie,value:L,onChange:Ae=>le(Ae.target.value)}),L&&s.jsx("button",{onClick:()=>le(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-300 hover:text-red-500 transition-colors",children:s.jsx(fs,{className:"w-4 h-4"})})]});return s.jsxs("div",{className:"space-y-8",children:[s.jsx("div",{className:"flex justify-end",children:s.jsxs("button",{onClick:o,className:"flex items-center text-sm text-lpBlue hover:text-blue-900 bg-blue-50 px-3 py-1.5 rounded-full",children:[s.jsx(vd,{className:"w-4 h-4 mr-1"}),"  "]})}),s.jsx("h2",{className:"text-3xl font-bold text-lpBlue font-serif border-b pb-2",children:"1. Case Setup & Structure"}),e.odakanitNo&&s.jsx("div",{className:"bg-indigo-50 border-l-4 border-indigo-600 p-4 mb-6",children:s.jsx("div",{className:"flex justify-between items-center",children:s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-indigo-900 flex items-center",children:[s.jsx($p,{className:"w-5 h-5 mr-2"})," Odakanit Case #",e.odakanitNo]}),s.jsx("p",{className:"text-sm text-indigo-700",children:"This report folder was initiated by Finance."})]})})}),s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 relative overflow-hidden",children:[s.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-lpGold"}),s.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 flex items-center",children:[s.jsx(Wl,{className:"w-5 h-5 mr-2 text-lpGold"}),"Re: Case Details (Mandatory Fields - English)"]}),s.jsx("div",{className:"mb-6 bg-blue-50 border-2 border-dashed border-blue-200 rounded-lg p-4 text-center relative group",children:E?s.jsxs("div",{className:"flex flex-col items-center justify-center py-2",children:[s.jsx(Ut,{className:"w-8 h-8 text-lpBlue animate-spin mb-2"}),s.jsx("span",{className:"text-sm font-bold text-lpBlue",children:"Analyzing Policy Document..."})]}):s.jsx(s.Fragment,{children:e.policyFile?s.jsxs("div",{className:"flex flex-col items-center justify-center gap-3",children:[s.jsxs("div",{className:"flex items-center justify-center gap-3",children:[s.jsxs("div",{className:"flex flex-col items-center text-green-700 font-bold text-center",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(Bp,{className:"w-6 h-6 mr-2"}),"Policy Document Attached"]}),s.jsxs("span",{className:"text-xs font-normal text-green-800",children:["Original file: ",e.policyFile.name]})]}),s.jsx("button",{className:"text-xs text-red-500 hover:underline",onClick:()=>t({policyFile:void 0}),children:"Remove"})]}),s.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs text-gray-700 bg-white/70 px-3 py-1 rounded-full border border-gray-200",children:[s.jsx("input",{id:"attach-policy-appendix",type:"checkbox",className:"h-3 w-3 accent-lpBlue",checked:e.attachPolicyAsAppendix??!0,onChange:L=>t({attachPolicyAsAppendix:L.target.checked})}),s.jsx("label",{htmlFor:"attach-policy-appendix",className:"cursor-pointer",children:"Attach policy as Appendix A to final PDF"})]})]}):s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"flex flex-col items-center justify-center cursor-pointer text-center px-4",children:[s.jsx(Vl,{className:"w-8 h-8 text-lpBlue mb-2 group-hover:scale-110 transition-transform"}),s.jsx("span",{className:"text-sm font-bold text-gray-700",children:"Upload Policy Document"}),s.jsx("span",{className:"text-xs text-gray-500 mt-1",children:"Any file uploaded here (PDF/DOCX/scan) is treated as the official policy for this case."})]}),s.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",accept:"application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,image/*",onChange:G})]})})}),s.jsxs("div",{className:"mb-6 mt-4 bg-slate-50 border border-dashed border-slate-300 rounded-lg p-4",children:[s.jsxs("h4",{className:"text-sm font-semibold text-slate-800 mb-2 flex items-center justify-between",children:[s.jsx("span",{children:"Additional Appendices (Lawyer)"}),s.jsxs("span",{className:"text-[11px] text-slate-500",children:[((te=e.lawyerAppendixFiles)==null?void 0:te.length)||0,"/",de]})]}),s.jsx("div",{className:"flex flex-col md:flex-row gap-3 md:items-center",children:s.jsx("div",{className:"flex-1",children:s.jsxs("label",{htmlFor:"lawyer-appendix-input",className:"flex flex-col items-center justify-center px-3 py-3 border-2 border-dashed border-slate-300 rounded-lg text-xs text-slate-600 bg-white hover:border-lpBlue hover:text-lpBlue cursor-pointer transition-colors",children:[s.jsx(Vl,{className:"w-5 h-5 mb-1"}),s.jsx("span",{className:"font-semibold",children:"Upload / drag legal appendices"}),s.jsxs("span",{className:"mt-1 text-[11px] text-slate-500",children:["Supported: PDF, PNG, JPG, TIFF (up to ",ne,"MB per file)"]}),s.jsx("input",{id:"lawyer-appendix-input",type:"file",multiple:!0,className:"hidden",accept:"application/pdf,image/png,image/jpeg,image/jpg,image/tiff,image/x-tiff",onChange:V})]})})}),(((se=e.lawyerAppendixFiles)==null?void 0:se.length)||0)>0&&s.jsx("div",{className:"mt-3 border-t border-slate-200 pt-2 space-y-1 max-h-40 overflow-y-auto text-xs text-slate-700 text-left",children:(ye=e.lawyerAppendixFiles)==null?void 0:ye.map(L=>s.jsxs("div",{className:"flex items-center justify-between gap-2 rounded bg-white px-2 py-1 border border-slate-200",children:[s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsx("div",{className:"truncate font-medium",children:L.name}),s.jsx("div",{className:"text-[11px] text-slate-500 truncate",children:L.type||"Unknown type"})]}),s.jsx("button",{type:"button",onClick:()=>K(L.id),className:"text-[11px] text-red-500 hover:text-red-700",children:"Remove"})]},L.id))})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[s.jsxs("div",{className:"space-y-1",children:[s.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase flex items-center",children:[s.jsx(tg,{className:"w-3 h-3 mr-1"})," Report Date"]}),s.jsx("input",{type:"date",className:"w-full border border-gray-300 p-2 rounded",value:b(e.reportDate),onChange:L=>t({reportDate:new Date(L.target.value).toISOString()})})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"RE (Subject)"}),s.jsx("input",{type:"text",className:"w-full border border-gray-300 p-2 rounded text-sm",placeholder:"e.g. John Doe v. XYZ Medical Center  Claim Update",value:e.reportSubject||"",onChange:L=>t({reportSubject:L.target.value,isSubjectAuto:!1})})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Odakanit Case Number (Internal File)"}),R(e.odakanitNo||"",L=>t({odakanitNo:L}),"e.g., 1/123")]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Insurer Name"}),s.jsxs("select",{className:"w-full border border-gray-300 p-2 rounded",value:S?"OTHER":e.insurerName,onChange:L=>H(L.target.value),children:[s.jsx("option",{value:"",disabled:!0,children:"-- Select Insurer --"}),Zu.map(L=>s.jsx("option",{value:L,children:L},L)),s.jsx("option",{value:"OTHER",children:"Other (Enter Manually)"})]}),S&&s.jsx("div",{className:"mt-2 animate-fade-in",children:R(e.insurerName,L=>t({insurerName:L}),"Type custom insurer name...")})]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:vm.lineSlip}),R(e.lineSlipNo,L=>t({lineSlipNo:L,marketRef:L}),"e.g., B0180PD2391439")]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:vm.certificate}),R(e.certificateRef||"",L=>t({certificateRef:L}),"e.g., 516902624")]}),s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Insured Name"}),R(e.insuredName,L=>t(U({insuredName:L})),"e.g., Dr. Cohen")]}),s.jsxs("div",{className:"space-y-1 md:col-span-2",children:[s.jsxs("div",{className:"flex justify-between items-end mb-1",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Party Name"}),s.jsxs("div",{className:"flex bg-gray-100 rounded p-0.5 text-xs",children:[s.jsx("button",{className:`px-3 py-1 rounded-sm transition-all ${e.plaintiffTitle==="Plaintiff"?"bg-white shadow text-lpBlue font-bold":"text-gray-500"}`,onClick:()=>t({plaintiffTitle:"Plaintiff"}),children:"Plaintiff"}),s.jsx("button",{className:`px-3 py-1 rounded-sm transition-all ${e.plaintiffTitle==="Claimant"?"bg-white shadow text-lpBlue font-bold":"text-gray-500"}`,onClick:()=>t({plaintiffTitle:"Claimant"}),children:"Claimant"})]})]}),R(e.plaintiffName,L=>t(U({plaintiffName:L})),"e.g., Mr. Levi")]})]})]}),s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[s.jsx("div",{className:"flex justify-between items-center mb-4",children:s.jsxs("div",{children:[s.jsxs("h3",{className:"font-bold text-lg text-gray-800 flex items-center",children:[s.jsx(Nc,{className:"w-5 h-5 mr-2 text-lpBlue"}),"Timeline Selection"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"       (   )."})]})}),s.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:pN.map(L=>{const le=e.selectedTimeline===L.id;return s.jsxs("button",{type:"button",onClick:()=>k(L),className:`text-left border rounded-xl p-4 transition hover:shadow-lg focus:outline-none ${le?"border-lpBlue ring-2 ring-lpBlue/30 shadow-lg bg-blue-50":"border-gray-200 bg-white"}`,children:[s.jsx("p",{className:"font-semibold text-gray-800",children:L.name}),s.jsx("p",{className:"text-xs text-gray-500",children:"     "}),le&&s.jsx("span",{className:"text-xs font-bold text-lpBlue mt-1 inline-block",children:""})]},L.id)})}),l.length>0&&s.jsxs("div",{className:"mt-6",children:[s.jsxs("h4",{className:"text-sm font-bold text-gray-700 mb-2 flex items-center gap-2",children:[s.jsx(Nc,{className:"w-3 h-3 text-lpBlue"})," Selected Timeline Slides"]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:l.map(L=>s.jsxs("div",{className:"px-3 py-1.5 border border-gray-200 rounded-full bg-white text-xs font-semibold text-gray-700 flex items-center gap-2",children:[s.jsx("span",{children:L.name}),i&&s.jsx("button",{onClick:()=>i(L.id),className:"text-red-400 hover:text-red-600",children:s.jsx(jt,{className:"w-3 h-3"})})]},L.id))})]})]}),s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:[s.jsxs("h3",{className:"font-bold text-lg mb-4 text-gray-800 flex items-center",children:[s.jsx(dg,{className:"w-5 h-5 mr-2 text-green-600"}),"Current Report Sections"]}),s.jsx("div",{className:"space-y-2 mb-6",children:e.selectedSections.map((L,le)=>{const Ie=le>0,Ae=le<e.selectedSections.length-1,Le=L==="Update";return s.jsxs("div",{className:"flex items-center justify-between p-3 bg-white border border-gray-200 rounded shadow-sm",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"w-6 h-6 rounded-full bg-gray-100 text-gray-500 flex items-center justify-center text-xs font-bold",children:le+1}),s.jsx("span",{className:"font-medium text-gray-800",children:L}),Le&&s.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-0.5 rounded",children:"Fixed"})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("div",{className:"flex flex-col gap-1",children:[s.jsx("button",{onClick:()=>I(le,"UP"),disabled:!Ie,className:`p-1 rounded border ${Ie?"text-gray-600 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,title:" ",children:s.jsx(sg,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>I(le,"DOWN"),disabled:!Ae,className:`p-1 rounded border ${Ae?"text-gray-600 hover:bg-gray-100":"text-gray-300 cursor-not-allowed"}`,title:" ",children:s.jsx(ng,{className:"w-4 h-4"})})]}),!Le&&s.jsx("button",{onClick:()=>D(L),className:"text-gray-400 hover:text-red-500 transition",title:" ",children:s.jsx(jt,{className:"w-4 h-4"})})]})]},`${L}-${le}`)})}),f?s.jsxs("div",{className:"bg-gray-50 p-4 rounded border animate-fade-in",children:[s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("select",{className:"flex-1 border p-2 rounded",onChange:L=>O(L.target.value),defaultValue:"",children:[s.jsx("option",{value:"",disabled:!0,children:"-- Select a Header --"}),hl.filter(L=>!e.selectedSections.includes(L)).map(L=>s.jsx("option",{value:L,children:L},L))]}),s.jsx("button",{onClick:()=>p(!1),className:"px-4 py-2 bg-gray-200 text-gray-600 rounded hover:bg-gray-300",children:"Cancel"})]}),s.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{className:"flex-1 border p-2 rounded",placeholder:"Type custom header name...",value:c,onChange:L=>u(L.target.value)}),s.jsx("button",{onClick:()=>{$(),p(!1)},className:"px-4 py-2 bg-purple-600 text-white rounded hover:bg-purple-700",children:"Add Custom"})]})})]}):s.jsxs("button",{onClick:()=>p(!0),className:"w-full py-2 border-2 border-dashed border-gray-300 text-gray-500 rounded hover:border-green-500 hover:text-green-600 transition flex items-center justify-center font-medium",children:[s.jsx(wd,{className:"w-4 h-4 mr-2"})," Add Report Section"]})]}),s.jsxs("div",{className:"flex flex-wrap justify-between gap-2",children:[s.jsxs("button",{onClick:o,className:"flex items-center text-gray-600 px-4 py-2 border rounded hover:bg-gray-50 transition",children:[s.jsx(fi,{className:"mr-2 w-4 h-4"})," Back to Dashboard"]}),s.jsxs("button",{onClick:W,className:"flex items-center bg-lpBlue text-white px-6 py-2 rounded hover:bg-blue-900 transition shadow-md",children:["Next Step ",s.jsx(Rn,{className:"ml-2 w-4 h-4"})]})]})]})},EN=({data:e,updateData:t,onBack:n,onNext:r,currentUser:l,onSaveAndExit:a,onTranslate:i,onFormatContent:o,onSubmitHebrewForReview:c,onApproveHebrewForTranslation:u,onAddReviewIssues:f,onMarkReviewIssueDone:p,onAddExternalFeedbackIssues:g,onReopenHebrewDueToExternalFeedback:S,step1Focus:A,onStep1FocusConsumed:E,isTranslating:P})=>{var rs;const x=xs,h=na,[b,M]=y.useState(null),[U,H]=y.useState(!1),[W,O]=y.useState(null),[D,$]=y.useState([]),[I,k]=y.useState(""),[G,de]=y.useState(!1),[ne,V]=y.useState(()=>hl[0]||"Update"),[K,R]=y.useState([]),[te,se]=y.useState(!1),[ye,L]=y.useState(null),[le,Ie]=y.useState([]),[Ae,Le]=y.useState(!1),[Te,he]=y.useState(null),[et,q]=y.useState([]),[F,Ne]=y.useState("TEMPLATES"),[xe,ze]=y.useState(""),[_,X]=y.useState(!1),[fe,ge]=y.useState(()=>hl[0]||"Update"),[Z,re]=y.useState(null),[pe,z]=y.useState(null),[we,ve]=y.useState(null),[ue,je]=y.useState(null),[be,Oe]=y.useState(null),Xe=y.useRef(null),Fe=y.useRef(null),Ye=y.useRef({}),[We,mt]=y.useState({date:new Date().toISOString().split("T")[0],description:"",amount:0,currency:"NIS"}),lt=l.role==="FINANCE"||l.role==="SUB_ADMIN"&&!0,Vr=e.selectedSections.some(N=>N.toLowerCase().includes("expenses")),Yr=l.role==="LAWYER"&&e.requiresExpenses===!0&&Vr,Cs=l.role==="ADMIN"&&e.isTranslated,Gr=l.role==="LAWYER"||l.role==="ADMIN",gt=l.role==="FINANCE"||l.role==="SUB_ADMIN"||l.role==="ADMIN",ct=((rs=e.reportReview)==null?void 0:rs.status)==="APPROVED"||e.hebrewWorkflowStatus==="HEBREW_APPROVED",Kr=N=>lm(N)?"EXPERT":N===h?"DEMAND":"CLAIM";y.useEffect(()=>{if(!A)return;const N=()=>{let T=null;A==="EXTERNAL_FEEDBACK"?T=vc:A==="REVIEW"&&(T=Ba);let B=null;if(T&&(B=document.getElementById(T)),B||(B=document.getElementById(Ba)),B)try{B.scrollIntoView({behavior:"smooth",block:"start"})}catch{}E&&E()};typeof window<"u"?window.requestAnimationFrame(()=>{const T=A==="EXTERNAL_FEEDBACK"&&document.getElementById(vc)||document.getElementById(Ba);if(T){try{T.scrollIntoView({behavior:"smooth",block:"start"})}catch{}E&&E()}else setTimeout(N,0)}):N()},[A,E]);const ts=()=>{if(!gt||!We.description||!We.amount)return;const N={id:Date.now().toString(),date:We.date||"",description:We.description,amount:Number(We.amount),currency:We.currency||"NIS"},T=[...e.expensesItems,N],B=T.reduce((d,m)=>d+m.amount,0);t({expensesItems:T,expensesSum:B.toLocaleString()}),mt({date:new Date().toISOString().split("T")[0],description:"",amount:0,currency:"NIS"})},Ds=N=>{const T=e.expensesItems.filter(d=>d.id!==N),B=T.reduce((d,m)=>d+m.amount,0);t({expensesItems:T,expensesSum:B.toLocaleString()})},Zs=async N=>{const T=N.target.files;if(!T)return;const B=e.invoiceFiles.length;if(B>=4){O({msg:"   4   (PDF  Word).",type:"info"}),N.target.value="";return}const d=Array.from(T).slice(0,4-B),m=[];for(let ee=0;ee<d.length;ee++){const ie=d[ee],Q=new FileReader;await new Promise(Ce=>{Q.onload=He=>{var Me;m.push({id:`inv-${Date.now()}-${ee}`,name:ie.name,data:((Me=He.target)==null?void 0:Me.result).split(",")[1],type:ie.type}),Ce()},Q.readAsDataURL(ie)})}const w=[...e.invoiceFiles,...m],j=w.length>0,Y=gt&&e.status==="WAITING_FOR_INVOICES"&&j?"TASK_ASSIGNED":e.status;t({invoiceFiles:w,isWaitingForInvoices:!j,status:Y}),O({msg:"   ( 4 ).",type:"success"})},qr=N=>{const T=e.invoiceFiles.filter(w=>w.id!==N),B=T.length>0,m=gt&&!B&&e.status==="TASK_ASSIGNED"?"WAITING_FOR_INVOICES":e.status;t({invoiceFiles:T,isWaitingForInvoices:!B,status:m})},Bt=(N,T)=>{lt||t({content:{...e.content,[N]:T}})};y.useEffect(()=>{let N=!1;return(async()=>{try{const B=await em();N||$(B)}catch(B){console.error("Failed to load templates",B)}try{const B=await kg();N||q(B)}catch(B){console.error("Failed to load best practices",B)}})(),()=>{N=!0}},[]);const er=(N,T)=>{Cs&&t({translatedContent:{...e.translatedContent,[N]:T}})},yt=N=>D.filter(T=>T.sectionKey===N&&T.isEnabled!==!1).sort((T,B)=>(T.orderIndex||0)-(B.orderIndex||0)||T.createdAt.localeCompare(B.createdAt)),tn=(N,T)=>{if(lt)return;let B=T.body.replace(/{plaintiff}/g,e.plaintiffName||"the claimant").replace(/{insured}/g,e.insuredName||"the insured").replace(/\[DATE\]/g,new Date().toLocaleDateString("he-IL"));const d=e.content[N]||"";Bt(N,d?`${d}

${B}`:B),M(null)},Ls=async N=>{try{const T=await em();$(T)}catch(T){console.error("Failed to refresh templates",T)}k(""),ze(""),M(T=>T===N?null:N)},ns=async N=>{if(l.role!=="ADMIN")return;const T=Ye.current[N],B=T==null?void 0:T.current;if(!B){O({msg:"     .",type:"error"});return}const d=B.selectionStart??0,m=B.selectionEnd??0;if(d===m){O({msg:"     .",type:"info"});return}let j=(e.content[N]||"").slice(d,m).trim();if(!j){O({msg:"    .",type:"info"});return}if(j.length<15&&!window.confirm("   .    ?"))return;const C=j.split(/\s+/).slice(0,6).join(" "),ee=(window.prompt(" :",C)||"").trim();if(!ee){O({msg:"   ( ).",type:"info"});return}const ie=new Date().toISOString(),Q={id:"",sectionKey:N,title:ee,body:j,createdByUserId:l.id,createdAt:ie,updatedAt:ie,isEnabled:!0};try{const Ce=await tm(Q,l.role);$(Ce),O({msg:"  .",type:"success"})}catch(Ce){console.error("Failed to save template",Ce),O({msg:"  .",type:"error"})}},jn=async(N,T)=>{if(l.role!=="ADMIN")return;const B=D.find(m=>m.id===N);if(!B)return;const d={...B,...T,updatedAt:new Date().toISOString()};try{const m=await tm(d,l.role);$(m)}catch(m){console.error("Failed to update template",m),O({msg:"  .",type:"error"})}},pn=async N=>{if(l.role==="ADMIN")try{const T=await Ng(N,l.role);$(T)}catch(T){console.error("Failed to delete template",T),O({msg:"  .",type:"error"})}},v=async(N,T)=>{if(l.role==="ADMIN")try{const B=await vg(N,T,l.role);$(B)}catch(B){console.error("Failed to reorder template",B),O({msg:"   .",type:"error"})}},ae=async N=>{if(lt)return;const T=e.content[N];if(T){je(N),H(!0);try{const B=await Sg(T);Bt(N,B)}finally{H(!1),je(null)}}},Ee=async(N,T,B)=>{var d;H(!0);try{const m=await Eg(T,B);if((d=m.items)!=null&&d.length){const w=[...e.expensesItems,...m.items],j=w.reduce((C,Y)=>C+(Y.amount||0),0);t({expensesItems:w,expensesSum:j.toLocaleString()}),O({msg:`  "${N}"  .`,type:"success"})}else O({msg:"    .",type:"info"})}catch(m){console.error("Expenses extraction failed",m),O({msg:" .   PDF/Word .",type:"error"})}finally{H(!1)}},Se=N=>new Promise((T,B)=>{const d=new FileReader;d.onload=()=>T(d.result.split(",")[1]),d.onerror=()=>B(new Error("Failed to read file")),d.readAsDataURL(N)}),Ue=N=>{var Y,ee,ie,Q,Ce,He,Me,tt;if(!N)return;const T=[...e.selectedSections],B=ke=>{T.includes(ke)||T.push(ke)},d=ke=>ke&&ke.length?ke.map(sn=>` ${sn}`).join(`
`):"",m=(Y=N.timeline)!=null&&Y.length?N.timeline.map(ke=>` ${(ke==null?void 0:ke.date)||"  "}  ${(ke==null?void 0:ke.event)||""}`).join(`
`):"",w={...e.content};if(N.briefSummary||m||(ee=N.injuries)!=null&&ee.length){B("Update");const ke=d(N.injuries),sn=d(N.requestedRelief),_s=[N.briefSummary||"",ke?`
 :
${ke}`:"",sn?`
 :
${sn}`:"",m?`
 :
${m}`:""].filter(Boolean);w.Update=_s.join(`
`).trim()}if((ie=N.facts)!=null&&ie.length){const ke=xs;B(ke),w[ke]=d(N.facts)}const j=[];if((Q=N.allegations)!=null&&Q.length&&j.push(` :
${d(N.allegations)}`),(Ce=N.negligenceTheory)!=null&&Ce.length&&j.push(` :
${d(N.negligenceTheory)}`),(He=N.medicalFindings)!=null&&He.length&&j.push(` :
${d(N.medicalFindings)}`),j.length){const ke=e.selectedSections.includes("Strategy & Recommendations")?"Strategy & Recommendations":"Strategy";B(ke),w[ke]=j.join(`

`)}N.riskAssessment&&(B("Risk Assessment"),w["Risk Assessment"]=N.riskAssessment);const C=[];(Me=N.recommendedActions)!=null&&Me.length&&C.push(d(N.recommendedActions)),(tt=N.requestedRelief)!=null&&tt.length&&C.push(` :
${d(N.requestedRelief)}`),C.length&&(B("Recommendations"),w.Recommendations=C.join(`

`)),t({content:w,selectedSections:T,complaintAnalysis:N}),O({msg:"     .",type:"success"})},Pe=(N,T)=>{var ra,Zr,_d,Od,Pd;if(!N)return"";const B=(T==null?void 0:T.analysisType)==="DEMAND"||(T==null?void 0:T.section)===h?"DEMAND":"CLAIM",d=B==="DEMAND"?"":"",m=B==="DEMAND"?"   ":"  ",w=(Zr=(ra=N.entities)==null?void 0:ra.plaintiff)==null?void 0:Zr.trim(),j=(N.defendants||[]).filter(Boolean).join(", "),C=[];C.push(w?`${d}, ${w}`:d),j&&C.push(`${m} ${j}`);const Y=`${C.join(" ")}.`.replace(/\s+/g," ").trim(),ee=(_t,Md,Fd,Nh=!1)=>{const Fi=Md.map(Bi=>Bi.trim()).filter(Boolean);if(!Fi.length&&Nh)return"";const Bd=Fi.length?Fi:Fd?[Fd]:[];if(!Bd.length)return"";const vh=Bd.map((Bi,bh)=>`${bh+1}. ${Bi}`.trim()).join(`
`);return`${_t}
${vh}`},ie=((_d=N.timeline)==null?void 0:_d.map(_t=>!(_t!=null&&_t.event)&&!(_t!=null&&_t.date)?"":`${_t!=null&&_t.date?` ${_t.date} `:""}${(_t==null?void 0:_t.event)||""}`.trim()).filter(Boolean))||[],Q=((Od=N.facts)==null?void 0:Od.filter(Boolean))||[],Ce=ie.length?ie:Q,Me=ee(B==="DEMAND"?"    :":"    :",Ce,"    ."),tt=B==="DEMAND"?"    :":"    :",ke=((Pd=N.allegations)==null?void 0:Pd.filter(Boolean))||[],sn=ee(tt,ke,"    ."),_s=[...N.injuries||[],...N.medicalFindings||[],...N.requestedRelief||[]].filter(Boolean),ls=ee(B==="DEMAND"?"      :":"      :",_s,void 0,!0);return[Y,Me,sn,ls].filter(Boolean).join(`

`).trim()},At=()=>{Bt("Strategy",bN),O({msg:' " "  .',type:"success"})},Re=(N,T)=>{var m;const B=(m=N.target.files)==null?void 0:m[0];if(!B)return;if(!T.includes("Expenses")){N.target.value="";return}const d=new FileReader;d.onload=async w=>{var C;const j=((C=w.target)==null?void 0:C.result).split(",")[1];await Ee(B.name,j,B.type)},d.readAsDataURL(B),N.target.value=""},nn=N=>{Oe(null),z(N),setTimeout(()=>{var T;(T=Xe.current)==null||T.click()},0)},Xr=async N=>{var d,m;const T=(d=N.target.files)==null?void 0:d[0];if(!T||!pe){z(null),N.target.value="";return}H(!0);const B=pe.section||pe.mode;ve(B);try{const w=await Se(T),j=pe.mode==="SECTION"&&pe.section||xs,C=j===x||j===h,Y=lm(j),ee={expertCountMode:pe.analysisType==="EXPERT"?((m=e.expertSummaryMode)==null?void 0:m[j])||"SINGLE":void 0,partyRole:Dg(j)||void 0};(C||Y)&&(ee.sectionKey=j,ee.plaintiffName=e.plaintiffName||"",ee.insuredName=e.insuredName||"",ee.insurerName=e.insurerName||"",ee.reportSubject=e.reportSubject||"");const ie=await jg(w,T.type||"application/octet-stream",pe.analysisType||"CLAIM",ee),Q=(ie==null?void 0:ie.analysis)||null;if(pe.mode==="SECTION"){const Ce=((ie==null?void 0:ie.claimSummary)||"").trim()||Pe(Q,{analysisType:pe.analysisType,section:pe.section});if(!Ce)O({msg:"      .",type:"error"});else{const He=pe.section||x,Me=e.content[He]||"",tt=Me?`${Me}

${Ce}`:Ce,ke={content:{...e.content,[He]:tt},selectedSections:e.selectedSections.includes(He)?e.selectedSections:[...e.selectedSections,He]};if(pe.analysisType==="EXPERT"&&pe.section){const _s=!!Me.trim()?"MULTIPLE":"SINGLE";ke.expertSummaryMode={...e.expertSummaryMode||{},[He]:_s}}Q&&(ke.complaintAnalysis=Q),t(ke),O({msg:"     .",type:"success"})}}else Q?(Ue(Q),pe.mode==="POLICY"&&t({policyFile:{id:`policy-${Date.now()}`,name:T.name,data:w,type:T.type}})):O({msg:"   .   .",type:"error"})}catch(w){console.error(w),O({msg:" .    .",type:"error"})}finally{H(!1),ve(null),z(null),N.target.value=""}},tr=()=>{const{policyPeriodStart:N,policyPeriodEnd:T,retroStart:B,retroEnd:d}=e;if(!N&&!T&&!B&&!d){O({msg:"    .  POLCY .",type:"info"});return}const m=gh(e.content["Insurance Coverage"],N,T,B,d);Bt("Insurance Coverage",m),O({msg:"   .",type:"success"})},nr=!!(e.policyPeriodStart||e.policyPeriodEnd||e.retroStart||e.retroEnd),sr=async N=>{if(e.odakanitNo)try{const d=await nt.getLatestSheetForCase(e.odakanitNo);if(d&&d.lineItems&&d.lineItems.length>0){const{text:m}=oh(d.sheet,d.lineItems);if(Bt(N,m),d.attachments&&d.attachments.length){const j=e.invoiceFiles||[],C=Math.max(0,4-j.length);if(C>0){const Y=d.attachments.slice(0,C).map((ee,ie)=>{const[Q,Ce]=ee.fileKey.split(",");let He=ee.mimeType||"application/octet-stream";if(Q&&Q.startsWith("data:")){const tt=Q.match(/^data:(.*?);base64$/);tt&&tt[1]&&(He=tt[1])}const Me=Ce||ee.fileKey;return{id:`fes-inv-${ee.id}-${ie}`,name:ee.originalFileName,data:Me,type:He}});if(Y.length){const ee=[...j,...Y],ie=ee.length>0,Ce=gt&&e.status==="WAITING_FOR_INVOICES"&&ie?"TASK_ASSIGNED":e.status;t({invoiceFiles:ee,isWaitingForInvoices:!ie,status:Ce,expensesSheetId:d.sheet.id,expensesSnapshotAt:d.sheet.updatedAt||new Date().toISOString()})}}}O({msg:"Expenses Table was inserted into the EXPENSES section.",type:"success"});return}}catch(d){Ld("Failed to load Expenses Table for report",d)}const T=e.expenseWorksheet;if(!T||!T.rows||T.rows.length===0){O({msg:"    .",type:"info"});return}if(T.status!=="LOCKED"){O({msg:'       ".',type:"info"});return}const B=Jr(T);Bt(N,B),O({msg:'   ".',type:"success"})},rr=()=>{o&&(o(),O({msg:"    .",type:"success"}))},lr=async()=>{if(!lt){se(!0);try{const N=await Tg(e.content||{}),T=N.issues||[];R(T),L(N.runAt||new Date().toISOString()),T.length?O({msg:"     .",type:"info"}):O({msg:"   Tone & Risk .",type:"success"})}catch(N){console.error("Tone & Risk check failed",N),O({msg:" .    .",type:"error"})}finally{se(!1)}}},ar=()=>{R([]),L(null)},ir=N=>{var m;if(!N.suggestion)return;const T=N.sectionKey,B=e.content[T]||"";if(!B||!N.excerpt||!B.includes(N.excerpt)){(m=navigator.clipboard)==null||m.writeText(N.suggestion).catch(()=>{}),O({msg:"    .   .",type:"info"});return}const d=B.replace(N.excerpt,N.suggestion);Bt(T,d)},or=async()=>{if(!lt){Le(!0);try{const N=await Ag(e.content||{},l.role),T=N.issues||[];Ie(T),he(N.runAt||new Date().toISOString()),T.length?O({msg:"       .",type:"info"}):O({msg:"     .",type:"success"})}catch(N){console.error("Hebrew style review failed",N),O({msg:"  .    .",type:"error"})}finally{Le(!1)}}},Be=N=>{var j;if(!N.suggestion)return;const T=N.sectionKey,B=e.content[T]||"",d=N.excerpt;if(!(d&&B.includes(d))){(j=navigator.clipboard)==null||j.writeText(N.suggestion).catch(()=>{}),O({msg:"    .   .",type:"info"});return}const w=B.replace(d,N.suggestion);Bt(T,w)},Gt=N=>et.filter(T=>T.sectionKey===N&&T.isEnabled!==!1).sort((T,B)=>{const d=T.label==="LLOYDS_RECOMMENDED"?0:1,m=B.label==="LLOYDS_RECOMMENDED"?0:1;if(d!==m)return d-m;const w=T.usageCount||0;return(B.usageCount||0)-w}),$t=N=>{if(l.role!=="ADMIN")return;const T=Ye.current[N],B=T==null?void 0:T.current;if(!B){O({msg:"     .",type:"error"});return}const d=B.selectionStart??0,m=B.selectionEnd??0;if(d===m){O({msg:"     -Best Practice.",type:"info"});return}const j=(e.content[N]||"").slice(d,m).trim();if(!j){O({msg:"    .",type:"info"});return}re({sectionKey:N,body:j})},hn=async({title:N,label:T,tags:B,behavior:d})=>{if(!Z)return;const m=new Date().toISOString(),w={id:"",sectionKey:Z.sectionKey,title:N,body:Z.body,label:T,tags:B.length?B:void 0,isEnabled:!0,createdByUserId:l.id,createdAt:m,updatedAt:m,usageCount:0,lastUsedAt:null,behavior:d};try{const j=await sm(w,l.role);q(j),O({msg:"Best Practice  .",type:"success"})}catch(j){console.error("Failed to save best practice",j),O({msg:" -Best Practice .",type:"error"})}re(null)},En=()=>{re(null)},Qr=async(N,T)=>{if(lt)return;const B=e.content[N]||"",d=B?`${B}

${T.body}`:T.body;Bt(N,d);try{const m=await rm(T.id,"INSERT",l.role);q(m)}catch(m){console.error("Failed to record best practice usage (insert)",m)}},cr=async N=>{var T;(T=navigator.clipboard)==null||T.writeText(N.body).catch(()=>{});try{const B=await rm(N.id,"COPY",l.role);q(B)}catch(B){console.error("Failed to record best practice usage (copy)",B)}O({msg:"  .",type:"info"})},ss=async(N,T)=>{const B=et.find(m=>m.id===N);if(!B)return;const d={...B,...T,updatedAt:new Date().toISOString()};try{const m=await sm(d,l.role);q(m)}catch(m){console.error("Failed to update best practice",m),O({msg:" -Best Practice .",type:"error"})}},dr=async N=>{try{const T=await Rg(N,l.role);q(T)}catch(T){console.error("Failed to delete best practice",T),O({msg:" -Best Practice .",type:"error"})}},Mn=async(N,T)=>{try{const B=await Cg(N,T,l.role);q(B)}catch(B){console.error("Failed to toggle best practice enabled",B),O({msg:"  -Best Practice .",type:"error"})}},Jr=N=>{const T=N.rows.filter(w=>w.type==="EXPENSE"),B=N.rows.filter(w=>w.type==="ADJUSTMENT"),d=T.map(w=>` ${w.label}${w.serviceProvider?` (${w.serviceProvider})`:""}  ${w.amount.toLocaleString()}`),m=B.map(w=>` ${w.label}  ${w.amount.toLocaleString()}`);return["     ","",":",d.length?d.join(`
`):"   ",""," / :",m.length?m.join(`
`):"  ","",`" : ${N.totals.totalExpenses.toLocaleString()}`,`" : ${N.totals.totalAdjustments.toLocaleString()}`,` : ${N.totals.totalBalance.toLocaleString()}`].join(`
`)};return s.jsxs(s.Fragment,{children:[s.jsx("input",{type:"file",ref:Xe,className:"hidden",accept:".pdf,.doc,.docx,.txt,.jpg,.jpeg,.png,application/pdf,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,image/*",onChange:Xr}),s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2",children:[s.jsxs("button",{onClick:n,className:"flex items-center text-sm text-gray-600 bg-gray-100 px-3 py-1.5 rounded-full hover:bg-gray-200",children:[s.jsx(fi,{className:"w-4 h-4 mr-1"}),"   1"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[l.role==="ADMIN"&&i&&s.jsxs("div",{className:"flex flex-col items-end gap-1",children:[s.jsx("button",{onClick:i,disabled:!ct||P,className:`flex items-center text-sm px-3 py-1.5 rounded-full transition ${ct&&!P?"text-indigo-700 bg-indigo-50 hover:bg-indigo-100":"text-slate-400 bg-slate-100 cursor-not-allowed"}`,children:P?s.jsxs(s.Fragment,{children:[s.jsx(Ut,{className:"w-4 h-4 mr-1 animate-spin"})," ..."]}):s.jsxs(s.Fragment,{children:[s.jsx(ig,{className:"w-4 h-4 mr-1"})," Auto-Translate"]})}),!ct&&!P&&s.jsx("p",{className:"text-[11px] text-slate-600",children:"      ."}),P&&s.jsx("p",{className:"text-[11px] text-indigo-600",children:"      ."})]}),l.role==="ADMIN"&&o&&s.jsxs("button",{onClick:rr,className:"flex items-center text-sm text-purple-700 bg-purple-50 px-3 py-1.5 rounded-full hover:bg-purple-100",children:[s.jsx(bd,{className:"w-4 h-4 mr-1"})," Format Text"]}),s.jsxs("button",{onClick:a,className:"flex items-center text-sm text-lpBlue bg-blue-50 px-3 py-1.5 rounded-full hover:bg-blue-100",children:[s.jsx(vd,{className:"w-4 h-4 mr-1"}),"  "]})]})]}),U&&s.jsxs("div",{className:"flex items-center justify-end gap-2 text-[11px] text-indigo-600",children:[s.jsx(Ut,{className:"w-3 h-3 animate-spin"}),s.jsx("span",{children:"   ,     "})]}),W&&s.jsx(dN,{message:W.msg,type:W.type,onClose:()=>O(null)}),s.jsx("h2",{className:"text-2xl font-bold text-lpBlue font-serif",children:"2. Draft Content"}),!lt&&s.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-2 mt-1",children:[s.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[s.jsx("button",{type:"button",onClick:lr,disabled:te,className:`flex items-center text-xs px-3 py-1.5 rounded-full border ${te?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-amber-50 text-amber-800 border-amber-200 hover:bg-amber-100"}`,children:te?s.jsxs(s.Fragment,{children:[s.jsx(Ut,{className:"w-3 h-3 mr-1 animate-spin"})," Tone & Risk Check..."]}):s.jsx(s.Fragment,{children:"Tone & Risk Check"})}),s.jsx("button",{type:"button",onClick:or,disabled:Ae,className:`flex items-center text-xs px-3 py-1.5 rounded-full border ${Ae?"bg-slate-100 text-slate-400 border-slate-200 cursor-not-allowed":"bg-blue-50 text-blue-800 border-blue-200 hover:bg-blue-100"}`,children:Ae?s.jsxs(s.Fragment,{children:[s.jsx(Ut,{className:"w-3 h-3 mr-1 animate-spin"}),"    ..."]}):s.jsx(s.Fragment,{children:"   "})}),K.length>0&&s.jsx("button",{type:"button",onClick:ar,className:"text-[11px] text-slate-600 hover:text-slate-800 underline",children:" "})]}),ye&&s.jsxs("div",{className:"text-[11px] text-slate-500",children:[" :"," ",new Date(ye).toLocaleString("he-IL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),!lt&&K.length>0&&s.jsxs("div",{className:"mb-4 border border-amber-200 bg-amber-50 rounded-md p-3 text-xs space-y-2",children:[s.jsx("div",{className:"flex items-center justify-between gap-2 mb-1",children:s.jsxs("div",{className:"font-semibold text-amber-900",children:[" ",K.length,"  Tone & Risk"]})}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:K.map(N=>s.jsxs("div",{className:"bg-white border border-amber-200 rounded px-2 py-2 space-y-1",children:[s.jsx("div",{className:"flex items-center justify-between gap-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold bg-slate-100 text-slate-700",children:N.sectionKey||"Unknown section"}),s.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ${N.severity==="CRITICAL"?"bg-red-100 text-red-700":N.severity==="WARNING"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-600"}`,children:N.severity}),s.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[10px] bg-indigo-50 text-indigo-700 font-mono",children:N.kind})]})}),s.jsxs("div",{className:"text-[11px] text-slate-700",children:[s.jsx("span",{className:"font-semibold",children:":"})," ",s.jsxs("span",{className:"italic",children:['"',N.excerpt,'"']})]}),s.jsxs("div",{className:"text-[11px] text-slate-700",children:[s.jsx("span",{className:"font-semibold",children:":"})," ",N.message]}),N.suggestion&&s.jsxs("div",{className:"text-[11px] text-slate-700",children:[s.jsx("span",{className:"font-semibold",children:" :"})," ",s.jsx("span",{className:"whitespace-pre-wrap",children:N.suggestion})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[N.suggestion&&s.jsxs(s.Fragment,{children:[s.jsx("button",{type:"button",onClick:()=>{var T;return(T=navigator.clipboard)==null?void 0:T.writeText(N.suggestion||"").catch(()=>{})},className:"px-2 py-0.5 rounded border border-slate-300 text-[11px] text-slate-700 hover:bg-slate-100",children:"  "}),s.jsx("button",{type:"button",onClick:()=>ir(N),className:"px-2 py-0.5 rounded border border-emerald-300 text-[11px] text-emerald-700 hover:bg-emerald-50",children:" "})]}),s.jsx("button",{type:"button",onClick:()=>Ie(T=>T.filter(B=>B.id!==N.id)),className:"px-2 py-0.5 rounded border border-slate-200 text-[11px] text-slate-500 hover:bg-slate-100 ml-auto",children:""})]})]},N.id))})]}),!lt&&le.length>0&&s.jsxs("div",{className:"mb-4 border border-blue-200 bg-blue-50 rounded-md p-3 text-xs space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1",children:[s.jsxs("div",{className:"font-semibold text-blue-900",children:[" ",le.length,"   "]}),Te&&s.jsxs("div",{className:"text-[11px] text-slate-500",children:[" :"," ",new Date(Te).toLocaleString("he-IL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),s.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:le.map(N=>{const T=e.content[N.sectionKey]||"",B=!!N.suggestion&&!!N.excerpt&&T.includes(N.excerpt);return s.jsxs("div",{className:"bg-white border border-blue-200 rounded px-2 py-2 space-y-1",children:[s.jsx("div",{className:"flex items-center justify-between gap-2",children:s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold bg-slate-100 text-slate-700",children:N.sectionKey||"Unknown section"}),s.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[10px] font-semibold ${N.severity==="CRITICAL"?"bg-red-100 text-red-700":N.severity==="WARNING"?"bg-amber-100 text-amber-700":"bg-slate-100 text-slate-600"}`,children:N.severity}),s.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[10px] bg-blue-50 text-blue-700 font-mono",children:N.category})]})}),s.jsxs("div",{className:"text-[11px] text-slate-700",children:[s.jsx("span",{className:"font-semibold",children:":"})," ",s.jsxs("span",{className:"italic",children:['"',N.excerpt,'"']})]}),s.jsxs("div",{className:"text-[11px] text-slate-700",children:[s.jsx("span",{className:"font-semibold",children:":"})," ",N.message]}),N.suggestion&&s.jsxs("div",{className:"text-[11px] text-slate-700",children:[s.jsx("span",{className:"font-semibold",children:" :"})," ",s.jsx("span",{className:"whitespace-pre-wrap",children:N.suggestion})]}),N.suggestion&&s.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[s.jsx("button",{type:"button",onClick:()=>{var d;return(d=navigator.clipboard)==null?void 0:d.writeText(N.suggestion||"").catch(()=>{})},className:"px-2 py-0.5 rounded border border-slate-300 text-[11px] text-slate-700 hover:bg-slate-100",children:" "}),B&&s.jsx("button",{type:"button",onClick:()=>Be(N),className:"px-2 py-0.5 rounded border border-emerald-300 text-[11px] text-emerald-700 hover:bg-emerald-50",children:" "})]})]},N.id)})})]}),lt&&s.jsxs("div",{className:"bg-orange-100 border-l-4 border-orange-500 p-4 text-orange-800",children:[s.jsxs("p",{className:"font-bold flex items-center",children:[s.jsx(fg,{className:"w-5 h-5 mr-2"})," Restricted Access Mode"]}),s.jsxs("p",{className:"text-sm",children:["You are logged in as ",l.role,". You can only modify the Invoice Attachments in the Expenses section."]})]}),e.financeInstructions&&s.jsx("div",{className:"bg-red-50 border-l-4 border-red-600 p-4 shadow-md rounded-r-lg animate-pulse-slow",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(ui,{className:"h-5 w-5 text-red-600"})}),s.jsxs("div",{className:"ml-3 w-full",children:[s.jsx("h3",{className:"text-sm font-bold text-red-800",children:"Instruction from Finance"}),s.jsx("div",{className:"mt-2 text-sm text-red-700 whitespace-pre-wrap",children:e.financeInstructions}),e.expensesSourceFile&&s.jsxs("div",{className:"mt-4 pt-2 border-t border-red-200",children:[s.jsx("p",{className:"text-xs font-bold text-red-800 mb-1",children:"Attached Expenses Source File (Word/Excel):"}),s.jsxs("div",{className:"flex items-center bg-white p-2 rounded border border-red-200 max-w-md",children:[s.jsx(Wl,{className:"w-4 h-4 text-blue-600 mr-2"}),s.jsx("span",{className:"text-sm text-gray-700 flex-1",children:e.expensesSourceFile.name}),s.jsx("a",{href:`data:${e.expensesSourceFile.type};base64,${e.expensesSourceFile.data}`,download:e.expensesSourceFile.name,className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200 font-bold",children:"Download"})]})]})]})]})}),Yr&&s.jsxs("div",{className:"bg-amber-50 border-l-4 border-amber-500 p-4 shadow rounded-r-lg flex gap-3 items-start",children:[s.jsx(ui,{className:"w-5 h-5 text-amber-600 mt-1"}),s.jsxs("div",{children:[s.jsx("p",{className:"font-bold text-amber-900",children:"    "}),s.jsx("p",{className:"text-sm text-amber-800",children:"  /   .              ."})]})]}),s.jsx(Mg,{report:e,currentUser:l,onSubmitToAdmin:()=>c&&c(),onApproveHebrew:()=>u&&u(),onRequestChanges:N=>f&&f(N),onMarkIssueDone:N=>p&&p(N),onAddExternalFeedbackIssues:(N,T)=>g&&g(N,T),onReopenHebrewDueToExternalFeedback:()=>S&&S()}),s.jsx("div",{className:"space-y-8",children:e.selectedSections.map(N=>{var T,B;return s.jsxs("div",{className:`bg-white p-6 rounded-lg shadow-sm border transition-all ${lt&&!N.includes("Expenses")?"opacity-60 pointer-events-none border-gray-100":"border-gray-200"}`,children:[s.jsxs("div",{className:"flex justify-between items-center mb-3 pb-2 border-b border-gray-100",children:[s.jsxs("div",{className:"flex flex-col",children:[s.jsx("h3",{className:"font-bold text-lg text-lpBlue uppercase tracking-wide",children:Lg(N,(T=e.expertSummaryMode)==null?void 0:T[N])}),N.includes("Expenses")&&e.expensesSnapshotAt&&s.jsxs("p",{className:"mt-1 text-[11px] text-gray-500",children:["Based on the latest Expenses Table as of"," ",new Date(e.expensesSnapshotAt).toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"}),"."]})]}),!lt&&s.jsxs("div",{className:"flex items-center gap-2",children:[!N.includes("Expenses")&&s.jsx("button",{className:"p-1.5 hover:bg-gray-100 rounded text-gray-500",onClick:()=>nn({mode:"SECTION",section:N,analysisType:Kr(N)}),title:"   ",children:we===N?s.jsx(Ut,{className:"w-4 h-4 animate-spin"}):s.jsx(ug,{className:"w-4 h-4"})}),N.includes("Expenses")&&Gr&&s.jsx("button",{onClick:()=>sr(N),className:"p-1.5 hover:bg-green-50 rounded text-gray-500 hover:text-green-600",title:"   ",children:s.jsx(zp,{className:"w-4 h-4"})}),!N.includes("Expenses")&&s.jsxs(s.Fragment,{children:[N==="Strategy"&&!lt&&s.jsx("button",{onClick:At,className:"px-3 py-1 text-xs font-semibold text-blue-700 bg-blue-50 border border-blue-200 rounded-full hover:bg-blue-100",children:" "}),s.jsx("button",{onClick:()=>ae(N),className:"p-1.5 hover:bg-purple-50 rounded text-gray-500 hover:text-purple-600",title:"  ",children:ue===N?s.jsx(Ut,{className:"w-4 h-4 animate-spin"}):s.jsx(pg,{className:"w-4 h-4"})}),N==="Insurance Coverage"&&nr&&s.jsx("button",{onClick:tr,className:"p-1.5 hover:bg-blue-50 rounded text-gray-500 hover:text-blue-600",title:"Auto-fill policy data",children:s.jsx(yg,{className:"w-4 h-4"})})]}),yt(N).length>0&&s.jsxs("button",{onClick:()=>Ls(N),className:"flex items-center gap-1 px-2 py-1 rounded text-xs font-bold bg-gray-50 text-gray-500 border hover:bg-yellow-50",children:[s.jsx(cg,{className:"w-3 h-3"})," Ideas"]}),l.role==="ADMIN"&&s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{type:"button",onClick:()=>ns(N),className:"px-2 py-1 rounded text-[11px] border border-dashed border-slate-300 text-slate-500 hover:bg-slate-50",children:"Save selection as template"}),s.jsx("button",{type:"button",onClick:()=>$t(N),className:"px-2 py-1 rounded text-[11px] border border-dashed border-emerald-300 text-emerald-700 hover:bg-emerald-50",children:"Save selection as Best Practice"})]})]})]}),b===N&&!lt&&s.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 rounded border border-yellow-200",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[s.jsxs("div",{className:"flex items-center gap-2 text-[11px]",children:[s.jsx("button",{type:"button",className:`px-2 py-1 rounded-full border ${F==="TEMPLATES"?"bg-white border-yellow-400 text-yellow-800 font-semibold":"bg-yellow-100/60 border-yellow-200 text-yellow-700"}`,onClick:()=>Ne("TEMPLATES"),children:"Templates"}),s.jsx("button",{type:"button",className:`px-2 py-1 rounded-full border ${F==="BEST_PRACTICES"?"bg-white border-emerald-400 text-emerald-800 font-semibold":"bg-emerald-50/70 border-emerald-200 text-emerald-700"}`,onClick:()=>Ne("BEST_PRACTICES"),children:"Best Practices"})]}),F==="TEMPLATES"?s.jsx("input",{type:"text",className:"flex-1 border border-yellow-300 rounded px-2 py-1 text-xs",placeholder:"Search templates",value:I,onChange:d=>k(d.target.value)}):s.jsx("input",{type:"text",className:"flex-1 border border-emerald-300 rounded px-2 py-1 text-xs",placeholder:"Search best practices",value:xe,onChange:d=>ze(d.target.value)}),l.role==="ADMIN"&&F==="TEMPLATES"&&s.jsx("button",{type:"button",onClick:()=>{V(N),de(!0)},className:"text-[11px] px-2 py-1 rounded bg-white text-slate-700 border border-slate-200 hover:bg-slate-50",children:"Manage templates"}),l.role==="ADMIN"&&F==="BEST_PRACTICES"&&s.jsx("button",{type:"button",onClick:()=>{ge(N),X(!0)},className:"text-[11px] px-2 py-1 rounded bg-white text-slate-700 border border-slate-200 hover:bg-slate-50",children:"Manage best practices"})]}),s.jsx("div",{className:"grid grid-cols-1 gap-2 max-h-60 overflow-y-auto text-xs",children:F==="TEMPLATES"?(()=>{const d=yt(N),m=I.trim().toLowerCase(),w=m?d.filter(j=>j.title.toLowerCase().includes(m)||j.body.toLowerCase().includes(m)):d;return w.length?w.map(j=>{const C=j.body.length>160?`${j.body.slice(0,160)}`:j.body;return s.jsxs("div",{className:"flex items-center gap-2 bg-white border border-yellow-100 rounded px-2 py-2 hover:bg-yellow-100 cursor-pointer",onClick:()=>tn(N,j),children:[s.jsxs("div",{className:"flex-1 min-w-0 text-right",children:[s.jsx("div",{className:"font-semibold text-slate-800 truncate",children:j.title}),s.jsx("div",{className:"text-[11px] text-slate-600 max-h-10 overflow-hidden whitespace-pre-wrap",children:C})]}),s.jsx("button",{type:"button",className:"text-[11px] px-2 py-1 rounded bg-yellow-50 text-yellow-800 border border-yellow-200 hover:bg-yellow-100",children:"Insert"})]},j.id)}):s.jsx("p",{className:"text-[11px] text-slate-600",children:"No templates found for this section."})})():(()=>{const d=Gt(N),m=xe.trim().toLowerCase(),w=m?d.filter(j=>{const C=(j.tags||[]).join(" ").toLowerCase();return j.title.toLowerCase().includes(m)||j.body.toLowerCase().includes(m)||C.includes(m)}):d;return w.length?w.map(j=>{const C=j.body.length>160?`${j.body.slice(0,160)}`:j.body,Y=j.behavior!=="COPY_ONLY";return s.jsxs("div",{className:"flex items-center gap-2 bg-white border border-emerald-100 rounded px-2 py-2 hover:bg-emerald-50 cursor-default",children:[s.jsxs("div",{className:"flex-1 min-w-0 text-right",children:[s.jsxs("div",{className:"flex flex-wrap items-center justify-end gap-1 mb-0.5",children:[s.jsx("span",{className:"font-semibold text-slate-800 truncate",children:j.title}),s.jsx("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[9px] font-semibold ${j.label==="LLOYDS_RECOMMENDED"?"bg-purple-100 text-purple-700":"bg-emerald-100 text-emerald-700"}`,children:j.label==="LLOYDS_RECOMMENDED"?"Lloyds recommended":"Best practice"}),j.tags&&j.tags.length>0&&s.jsx("span",{className:"inline-flex items-center rounded-full px-2 py-0.5 text-[9px] bg-slate-100 text-slate-700",children:j.tags.join(", ")})]}),s.jsx("div",{className:"text-[11px] text-slate-600 max-h-10 overflow-hidden whitespace-pre-wrap",children:C})]}),s.jsxs("div",{className:"flex flex-col items-stretch gap-1",children:[Y&&s.jsx("button",{type:"button",onClick:()=>Qr(N,j),className:"text-[11px] px-2 py-0.5 rounded bg-emerald-50 text-emerald-800 border border-emerald-200 hover:bg-emerald-100",children:"Insert"}),s.jsx("button",{type:"button",onClick:()=>cr(j),className:"text-[11px] px-2 py-0.5 rounded bg-slate-50 text-slate-700 border border-slate-200 hover:bg-slate-100",children:"Copy"})]})]},j.id)}):s.jsx("p",{className:"text-[11px] text-slate-600",children:"No best practices found for this section."})})()})]}),N.includes("Expenses")?s.jsxs("div",{className:"space-y-4",children:[gt&&s.jsxs("div",{className:"bg-blue-50 p-4 rounded border border-blue-100 mb-4",children:[s.jsx("h4",{className:"text-sm font-bold text-blue-800 mb-2",children:"Add Expense Item"}),s.jsxs("div",{className:"flex gap-2 flex-wrap",children:[s.jsx("input",{type:"date",className:"border p-2 rounded text-sm",value:We.date,onChange:d=>mt({...We,date:d.target.value})}),s.jsx("input",{type:"text",className:"border p-2 rounded text-sm flex-1",placeholder:"Description (e.g. Court Fee)",value:We.description,onChange:d=>mt({...We,description:d.target.value})}),s.jsx("input",{type:"number",className:"border p-2 rounded text-sm w-24",placeholder:"Amount",value:We.amount,onChange:d=>mt({...We,amount:Number(d.target.value)})}),s.jsx("button",{onClick:ts,className:"bg-blue-600 text-white px-4 py-2 rounded text-sm font-bold hover:bg-blue-700",children:"Add"})]})]}),gt&&s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"relative text-xs",children:[s.jsxs("button",{className:"flex items-center text-indigo-600 bg-white px-2 py-1 rounded hover:bg-indigo-50",onClick:()=>Oe(be===N?null:N),children:[s.jsx(Vl,{className:"w-3 h-3 mr-1"})," Auto-extract"]}),be===N&&s.jsxs("div",{className:"absolute right-0 mt-2 w-44 bg-white border border-gray-200 rounded-lg shadow-lg z-20",children:[s.jsxs("label",{className:"w-full block px-3 py-2 hover:bg-gray-50 cursor-pointer text-right",children:["  ",s.jsx("input",{type:"file",className:"hidden",onChange:d=>{Oe(null),Re(d,N)},accept:".pdf,.jpg,.png"})]}),s.jsx("button",{className:"w-full text-right px-3 py-2 hover:bg-gray-50",onClick:()=>nn({mode:"EXPENSES",section:N}),children:"  OCR"})]})]}),U&&s.jsxs("span",{className:"text-xs text-indigo-500 flex items-center",children:[s.jsx(Ut,{className:"w-3 h-3 animate-spin mr-1"}),"   ,     "]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex justify-between items-center bg-indigo-50 p-2 rounded border border-indigo-200",children:[s.jsxs("span",{className:"text-sm font-bold text-indigo-900",children:["Total Extracted: ",e.expensesSum||"0"," NIS"]}),gt&&s.jsx("button",{onClick:()=>t({expensesItems:[],expensesSum:"0"}),className:"text-xs text-red-500 hover:underline",children:"Clear All"})]}),s.jsx("div",{className:"overflow-x-auto border rounded",children:s.jsxs("table",{className:"w-full text-sm border-collapse border-gray-300",children:[s.jsx("thead",{className:"bg-gray-100",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 text-left text-gray-600",children:"Date"}),s.jsx("th",{className:"p-2 text-left text-gray-600",children:"Description"}),s.jsx("th",{className:"p-2 text-right text-gray-600",children:"Amount"}),!lt&&s.jsx("th",{className:"p-2 w-8"})]})}),s.jsxs("tbody",{children:[e.expensesItems.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-400 italic",children:"No expenses added."})}),e.expensesItems.map((d,m)=>s.jsxs("tr",{className:"border-t",children:[s.jsx("td",{className:"p-2",children:d.date}),s.jsx("td",{className:"p-2",children:d.description}),s.jsxs("td",{className:"p-2 text-right",children:[d.amount," ",d.currency]}),gt&&s.jsx("td",{className:"p-2 text-center",children:s.jsx("button",{onClick:()=>Ds(d.id),className:"text-red-400 hover:text-red-600",children:s.jsx(jt,{className:"w-3 h-3"})})})]},m))]})]})}),gt&&s.jsx("div",{className:"bg-indigo-50 p-3 rounded border",children:s.jsxs("select",{className:"w-full text-sm border p-2 rounded",value:e.paymentRecommendation||"",onChange:d=>t({paymentRecommendation:d.target.value}),children:[s.jsx("option",{value:"",children:"-- Select Recommendation --"}),s.jsx("option",{value:"The expenses are lower than the Deductible...",children:"Option A: Lower than Deductible"}),s.jsxs("option",{value:`It would be appreciated... transfer NIS ${e.expensesSum||"..."}`,children:["Option B: Transfer Funds (",e.expensesSum," NIS)"]})]})})]}),s.jsxs("div",{className:`border-t-2 pt-4 mt-6 ${lt?"bg-green-50 p-4 rounded border-green-200":""}`,children:[s.jsxs("h4",{className:"font-bold text-sm text-gray-700 mb-2 flex items-center",children:[s.jsx(Hp,{className:"w-4 h-4 mr-2"})," Tax Invoices (Appendices)"]}),(gt||!e.isWaitingForInvoices)&&s.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-2",children:[s.jsxs("button",{onClick:()=>{var d;return(d=Fe.current)==null?void 0:d.click()},className:"px-3 py-1.5 text-xs bg-gray-100 text-gray-700 rounded hover:bg-gray-200 flex items-center gap-1",children:[s.jsx(Vl,{className:"w-3 h-3"})," "]}),s.jsx("button",{onClick:()=>nn({mode:"INVOICE"}),className:"px-3 py-1.5 text-xs bg-red-100 text-red-700 rounded hover:bg-red-200 flex items-center gap-1",children:we==="INVOICE"?s.jsx(Ut,{className:"w-3 h-3 animate-spin"}):" "}),s.jsx("input",{ref:Fe,type:"file",className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf",onChange:Zs})]}),s.jsx("div",{className:"mt-2 space-y-2",children:e.invoiceFiles.map(d=>s.jsxs("div",{className:"flex items-center justify-between bg-white p-2 rounded border shadow-sm text-xs",children:[s.jsxs("span",{className:"flex items-center",children:[s.jsx(Wl,{className:"w-3 h-3 mr-2 text-blue-500"})," ",d.name]}),s.jsx("button",{onClick:()=>qr(d.id),className:"text-red-400 hover:text-red-600",children:s.jsx(jt,{className:"w-3 h-3"})})]},d.id))})]})]}):s.jsxs("div",{className:"relative",children:[s.jsx(Nm,{className:"w-full border border-gray-300 rounded-md p-4 min-h-[100px] text-right font-sans focus:ring-1 focus:ring-lpBlue outline-none transition-all",dir:"rtl",value:e.content[N]||"",onChange:d=>Bt(N,d.target.value),disabled:lt,placeholder:"Type Hebrew content here...",style:{lineHeight:"1.6",textAlign:"justify"},textareaRef:(Ye.current[N]||(Ye.current[N]=bi.createRef()),Ye.current[N])}),Cs&&s.jsxs("div",{className:"mt-4 border-t pt-4",children:[s.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"English Output (Editable)"}),s.jsx(Nm,{className:"w-full border border-indigo-200 rounded-md p-4 min-h-[100px] font-serif focus:ring-1 focus:ring-indigo-300 outline-none transition-all",dir:"ltr",value:((B=e.translatedContent)==null?void 0:B[N])||"",onChange:d=>er(N,d.target.value),placeholder:"Translated text will appear here after Auto-Translate...",style:{lineHeight:"1.6",textAlign:"justify"}})]})]})]},N)})}),l.role==="ADMIN"&&G&&s.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[80vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-4 py-2 border-b flex items-center justify-between",children:[s.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Manage Templates"}),s.jsx("button",{type:"button",onClick:()=>de(!1),className:"text-slate-500 hover:text-slate-700",children:s.jsx(jt,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"px-4 py-3 border-b flex items-center gap-3 text-xs",children:s.jsxs("label",{className:"font-semibold text-slate-700",children:["Section:",s.jsx("select",{className:"ml-2 border border-slate-300 rounded px-2 py-1 text-xs",value:ne,onChange:N=>V(N.target.value),children:hl.map(N=>s.jsx("option",{value:N,children:N},N))})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-3 text-xs",children:(()=>{const N=D.filter(T=>T.sectionKey===ne).sort((T,B)=>(T.orderIndex||0)-(B.orderIndex||0)||T.createdAt.localeCompare(B.createdAt));return N.length?N.map((T,B)=>s.jsxs("div",{className:"border border-slate-200 rounded-md p-2 bg-slate-50 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("input",{type:"text",className:"flex-1 border border-slate-300 rounded px-2 py-1 text-xs",value:T.title,onChange:d=>jn(T.id,{title:d.target.value})}),s.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-slate-700",children:[s.jsx("input",{type:"checkbox",checked:T.isEnabled!==!1,onChange:d=>jn(T.id,{isEnabled:d.target.checked})}),"Enabled"]})]}),s.jsx("textarea",{className:"w-full border border-slate-300 rounded px-2 py-1 text-xs mt-1",rows:3,value:T.body,onChange:d=>jn(T.id,{body:d.target.value})}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("div",{className:"flex items-center gap-1",children:[s.jsx("button",{type:"button",className:"px-2 py-0.5 rounded border border-slate-300 text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>v(T.id,"UP"),disabled:B===0,children:""}),s.jsx("button",{type:"button",className:"px-2 py-0.5 rounded border border-slate-300 text-[11px] text-slate-700 hover:bg-slate-100",onClick:()=>v(T.id,"DOWN"),disabled:B===N.length-1,children:""})]}),s.jsx("button",{type:"button",className:"px-2 py-0.5 rounded border border-red-200 text-[11px] text-red-700 hover:bg-red-50",onClick:()=>{window.confirm("Delete this template?")&&pn(T.id)},children:"Delete"})]})]},T.id)):s.jsx("p",{className:"text-[11px] text-slate-600",children:"No templates defined yet for this section."})})()})]})}),l.role==="ADMIN"&&_&&s.jsx("div",{className:"fixed inset-0 z-[120] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-3xl max-h-[80vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-4 py-2 border-b flex items-center justify-between",children:[s.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Manage Best Practices"}),s.jsx("button",{type:"button",onClick:()=>X(!1),className:"text-slate-500 hover:text-slate-700",children:s.jsx(jt,{className:"w-4 h-4"})})]}),s.jsx("div",{className:"px-4 py-3 border-b flex items-center gap-3 text-xs",children:s.jsxs("label",{className:"font-semibold text-slate-700",children:["Section:",s.jsx("select",{className:"ml-2 border border-slate-300 rounded px-2 py-1 text-xs",value:fe,onChange:N=>ge(N.target.value),children:hl.map(N=>s.jsx("option",{value:N,children:N},N))})]})}),s.jsx("div",{className:"flex-1 overflow-y-auto px-4 py-3 space-y-3 text-xs",children:(()=>{const N=et.filter(T=>T.sectionKey===fe).sort((T,B)=>{const d=T.label==="LLOYDS_RECOMMENDED"?0:1,m=B.label==="LLOYDS_RECOMMENDED"?0:1;if(d!==m)return d-m;const w=T.usageCount||0;return(B.usageCount||0)-w});return N.length?N.map(T=>s.jsxs("div",{className:"border border-slate-200 rounded-md p-2 bg-slate-50 space-y-1",children:[s.jsxs("div",{className:"flex items-center justify-between gap-2",children:[s.jsx("input",{type:"text",className:"flex-1 border border-slate-300 rounded px-2 py-1 text-xs",value:T.title,onChange:B=>ss(T.id,{title:B.target.value})}),s.jsxs("select",{className:"border border-slate-300 rounded px-2 py-1 text-[11px]",value:T.label,onChange:B=>ss(T.id,{label:B.target.value==="LLOYDS_RECOMMENDED"?"LLOYDS_RECOMMENDED":"BEST_PRACTICE"}),children:[s.jsx("option",{value:"BEST_PRACTICE",children:"Best practice"}),s.jsx("option",{value:"LLOYDS_RECOMMENDED",children:"Lloyds recommended"})]}),s.jsxs("label",{className:"flex items-center gap-1 text-[11px] text-slate-700",children:[s.jsx("input",{type:"checkbox",checked:T.isEnabled!==!1,onChange:B=>Mn(T.id,B.target.checked)}),"Enabled"]})]}),s.jsx("textarea",{className:"w-full border border-slate-300 rounded px-2 py-1 text-xs mt-1",rows:3,value:T.body,onChange:B=>ss(T.id,{body:B.target.value})}),s.jsx("input",{type:"text",className:"w-full border border-slate-300 rounded px-2 py-1 text-[11px] mt-1",placeholder:"Tags (comma separated)",value:(T.tags||[]).join(", "),onChange:B=>ss(T.id,{tags:B.target.value.split(",").map(d=>d.trim()).filter(Boolean)})}),s.jsxs("div",{className:"flex items-center justify-between mt-1",children:[s.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-500",children:[s.jsxs("span",{children:["Usage: ",T.usageCount||0]}),T.lastUsedAt&&s.jsxs("span",{children:["Last used:"," ",new Date(T.lastUsedAt).toLocaleString("he-IL",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})]})]}),s.jsx("button",{type:"button",className:"px-2 py-0.5 rounded border border-red-200 text-[11px] text-red-700 hover:bg-red-50",onClick:()=>{window.confirm("Delete this best practice?")&&dr(T.id)},children:"Delete"})]})]},T.id)):s.jsx("p",{className:"text-[11px] text-slate-600",children:"No best practices defined yet for this section."})})()})]})}),l.role==="ADMIN"&&Z&&s.jsx("div",{className:"fixed inset-0 z-[130] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[80vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"px-4 py-2 border-b flex items-center justify-between",children:[s.jsx("h3",{className:"text-sm font-semibold text-slate-800",children:"Save Best Practice"}),s.jsx("button",{type:"button",onClick:En,className:"text-slate-500 hover:text-slate-700",children:s.jsx(jt,{className:"w-4 h-4"})})]}),s.jsx(uN,{onSubmit:hn,onCancel:En,initialTitle:Z.body.split(/\s+/).slice(0,6).join(" ")})]})}),s.jsxs("div",{className:"flex justify-between pt-4",children:[s.jsxs("button",{onClick:n,className:"flex items-center text-gray-600 px-4 py-2 hover:bg-gray-100 rounded",children:[s.jsx(fi,{className:"mr-2 w-4 h-4"})," Back"]}),s.jsxs("button",{onClick:r,className:"flex items-center bg-lpBlue text-white px-6 py-2 rounded hover:bg-blue-900 transition",children:["Next Step ",s.jsx(Rn,{className:"ml-2 w-4 h-4"})]})]})]})]})},IN=({onClose:e,onSubmit:t,currentUser:n,favoriteProviders:r=[],onSaveFavorite:l})=>{const a=n.role==="LAWYER",[i,o]=y.useState(a?n.id:""),[c,u]=y.useState(""),[f,p]=y.useState(""),[g,S]=y.useState(null),[A,E]=y.useState([{id:rn(),category:"EXPERT_OUR",serviceProvider:"",amount:""}]),[P,x]=y.useState([]),h=4,b=async()=>{if(!i||!f)return;let I=null;const k=G=>t({lawyerId:i,instructions:c,odakanitNo:f,file:G,worksheet:A,invoiceFiles:P});if(g){const G=new FileReader;G.onload=de=>{var ne;I={name:g.name,type:g.type,data:((ne=de.target)==null?void 0:ne.result).split(",")[1]},k(I)},G.readAsDataURL(g)}else k()},M=async I=>{const k=I.target.files;if(!k)return;if(P.length>=h){alert("   4 ."),I.target.value="";return}const G=Array.from(k).slice(0,h-P.length),de=await Promise.all(G.map(ne=>new Promise(V=>{const K=new FileReader;K.onload=R=>{var te;return V({id:`inv-${Date.now()}-${Math.random().toString(36).slice(2,6)}`,name:ne.name,data:((te=R.target)==null?void 0:te.result).split(",")[1],type:ne.type})},K.readAsDataURL(ne)})));x(ne=>[...ne,...de]),I.target.value=""},U=I=>{x(k=>k.filter(G=>G.id!==I))},H=(I,k,G)=>{E(de=>de.map(ne=>ne.id===I?{...ne,[k]:G}:ne))},W=I=>{const k=Dn.find(G=>G.type===I)||Dn[0];E(G=>[...G,{id:rn(),category:k.value,serviceProvider:"",amount:"",customLabel:""}])},O=I=>{E(k=>k.length===1?k:k.filter(G=>G.id!==I))},D=jc(A,n),$=Ni(D);return s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[200]",children:s.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-xl w-96 animate-scale-in",children:[s.jsx("h3",{className:"font-bold text-lg mb-4 text-gray-800",children:a?"  ":"Open New Finance Case"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Internal Case # (Odakanit)"}),s.jsx("input",{className:"w-full border p-2 rounded",value:f,onChange:I=>p(I.target.value),placeholder:"e.g. 55492"})]}),!a&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Assign Lawyer"}),s.jsxs("select",{className:"w-full border p-2 rounded",value:i,onChange:I=>o(I.target.value),children:[s.jsx("option",{value:"",children:"-- Select --"}),Es.filter(I=>I.role==="LAWYER").map(I=>s.jsx("option",{value:I.id,children:I.name},I.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Instructions"}),s.jsx(zl,{clientId:Kl,children:s.jsx("textarea",{className:"w-full border p-2 rounded",rows:3,value:c,onChange:I=>u(I.target.value),placeholder:"Notes for lawyer..."})})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500",children:"Attach Expenses File"}),s.jsx("input",{type:"file",onChange:I=>{var k;return S(((k=I.target.files)==null?void 0:k[0])||null)},className:"text-xs"})]}),s.jsxs("div",{className:"border rounded-lg p-3 bg-amber-50",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"block text-xs font-bold text-amber-700",children:"Expense Worksheet"}),s.jsxs("div",{className:"flex gap-2 text-xs text-amber-700 font-semibold",children:[s.jsx("button",{type:"button",onClick:()=>W("EXPENSE"),className:"hover:underline",children:"+ Expense"}),s.jsx("button",{type:"button",onClick:()=>W("ADJUSTMENT"),className:"hover:underline",children:"+ Adjustment"})]})]}),s.jsx("div",{className:"space-y-2 max-h-48 overflow-auto pr-1",children:A.map(I=>{const k=Dn.find(V=>V.value===I.category),G=(k==null?void 0:k.type)!=="ADJUSTMENT",de=r.filter(V=>V.category===I.category||V.category==="OTHER"),ne=jc([I],n)[0];return s.jsxs("div",{className:"border border-amber-100 bg-white rounded-lg p-2 space-y-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Expense Details"}),s.jsx("select",{value:I.category,onChange:V=>H(I.id,"category",V.target.value),className:"w-full border rounded text-xs p-2",children:Dn.map(V=>s.jsx("option",{value:V.value,children:V.label},V.value))})]}),I.category==="OTHER"&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Custom Label"}),s.jsx("input",{className:"w-full border rounded text-xs p-2",placeholder:"Describe expense",value:I.customLabel||"",onChange:V=>H(I.id,"customLabel",V.target.value)})]}),G&&s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Service Provider"}),s.jsx("input",{list:`provider-${I.id}`,className:"w-full border rounded text-xs p-2",placeholder:"Provider name",value:I.serviceProvider,onChange:V=>H(I.id,"serviceProvider",V.target.value)}),s.jsx("datalist",{id:`provider-${I.id}`,children:de.map(V=>s.jsx("option",{value:V.serviceProvider,children:V.label},V.id))}),s.jsx("button",{type:"button",onClick:()=>l&&I.serviceProvider.trim()&&l({id:rn(),category:I.category,label:(ne==null?void 0:ne.label)||"Expense",serviceProvider:I.serviceProvider.trim()}),className:"text-[10px] text-amber-600 hover:underline mt-1",children:"Save to favorites"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-[10px] font-bold text-gray-500",children:"Cost ()"}),s.jsx("input",{type:"number",min:"0",className:"w-full border rounded text-xs p-2",placeholder:"",value:I.amount,onChange:V=>H(I.id,"amount",V.target.value)})]}),s.jsx("div",{className:"text-right",children:s.jsx("button",{type:"button",onClick:()=>O(I.id),className:"text-[10px] text-red-500 hover:underline",children:"Remove"})})]},I.id)})}),s.jsxs("div",{className:"text-right text-xs font-bold text-amber-800 mt-2",children:["Total balance preview: ",$.totalBalance.toLocaleString()]})]}),s.jsxs("div",{className:"border rounded-lg p-3 bg-white",children:[s.jsxs("div",{className:"flex justify-between items-center mb-2",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-700",children:"Tax Invoices (PDF / Word)"}),s.jsxs("span",{className:"text-[11px] text-gray-500",children:[P.length,"/",h]})]}),s.jsxs("label",{className:"flex flex-col items-center justify-center w-full h-24 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-white hover:bg-gray-50",children:[s.jsxs("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:[s.jsx(Vl,{className:"w-6 h-6 text-gray-400 mb-2"}),s.jsx("p",{className:"text-xs text-gray-500",children:"   ( 4 )"})]}),s.jsx("input",{type:"file",className:"hidden",multiple:!0,accept:".pdf,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/pdf",onChange:M})]}),s.jsxs("div",{className:"mt-2 space-y-2 max-h-32 overflow-auto",children:[P.map(I=>s.jsxs("div",{className:"flex items-center justify-between bg-gray-50 p-2 rounded border text-xs",children:[s.jsxs("span",{className:"flex items-center gap-2 text-gray-700",children:[s.jsx(Wl,{className:"w-3 h-3 text-blue-500"}),I.name]}),s.jsx("button",{type:"button",onClick:()=>U(I.id),className:"text-red-400 hover:text-red-600",children:s.jsx(jt,{className:"w-3 h-3"})})]},I.id)),P.length===0&&s.jsx("p",{className:"text-xs text-gray-400 text-center",children:"   ."})]})]})]}),a&&s.jsx("p",{className:"text-xs text-gray-500",children:"    .    ."}),s.jsx("button",{onClick:b,className:"w-full bg-indigo-600 text-white py-2 rounded font-bold mt-2 hover:bg-indigo-700",children:a?"Create Personal Folder":"Create Folder"}),s.jsx("button",{onClick:e,className:"w-full text-gray-500 text-sm hover:underline mt-1",children:"Cancel"})]})]})})},TN=({user:e,reports:t,onSelectReport:n,onNewReport:r,onLogout:l,onUpdateReport:a,onDeleteReport:i,onFinanceTaskCreate:o,caseTemplates:c=[],onStartTemplate:u,onStartNextReport:f,archiveAfterMs:p,favoriteProviders:g={},onSaveFavorite:S,onDeleteFavorite:A,onOpenWorksheet:E,onRequestReminder:P,onRequestNote:x,onSoftDeleteReport:h,onRestoreReport:b,notifications:M=[],showNotifications:U,setShowNotifications:H,onClearNotifications:W,dailySummaryOptIn:O,setDailySummaryOptIn:D,caseFolders:$,onOpenCaseFolder:I})=>{const k=e.role==="ADMIN"||e.role==="SUB_ADMIN"||e.role==="FINANCE",G=e.role==="LAWYER"||e.role==="SUB_ADMIN"||e.role==="FINANCE",[de,ne]=y.useState(!1),[V,K]=y.useState(!1),[R,te]=y.useState(!1),[se,ye]=y.useState(!1),[L,le]=y.useState({category:"EXPERT_OUR",label:"",provider:""}),[Ie,Ae]=y.useState(""),[Le,Te]=y.useState(null),he=e.role==="ADMIN",et=e.role==="SUB_ADMIN"||e.role==="FINANCE";if(e.role==="FINANCE"){const v=async({caseId:ae,sheetId:Ee,lawyerId:Se})=>{var ir,or;const Ue=Be=>(Be||"").trim(),Pe=Ue(ae),At=t.filter(Be=>Ue(Be.odakanitNo)===Pe);let Re=At.filter(Be=>!Se||Be.createdBy===Se).sort((Be,Gt)=>{const $t=Be.updatedAt?new Date(Be.updatedAt).getTime():0;return(Gt.updatedAt?new Date(Gt.updatedAt).getTime():0)-$t})[0];!Re&&At.length&&(Re=At.sort((Be,Gt)=>{const $t=Be.updatedAt?new Date(Be.updatedAt).getTime():0;return(Gt.updatedAt?new Date(Gt.updatedAt).getTime():0)-$t})[0]);const nn=Se||(Re==null?void 0:Re.createdBy),Xr=(Re==null?void 0:Re.odakanitNo)||ae,tr=(Re==null?void 0:Re.insuredName)||(Re==null?void 0:Re.plaintiffName)||"case",nr=`New financial update (Expenses breakdown) is available for Odakanit case ${Xr} (${tr}).`;let sr=null,rr,lr,ar=[];try{const Be=await nt.getSheet(Ee);if(Be&&Be.sheet&&((ir=Be.lineItems)!=null&&ir.length)){const{text:Gt,totals:$t}=oh(Be.sheet,Be.lineItems),hn=((or=Be.attachments)==null?void 0:or.length)??0,En=$t.amountToRequest.toLocaleString("he-IL",{minimumFractionDigits:2,maximumFractionDigits:2}),Qr="This expenses breakdown was prepared by the finance department and is attached for your review.",cr=`Summary: total amount to request NIS ${En}${hn>0?` (invoices attached: ${hn})`:""}.`;if(sr=`${Qr}

${cr}

${Gt}`,rr=Be.sheet.id,lr=Be.sheet.updatedAt||new Date().toISOString(),Be.attachments&&Be.attachments.length){const dr=Be.attachments.slice(0,4).map((Mn,Jr)=>{const[rs,N]=Mn.fileKey.split(",");let T=Mn.mimeType||"application/octet-stream";if(rs&&rs.startsWith("data:")){const d=rs.match(/^data:(.*?);base64$/);d&&d[1]&&(T=d[1])}const B=N||Mn.fileKey;return{id:`fes-inv-${Mn.id}-${Jr}`,name:Mn.originalFileName,data:B,type:T}});dr.length&&(ar=dr)}}}catch(Be){Ld("Failed to build Expenses Breakdown text for finance notification",Be)}if(Re&&nn){const Be=new Date().toISOString(),Gt=sr||"An expenses table has been prepared by the finance department for this case. Please review the attached sheet or coordinate with Finance as needed.",$t={...createNewReport(),id:`${Date.now()}-finance`,createdBy:nn,ownerName:Re.ownerName||Re.reportAuthor||Re.ownerName||"",ownerEmail:Re.ownerEmail||"",odakanitNo:Pe,insurerName:Re.insurerName||"",insuredName:Re.insuredName||"",plaintiffName:Re.plaintiffName||"",plaintiffTitle:Re.plaintiffTitle||Re.plaintiffTitle,marketRef:Re.marketRef||Re.lineSlipNo||"",lineSlipNo:Re.lineSlipNo||"",certificateRef:Re.certificateRef||"",status:"TASK_ASSIGNED",reportDate:Be,updatedAt:Be,expensesSheetId:rr||Ee,expensesSnapshotAt:lr||Be,invoiceFiles:ar,content:{Update:"","Expenses breakdown":Gt,Recommendations:""},selectedSections:["Update","Expenses breakdown","Recommendations"]};setReports(hn=>{const En=[...hn,$t];return upsertCaseFolderFromReport($t,Be),En}),pushNotification({id:`${Date.now()}`,message:nr,createdAt:new Date().toISOString(),reportId:$t.id,severity:"info",targetUserId:nn})}else pushNotification({id:`${Date.now()}`,message:nr,createdAt:new Date().toISOString(),reportId:Re==null?void 0:Re.id,severity:"info",targetUserId:nn})};return s.jsx(Jy,{user:e,reports:t,onLogout:l,onNotifyLawyer:v})}if(!k&&e.role==="LAWYER")return s.jsx(Ry,{user:e,reports:t,caseFolders:$||{},notifications:M,showNotifications:U,setShowNotifications:H,onClearNotifications:W,dailySummaryOptIn:O,setDailySummaryOptIn:D,archiveAfterMs:p,onSelectReport:n,onNewReport:r,onOpenCaseFolder:I,onLogout:l,deleteReportById:i});const q=Date.now(),F=p??Number.MAX_SAFE_INTEGER,Ne=v=>v.status==="SENT"&&v.sentAt&&q-new Date(v.sentAt).getTime()>=F,xe=k?t:t.filter(v=>v.createdBy===e.id),ze=xe.filter(Ne),_=xe.filter(v=>!Ne(v)&&!v.deletedAt),X=xe.filter(v=>v.deletedAt&&q-new Date(v.deletedAt).getTime()<ph),fe=xe.filter(v=>!v.deletedAt),ge=he?_:G?fe:xe,Z=he?ze:G?X:[],re=k?[]:t.filter(v=>v.status==="READY_TO_SEND"&&v.createdBy===e.id&&!v.deletedAt),pe=k?[]:t.filter(v=>["TASK_ASSIGNED","WAITING_FOR_INVOICES"].includes(v.status)&&v.createdBy===e.id&&!v.deletedAt),z=v=>{var ae;if((ae=v.reportHistory)!=null&&ae.length)return v.reportHistory;if(v.status==="SENT"){const Ee=v.sentAt||v.reportDate||new Date().toISOString();return[{id:`${v.id}-legacy`,reportNumber:1,subject:`${v.insurerName||"Report"}${v.insuredName?` - ${v.insuredName}`:""}`,date:Ee,sent:!0}]}return[]},we=k?[]:t.filter(v=>v.createdBy===e.id&&!v.deletedAt).flatMap(v=>{const ae=z(v);return ae.length?ae.map((Ee,Se)=>{var Ue;return{parent:v,entry:Ee,reportNumber:Ee.reportNumber||Se+1,sentAt:Ee.date||((Ue=Ee.snapshot)==null?void 0:Ue.createdAt)||v.sentAt,isLatest:Se===ae.length-1}}):[]}).sort((v,ae)=>{const Ee=v.sentAt?new Date(v.sentAt).getTime():0;return(ae.sentAt?new Date(ae.sentAt).getTime():0)-Ee}),ve=v=>{const ae=z(v),Ee=ae[ae.length-1],Se=(Ee==null?void 0:Ee.date)||v.sentAt;return Se?new Date(Se).getTime():0},ue=k?[]:t.filter(v=>v.createdBy!==e.id||v.deletedAt||v.status!=="SENT"?!1:z(v).length>0).sort((v,ae)=>ve(ae)-ve(v)),je=k?[]:[{id:"ready",title:"  ",subtitle:"    ",items:re,empty:"   .",actionLabel:" ",action:v=>n(v.id),tone:"border-red-100"},{id:"finance",title:"   ",subtitle:"  /   ",items:pe,empty:"   .",actionLabel:" ",action:v=>n(v.id),tone:"border-amber-100"},{id:"followup",title:"  ",subtitle:"        ",items:ue,empty:"    .",actionLabel:" ",action:f?v=>f(v.id):void 0,tone:"border-blue-100"},{id:"sent",title:" ",subtitle:"         ",items:we,empty:"     .",tone:"border-green-100"}],be=k?t.filter(v=>v.odakanitNo&&!v.deletedAt):[],Oe=(g==null?void 0:g[e.id])||[],Xe=()=>{if(!L.provider.trim())return;const v=Dn.find(Ee=>Ee.value===L.category),ae=L.label.trim()||(v==null?void 0:v.label)||"Favorite provider";S&&S(e.id,{id:rn(),category:L.category,label:ae,serviceProvider:L.provider.trim()}),le({category:L.category,label:"",provider:""})},Fe=v=>{A&&A(e.id,v)};c.filter(v=>v.ownerId===e.id);const Ye=t.filter(v=>Sm(v)&&!v.deletedAt),We=e.role==="FINANCE"||e.role==="SUB_ADMIN",mt=he||G,lt=he?`Items move here ${p/(1e3*60*60)}h after sending and are deleted after ${fh/(1e3*60*60*24)} days.`:G?"     7    .":"",Vr=Ye.filter(v=>!["READY_TO_SEND","SENT"].includes(v.status)),Yr=Ye.filter(v=>v.status==="READY_TO_SEND"),Cs=Ye.filter(v=>v.status==="SENT"),Gr=Cs.reduce((v,ae)=>v+wm(ae),0),gt=v=>v==="SENT"?"bg-green-100 text-green-700 border-green-200":v==="READY_TO_SEND"?"bg-red-100 text-red-700 border-red-200":"bg-gray-100 text-gray-600 border-gray-200",ct=v=>v==="READY_TO_SEND"?"READY TO SEND":v.replace(/_/g," "),Kr=v=>{a(v,{isPaid:!0})},ts=R?Z:ge,Ds=v=>{const ae=v.createdBy||"unknown",Ee=v.odakanitNo||v.marketRef||v.id||"unknown",Se=(v.plaintiffName||"unknown").toLowerCase();return`${ae}::${Ee}::${Se}`},Zs=We?ts.filter(Sm):ts,qr=new Set((We?[]:ts).map(v=>Ds(v))),Bt=!k&&!We?c.filter(v=>v.ownerId===e.id&&!qr.has(v.caseKey)).map(v=>({id:`template-${v.caseKey}`,createdBy:v.ownerId,ownerName:v.ownerName,reportDate:v.lastUpdated,status:"TASK_ASSIGNED",recipientId:"1",insurerName:v.insurerName||"",lineSlipNo:v.lineSlipNo||"",marketRef:v.marketRef||"",insuredName:v.insuredName||"",plaintiffName:v.plaintiffName||"",plaintiffTitle:v.plaintiffTitle||"Plaintiff",odakanitNo:v.odakanitNo,selectedTimeline:"standard",filenameTag:Yp[0],selectedSections:["Update"],content:{},translatedContent:{},expertSummaryMode:{},invoiceFiles:[],isWaitingForInvoices:!1,isTranslated:!1,expensesItems:[],expenseWorksheet:ds(),reportNotes:[],__templateKey:v.caseKey})):[],er=We?Zs:[...Zs,...Bt],yt=Ie.trim().toLowerCase(),tn=v=>yt?`${v.odakanitNo||""} ${v.insuredName||""} ${v.plaintiffName||""} ${v.ownerName||""}`.toLowerCase().includes(yt):!0,Ls=yt?er.filter(tn):er,ns=We?[]:(()=>{const v=new Map;return Ls.forEach(ae=>{if(ae.__templateKey)return;const Ee=ae.odakanitNo||ae.marketRef||ae.insuredName||ae.id,Se=ae.reportDate?new Date(ae.reportDate).getTime():0,Ue=v.get(Ee);Ue?(Ue.reports.push(ae),Se>Ue.latestDate&&(Ue.latestDate=Se),!Ue.caseLabel&&(ae.insuredName||ae.plaintiffName)&&(Ue.caseLabel=ae.insuredName||ae.plaintiffName||Ue.caseLabel),!Ue.insuredName&&ae.insuredName&&(Ue.insuredName=ae.insuredName),!Ue.plaintiffName&&ae.plaintiffName&&(Ue.plaintiffName=ae.plaintiffName)):v.set(Ee,{key:Ee,odakanitNo:ae.odakanitNo||"",caseLabel:ae.insuredName||ae.plaintiffName||ae.marketRef||"",insuredName:ae.insuredName||"",plaintiffName:ae.plaintiffName||"",reports:[ae],latestDate:Se})}),Array.from(v.values()).sort((ae,Ee)=>Ee.latestDate-ae.latestDate)})(),jn=v=>!["READY_TO_SEND","SENT"].includes(v.status),pn=v=>{if(!jn(v)){alert("      -READY TO SEND  .");return}const ae=v.insuredName||v.plaintiffName||v.odakanitNo||v.id;window.confirm(`  " "${ae}"?    .`)&&i&&i(v.id)};return y.useEffect(()=>{Le&&(ns.some(v=>v.key===Le)||Te(null))},[Le,ns]),s.jsxs("div",{className:"min-h-screen bg-gray-100 p-6 relative",children:[V&&s.jsx(mN,{onClose:()=>K(!1)}),de&&s.jsx(IN,{currentUser:e,onClose:()=>ne(!1),onSubmit:v=>{o(v),ne(!1)},favoriteProviders:g[e.id]||[],onSaveFavorite:v=>S&&S(e.id,v)}),se&&s.jsx("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-[200] p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(hg,{className:"w-4 h-4 text-amber-500"}),"   "]}),s.jsx("button",{onClick:()=>ye(!1),className:"text-gray-500 hover:text-gray-800",children:s.jsx(jt,{className:"w-5 h-5"})})]}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:""}),s.jsx("select",{value:L.category,onChange:v=>le({...L,category:v.target.value}),className:"w-full border rounded text-sm p-2",children:Dn.filter(v=>v.type==="EXPENSE").map(v=>s.jsx("option",{value:v.value,children:v.label},v.value))})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),s.jsx("input",{className:"w-full border rounded text-sm p-2",value:L.label,onChange:v=>le({...L,label:v.target.value}),placeholder:":  "})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:" "}),s.jsx("input",{className:"w-full border rounded text-sm p-2",value:L.provider,onChange:v=>le({...L,provider:v.target.value}),placeholder:'"  '})]})]}),s.jsx("div",{className:"text-right",children:s.jsx("button",{onClick:Xe,className:"bg-amber-500 text-white px-4 py-2 rounded font-bold hover:bg-amber-600",children:" "})}),s.jsxs("div",{className:"max-h-64 overflow-y-auto border rounded-lg divide-y",children:[Oe.length===0&&s.jsx("p",{className:"text-sm text-gray-400 text-center py-6",children:"   ."}),Oe.map(v=>s.jsxs("div",{className:"p-3 flex items-center justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-bold text-gray-800",children:v.label}),s.jsx("p",{className:"text-xs text-gray-500",children:v.serviceProvider})]}),s.jsx("button",{onClick:()=>Fe(v.id),className:"text-xs text-red-500 hover:underline",children:""})]},v.id))]})]})}),s.jsxs("div",{className:"max-w-6xl mx-auto",children:[s.jsxs("div",{className:"flex justify-between items-center mb-8",children:[s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-serif font-bold text-lpBlue",children:"Lior Perry Law Office"}),s.jsxs("p",{className:"text-gray-600",children:["Welcome back, ",s.jsx("span",{className:"font-bold",children:e.name})," (",e.role,")"]})]}),s.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[mt&&s.jsxs("button",{onClick:()=>te(v=>!v),className:`flex items-center px-4 py-2 rounded shadow text-sm font-bold ${R?"bg-gray-300 text-gray-800":"bg-gray-200 text-gray-700"} hover:bg-gray-300`,children:[s.jsx(fs,{className:"w-4 h-4 mr-2"})," ",R?"Back to Reports":`Recycle Bin (${Z.length})`]}),s.jsxs("button",{onClick:()=>ne(!0),className:"flex items-center bg-indigo-600 text-white px-4 py-2 rounded shadow hover:bg-indigo-700 font-bold",children:[s.jsx(wd,{className:"w-4 h-4 mr-2"})," Open New Case Folder"]}),s.jsxs("div",{className:"relative",children:[s.jsxs("button",{onClick:()=>H(v=>!v),className:"flex items-center text-blue-600 bg-blue-50 px-3 py-2 rounded hover:bg-blue-100 relative",children:[s.jsx(mi,{className:"w-4 h-4 mr-2"})," Notifications",M.length>0&&s.jsx("span",{className:"absolute -top-2 -right-2 bg-red-500 text-white text-[10px] rounded-full px-1",children:M.length})]}),U&&s.jsxs("div",{className:"absolute right-0 mt-2 w-80 bg-white border border-gray-200 shadow-xl rounded-lg z-50",children:[s.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-b",children:[s.jsx("span",{className:"text-sm font-bold text-gray-700",children:"Smart Notifications"}),s.jsxs("label",{className:"text-xs text-gray-500 flex items-center gap-1",children:[s.jsx("input",{type:"checkbox",checked:O,onChange:v=>D(v.target.checked)}),"Daily summary"]})]}),s.jsxs("div",{className:"max-h-64 overflow-auto divide-y",children:[M.length===0&&s.jsx("div",{className:"p-4 text-xs text-gray-400 text-center",children:"No notifications yet."}),M.map(v=>s.jsxs("div",{className:"p-3 text-sm",children:[s.jsx("p",{className:"font-medium text-gray-800",children:v.message}),s.jsx("p",{className:"text-[10px] text-gray-400",children:new Date(v.createdAt).toLocaleString()})]},v.id))]}),s.jsx("div",{className:"px-3 py-2 text-right text-xs",children:s.jsx("button",{onClick:W,className:"text-red-500 hover:underline",children:"Clear all"})})]})]}),s.jsxs("button",{onClick:()=>K(!0),className:"flex items-center text-blue-600 bg-blue-50 px-3 py-2 rounded hover:bg-blue-100",children:[s.jsx(Nd,{className:"w-4 h-4 mr-2"})," "]}),!1,s.jsxs("button",{onClick:l,className:"flex items-center text-red-600 hover:bg-red-50 px-4 py-2 rounded",children:[s.jsx(Up,{className:"w-4 h-4 mr-2"})," Logout"]})]})]}),k&&s.jsx(fN,{reports:t,currentUser:e,onMarkPaid:Kr}),et&&s.jsxs("div",{className:"mb-8 bg-white border border-amber-200 rounded-2xl shadow p-6 space-y-4",children:[s.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-3",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-lg font-bold text-amber-700 flex items-center gap-2",children:[s.jsx(Hp,{className:"w-5 h-5"})," Expenses Overview"]}),s.jsx("p",{className:"text-sm text-gray-500",children:"Tracking all reports that include expense tables."})]}),s.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[s.jsx("button",{onClick:()=>ye(!0),className:"text-xs text-amber-700 underline hover:text-amber-900",children:"Manage Favorite Providers"}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Assigned to Lawyers"}),s.jsx("p",{className:"text-xl font-bold text-amber-700",children:Vr.length})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Waiting for Lior"}),s.jsx("p",{className:"text-xl font-bold text-blue-600",children:Yr.length})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Sent to Insurer"}),s.jsx("p",{className:"text-xl font-bold text-green-600",children:Cs.length})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Total Sent Balance"}),s.jsxs("p",{className:"text-xl font-bold text-green-700",children:["",Gr.toLocaleString()]})]})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-amber-50 text-amber-800",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 text-left",children:"Case / Lawyer"}),s.jsx("th",{className:"p-2 text-left",children:"Status"}),s.jsx("th",{className:"p-2 text-right",children:"Total Balance ()"}),s.jsx("th",{className:"p-2 text-right",children:"Action"})]})}),s.jsxs("tbody",{className:"divide-y",children:[Ye.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:4,className:"p-4 text-center text-gray-400",children:"No expense reports yet."})}),Ye.map(v=>s.jsxs("tr",{className:"hover:bg-amber-50 transition",children:[s.jsxs("td",{className:"p-2",children:[s.jsx("div",{className:"font-semibold text-gray-800",children:v.insuredName||"Unnamed Case"}),s.jsxs("div",{className:"text-xs text-gray-500",children:["Lawyer: ",v.ownerName]})]}),s.jsx("td",{className:"p-2",children:s.jsx("span",{className:`px-2 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide shadow-sm border ${gt(v.status)}`,children:ct(v.status)})}),s.jsxs("td",{className:"p-2 text-right font-bold",children:["",wm(v).toLocaleString()]}),s.jsx("td",{className:"p-2 text-right",children:s.jsx("button",{onClick:()=>n(v.id),className:"text-lpBlue hover:underline text-xs font-bold",children:"Open"})})]},`expense-${v.id}`))]})]})})]}),!k&&je.length>0&&s.jsx("div",{className:"space-y-6 mb-8",children:je.map(v=>s.jsxs("div",{className:"bg-white border rounded-2xl shadow-sm",children:[s.jsx("div",{className:"flex flex-wrap justify-between items-center gap-3 px-4 py-3 border-b",children:s.jsxs("div",{children:[s.jsx("h3",{className:"font-bold text-gray-800",children:v.title}),s.jsx("p",{className:"text-sm text-gray-500",children:v.subtitle})]})}),v.items.length===0?s.jsx("div",{className:"p-6 text-center text-gray-400 text-sm",children:v.empty}):s.jsx("div",{className:"p-4 space-y-3",children:v.items.map(ae=>{var Ue;if(v.id==="sent"){const Pe=ae,At=Pe.sentAt?new Date(Pe.sentAt).toLocaleDateString("he-IL"):"",Re=Pe.isLatest&&Pe.parent.status==="SENT"&&typeof f=="function",nn=Pe.isLatest&&Pe.parent.status!=="SENT";return s.jsxs("div",{className:`border ${v.tone} rounded-xl p-4`,children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:Pe.parent.odakanitNo||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:Pe.parent.insuredName||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:Pe.parent.plaintiffTitle}),s.jsx("p",{className:"font-bold text-gray-900",children:Pe.parent.plaintiffName||""})]}),s.jsxs("div",{children:[s.jsxs("p",{className:"text-xs uppercase text-gray-400",children:[" #",Pe.reportNumber]}),s.jsx("p",{className:"font-bold text-gray-900",children:At})]})]}),s.jsxs("div",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[s.jsxs("p",{children:[s.jsx("span",{className:"font-semibold text-gray-800",children:":"})," ",Pe.entry.subject||""]}),Pe.entry.fileName&&s.jsxs("p",{className:"text-xs text-gray-500",children:[" : ",Pe.entry.fileName]})]}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 justify-end",children:[Re&&f&&s.jsx("button",{onClick:()=>f(Pe.parent.id),className:"px-4 py-2 rounded-full bg-lpBlue text-white text-sm font-semibold hover:bg-blue-900",children:" "}),nn&&s.jsx("span",{className:"text-xs text-gray-500 font-semibold px-3 py-1 rounded-full bg-gray-100",children:"  "})]})]},`${Pe.parent.id}-${Pe.entry.id}`)}const Ee=ae,Se=(((Ue=Ee.reportHistory)==null?void 0:Ue.length)||0)+1;return s.jsxs("div",{className:`border ${v.tone} rounded-xl p-4`,children:[s.jsxs("div",{className:"grid md:grid-cols-4 gap-4 text-sm text-gray-600",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:Ee.odakanitNo||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:Ee.plaintiffName||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"font-bold text-gray-900",children:Ee.insuredName||""})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsxs("p",{className:"font-bold text-gray-900",children:["#",Se]})]})]}),v.id==="followup"&&s.jsx("div",{className:"mt-2 text-xs text-gray-500",children:(()=>{var Re;const Pe=(Re=Ee.reportHistory)==null?void 0:Re[Ee.reportHistory.length-1],At=Pe!=null&&Pe.date?new Date(Pe.date).toLocaleDateString("he-IL"):Ee.sentAt?new Date(Ee.sentAt).toLocaleDateString("he-IL"):"";return`  : #${(Pe==null?void 0:Pe.reportNumber)||Se-1}  ${At}`})()}),s.jsxs("div",{className:"mt-3 flex flex-wrap gap-2 justify-end",children:[v.id==="finance"&&jn(Ee)&&s.jsxs("button",{onClick:()=>pn(Ee),className:"px-3 py-2 rounded-full border border-red-200 text-red-600 text-sm font-semibold flex items-center gap-1 hover:bg-red-50",title:"  ",children:[s.jsx(fs,{className:"w-4 h-4"}),""]}),v.action&&s.jsx("button",{onClick:()=>v.action&&v.action(Ee),className:"px-4 py-2 rounded-full bg-lpBlue text-white text-sm font-semibold hover:bg-blue-900",children:v.actionLabel})]})]},Ee.id)})})]},v.id))}),k&&s.jsxs("div",{className:"mb-8",children:[s.jsx("div",{className:"flex justify-between items-end mb-4",children:s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center",children:[s.jsx($p,{className:"w-6 h-6 mr-2 text-indigo-600"})," Active Case Folders"]})}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[be.length===0&&s.jsx("p",{className:"text-gray-400 italic col-span-3 text-center py-4",children:"No active finance folders."}),be.map(v=>{var Se;const ae=(()=>{switch(v.status){case"WAITING_FOR_INVOICES":return{badge:"bg-yellow-50 text-yellow-700",text:"Awaiting Finance Finalize",icon:s.jsx(Ut,{className:"text-yellow-500 w-5 h-5 animate-spin"})};case"TASK_ASSIGNED":return{badge:"bg-blue-50 text-blue-700",text:"Pending Lawyer Action",icon:s.jsx(Fp,{className:"text-blue-500 w-5 h-5"})};case"READY_TO_SEND":return{badge:"bg-orange-50 text-orange-700",text:"Waiting for Lior",icon:s.jsx(Ut,{className:"text-orange-500 w-5 h-5 animate-spin"})};case"SENT":return{badge:"bg-green-50 text-green-700",text:"Completed",icon:s.jsx(Bp,{className:"text-green-500 w-6 h-6"})};default:return{badge:"bg-gray-50 text-gray-600",text:v.status,icon:s.jsx(Ut,{className:"text-gray-400 w-5 h-5 animate-spin"})}}})(),Ee=(Se=Es.find(Ue=>Ue.id===v.createdBy))==null?void 0:Se.name;return s.jsxs("div",{className:"bg-white p-4 rounded-lg shadow border-t-4 relative border-indigo-100",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("h4",{className:"font-bold text-lg",children:["Case #",v.odakanitNo]}),ae.icon]}),s.jsxs("div",{className:"text-sm text-gray-600 mb-1 flex items-center",children:[s.jsx(xg,{className:"w-4 h-4 mr-1"})," Assigned to: ",Ee]}),s.jsx("div",{className:"text-xs text-gray-500 mb-4",children:new Date(v.reportDate).toLocaleDateString()}),s.jsx("div",{className:"flex justify-end gap-2 mt-2",children:v.status==="SENT"?s.jsxs("button",{onClick:()=>i(v.id),className:"text-red-500 hover:bg-red-50 px-3 py-1 rounded text-sm flex items-center",children:[s.jsx(fs,{className:"w-4 h-4 mr-1"})," Delete Folder"]}):s.jsx("span",{className:`text-xs font-bold px-2 py-1 rounded ${ae.badge}`,children:ae.text})})]},v.id)})]})]}),(k||We)&&s.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden",children:[s.jsxs("div",{className:"p-4 border-b border-gray-100 bg-gray-50/50 flex flex-wrap gap-3 items-center justify-between",children:[s.jsxs("h3",{className:"font-bold text-gray-700 flex items-center",children:[s.jsx(Nc,{className:"w-4 h-4 mr-2 text-gray-400"})," ",R?"Recycle Bin":"All Reports"]}),s.jsxs("div",{className:"flex items-center gap-3 flex-wrap justify-end",children:[R&&lt&&s.jsx("span",{className:"text-xs text-gray-500",children:lt}),s.jsxs("div",{className:"relative w-full sm:w-72",children:[s.jsx(mg,{className:"w-4 h-4 text-gray-400 absolute left-3 top-1/2 -translate-y-1/2"}),s.jsx("input",{value:Ie,onChange:v=>Ae(v.target.value),placeholder:"     ",className:"w-full border border-gray-300 rounded-full pl-9 pr-10 py-1.5 text-sm focus:ring-2 focus:ring-blue-200 outline-none"}),Ie&&s.jsx("button",{onClick:()=>Ae(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-red-500",children:s.jsx(jt,{className:"w-4 h-4"})})]})]})]}),We?s.jsxs("table",{className:"w-full text-left",children:[s.jsx("thead",{className:"bg-gray-50 text-gray-500 text-xs uppercase tracking-wider font-semibold",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-4",children:"Insurer / Subject"}),k&&s.jsx("th",{className:"p-4",children:"Lawyer"}),s.jsx("th",{className:"p-4",children:"Status"}),s.jsx("th",{className:"p-4 text-right",children:"Action"})]})}),s.jsxs("tbody",{className:"divide-y divide-gray-100",children:[Ls.length===0&&s.jsx("tr",{children:s.jsx("td",{colSpan:k?4:3,className:"p-6 text-center text-gray-400 text-sm",children:yt?"    .":"  ."})}),Ls.map(v=>{const ae=v.status==="READY_TO_SEND",Ee=v.status==="SENT",Se=!!v.__templateKey;return s.jsxs("tr",{className:`transition cursor-default ${ae?"bg-red-50":Ee?"bg-green-50/50":"hover:bg-blue-50/30"}`,children:[s.jsxs("td",{className:"p-4",children:[s.jsx("div",{className:"font-bold text-gray-800",children:v.insurerName||"Untitled"}),s.jsxs("div",{className:"text-xs text-gray-500",children:[v.marketRef," ",v.insuredName?` - ${v.insuredName}`:""]})]}),k&&s.jsx("td",{className:"p-4 text-sm text-gray-600 font-medium",children:v.ownerName}),s.jsx("td",{className:"p-4",children:s.jsx("span",{className:`px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide shadow-sm border ${gt(v.status)}`,children:ct(v.status)})}),s.jsx("td",{className:"p-4 text-right",children:s.jsxs("div",{className:"flex justify-end gap-2 flex-wrap",children:[s.jsxs(s.Fragment,{children:[s.jsxs("button",{onClick:()=>E(v.id),className:"text-xs bg-gray-100 hover:bg-gray-200 px-3 py-1.5 rounded flex items-center gap-1",children:[s.jsx(zp,{className:"w-3 h-3"})," View Expenses"]}),s.jsxs("button",{onClick:()=>P(v),className:"text-xs bg-blue-50 text-blue-700 hover:bg-blue-100 px-3 py-1.5 rounded flex items-center gap-1",children:[s.jsx(mi,{className:"w-3 h-3"})," Reminder"]}),s.jsxs("button",{onClick:()=>x(v),className:"text-xs bg-purple-50 text-purple-700 hover:bg-purple-100 px-3 py-1.5 rounded flex items-center gap-1",children:[s.jsx(bd,{className:"w-3 h-3"})," Add Note"]})]}),G&&!he&&!R&&s.jsxs("button",{onClick:()=>!Se&&h(v.id),disabled:Se,className:`text-xs px-3 py-1.5 rounded flex items-center gap-1 ${Se?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-700 hover:bg-red-100"}`,children:[s.jsx(fs,{className:"w-3 h-3"})," Delete"]}),R&&s.jsxs(s.Fragment,{children:[he&&s.jsx("button",{onClick:()=>a(v.id,{sentAt:new Date().toISOString()}),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-sm font-bold",children:"Restore"}),!he&&G&&s.jsx("button",{onClick:()=>b(v.id),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-sm font-bold",children:"Restore"})]})]})})]},v.id)})]})]}):s.jsx("div",{children:ns.length===0?s.jsx("div",{className:"p-6 text-center text-gray-400 text-sm",children:yt?"    .":"  ."}):s.jsx("div",{className:"divide-y divide-gray-100",children:ns.map(v=>{const ae=v.latestDate?new Date(v.latestDate).toLocaleDateString("he-IL"):"-",Ee=[...v.reports].sort((Se,Ue)=>{const Pe=Se.reportDate?new Date(Se.reportDate).getTime():0;return(Ue.reportDate?new Date(Ue.reportDate).getTime():0)-Pe});return s.jsxs("div",{className:"p-4",children:[s.jsxs("div",{className:"flex flex-wrap justify-between gap-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:" "}),s.jsx("p",{className:"text-xl font-bold text-gray-900",children:v.odakanitNo||""}),s.jsxs("p",{className:"text-xs text-gray-500",children:[" : ",s.jsx("span",{className:"font-semibold",children:v.plaintiffName||""}),"   : ",s.jsx("span",{className:"font-semibold",children:v.insuredName||""})]}),s.jsxs("p",{className:"text-xs text-gray-400",children:[" : ",ae]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("p",{className:"text-xs text-gray-500",children:'" '}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:v.reports.length}),s.jsx("button",{onClick:()=>Te(Se=>Se===v.key?null:v.key),className:"mt-2 px-4 py-1.5 text-sm font-semibold rounded-full border border-gray-300 text-gray-700 hover:bg-gray-100",children:Le===v.key?" ":" "})]})]}),Le===v.key&&s.jsx("div",{className:"mt-4 bg-gray-50 border border-gray-200 rounded-xl overflow-hidden",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{className:"bg-gray-100 text-gray-600 text-xs uppercase tracking-wide",children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-3 text-left",children:" "}),s.jsx("th",{className:"p-3 text-left",children:" "}),s.jsx("th",{className:"p-3 text-left",children:" "}),s.jsx("th",{className:"p-3 text-left",children:""}),s.jsx("th",{className:"p-3 text-right",children:""})]})}),s.jsx("tbody",{className:"divide-y divide-gray-200",children:Ee.map(Se=>{const Ue=Se.status==="READY_TO_SEND",Pe=Se.status==="SENT",At=!!Se.__templateKey;return s.jsxs("tr",{className:`bg-white ${Ue?"bg-red-50":Pe?"bg-green-50/60":""}`,children:[s.jsx("td",{className:"p-3",children:Se.reportDate?new Date(Se.reportDate).toLocaleDateString("he-IL"):""}),s.jsx("td",{className:"p-3",children:Se.plaintiffName||""}),s.jsx("td",{className:"p-3",children:Se.insuredName||""}),s.jsx("td",{className:"p-3",children:s.jsx("span",{className:`px-2.5 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide shadow-sm border ${gt(Se.status)}`,children:ct(Se.status)})}),s.jsx("td",{className:"p-3 text-right",children:s.jsxs("div",{className:"flex justify-end gap-2 flex-wrap",children:[s.jsxs("button",{onClick:()=>n(Se.id),className:"text-lpBlue hover:bg-blue-50 px-3 py-1.5 rounded transition font-bold text-xs flex items-center",children:["Open ",s.jsx(Rn,{className:"w-3 h-3 ml-1"})]}),G&&!he&&!R&&s.jsxs("button",{onClick:()=>!At&&h(Se.id),disabled:At,className:`text-xs px-3 py-1.5 rounded flex items-center gap-1 ${At?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-red-50 text-red-700 hover:bg-red-100"}`,children:[s.jsx(fs,{className:"w-3 h-3"})," Delete"]}),R&&s.jsxs(s.Fragment,{children:[he&&s.jsx("button",{onClick:()=>a(Se.id,{sentAt:new Date().toISOString()}),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-xs font-bold",children:"Restore"}),!he&&G&&s.jsx("button",{onClick:()=>b(Se.id),className:"text-green-600 hover:bg-green-50 px-3 py-1.5 rounded text-xs font-bold",children:"Restore"})]})]})})]},Se.id)})})]})})]},v.key)})})})]}),!k&&s.jsx("div",{className:"fixed bottom-8 right-8",children:s.jsx("button",{onClick:r,className:"bg-lpBlue text-white p-4 rounded-full shadow-xl hover:bg-blue-900 transition transform hover:scale-110",children:s.jsx(lg,{className:"w-6 h-6"})})})]})]})},AN=({onLogin:e})=>{const[t,n]=y.useState(""),[r,l]=y.useState(""),a=()=>{const i=Es.find(o=>o.username===t&&o.password===r);i?e(i):alert("Invalid credentials. Try: lior/lior123")};return s.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 bg-gradient-to-b from-[#08162c] via-[#0b1f3b] to-[#132d52]",children:s.jsxs("div",{className:"w-full max-w-sm bg-white/10 border border-white/15 rounded-[30px] p-10 text-center shadow-2xl backdrop-blur-lg",children:[s.jsx("div",{className:"mx-auto mb-6 h-20 w-20 rounded-full bg-gradient-to-br from-[#f8b733] via-[#f49e1b] to-[#f47b0a] flex items-center justify-center text-4xl font-bold text-[#16305b] shadow-lg",children:"LP"}),s.jsx("div",{className:"text-sm tracking-[0.5em] text-[#f7b23a] uppercase mb-2",children:"Lloyd's"}),s.jsx("div",{className:"text-3xl font-serif text-white mb-1",children:"REPORT"}),s.jsx("div",{className:"text-xs text-blue-200 uppercase tracking-[0.4em] mb-8",children:"Builder System"}),s.jsxs("div",{className:"space-y-4 text-left",children:[s.jsx("label",{className:"text-xs uppercase text-blue-200 tracking-[0.2em]",children:"Username"}),s.jsxs("div",{className:"relative",children:[s.jsx(gg,{className:"w-4 h-4 text-blue-200 absolute left-3 top-1/2 -translate-y-1/2"}),s.jsx("input",{className:"w-full bg-white/10 border border-white/20 rounded-full py-3 pl-10 pr-4 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-[#f7b23a]/60",placeholder:"Username",value:t,onChange:i=>n(i.target.value)})]}),s.jsx("label",{className:"text-xs uppercase text-blue-200 tracking-[0.2em]",children:"Password"}),s.jsxs("div",{className:"relative",children:[s.jsx(og,{className:"w-4 h-4 text-blue-200 absolute left-3 top-1/2 -translate-y-1/2"}),s.jsx("input",{type:"password",className:"w-full bg-white/10 border border-white/20 rounded-full py-3 pl-10 pr-4 text-white placeholder-blue-200 focus:outline-none focus:ring-2 focus:ring-[#f7b23a]/60",placeholder:"Password",value:r,onChange:i=>l(i.target.value)})]})]}),s.jsxs("button",{onClick:a,className:"mt-8 w-full bg-gradient-to-r from-[#0a6bff] to-[#1740e6] text-white py-3 rounded-full font-semibold tracking-wide flex items-center justify-center gap-2 hover:from-[#0955c6] hover:to-[#1430af] transition-colors",children:["Sign In ",s.jsx(Fp,{className:"w-4 h-4"})]}),s.jsx("div",{className:"mt-6 text-[11px] text-blue-200 tracking-[0.3em] uppercase",children:"Lior Perry Law Office & Notary  2024"})]})})},kN=()=>{var T,B;const[e,t]=y.useState(()=>NN()),[n,r]=y.useState(()=>vN()),[l,a]=y.useState(()=>yN()),[i,o]=y.useState(null),c=y.useRef(!1),[u,f]=y.useState(null),[p,g]=y.useState([]),[S,A]=y.useState(!1);e==null||e.role;const[E,P]=y.useState(()=>{if(typeof window>"u")return[];try{const d=window.localStorage.getItem(Ke.NOTIFICATIONS),m=d?JSON.parse(d):[];return Array.isArray(m)?m.filter(w=>w&&typeof w.id=="string"&&typeof w.message=="string"&&typeof w.createdAt=="string"):[]}catch{return[]}}),[x,h]=y.useState(!1),[b,M]=y.useState(!1),[U,H]=y.useState([]),[W,O]=y.useState(null),[D,$]=y.useState(()=>{if(typeof window>"u")return{};try{const d=localStorage.getItem("favoriteProviders");return d?JSON.parse(d):{}}catch(d){return console.error("Failed to load favorite providers",d),{}}});y.useEffect(()=>{if(!(typeof window>"u"))try{window.localStorage.setItem(Ke.NOTIFICATIONS,JSON.stringify(E))}catch{}},[E]);const[I,k]=y.useState(null),[G,de]=y.useState(""),[ne,V]=y.useState(null),[K,R]=y.useState(""),[te,se]=y.useState("LAWYER"),[ye,L]=y.useState(!1),[le,Ie]=y.useState(!1),[Ae,Le]=y.useState(!1),[Te,he]=y.useState(!1),[et,q]=y.useState(!1),[F,Ne]=y.useState(!1),[xe,ze]=y.useState(()=>{if(typeof window>"u")return[];try{const d=localStorage.getItem("caseTemplates");return d?JSON.parse(d):[]}catch(d){return console.error("Failed to load case templates",d),[]}}),[_,X]=y.useState(null),[fe,ge]=y.useState(""),[Z,re]=y.useState(!1);y.useEffect(()=>{typeof window>"u"||aN()||l.length&&z(d=>{const m=rN(d,l);return dl(m),lN(),m})},[l]);const[pe,z]=y.useState(()=>sN());y.useEffect(()=>{n!=="PREVIEW"&&A(!1)},[n]);const we=d=>d.deletedAt?Date.now()-new Date(d.deletedAt).getTime()>=ph:d.status==="SENT"&&d.sentAt?Date.now()-new Date(d.sentAt).getTime()>=fh:!1;y.useEffect(()=>{const d=()=>{a(w=>w.filter(j=>!we(j)))};d();const m=setInterval(d,60*60*1e3);return()=>clearInterval(m)},[]),y.useEffect(()=>{if(!b)return;const d=setInterval(()=>{if(!l.length)return;const m=l.filter(C=>C.status==="READY_TO_SEND").length,w=l.filter(C=>C.status==="SENT").length,j=`Daily summary: ${m} ready to send, ${w} sent reports.`;P(C=>[{id:`daily-${Date.now()}`,message:j,createdAt:new Date().toISOString(),severity:"info"},...C])},1e3*60*60*12);return()=>clearInterval(d)},[b,l]),y.useEffect(()=>{try{localStorage.setItem("caseTemplates",JSON.stringify(xe))}catch(d){console.error("Failed to persist case templates",d)}},[xe]),y.useEffect(()=>{try{localStorage.setItem("favoriteProviders",JSON.stringify(D))}catch(d){console.error("Failed to persist favorites",d)}},[D]),y.useEffect(()=>{if(!(typeof window>"u"))try{localStorage.setItem(Ke.REPORTS,JSON.stringify(l))}catch(d){console.error("Failed to persist reports",d)}},[l]),y.useEffect(()=>{typeof window>"u"||(e?localStorage.setItem(Ke.USER,e.username):localStorage.removeItem(Ke.USER))},[e]),y.useEffect(()=>{typeof window>"u"||localStorage.setItem(Ke.VIEW,n)},[n]),y.useEffect(()=>{typeof window>"u"||(i?localStorage.setItem(Ke.CURRENT_REPORT,i.id):localStorage.removeItem(Ke.CURRENT_REPORT))},[i]),y.useEffect(()=>{if(typeof window>"u"||c.current)return;const d=localStorage.getItem(Ke.CURRENT_REPORT);if(!d){c.current=!0;return}const m=l.find(w=>w.id===d);m&&o(m),c.current=!0},[l,e]),y.useEffect(()=>{n!=="DASHBOARD"&&(i||(r("DASHBOARD"),typeof window<"u"&&(localStorage.setItem(Ke.VIEW,"DASHBOARD"),localStorage.removeItem(Ke.CURRENT_REPORT))))},[i,n]);const ve=()=>({id:Date.now().toString(),createdBy:e.id,ownerName:e.name,ownerEmail:e.email,reportDate:new Date().toISOString(),updatedAt:new Date().toISOString(),status:"DRAFT",reportSubject:"",recipientId:"1",insurerName:"",lineSlipNo:"",marketRef:"",certificateRef:"",insuredName:"",plaintiffName:"",plaintiffTitle:"Plaintiff",policyPeriodStart:"",policyPeriodEnd:"",retroStart:"",retroEnd:"",sentAt:void 0,reportHistory:[],selectedTimeline:"standard",filenameTag:Yp[0],selectedSections:["Update","Recommendations"],content:{},translatedContent:{},invoiceFiles:[],isWaitingForInvoices:!1,requiresExpenses:!1,isTranslated:!1,expensesItems:[],expenseWorksheet:ds(),reportNotes:[],complaintAnalysis:void 0,attachPolicyAsAppendix:!0}),ue=d=>{const m=d.createdBy||"unknown",w=d.odakanitNo||d.marketRef||d.id,j=(d.plaintiffName||"unknown").toLowerCase();return`${m}::${w}::${j}`},je=d=>{const m=ue(d),w={caseKey:m,ownerId:d.createdBy,ownerName:d.ownerName,odakanitNo:d.odakanitNo,plaintiffName:d.plaintiffName,plaintiffTitle:d.plaintiffTitle,insurerName:d.insurerName,lineSlipNo:d.lineSlipNo,marketRef:d.marketRef,certificateRef:d.certificateRef,insuredName:d.insuredName,policyPeriodStart:d.policyPeriodStart,policyPeriodEnd:d.policyPeriodEnd,retroStart:d.retroStart,retroEnd:d.retroEnd,lastUpdated:new Date().toISOString()};ze(j=>j.find(Y=>Y.caseKey===m)?j.map(Y=>Y.caseKey===m?w:Y):[...j,w])},be=d=>{if(!e)return;const m=xe.find(j=>j.caseKey===d&&j.ownerId===e.id);if(!m)return;const w={...ve(),odakanitNo:m.odakanitNo||"",insurerName:m.insurerName||"",lineSlipNo:m.lineSlipNo||"",marketRef:m.marketRef||"",certificateRef:m.certificateRef||"",insuredName:m.insuredName||"",plaintiffName:m.plaintiffName||"",plaintiffTitle:m.plaintiffTitle||"Plaintiff",policyPeriodStart:m.policyPeriodStart||"",policyPeriodEnd:m.policyPeriodEnd||"",retroStart:m.retroStart||"",retroEnd:m.retroEnd||""};o(w),r("STEP1")},Oe=d=>{var Ce;if(!e)return;const m=Xe(d);if(!m||m.createdBy!==e.id||(((Ce=m.reportHistory)==null?void 0:Ce.length)||0)===0||m.status!=="SENT")return;const w=m.reportHistory[m.reportHistory.length-1];if(!w)return;const C=w.snapshot||m,Y=C.selectedSections&&C.selectedSections.length?[...C.selectedSections]:[...m.selectedSections||[]],ee=Y.length?Y:["Update","Recommendations"],ie=new Date().toISOString(),Q={...m,reportDate:ie,updatedAt:ie,status:"DRAFT",sentAt:void 0,reportNotes:[],content:{},translatedContent:{},executiveSummary:void 0,complaintAnalysis:void 0,expensesItems:[],expensesSum:void 0,paymentRecommendation:void 0,expenseWorksheet:ds(),invoiceFiles:[],expensesSourceFile:void 0,requiresExpenses:!1,isWaitingForInvoices:!1,isTranslated:!1,selectedEmailTemplate:void 0,emailBodyDraft:void 0,fileNameTitles:[],deletedAt:void 0,deletedBy:void 0,selectedSections:ee,reportHistory:[...m.reportHistory||[]]};Q.insurerName=C.insurerName||"",Q.lineSlipNo=C.lineSlipNo||"",Q.marketRef=C.marketRef||"",Q.certificateRef=C.certificateRef||"",Q.insuredName=C.insuredName||"",Q.plaintiffName=C.plaintiffName||"",Q.plaintiffTitle=C.plaintiffTitle||m.plaintiffTitle,Q.policyPeriodStart=C.policyPeriodStart||"",Q.policyPeriodEnd=C.policyPeriodEnd||"",Q.retroStart=C.retroStart||"",Q.retroEnd=C.retroEnd||"",Q.filenameTag=C.filenameTag||Q.filenameTag,Q.fileNameTitles=[],Q.selectedTimeline=C.selectedTimeline||Q.selectedTimeline,Q.selectedTimelineImage=C.selectedTimelineImage,Q.odakanitNo=C.odakanitNo||m.odakanitNo,Q.recipientId=C.recipientId||m.recipientId,a(He=>He.map(Me=>Me.id===m.id?Q:Me)),o(Q),je(Q),r("STEP1")},Xe=d=>l.find(m=>m.id===d),Fe=(d,m)=>{if(d.status!==m.status||d.hebrewWorkflowStatus!==m.hebrewWorkflowStatus||d.insuredName!==m.insuredName||d.plaintiffName!==m.plaintiffName||d.insurerName!==m.insurerName||d.odakanitNo!==m.odakanitNo||d.marketRef!==m.marketRef||d.lineSlipNo!==m.lineSlipNo||d.certificateRef!==m.certificateRef||d.policyPeriodStart!==m.policyPeriodStart||d.policyPeriodEnd!==m.policyPeriodEnd||d.retroStart!==m.retroStart||d.retroEnd!==m.retroEnd||d.reportSubject!==m.reportSubject||d.executiveSummary!==m.executiveSummary)return!0;const w=(j,C)=>JSON.stringify(j)===JSON.stringify(C);return!w(d.content,m.content)||!w(d.translatedContent,m.translatedContent)||!w(d.expenseWorksheet,m.expenseWorksheet)||!w(d.expensesItems,m.expensesItems)||d.expensesSum!==m.expensesSum||d.paymentRecommendation!==m.paymentRecommendation||!w(d.complaintAnalysis,m.complaintAnalysis)||!w(d.reportReview,m.reportReview)},Ye=(d,m)=>{d.odakanitNo&&z(w=>{const j=Sc(w,d,m);return dl(j),j})},We=(d,m,w,j)=>{d.odakanitNo&&z(C=>{const Y=mh(C,d,m,w,j);return dl(Y),Y})},mt=(d,m)=>{const w=d.reportReview??{status:"DRAFT",issues:[]};return{...d,reportReview:m(w)}},lt=d=>{ct(d,m=>{const w=(e==null?void 0:e.id)||"unknown",j=new Date().toISOString();return{...mt(m,Y=>({...Y,status:"SUBMITTED",submittedAt:j,submittedByUserId:Y.submittedByUserId||w})),hebrewWorkflowStatus:"HEBREW_SUBMITTED"}})},Vr=d=>{(e==null?void 0:e.role)==="ADMIN"&&ct(d,m=>{const w=(e==null?void 0:e.id)||"unknown",j=new Date().toISOString();return{...mt(m,Y=>({...Y,status:"APPROVED",reviewedAt:j,reviewedByUserId:w})),hebrewWorkflowStatus:"HEBREW_APPROVED"}})},Yr=(d,m)=>{m.length&&ct(d,w=>{const j=(e==null?void 0:e.id)||"unknown",C=new Date().toISOString();return{...mt(w,ee=>({...ee,status:"CHANGES_REQUESTED",reviewedAt:C,reviewedByUserId:j,issues:[...ee.issues,...m.map(ie=>({id:`issue-${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:C,createdByUserId:j,sectionKey:ie.sectionKey,severity:ie.severity,type:ie.type,title:ie.title,instruction:ie.instruction,status:"OPEN"}))]})),hebrewWorkflowStatus:"HEBREW_CHANGES_REQUESTED"}})},Cs=(d,m)=>{ct(d,w=>{const j=new Date().toISOString();return mt(w,C=>({...C,issues:C.issues.map(Y=>Y.id===m&&Y.status!=="DONE"?{...Y,status:"DONE",doneAt:j}:Y)}))})},Gr=d=>{(e==null?void 0:e.role)==="ADMIN"&&ct(d,m=>{const w=new Date().toISOString();return mt(m,j=>({...j,issues:j.issues.map(C=>(C.origin??"INTERNAL")==="EXTERNAL"&&C.status!=="DONE"?{...C,status:"DONE",doneAt:w}:C)}))})},gt=d=>{var w;return d?((w=d.reportReview)==null?void 0:w.status)==="APPROVED"||d.hebrewWorkflowStatus==="HEBREW_APPROVED":!1},ct=(d,m)=>{const w=new Date().toISOString();let j=null,C=null;if(a(Y=>Y.map(ee=>{if(ee.id!==d)return ee;const ie=m(ee);return j=ee,C=ie,Fe(ee,ie)?{...ie,updatedAt:w}:ie})),j&&C&&j.odakanitNo&&C.odakanitNo){const Y=j.odakanitNo.trim(),ee=C.odakanitNo.trim();Y&&ee&&Y!==ee&&z(ie=>{let Q={...ie};const Ce=Q[Y];if(Ce){const He=Ce.reportIds.filter(Me=>Me!==C.id);Q[Y]={...Ce,reportIds:He}}return Q=Sc(Q,C,w),dl(Q),Q})}o(Y=>{if(!Y||Y.id!==d)return Y;const ee=m(Y);return Fe(Y,ee)?{...ee,updatedAt:w}:ee})},Kr=(d,m,w)=>{m.length&&(e==null?void 0:e.role)==="ADMIN"&&ct(d,j=>{const C=(e==null?void 0:e.id)||"unknown",Y=new Date().toISOString();return{...mt(j,ie=>({...ie,status:"CHANGES_REQUESTED",reviewedAt:Y,reviewedByUserId:C,issues:[...ie.issues,...m.map(Q=>({id:`issue-${Date.now()}-${Math.random().toString(36).slice(2)}`,createdAt:Y,createdByUserId:C,sectionKey:Q.sectionKey,severity:Q.severity,type:Q.type,title:Q.title,instruction:Q.instruction,status:"OPEN",origin:"EXTERNAL",externalRefId:w,externalAction:Q.externalAction??"ENGLISH_ONLY"}))]})),postSendFeedbackMeta:{...j.postSendFeedbackMeta||{},lastFeedbackAt:Y}}})},ts=d=>{(e==null?void 0:e.role)==="ADMIN"&&ct(d,m=>{const w=new Date().toISOString(),j=m.reportReview??{status:"DRAFT",issues:[]};return{...m,hebrewWorkflowStatus:"HEBREW_REOPENED_EXTERNAL",reportReview:{...j,status:j.status==="CHANGES_REQUESTED"?j.status:"CHANGES_REQUESTED"},postSendFeedbackMeta:{...m.postSendFeedbackMeta||{},reopenedDueToFeedbackAt:w}}})},Ds=d=>{P(m=>[d,...m])},Zs=d=>{H(m=>m.some(w=>w.reportId===d)?m:[...m,{reportId:d}]),O(d)},qr=d=>{H(m=>m.filter(w=>w.reportId!==d)),O(m=>m===d?null:m)},Bt=(d,m)=>{$(w=>{const j=w[d]||[];return j.some(C=>C.serviceProvider.toLowerCase()===m.serviceProvider.toLowerCase()&&C.category===m.category)?w:{...w,[d]:[m,...j]}})},er=(d,m)=>{$(w=>{const j=w[d]||[];return{...w,[d]:j.filter(C=>C.id!==m)}})},yt=d=>{if(i){const m=i,w={...i,...d},j=Fe(m,w);o(j?{...w,updatedAt:new Date().toISOString()}:w)}},tn=()=>{i&&a(d=>{const w=d.find(j=>j.id===i.id)?d.map(j=>j.id===i.id?i:j):[...d,i];return Ye(i),w})},Ls=()=>{if(!i)return;const d=Eo(i.content),m=Eo(i.translatedContent);yt({content:d,translatedContent:m})},ns=async()=>{if(i){if(!gt(i)){window.alert("       .");return}Ie(!0);try{const d=Eo(i.content),m={};for(const w of Object.keys(d)){const j=d[w];if(j){const C=await bg(j);m[w]=xh(C)}}yt({content:d,translatedContent:m,isTranslated:!0}),window.alert("  .")}catch(d){console.error("Translate failed",d),window.alert(" .    .")}finally{Ie(!1)}}},jn=d=>{const m=new Set(["lidor@lp-law.co.il"]),w=new Set(["reports@lp-law.co.il"]);if(d.ownerEmail)w.add(d.ownerEmail);else{const j=Es.find(C=>C.id===d.createdBy);j!=null&&j.email&&w.add(j.email)}return{to:Array.from(m),cc:Array.from(w)}},pn=d=>hi(d),v=d=>({...d,invoiceFiles:[],policyFile:void 0,expensesSourceFile:void 0}),ae=(d,m)=>{var C,Y,ee;const w=d.content?mr(d.content):{},j=d.translatedContent?mr(d.translatedContent):{};return{createdAt:m,reportDate:d.reportDate,subject:((C=d.emailSubjectDraft)==null?void 0:C.trim())||pn(d),status:"SENT",odakanitNo:d.odakanitNo,recipientId:d.recipientId,insurerName:d.insurerName,lineSlipNo:d.lineSlipNo,marketRef:d.marketRef,insuredName:d.insuredName,plaintiffName:d.plaintiffName,plaintiffTitle:d.plaintiffTitle,policyPeriodStart:d.policyPeriodStart,policyPeriodEnd:d.policyPeriodEnd,retroStart:d.retroStart,retroEnd:d.retroEnd,filenameTag:d.filenameTag,fileNameTitles:d.fileNameTitles?[...d.fileNameTitles]:void 0,selectedSections:[...d.selectedSections||[]],content:w,translatedContent:j,executiveSummary:d.executiveSummary,complaintAnalysis:d.complaintAnalysis?mr(d.complaintAnalysis):void 0,requiresExpenses:!!d.requiresExpenses,isWaitingForInvoices:!!d.isWaitingForInvoices,isTranslated:!!d.isTranslated,selectedTimeline:d.selectedTimeline,selectedTimelineImage:d.selectedTimelineImage,expensesItems:(Y=d.expensesItems)!=null&&Y.length?mr(d.expensesItems):void 0,expenseWorksheet:d.expenseWorksheet?mr(d.expenseWorksheet):void 0,expensesSum:d.expensesSum,paymentRecommendation:d.paymentRecommendation,reportNotes:(ee=d.reportNotes)!=null&&ee.length?mr(d.reportNotes):void 0,ownerName:d.ownerName,ownerEmail:d.ownerEmail}},Ee=(d,m,w)=>{var C,Y;const j=((C=d.emailSubjectDraft)==null?void 0:C.trim())||pn(d);return{id:rn(),reportNumber:(((Y=d.reportHistory)==null?void 0:Y.length)||0)+1,subject:j,date:w,sent:!0,fileName:m,snapshot:ae(d,w)}},Se=(d,m,w)=>{if(typeof window>"u")return;const j=d.to.join(";"),C=ie=>encodeURIComponent(ie),Y=[];d.cc.length&&Y.push(`cc=${C(d.cc.join(";"))}`),Y.push(`subject=${C(m)}`),Y.push(`body=${C(w)}`);const ee=`mailto:${j}?${Y.join("&")}`;window.location.href=ee},Ue=async()=>{if(i){L(!0);try{const d=await po(i),m=Fs(i),w=URL.createObjectURL(d),j=document.createElement("a");j.href=w,j.download=m,document.body.appendChild(j),j.click(),j.remove(),URL.revokeObjectURL(w)}catch(d){console.error("PDF download failed",d),alert(" -PDF .  .")}finally{L(!1)}}},Pe=()=>{i&&((e==null?void 0:e.role)==="ADMIN"?(q(!1),Le(!0)):tr())},At=()=>{var w,j;if(!i||(e==null?void 0:e.role)!=="ADMIN")return;if(i.status!=="SENT"){setShowToast({msg:"       (SENT).",type:"error"});return}if(!gt(i)){setShowToast({msg:"   /   .       .",type:"error"});return}if(((j=(w=i.reportReview)==null?void 0:w.issues)==null?void 0:j.some(C=>(C.origin??"INTERNAL")==="EXTERNAL"&&C.status!=="DONE"&&C.externalAction==="REQUIRES_HEBREW"))??!1){setShowToast({msg:"      .    /      .",type:"error"});return}if(!(i.isTranslated&&i.translatedContent&&Object.values(i.translatedContent).some(C=>C&&C.trim().length>0))){setShowToast({msg:"    .      .",type:"error"});return}q(!0),Le(!0)},Re=async({body:d,templateId:m,subjectBase:w,topics:j})=>{if(!i)return;const C={...i,selectedEmailTemplate:m,emailBodyDraft:d,emailSubjectDraft:w.trim()?w.trim():void 0,fileNameTitles:j};if(yt({selectedEmailTemplate:m,emailBodyDraft:d,emailSubjectDraft:C.emailSubjectDraft,fileNameTitles:j}),e){const Me=wc(e.id),tt=cm(Me,j,6);im(e.id,tt)}he(!0);let Y=null,ee="";const ie=w.trim()||pn(C);let Q="",Ce=null,He=!1;try{Ce=await po(C);const Me=await jm(Ce);Q=Fs(C),Y=jn(C),ee=ie,He=await nm({to:Y.to,cc:Y.cc,subject:ee,body:d,attachmentBase64:Me,attachmentName:Q}),He?setShowToast({msg:"  .",type:"success"}):setShowToast({msg:"          ( PDF  ,    ).",type:"error"})}catch(Me){console.error("Email send failed",Me),setShowToast({msg:"          ( PDF  ,    ).",type:"error"})}finally{if(Y){if(!He){if(Ce){const Me=Q||Fs(C),tt=URL.createObjectURL(Ce),ke=document.createElement("a");ke.href=tt,ke.download=Me,document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),URL.revokeObjectURL(tt)}Se(Y,ee||ie,d)}tr(Q||void 0),Le(!1)}he(!1)}},nn=async({body:d,templateId:m,subjectBase:w,topics:j})=>{var He;if(!i||(e==null?void 0:e.role)!=="ADMIN")return;const C={...i,selectedEmailTemplate:m,emailBodyDraft:d,emailSubjectDraft:w.trim()?w.trim():void 0,fileNameTitles:j};if(yt({selectedEmailTemplate:m,emailBodyDraft:d,emailSubjectDraft:C.emailSubjectDraft,fileNameTitles:j}),e&&j.length){const Me=wc(e.id),tt=cm(Me,j,6);im(e.id,tt)}he(!0);let Y=null,ee="",ie="";const Q=w.trim()||pn(C);let Ce=!1;try{const Me=await po(C),tt=await jm(Me);ie=Fs(C),Y=jn(C),ee=`UPDATED: ${Q}`,Ce=await nm({to:Y.to,cc:Y.cc,subject:ee,body:d,attachmentBase64:tt,attachmentName:ie}),Ce?setShowToast({msg:"   ( ).",type:"success"}):setShowToast({msg:"         .",type:"error"});const ke=new Date().toISOString(),sn=Ee({...i,status:"SENT",sentAt:ke},ie,ke),_s=(((He=i.reportHistory)==null?void 0:He.length)||0)+1,Mi={...sn,subject:`Resent #${_s}  ${sn.subject}`},ls={...i,status:"SENT",sentAt:ke,reportHistory:[...i.reportHistory||[],Mi],selectedEmailTemplate:void 0,emailBodyDraft:void 0};je(ls),Ye(ls,ke),We(ls,ke,Mi.fileName||ie,!0),o(ls),a(ra=>ra.map(Zr=>Zr.id===ls.id?ls:Zr))}catch(Me){console.error("Resend email failed",Me),setShowToast({msg:"         .",type:"error"})}finally{if(Y){const Me=Q||pn(i),tt=ee||`UPDATED: ${Me}`;Ce||Se(Y,tt,d),Le(!1)}q(!1),he(!1)}},Xr=d=>{if(!d)return;let m=d.trim();if(!(!m||(m=m.replace(Ad," ").replace(/\s+/g," ").trim(),!m)||(m.toLowerCase().endsWith(".pdf.pdf")&&(m=m.slice(0,-4)),m.toLowerCase().endsWith(".pdf")||(m=`${m}.pdf`),m.length>255)))return m},tr=d=>{var Y;if(!i)return;let m="READY_TO_SEND",w=i.sentAt,j=i;if((e==null?void 0:e.role)==="ADMIN"){m="SENT",w=new Date().toISOString();const ie=Xr(d)||Fs(v(i)),Q=Ee({...i},ie,w);j={...i,reportHistory:[...i.reportHistory||[],Q],selectedEmailTemplate:void 0,emailBodyDraft:void 0}}else((e==null?void 0:e.role)==="FINANCE"||(e==null?void 0:e.role)==="SUB_ADMIN")&&(m="TASK_ASSIGNED");const C={...j,status:m,sentAt:w};if(je(C),Ye(C,w||new Date().toISOString()),m==="SENT"&&w){const ee=(Y=C.reportHistory)==null?void 0:Y[C.reportHistory.length-1];We(C,w,ee==null?void 0:ee.fileName,!1)}o(C),a(ee=>ee.find(Q=>Q.id===C.id)?ee.map(Q=>Q.id===C.id?C:Q):[...ee,C]),r("DASHBOARD")},nr=(d,m)=>{e&&(ct(d,w=>{const j=[{id:rn(),authorId:e.id,authorName:e.name,message:m,createdAt:new Date().toISOString()},...w.reportNotes||[]];return{...w,reportNotes:j}}),Ds({id:`note-${Date.now()}`,message:`${e.name} added a note: "${m}"`,createdAt:new Date().toISOString()}))},sr=(d,m)=>{ct(d,w=>{const j=w.expenseWorksheet||ds(),C={id:rn(),timestamp:new Date().toISOString(),userId:(e==null?void 0:e.id)||"system",userName:(e==null?void 0:e.name)||"System",action:m.action||"UPDATE",details:m.details};return{...w,expenseWorksheet:{...j,history:[C,...j.history||[]]}}})},rr=(d,m,w)=>{e&&(ct(d,j=>{const C=j.expenseWorksheet||ds(),Y={id:rn(),rowId:m,authorId:e.id,authorName:e.name,message:w,createdAt:new Date().toISOString()};return{...j,expenseWorksheet:{...C,notes:[Y,...C.notes||[]]}}}),sr(d,{action:"NOTE_ADDED",details:w}))},lr=d=>{const m=new Date().toISOString();ct(d,w=>({...w,deletedAt:m,deletedBy:e==null?void 0:e.id}))},ar=d=>{ct(d,m=>{const w={...m};return delete w.deletedAt,delete w.deletedBy,w})},ir=(d,m)=>{ct(d,w=>{const j=w.expenseWorksheet||ds();return{...w,expenseWorksheet:{...j,notes:j.notes.map(C=>C.id===m?{...C,resolved:!0,resolvedAt:new Date().toISOString()}:C)}}})},or=(d,m)=>{!m.amount||m.amount<=0||ct(d,w=>{var tt,ke;const j=w.expenseWorksheet||ds(),C=Dn.find(sn=>sn.value===m.category),Y=(C==null?void 0:C.type)||"EXPENSE",ee=m.category==="OTHER"?((tt=m.customLabel)==null?void 0:tt.trim())||"Other expense":(C==null?void 0:C.label)||"Expense",ie={id:rn(),type:Y,category:m.category,label:ee,serviceProvider:Y==="EXPENSE"?(ke=m.serviceProvider)==null?void 0:ke.trim():void 0,amount:m.amount,createdBy:e==null?void 0:e.id,createdAt:new Date().toISOString()},Q=[...j.rows||[],ie],Ce=Ni(Q),He=SN(Q),Me={id:rn(),timestamp:new Date().toISOString(),userId:(e==null?void 0:e.id)||"system",userName:(e==null?void 0:e.name)||"System",action:"ROW_ADDED",details:`${ee} ${ie.amount.toLocaleString()}`};return{...w,expenseWorksheet:{...j,rows:Q,totals:Ce,history:[Me,...j.history||[]]},expensesItems:He,expensesSum:Ce.totalExpenses.toLocaleString()}})},Be=d=>{const m=Es.find(Q=>Q.id===d.lawyerId);if(!m)return;const w=jc(d.worksheet||[],e||void 0),j=Ni(w),C=d.invoiceFiles||[],Y=C.length===0,ee={...ve(),createdBy:m.id,ownerName:m.name,ownerEmail:m.email,status:Y?"WAITING_FOR_INVOICES":"TASK_ASSIGNED",odakanitNo:d.odakanitNo,financeInstructions:d.instructions,expensesSourceFile:d.file,selectedSections:["Update","Expenses breakdown"],isWaitingForInvoices:Y,requiresExpenses:!0},ie={...ee,expensesItems:w.filter(Q=>Q.type==="EXPENSE").map(Q=>({id:Q.id,date:new Date().toISOString().split("T")[0],description:`${Q.label}${Q.serviceProvider?` (${Q.serviceProvider})`:""}`,amount:Q.amount,currency:"NIS"})),expensesSum:w.length?j.totalExpenses.toLocaleString():ee.expensesSum,invoiceFiles:C,expenseWorksheet:{status:"DRAFT",rows:w,history:[{id:rn(),timestamp:new Date().toISOString(),userId:(e==null?void 0:e.id)||"system",userName:(e==null?void 0:e.name)||"System",action:"WORKSHEET_CREATED",details:`${w.length} rows added via finance request`}],notes:[],favorites:D[d.lawyerId]||[],totals:j}};a(Q=>[...Q,ie]),Ds({id:`worksheet-${Date.now()}`,message:`New expense worksheet created for case ${d.odakanitNo||ie.id}`,createdAt:new Date().toISOString(),reportId:ie.id,severity:"info"})},Gt=d=>{t(d),r("DASHBOARD"),o(null),c.current=!1,typeof window<"u"&&(localStorage.setItem(Ke.USER,d.username),localStorage.setItem(Ke.VIEW,"DASHBOARD"),localStorage.removeItem(Ke.CURRENT_REPORT))},$t=()=>{if(t(null),o(null),c.current=!1,r("DASHBOARD"),f(null),A(!1),Le(!1),he(!1),q(!1),Ne(!1),k(null),de(""),V(null),R(""),se("LAWYER"),H([]),O(null),h(!1),X(null),g([]),typeof window<"u")try{localStorage.removeItem(Ke.USER),localStorage.removeItem(Ke.CURRENT_REPORT),localStorage.setItem(Ke.VIEW,"DASHBOARD"),localStorage.removeItem(Gy)}catch(d){console.error("Failed to clear session storage on logout",d)}};if(!e)return s.jsx(AN,{onLogin:Gt});if(n==="CASE_FOLDER"&&_){const d=pe[_]||null,m=()=>{r("DASHBOARD")};return d?s.jsx(nN,{folder:d,reports:l,onBack:m,onUpdateReTemplate:w=>{z(j=>{const C=j[_];if(!C)return j;const Y={...C,reTemplate:w,updatedAt:new Date().toISOString()},ee={...j,[_]:Y};return dl(ee),ee})},onCreateReportInCase:()=>{const w=pe[_];if(!w||!e)return;const j=new Date().toISOString(),C={...ve(),odakanitNo:w.odakanitNo,reportSubject:w.reTemplate||"",insuredName:w.insuredName||"",plaintiffName:w.plaintiffName||"",insurerName:w.insurerName||"",marketRef:w.marketRef||"",lineSlipNo:w.lineSlipNo||"",certificateRef:w.certificateRef||"",reportDate:j,updatedAt:j};if(o(C),r("STEP1"),typeof window<"u")try{localStorage.setItem(Ke.CURRENT_REPORT,C.id)}catch{}Ye(C,j)},onOpenReport:w=>{const j=l.find(C=>C.id===w);if(j&&(o(j),r("STEP1"),typeof window<"u"))try{localStorage.setItem(Ke.CURRENT_REPORT,j.id)}catch{}}}):s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4",children:s.jsxs("div",{className:"max-w-md rounded-2xl bg-white p-6 text-center text-sm text-gray-700 shadow-sm border border-gray-200",children:[s.jsx("p",{className:"mb-3 font-semibold text-gray-900",children:"Case folder not found"}),s.jsx("p",{className:"mb-4 text-xs text-gray-500",children:"The requested case folder is no longer available. You can return to the dashboard and select another case."}),s.jsx("button",{type:"button",onClick:m,className:"inline-flex items-center rounded-full bg-lpBlue px-4 py-1.5 text-xs font-semibold text-white shadow-sm hover:bg-blue-900 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-lpBlue focus-visible:ring-offset-2",children:"Back to dashboard"})]})})}const hn=()=>{if((e==null?void 0:e.role)==="LAWYER"){ge(""),re(!0);return}const d=ve();if(o(d),r("STEP1"),typeof window<"u")try{localStorage.setItem(Ke.CURRENT_REPORT,d.id)}catch{}},En=(d,m)=>{const w=l.find(j=>j.id===d);if(w&&(o(w),r("STEP1"),f(m||null),typeof window<"u"))try{localStorage.setItem(Ke.CURRENT_REPORT,w.id)}catch{}};if(n==="DASHBOARD")return(e==null?void 0:e.role)==="ADMIN"||(e==null?void 0:e.role)==="SUB_ADMIN"?s.jsx(Xy,{user:e,reports:l,onNewReport:hn,onSelectReport:En,onSelectReportWithFocus:(d,m)=>En(d,m),onMarkExternalIssuesDone:Gr,onReopenHebrewDueToExternalFeedback:d=>ts(d),canTranslate:gt,onLogout:$t}):s.jsxs(s.Fragment,{children:[s.jsx(TN,{user:e,reports:l,onNewReport:hn,onSelectReport:En,onLogout:$t,onUpdateReport:(d,m)=>{a(w=>w.map(j=>j.id===d?{...j,...m}:j))},onDeleteReport:d=>a(m=>m.filter(w=>w.id!==d)),onFinanceTaskCreate:Be,caseTemplates:xe,onStartTemplate:be,onStartNextReport:Oe,archiveAfterMs:hN,favoriteProviders:D,onSaveFavorite:Bt,onDeleteFavorite:er,onOpenWorksheet:Zs,onRequestReminder:d=>{V(d),R(`Reminder for ${d.insuredName||"case"}`)},onRequestNote:d=>{k(d),de("")},onSoftDeleteReport:lr,onRestoreReport:ar,notifications:E.filter(d=>!d.targetUserId||d.targetUserId===(e==null?void 0:e.id)),showNotifications:x,setShowNotifications:h,onClearNotifications:()=>P([]),dailySummaryOptIn:b,setDailySummaryOptIn:M,caseFolders:pe,onOpenCaseFolder:d=>{X(d),r("CASE_FOLDER")}}),(e==null?void 0:e.role)==="LAWYER"&&Z&&s.jsx("div",{className:"fixed inset-0 z-[250] flex items-center justify-center bg-black/40",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-xl max-w-sm w-full mx-4 p-5 space-y-3",dir:"rtl",children:[s.jsx("h2",{className:"text-sm font-bold text-slate-900 text-right",children:"    "}),s.jsx("p",{className:"text-xs text-slate-600 text-right",children:"/   .         /  .          ."}),s.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded px-3 py-1.5 text-sm text-gray-900",placeholder:": 1/123",value:fe,onChange:d=>ge(d.target.value)}),s.jsxs("div",{className:"flex justify-end gap-2 mt-2",children:[s.jsx("button",{type:"button",className:"px-3 py-1.5 rounded-md border border-slate-300 text-xs text-slate-700 bg-white hover:bg-slate-50",onClick:()=>{re(!1),ge("")},children:""}),s.jsx("button",{type:"button",className:"px-3 py-1.5 rounded-md bg-lpBlue text-xs font-semibold text-white hover:bg-blue-900",onClick:()=>{const d=fe.trim();if(!d){alert("    .");return}const m=d,w=pe[m],j=new Date().toISOString();if(w){const Y={...ve(),odakanitNo:w.odakanitNo,reportSubject:w.reTemplate||"",insuredName:w.insuredName||"",plaintiffName:w.plaintiffName||"",insurerName:w.insurerName||"",marketRef:w.marketRef||"",lineSlipNo:w.lineSlipNo||"",certificateRef:w.certificateRef||"",reportDate:j,updatedAt:j};if(o(Y),r("STEP1"),typeof window<"u")try{localStorage.setItem(Ke.CURRENT_REPORT,Y.id)}catch{}Ye(Y,j)}else{const Y={...ve(),odakanitNo:m};if(o(Y),r("STEP1"),typeof window<"u")try{localStorage.setItem(Ke.CURRENT_REPORT,Y.id)}catch{}Ye(Y,j)}re(!1),ge("")},children:""})]})]})})]});if(!i)return null;const Qr=(((T=i.reportHistory)==null?void 0:T.length)||0)+1,cr=Gp(i.selectedSections||[]),ss=cr.map((d,m)=>({id:`${m}-${d.replace(/\s+/g,"-")||"title"}`,label:d})).filter(d=>!!d.label),dr=bc(cr),Mn=i.fileNameTitles&&i.fileNameTitles.length?i.fileNameTitles:dr,Jr=Qr!==1&&ss.length>0,rs=U.map(d=>{const m=Xe(d.reportId);return m?{...d,report:m,title:`${m.insuredName||"Case"} (${m.ownerName})`}:null}).filter(Boolean),N=W?Xe(W):null;return s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"min-h-screen bg-gray-50 pb-12",children:s.jsxs("div",{className:"max-w-5xl mx-auto pt-6 px-4",children:[s.jsx("div",{className:"flex justify-center mb-8",children:s.jsxs("div",{className:"flex items-center bg-white p-2 rounded-full shadow-sm",children:[s.jsx("div",{className:`px-4 py-1 rounded-full ${n==="STEP1"?"bg-lpBlue text-white font-bold":"text-gray-500"}`,children:"1. Setup"}),s.jsx(Rn,{className:"w-4 h-4 text-gray-300 mx-2"}),s.jsx("div",{className:`px-4 py-1 rounded-full ${n==="STEP2"?"bg-lpBlue text-white font-bold":"text-gray-500"}`,children:"2. Draft"}),s.jsx(Rn,{className:"w-4 h-4 text-gray-300 mx-2"}),s.jsx("div",{className:`px-4 py-1 rounded-full ${n==="PREVIEW"?"bg-lpBlue text-white font-bold":"text-gray-500"}`,children:"3. Preview"})]})}),n==="STEP1"&&s.jsx(jN,{data:i,updateData:yt,onNext:()=>{tn(),r("STEP2")},onBack:()=>{tn(),r("DASHBOARD")},currentUser:e,timelineGallery:p,onAddTimelineImages:d=>g(m=>[...m,...d.map(w=>({...w,id:Date.now().toString()}))]),onRemoveTimelineImage:d=>g(m=>m.filter(w=>w.id!==d)),onSaveAndExit:()=>{tn(),r("DASHBOARD")}}),n==="STEP2"&&s.jsx(EN,{data:i,updateData:yt,onNext:()=>{tn(),r("PREVIEW")},onBack:()=>{tn(),r("STEP1")},currentUser:e,timelineGallery:p,onAddTimelineImages:d=>{},onSaveAndExit:()=>{tn(),r("DASHBOARD")},onTranslate:ns,onFormatContent:Ls,onSubmitHebrewForReview:()=>lt(i.id),onApproveHebrewForTranslation:()=>Vr(i.id),onAddReviewIssues:d=>Yr(i.id,d),onMarkReviewIssueDone:d=>Cs(i.id,d),onAddExternalFeedbackIssues:(d,m)=>Kr(i.id,d,m),onReopenHebrewDueToExternalFeedback:()=>ts(i.id),step1Focus:u,onStep1FocusConsumed:()=>f(null),isTranslating:le}),n==="PREVIEW"&&(()=>{const d=cN(e==null?void 0:e.role),m=(e==null?void 0:e.role)==="LAWYER";return s.jsxs("div",{className:"space-y-6 animate-fade-in",dir:m?"rtl":void 0,lang:m?"he":void 0,children:[s.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-2",children:[s.jsxs("button",{onClick:()=>{tn(),r("STEP2")},className:"flex items-center text-sm text-gray-600 bg-gray-100 px-3 py-1.5 rounded-full hover:bg-gray-200",children:[s.jsx(fi,{className:"w-4 h-4 mr-1"}),d.backToStep2]}),s.jsxs("button",{onClick:()=>{tn(),r("DASHBOARD")},className:"flex items-center text-sm text-lpBlue bg-blue-50 px-3 py-1.5 rounded-full hover:bg-blue-100",children:[s.jsx(vd,{className:"w-4 h-4 mr-1"}),d.backToDashboard]})]}),s.jsxs("div",{className:"flex justify-between items-center bg-white p-4 rounded shadow mb-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-xl font-bold text-lpBlue",children:d.title}),s.jsx("p",{className:"mt-1 text-xs text-gray-500",children:"Export options let you back up the current report data (JSON/CSV) in addition to the PDF."})]}),s.jsxs("div",{className:"flex gap-2 flex-wrap justify-end",children:[s.jsx("button",{onClick:()=>A(w=>!w),className:"flex items-center bg-gray-200 text-gray-700 px-4 py-2 rounded hover:bg-gray-300",children:S?d.toggleHide:d.toggleShow}),s.jsxs("button",{onClick:Ue,disabled:ye,className:"flex items-center bg-white text-gray-700 border border-gray-300 px-4 py-2 rounded hover:bg-gray-50 disabled:opacity-50",children:[ye?s.jsx(Ut,{className:"w-4 h-4 mr-2 animate-spin"}):s.jsx(Wl,{className:"w-4 h-4 mr-2"}),d.downloadPdf]}),s.jsx("button",{onClick:()=>Ne(!0),disabled:!Jr,className:"flex items-center bg-white text-gray-700 border border-gray-300 px-4 py-2 rounded hover:bg-gray-50 disabled:opacity-40",children:d.editFileNames}),s.jsx("button",{onClick:()=>{const w={report:i},j=new Blob([JSON.stringify(w,null,2)],{type:"application/json"}),C=URL.createObjectURL(j),Y=document.createElement("a");Y.href=C,Y.download=`report-${i.odakanitNo||i.id}.json`,Y.click(),URL.revokeObjectURL(C)},className:"flex items-center bg-white text-gray-700 border border-gray-300 px-3 py-2 rounded hover:bg-gray-50 text-xs",children:"JSON Export"}),s.jsx("button",{onClick:()=>{const w=["OdakanitNo","InsuredName","PlaintiffName","InsurerName","MarketRef","LineSlipNo","CertificateRef","ReportDate","Status"],j=[i.odakanitNo||"",i.insuredName||"",i.plaintiffName||"",i.insurerName||"",i.marketRef||"",i.lineSlipNo||"",i.certificateRef||"",i.reportDate||"",i.status||""],C=Ce=>{const He=String(Ce??"");return/[",\n]/.test(He)?`"${He.replace(/"/g,'""')}"`:He},Y=[w.join(","),j.map(C).join(",")].join(`
`),ee=new Blob(["\uFEFF"+Y],{type:"text/csv;charset=utf-8;"}),ie=URL.createObjectURL(ee),Q=document.createElement("a");Q.href=ie,Q.download=`report-${i.odakanitNo||i.id}.csv`,Q.click(),URL.revokeObjectURL(ie)},className:"flex items-center bg-white text-gray-700 border border-gray-300 px-3 py-2 rounded hover:bg-gray-50 text-xs",children:"CSV Export"}),s.jsxs("button",{onClick:Pe,className:"flex items-center bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700",children:[s.jsx(pi,{className:"w-4 h-4 mr-2"}),d.finalize]}),e.role==="ADMIN"&&s.jsxs("button",{onClick:At,className:"flex items-center bg-orange-600 text-white px-4 py-2 rounded hover:bg-orange-700",children:[s.jsx(pi,{className:"w-4 h-4 mr-2"}),"   "]})]})]}),S?s.jsxs("div",{className:"bg-white rounded-2xl shadow p-4 space-y-4",children:[s.jsx("div",{className:"flex items-center justify-end flex-wrap gap-3",children:s.jsx("span",{className:"text-xs text-gray-500",children:d.helperScroll})}),s.jsx("div",{className:"border rounded-2xl bg-gray-50 p-4 pr-6 max-h-[900px] overflow-auto shadow-inner",children:s.jsx("div",{className:"scale-[0.85] origin-top flex justify-center overflow-visible",children:s.jsx(_g,{data:i})})})]}):s.jsx("div",{className:"text-center text-gray-500 border border-dashed border-gray-300 rounded-2xl p-6 bg-gray-50",children:d.collapsedHint}),s.jsx("div",{className:"flex justify-start mt-4",children:s.jsx("button",{onClick:()=>r("STEP2"),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300",children:d.backToEditing})})]})})()]})}),i&&s.jsx(Xg,{isOpen:Ae,isSending:Te,report:i,userId:e==null?void 0:e.id,recipientsPreview:jn(i),defaultSubject:pn(i),subjectDraft:((B=i.emailSubjectDraft)==null?void 0:B.trim())||pn(i),onSubjectDraftChange:d=>yt({emailSubjectDraft:d&&d.trim()?d.trim():void 0}),selectedTopics:i.fileNameTitles||[],onSelectedTopicsChange:d=>yt({fileNameTitles:d}),onClose:()=>{Te||(q(!1),Le(!1))},onSend:et?nn:Re}),i&&s.jsx(Qg,{isOpen:F,availableTitles:ss,selectedTitles:Mn,onClose:()=>Ne(!1),onSave:d=>{const m=d.map(w=>w.trim()).filter(Boolean);yt({fileNameTitles:m}),Ne(!1)}}),I&&s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[200] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 space-y-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(bd,{className:"w-4 h-4"})," Add Note"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Case: ",I.insuredName||I.odakanitNo||I.id]}),s.jsx(zl,{clientId:Kl,children:s.jsx("textarea",{className:"w-full border rounded p-3 text-sm",rows:4,value:G,onChange:d=>de(d.target.value),placeholder:"Write your note..."})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>{k(null),de("")},className:"px-4 py-2 text-gray-500 hover:bg-gray-100 rounded",children:"Cancel"}),s.jsx("button",{onClick:()=>{I&&G.trim()&&(nr(I.id,G.trim()),k(null),de(""))},className:"px-4 py-2 bg-lpBlue text-white rounded hover:bg-blue-900",children:"Save"})]})]})}),ne&&s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[200] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 space-y-4",children:[s.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[s.jsx(mi,{className:"w-4 h-4"})," Send Reminder"]}),s.jsxs("p",{className:"text-sm text-gray-500",children:["Case: ",ne.insuredName||ne.odakanitNo||ne.id]}),s.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Recipients"}),s.jsxs("select",{className:"w-full border rounded p-2 text-sm",value:te,onChange:d=>se(d.target.value),children:[s.jsx("option",{value:"LAWYER",children:"Lawyer"}),s.jsx("option",{value:"SUB_ADMIN",children:"Sub-Admin"}),s.jsx("option",{value:"BOTH",children:"Both"})]}),s.jsx("label",{className:"text-xs font-bold text-gray-500",children:"Message"}),s.jsx(zl,{clientId:Kl,children:s.jsx("textarea",{className:"w-full border rounded p-3 text-sm",rows:4,value:K,onChange:d=>R(d.target.value),placeholder:"Reminder details..."})}),s.jsxs("div",{className:"flex justify-end gap-2",children:[s.jsx("button",{onClick:()=>{V(null),R("")},className:"px-4 py-2 text-gray-500 hover:bg-gray-100 rounded",children:"Cancel"}),s.jsx("button",{onClick:()=>{if(ne&&K.trim()){const d=[];(te==="LAWYER"||te==="BOTH")&&d.push(ne.ownerName),(te==="SUB_ADMIN"||te==="BOTH")&&d.push(...Es.filter(m=>m.role==="SUB_ADMIN").map(m=>m.name)),Ds({id:`reminder-${Date.now()}`,message:`Reminder to ${d.join(", ")}: ${K.trim()}`,createdAt:new Date().toISOString(),reportId:ne.id}),V(null),R("")}},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Send"})]})]})}),N&&s.jsx(RN,{report:N,sessions:rs,onSwitch:O,onClose:qr,currentUser:e,onAddRowNote:rr,onResolveRowNote:ir,onAddWorksheetRow:or,previousReport:l.filter(d=>d.id!==N.id&&d.odakanitNo&&d.odakanitNo===N.odakanitNo).sort((d,m)=>new Date(m.reportDate).getTime()-new Date(d.reportDate).getTime())[0]})]})},RN=({report:e,sessions:t,onSwitch:n,onClose:r,currentUser:l,onAddRowNote:a,onResolveRowNote:i,onAddWorksheetRow:o,previousReport:c})=>{const[u,f]=y.useState("table"),[p,g]=y.useState(""),[S,A]=y.useState(null),[E,P]=y.useState({category:"EXPERT_OUR",serviceProvider:"",amount:"",customLabel:""}),x=e.expenseWorksheet||ds(),h=x.rows.filter(I=>I.type==="EXPENSE"),b=x.rows.filter(I=>I.type==="ADJUSTMENT"),M=x.notes.filter(I=>!I.resolved),U=x.totals||Ni(x.rows),H=(l==null?void 0:l.role)==="FINANCE"||(l==null?void 0:l.role)==="SUB_ADMIN",W=Dn.find(I=>I.value===E.category),O=(W==null?void 0:W.type)!=="ADJUSTMENT",D=I=>{p.trim()&&(a(e.id,I,p.trim()),g(""),A(null))},$=()=>{const I=parseFloat(E.amount);isNaN(I)||I<=0||(o(e.id,{category:E.category,serviceProvider:O?E.serviceProvider:void 0,amount:I,customLabel:E.customLabel}),P({category:"EXPERT_OUR",serviceProvider:"",amount:"",customLabel:""}))};return s.jsx("div",{className:"fixed inset-0 bg-black/40 z-[220] flex items-center justify-center p-4",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",children:[s.jsxs("div",{className:"flex justify-between items-center px-5 py-3 border-b bg-gray-50",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-500 uppercase",children:"Expense Worksheet"}),s.jsxs("h2",{className:"text-lg font-bold text-gray-800",children:[e.insuredName||e.odakanitNo||"Case","  ",e.ownerName]})]}),s.jsx("button",{onClick:()=>r(e.id),className:"text-gray-500 hover:text-gray-800",children:s.jsx(jt,{className:"w-5 h-5"})})]}),s.jsx("div",{className:"flex border-b bg-white px-4 overflow-x-auto",children:t.map(I=>s.jsxs("button",{onClick:()=>n(I.reportId),className:`flex items-center gap-2 px-3 py-2 text-sm border-b-2 ${I.reportId===e.id?"border-lpBlue text-lpBlue font-bold":"border-transparent text-gray-400"}`,children:[I.title,s.jsx("span",{onClick:k=>{k.stopPropagation(),r(I.reportId)},className:"text-gray-400 hover:text-red-500",children:s.jsx(jt,{className:"w-3 h-3"})})]},I.reportId))}),s.jsx("div",{className:"flex gap-2 px-5 pt-4 text-sm font-semibold",children:["table","history","notes","compare"].map(I=>s.jsx("button",{onClick:()=>f(I),className:`px-3 py-1 rounded-full ${u===I?"bg-lpBlue text-white":"bg-gray-100 text-gray-500"}`,children:I==="table"?"Worksheet":I==="history"?"History":I==="notes"?`Notes (${M.length})`:"Compare"},I))}),s.jsxs("div",{className:"flex-1 overflow-auto p-5 space-y-4",children:[u==="table"&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center bg-gray-50 rounded-lg py-3",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Total Expenses"}),s.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["",U.totalExpenses.toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Adjustments"}),s.jsxs("p",{className:"text-lg font-bold text-yellow-700",children:["",U.totalAdjustments.toLocaleString()]})]}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs uppercase text-gray-400",children:"Balance Due"}),s.jsxs("p",{className:"text-lg font-bold text-green-700",children:["",U.totalBalance.toLocaleString()]})]})]}),H&&s.jsxs("div",{className:"border rounded-lg p-3 bg-amber-50 space-y-2",children:[s.jsx("p",{className:"text-xs font-bold text-amber-700",children:"  "}),s.jsxs("div",{className:"grid md:grid-cols-3 gap-2",children:[s.jsx("select",{value:E.category,onChange:I=>P({...E,category:I.target.value}),className:"border rounded text-xs p-2",children:Dn.map(I=>s.jsx("option",{value:I.value,children:I.label},I.value))}),E.category==="OTHER"&&s.jsx("input",{className:"border rounded text-xs p-2",placeholder:" ",value:E.customLabel,onChange:I=>P({...E,customLabel:I.target.value})}),O&&s.jsx("input",{className:"border rounded text-xs p-2",placeholder:" ",value:E.serviceProvider,onChange:I=>P({...E,serviceProvider:I.target.value})}),s.jsx("input",{className:"border rounded text-xs p-2",placeholder:" ",type:"number",min:"0",value:E.amount,onChange:I=>P({...E,amount:I.target.value})}),s.jsx("button",{onClick:$,className:"bg-amber-500 text-white rounded text-xs font-bold px-3 py-2 hover:bg-amber-600",children:"Add"})]})]}),s.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Service Expenses"}),s.jsxs("div",{className:"space-y-2",children:[h.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No expenses recorded."}),h.map(I=>{const k=x.notes.filter(G=>G.rowId===I.id&&!G.resolved).length;return s.jsxs("div",{className:"border rounded-lg p-3 bg-white shadow-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"font-semibold text-sm",children:I.label}),I.serviceProvider&&s.jsx("p",{className:"text-xs text-gray-500",children:I.serviceProvider})]}),s.jsxs("div",{className:"text-right",children:[s.jsxs("p",{className:"font-bold text-lpBlue",children:["",I.amount.toLocaleString()]}),s.jsxs("button",{className:"text-[10px] text-gray-400",onClick:()=>A(S===I.id?null:I.id),children:[" Notes (",k,")"]})]})]}),S===I.id&&s.jsxs("div",{className:"mt-2 flex gap-2",children:[s.jsx("input",{className:"flex-1 border rounded text-xs p-2",value:p,onChange:G=>g(G.target.value),placeholder:"Add note..."}),s.jsx("button",{onClick:()=>D(I.id),className:"px-3 py-1 text-xs bg-lpBlue text-white rounded",children:"Save"})]})]},I.id)})]})]}),s.jsxs("div",{children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Adjustments"}),s.jsxs("div",{className:"space-y-2",children:[b.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No adjustments yet."}),b.map(I=>s.jsx("div",{className:"border rounded-lg p-3 bg-gray-50",children:s.jsxs("div",{className:"flex justify-between",children:[s.jsx("p",{className:"font-semibold text-sm",children:I.label}),s.jsxs("p",{className:"font-bold text-red-600",children:["",I.amount.toLocaleString()]})]})},I.id))]})]})]}),s.jsxs("div",{className:"border rounded-lg p-3 bg-gray-50",children:[s.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"General Note"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{className:"flex-1 border rounded text-xs p-2",value:p,onChange:I=>g(I.target.value),placeholder:"Add note for worksheet..."}),s.jsx("button",{onClick:()=>D(void 0),className:"px-3 py-1 text-xs bg-lpBlue text-white rounded",children:"Save"})]})]})]}),u==="history"&&s.jsxs("div",{className:"space-y-2",children:[x.history.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No history recorded yet."}),x.history.map(I=>s.jsxs("div",{className:"border rounded-lg p-3 bg-white flex justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",children:I.action}),I.details&&s.jsx("p",{className:"text-xs text-gray-500",children:I.details})]}),s.jsxs("div",{className:"text-right text-[10px] text-gray-400",children:[s.jsx("p",{children:I.userName}),s.jsx("p",{children:new Date(I.timestamp).toLocaleString()})]})]},I.id))]}),u==="notes"&&s.jsxs("div",{className:"space-y-2",children:[x.notes.length===0&&s.jsx("p",{className:"text-xs text-gray-400",children:"No notes yet."}),x.notes.map(I=>s.jsx("div",{className:`border rounded-lg p-3 ${I.resolved?"bg-green-50":"bg-white"}`,children:s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("div",{children:[s.jsx("p",{className:"text-sm font-semibold",children:I.authorName}),s.jsx("p",{className:"text-xs text-gray-500",children:I.message})]}),s.jsxs("div",{className:"text-right text-[10px] text-gray-400",children:[s.jsx("p",{children:new Date(I.createdAt).toLocaleString()}),!I.resolved&&s.jsx("button",{onClick:()=>i(e.id,I.id),className:"text-xs text-green-600 hover:underline",children:"Resolve"})]})]})},I.id))]}),u==="compare"&&s.jsx("div",{children:c!=null&&c.expenseWorksheet?s.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Previous Report"}),s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:new Date(c.reportDate).toLocaleDateString()}),s.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["",c.expenseWorksheet.totals.totalBalance.toLocaleString()]})]}),s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsx("h4",{className:"text-sm font-bold text-gray-600 mb-2",children:"Current Report"}),s.jsx("p",{className:"text-xs text-gray-400 mb-2",children:new Date(e.reportDate).toLocaleDateString()}),s.jsxs("p",{className:"text-lg font-bold text-gray-800",children:["",U.totalBalance.toLocaleString()]})]})]}):s.jsx("p",{className:"text-xs text-gray-400",children:"No previous worksheet available for comparison."})})]})]})})},CN=()=>s.jsx(tN,{children:s.jsx(kN,{})}),yh=document.getElementById("root");if(!yh)throw new Error("Could not find root element to mount to");const DN=Io.createRoot(yh);DN.render(s.jsx(bi.StrictMode,{children:s.jsx(CN,{})}));
