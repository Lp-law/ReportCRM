# אבחון UX ו־Flow — "לפני שליחת הדיווח" (ליאור / ADMIN)

**תאריך:** 2025-02-06  
**תחום:** Block 1 — בדיקת הדיווח לפני שליחה  
**תפקיד:** LIOR / ADMIN  
**סוג:** אבחון בלבד — ללא הצעות פתרון או שינוי קוד

---

## 1. Executive Summary

ליאור מגיע לשלב "לפני שליחה" בשני מקומות: **שלב 2 (Draft)** — שם מבוצעות בדיקות ניסוח ו־Tone & Risk — ו־**שלב 3 (Preview)** — שם מתבצעות תצוגה מקדימה, עריכת כותרות קובץ ושליחה. במסך ה־Preview מופיעים כפתורים רבים באותו משקל ויזואלי, כאשר "Edit file name titles" עשוי להיות מושבת ללא הסבר. העוזר החכם מופיע שלוש פעמים בזרימה, וכשנכשל — מוצגת הודעה גנרית. כפתורי JSON/CSV Export מוסתרים מ־ADMIN, אך הטקסט "Export options let you back up… (JSON/CSV)" עדיין מופיע. אין היררכיה ברורה בין פעולה ראשית (Finalize) לפעולות משניות.

---

## 2. טבלת כפתורים מלאה (מיפוי)

| כפתור | מיקום | פעיל / לא פעיל | Role | שלב רלוונטי |
|-------|--------|-----------------|------|-------------|
| 1. Setup | Stepper (header) | פעיל (ניווט) | כולם | תמיד |
| 2. Draft | Stepper (header) | פעיל (ניווט) | כולם | תמיד |
| 3. Preview | Stepper (header) | פעיל (ניווט) | כולם | תמיד |
| העוזר החכם | Stepper (צד ימין) | פעיל | כולם (חוץ מ־restricted) | תמיד |
| חזרה לשלב 1 | Toolbar עליון STEP2 | פעיל | ADMIN | STEP2 בלבד |
| Auto-Translate | Toolbar עליון STEP2 | מותנה (canTranslateNow) | ADMIN | STEP2 |
| Improve English | Toolbar עליון STEP2 | מותנה (isTranslated, hasEnglishToImprove) | ADMIN | STEP2 |
| עברית + אנגלית / אנגלית בלבד | Toolbar STEP2 | פעיל | ADMIN | STEP2 |
| Format Text | Toolbar STEP2 | פעיל | ADMIN | STEP2 |
| חזרה לדשבורד | Toolbar STEP2 | פעיל | כולם | STEP2 |
| העוזר החכם | ליד "2. Draft Content" | פעיל | כולם (חוץ מ־restricted) | STEP2 |
| בדיקת ניסוח (הערות בלבד) | בלוק "בדיקות לפני שליחה" | מותנה (!isHebrewStyleRunning) | כולם | STEP2 |
| הערת ניסוח (N) | בלוק "בדיקות לפני שליחה" | פעיל (מופיע רק אם יש הערות) | כולם | STEP2 |
| בדיקת Tone & Risk (למבטחת) | בלוק "בדיקות לפני שליחה" | מותנה (!isToneRiskRunning) | כולם | STEP2 |
| נקה תוצאות Tone & Risk | בלוק "בדיקות לפני שליחה" | פעיל (מופיע רק אם יש תוצאות) | כולם | STEP2 |
| העוזר החכם | Toolbar Preview | פעיל | כולם | PREVIEW |
| Hide Preview / Show Preview | Toolbar Preview | פעיל | כולם | PREVIEW |
| Download PDF | Toolbar Preview | מותנה (!isPdfGenerating) | כולם | PREVIEW |
| Edit file name titles | Toolbar Preview | **חסום** כאשר `availableFileNameTitleOptions.length === 0` | כולם | PREVIEW |
| JSON Export | Toolbar Preview | **מוסתר** מ־ADMIN ו־LAWYER | FINANCE, SUB_ADMIN | PREVIEW |
| CSV Export | Toolbar Preview | **מוסתר** מ־ADMIN ו־LAWYER | FINANCE, SUB_ADMIN | PREVIEW |
| Finalize & Close | Toolbar Preview | פעיל | כולם | PREVIEW |
| הכן שליחה מחדש למבטחת | Toolbar Preview | פעיל | ADMIN בלבד | PREVIEW |
| Back to Editing | תחתית Preview | פעיל | כולם | PREVIEW |
| Back to dashboard | בתוך אזור שמירה | פעיל | כולם | PREVIEW |

---

## 3. כפילויות ועומס

### כפילויות
- **העוזר החכם** מופיע בשלושה מקומות: (1) Stepper header, (2) ליד "2. Draft Content" ב־STEP2, (3) Toolbar Preview. אותו כפתור, אותה פעולה — פתיחת פאנל צד.
- אין כפתורים זהים תחת שמות שונים.

### עומס ויזואלי
- ב־Preview, כל הכפתורים (העוזר החכם, Toggle, Download PDF, Edit file names, Finalize, הכן שליחה מחדש) מוצגים בשורה אחת עם `flex gap-2`, באותו משקל סגנוני — כולם border / bg-panel או דומה. אין הבחנה ברורה בין פעולה ראשית (Finalize) לפעולות משניות.
- בלוק "בדיקות לפני שליחה" ב־STEP2 מכיל 4–5 אלמנטים לחיצים בקבוצה אחת — בדיקת ניסוח, הערת ניסוח, Tone & Risk, נקה — בלי הפרדה ויזואלית בולטת בין "הרצת בדיקה" ל"פעולות על תוצאות".

---

## 4. פעולות מיותרות בשלב זה

- **JSON Export / CSV Export** — מוסתרים מ־ADMIN. לליאור בשלב "לפני שליחה" הם אינם מוצגים. עם זאת, הטקסט "Export options let you back up the current report data (JSON/CSV) in addition to the PDF" מופיע מעל ה־Toolbar ומזכיר אפשרויות שאינן זמינות ל־ADMIN.
- **העוזר החכם** — רלוונטי, אך שלוש הופעות יוצרות כפילות; לא ברור אם כולן נדרשות בשלב "לפני שליחה".

---

## 5. פעולות לא מתפקדות / מבלבלות

### Edit file name titles — כפתור חסום
- **מיקום:** Toolbar Preview.
- **תנאי חסימה:** `disabled={!canEditFileNameTitles}` — כאשר `availableFileNameTitleOptions.length === 0`.
- **מתי זה קורה:** כאשר `mapSectionsToFileNameTitles(selectedSections)` מחזיר מערך ריק — למשל `selectedSections` ריק, או שכל הסקשנים לא ממופים ל־label ב־SECTION_LABELS (למשל סקשנים מותאמים אישית).
- **מה המשתמש מצפה:** לחיצה על "Edit file name titles" תפתח מודל לעריכת כותרות.
- **מה קורה בפועל:** הכפתור אפור ולא לחיץ, ללא הודעה או tooltip המסבירים למה הוא חסום.
- **למה זה מבלבל:** אין הקשר — המשתמש לא יודע אם הדיווח חסר נתונים, או שיש תקלה, או שפשוט אין סקשנים תואמים.

### העוזר החכם — כשלון
- **מתי:** כשבקשת ה־API נכשלת (למשל רשת, API key).
- **מה המשתמש מצפה:** הסבר או פעולה מהירה.
- **מה קורה בפועל:** בפאנל מוצגת הודעה "העוזר החכם אינו זמין כרגע" עם טקסט "ניתן להמשיך לעבוד כרגיל… אם התקלה חוזרת, כדאי לדווח לליאור." אין פירוט על סיבת הכשל (רשת, מפתח, וכו').
- **למה זה מבלבל:** הודעה גנרית — לא ברור אם הבעיה זמנית או קבועה, ואם יש צעד פעולה ברור.

---

## 6. נקודות בלבול קריטיות למשתמש

1. **Edit file name titles חסום** — אין הסבר למה הכפתור לא לחיץ. ליאור עשוי לחשוב שזו שגיאה או שמשהו חסר בדיווח.
2. **טקסט Export (JSON/CSV)** — מוזכר באזור ה־Preview אך הכפתורים עצמם מוסתרים מ־ADMIN. נוצר רושם שיש אפשרות ש־ADMIN לא רואה.
3. **היררכיה ב־Preview** — Finalize ו־הכן שליחה מחדש נראים דומים ויזואלית; לא ברור איזה מהם הפעולה העיקרית ל"שליחה סופית" לעומת "שליחה מחדש".
4. **העוזר החכם בשלושה מקומות** — לא ברור אם יש הבדל בין הכפתורים או שמדובר באותו דבר; עלול ליצור רעש ויזואלי.

---

## 7. סיכום: מה ברור / מה לא ברור / אילו החלטות מוצר נדרשות

### מה ברור
- הזרימה הכללית: Setup → Draft → Preview → Finalize.
- הבדיקות "בדיקת ניסוח" ו־"Tone & Risk" ממוקמות ב־STEP2 ומסומנות כ"בדיקות לפני שליחה".
- הפעולות הראשיות — Download PDF, Finalize, הכן שליחה מחדש — זמינות ב־Preview.

### מה לא ברור
- מתי ולמה "Edit file name titles" חסום, ומה לעשות כדי לפתור.
- מדוע מוזכרים JSON/CSV Export כשהם לא זמינים ל־ADMIN.
- האם נדרשות שלוש הופעות של העוזר החכם, או שמספיק כפתור אחד גלובלי.
- מה ההבדל המעשי בין Finalize ל־הכן שליחה מחדש מבחינת המשתמש — מתי להשתמש בכל אחד.

### החלטות מוצר נדרשות
1. האם להציג הסבר/tooltip כש־Edit file name titles חסום (למשל: "אין סקשנים להצגת כותרות" או "בחר סקשנים בשלב Setup")?
2. האם להסיר או להתאים את הטקסט על Export options כשהכפתורים מוסתרים מ־ADMIN?
3. האם להפחית את מספר הופעות העוזר החכם, או להשאיר כפי שהוא?
4. האם לשפר את ההיררכיה הוויזואלית ב־Preview — הבדלה בין Finalize (פעולה ראשית) לפעולות משניות?

---

*מסמך זה הוא אבחון בלבד. לא בוצעו שינויים בקוד.*
